"use strict";(self.webpackChunkSherlyn=self.webpackChunkSherlyn||[]).push([[263],{9644:(r5,Gd,ar)=>{ar.r(Gd),ar.d(Gd,{SummaryModule:()=>HL});var hn=ar(177),Hd=ar(803),oi=ar(467),Ur=ar(7376),D=ar(7705),dm=ar(1088),zd=ar(6600);const um=["*"],mm=new D.nKC("MAT_CARD_CONFIG");let Vd=(()=>{class e{constructor(r){this.appearance=r?.appearance||"raised"}static#e=this.\u0275fac=function(i){return new(i||e)(D.rXU(mm,8))};static#t=this.\u0275cmp=D.VBU({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,s){2&i&&D.AVh("mat-mdc-card-outlined","outlined"===s.appearance)("mdc-card--outlined","outlined"===s.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:um,decls:1,vars:0,template:function(i,s){1&i&&(D.NAR(),D.SdG(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation);--mdc-elevated-card-container-shape:4px;--mdc-outlined-card-container-shape:4px;--mdc-outlined-card-outline-width:1px}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return e})(),vm=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=D.$C({type:e});static#r=this.\u0275inj=D.G2t({imports:[zd.yE,hn.MD,zd.yE]})}return e})(),Cm=(()=>{class e{constructor(){this.cardsdata=[]}ngOnInit(){}ngOnChanges(){this.cardsdata=this.carddetails}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=D.VBU({type:e,selectors:[["app-summarycard"]],inputs:{carddetails:"carddetails"},features:[D.OA$],decls:9,vars:5,consts:[[1,"card-wrapper"],[1,"example-card"],[1,"mx-auto","mt-2"],[1,"text-center","highcard"],[1,"text-center"]],template:function(i,s){1&i&&(D.j41(0,"div",0)(1,"mat-card",1)(2,"h1",2),D.EFF(3),D.k0s(),D.j41(4,"span",3),D.EFF(5),D.k0s(),D.j41(6,"h3",4),D.EFF(7),D.nI1(8,"uppercase"),D.k0s()()()),2&i&&(D.R7$(3),D.JRh(s.carddetails.heading),D.R7$(2),D.JRh(s.carddetails.matprice),D.R7$(2),D.JRh(D.bMT(8,3,s.carddetails.matname)))},dependencies:[Vd,hn.Pc],styles:['.card-wrapper[_ngcontent-%COMP%]{margin:5px;box-sizing:border-box;transition:transform .3s ease,box-shadow .3s ease}.example-card[_ngcontent-%COMP%]{background:linear-gradient(to right,#0980b2,#0ca6d9);color:#fff!important;width:250px;height:120px;overflow:hidden;position:relative}.example-card[_ngcontent-%COMP%]:before{content:"";position:absolute;height:200px;width:20px;box-shadow:0 0 10px #fff;background-color:#fff;filter:blur(1px);opacity:.9;top:-30px;transform:rotate(-20deg) translate(-60px);animation:_ngcontent-%COMP%_slide 7s infinite}@keyframes _ngcontent-%COMP%_slide{0%{transform:rotate(-20deg) translate(-60px);opacity:.9}40%{transform:rotate(-20deg) translate(400px,70px);opacity:.9}50%{opacity:0}to{transform:rotate(-20deg) translate(-60px);opacity:0}}@media (max-width: 650px){.cardlength[_ngcontent-%COMP%]{width:10rem}.cardlengthtotal[_ngcontent-%COMP%]{width:100%}.h1[_ngcontent-%COMP%]{font-size:.5em}.cards[_ngcontent-%COMP%]{font-size:1em}}.highcard[_ngcontent-%COMP%]{color:beige;text-transform:uppercase;font-size:20px;font-weight:800;padding-bottom:1vh}']})}return e})();var gn={version:"0.18.5"},lr=1200,Xi=1252,wm=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Wa={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yo=function(e){-1!=wm.indexOf(e)&&(Xi=Wa[0]=e)},Cr=function(e){lr=e,yo(e)};var ze,fn=function(t){return String.fromCharCode(t)},Ua=function(t){return String.fromCharCode(t)},nt=null,Fi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mn(e){for(var t="",r=0,i=0,s=0,n=0,o=0,a=0,l=0,c=0;c<e.length;)n=(r=e.charCodeAt(c++))>>2,o=(3&r)<<4|(i=e.charCodeAt(c++))>>4,a=(15&i)<<2|(s=e.charCodeAt(c++))>>6,l=63&s,isNaN(i)?a=l=64:isNaN(s)&&(l=64),t+=Fi.charAt(n)+Fi.charAt(o)+Fi.charAt(a)+Fi.charAt(l);return t}function cr(e){var t="",n=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)n=Fi.indexOf(e.charAt(c++)),o=Fi.indexOf(e.charAt(c++)),t+=String.fromCharCode(n<<2|o>>4),64!==(a=Fi.indexOf(e.charAt(c++)))&&(t+=String.fromCharCode((15&o)<<4|a>>2)),64!==(l=Fi.indexOf(e.charAt(c++)))&&(t+=String.fromCharCode((3&a)<<6|l));return t}var Pe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ai=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ri(e){return Pe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ud(e){return Pe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var dr=function(t){return Pe?ai(t,"binary"):t.split("").map(function(r){return 255&r.charCodeAt(0)})};function vn(e){if(typeof ArrayBuffer>"u")return dr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),i=0;i!=e.length;++i)r[i]=255&e.charCodeAt(i);return t}function ki(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var bt=Pe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ai(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var i=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)i.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";i.set(new Uint8Array(e[t]),r)}return i}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))},Mt=/\u0000/g,Cn=/[\u0001-\u0006]/g;function Ms(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Or(e,t){var r=""+e;return r.length>=t?r:at("0",t-r.length)+r}function $a(e,t){var r=""+e;return r.length>=t?r:at(" ",t-r.length)+r}function Fo(e,t){var r=""+e;return r.length>=t?r:r+at(" ",t-r.length)}var jd=Math.pow(2,32);function Is(e,t){return e>jd||e<-jd?function Em(e,t){var r=""+Math.round(e);return r.length>=t?r:at("0",t-r.length)+r}(e,t):function Fm(e,t){var r=""+e;return r.length>=t?r:at("0",t-r.length)+r}(Math.round(e),t)}function Ro(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var $d=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ka=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Se={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Kd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},km={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ko(e,t,r){for(var i=e<0?-1:1,s=e*i,n=0,o=1,a=0,l=1,c=0,d=0,u=Math.floor(s);c<t&&(a=(u=Math.floor(s))*o+n,d=u*c+l,!(s-u<5e-8));)s=1/(s-u),n=o,o=a,l=c,c=d;if(d>t&&(c>t?(d=l,a=n):(d=c,a=o)),!r)return[0,i*a,d];var h=Math.floor(i*a/d);return[h,i*a-h*d,d]}function Ti(e,t,r){if(e>2958465||e<0)return null;var i=0|e,s=Math.floor(86400*(e-i)),n=0,o=[],a={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(i+=1462),a.u>.9999&&(a.u=0,86400==++s&&(a.T=s=0,++i,++a.D)),60===i)o=r?[1317,10,29]:[1900,2,29],n=3;else if(0===i)o=r?[1317,8,29]:[1900,1,0],n=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),i<60&&(n=(n+6)%7),r&&(n=function Im(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=s%60,s=Math.floor(s/60),a.M=s%60,s=Math.floor(s/60),a.H=s,a.q=n,a}var Yd=new Date(1899,11,31,0,0,0),Tm=Yd.getTime(),Dm=new Date(1900,2,1,0,0,0);function qd(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Dm&&(r+=864e5),(r-(Tm+6e4*(e.getTimezoneOffset()-Yd.getTimezoneOffset())))/864e5}function Ya(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):function wn(e){var r,t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return r=t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?function Pm(e){var t=e<0?12:11,r=Ya(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===t?e.toFixed(10).substr(0,12):function Mm(e){var t=Ya(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Ya(function Am(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(r.toUpperCase()))}(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return ur(14,qd(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Lm(e,t,r,i){var l,s="",n=0,o=0,a=r.y,c=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Ka[r.m-1][1];case 5:return Ka[r.m-1][0];default:return Ka[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return $d[r.q][0];default:return $d[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=i>=2?3===i?1e3:100:1===i?10:1,(n=Math.round(o*(r.S+r.u)))>=60*o&&(n=0),"s"===t?0===n?"0":""+n/o:(s=Or(n,2+i),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Or(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":l=24*r.D+r.H;break;case"[m]":case"[mm]":l=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":l=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:l=a,c=1}return c>0?Or(l,c):""}function Di(e){if(e.length<=3)return e;for(var r=e.length%3,i=e.substr(0,r);r!=e.length;r+=3)i+=(i.length>0?",":"")+e.substr(r,3);return i}var Xd=/%/g;function Qd(e,t){var r,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Qd(e,-t);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),-1===(r=(t/Math.pow(10,n)).toPrecision(i+1+(s+n)%s)).indexOf("e")){var o=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,d){return l+c+d.substr(0,(s+n)%s)+"."+d.substr(n)+"E"})}else r=t.toExponential(i);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Zd=/# (\?+)( ?)\/( ?)(\d+)/,Jd=/^#*0*\.([0#]+)/,eu=/\).*[0#]/,tu=/\(###\) ###\\?-####/;function Ut(e){for(var r,t="",i=0;i!=e.length;++i)switch(r=e.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ru(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function iu(e,t){var r=e-Math.floor(e),i=Math.pow(10,t);return t<(""+Math.round(r*i)).length?0:Math.round(r*i)}function wr(e,t,r){if(40===e.charCodeAt(0)&&!t.match(eu)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wr("n",i,r):"("+wr("n",i,-r)+")"}if(44===t.charCodeAt(t.length-1))return function Om(e,t,r){for(var i=t.length-1;44===t.charCodeAt(i-1);)--i;return li(e,t.substr(0,i),r/Math.pow(10,3*(t.length-i)))}(e,t,r);if(-1!==t.indexOf("%"))return function _m(e,t,r){var i=t.replace(Xd,""),s=t.length-i.length;return li(e,i,r*Math.pow(10,2*s))+at("%",s)}(e,t,r);if(-1!==t.indexOf("E"))return Qd(t,r);if(36===t.charCodeAt(0))return"$"+wr(e,t.substr(" "==t.charAt(1)?2:1),r);var s,n,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Is(l,t.length);if(t.match(/^[#?]+$/))return"0"===(s=Is(r,0))&&(s=""),s.length>t.length?s:Ut(t.substr(0,t.length-s.length))+s;if(n=t.match(Zd))return function Bm(e,t,r){var i=parseInt(e[4],10),s=Math.round(t*i),n=Math.floor(s/i),o=s-n*i,a=i;return r+(0===n?"":""+n)+" "+(0===o?at(" ",e[1].length+1+e[4].length):$a(o,e[1].length)+e[2]+"/"+e[3]+Or(a,e[4].length))}(n,l,c);if(t.match(/^#+0+$/))return c+Is(l,t.length-t.indexOf("0"));if(n=t.match(Jd))return s=ru(r,n[1].length).replace(/^([^\.]+)$/,"$1."+Ut(n[1])).replace(/\.$/,"."+Ut(n[1])).replace(/\.(\d*)$/,function(p,f){return"."+f+at("0",Ut(n[1]).length-f.length)}),-1!==t.indexOf("0.")?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+ru(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+Di(Is(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wr(e,t,-r):Di(""+(Math.floor(r)+function Gm(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,n[1].length)))+"."+Or(iu(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return wr(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ms(wr(e,t.replace(/[\\-]/g,""),r)),o=0,Ms(Ms(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<s.length?s.charAt(o++):"0"===p?"0":""}));if(t.match(tu))return"("+(s=wr(e,"##########",r)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),a=ko(l,Math.pow(10,o)-1,!1),s=""+c," "==(d=li("n",n[1],a[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],(d=Fo(a[2],o)).length<n[4].length&&(d=Ut(n[4].substr(n[4].length-d.length))+d),s+=d;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),c+((a=ko(l,Math.pow(10,o)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?$a(a[1],o)+n[2]+"/"+n[3]+Fo(a[2],o):at(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=Is(r,0),t.length<=s.length?s:Ut(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var u=t.indexOf(".")-o,h=t.length-s.length-u;return Ut(t.substr(0,u)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return o=iu(r,n[1].length),r<0?"-"+wr(e,t,-r):Di(function Hm(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Or(0,3-p.length):"")+p})+"."+Or(o,n[1].length);switch(t){case"###,##0.00":return wr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Di(Is(l,0));return"0"!==g?c+g:"";case"###,###.00":return wr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function su(e,t){var r,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+su(e,-t);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),!(r=(t/Math.pow(10,n)).toPrecision(i+1+(s+n)%s)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,d){return l+c+d.substr(0,(s+n)%s)+"."+d.substr(n)+"E"})}else r=t.toExponential(i);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function jr(e,t,r){if(40===e.charCodeAt(0)&&!t.match(eu)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jr("n",i,r):"("+jr("n",i,-r)+")"}if(44===t.charCodeAt(t.length-1))return function zm(e,t,r){for(var i=t.length-1;44===t.charCodeAt(i-1);)--i;return li(e,t.substr(0,i),r/Math.pow(10,3*(t.length-i)))}(e,t,r);if(-1!==t.indexOf("%"))return function Vm(e,t,r){var i=t.replace(Xd,""),s=t.length-i.length;return li(e,i,r*Math.pow(10,2*s))+at("%",s)}(e,t,r);if(-1!==t.indexOf("E"))return su(t,r);if(36===t.charCodeAt(0))return"$"+jr(e,t.substr(" "==t.charAt(1)?2:1),r);var s,n,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Or(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,0===r&&(s=""),s.length>t.length?s:Ut(t.substr(0,t.length-s.length))+s;if(n=t.match(Zd))return function Nm(e,t,r){return r+(0===t?"":""+t)+at(" ",e[1].length+2+e[4].length)}(n,l,c);if(t.match(/^#+0+$/))return c+Or(l,t.length-t.indexOf("0"));if(n=t.match(Jd))return s=(s=(""+r).replace(/^([^\.]+)$/,"$1."+Ut(n[1])).replace(/\.$/,"."+Ut(n[1]))).replace(/\.(\d*)$/,function(p,f){return"."+f+at("0",Ut(n[1]).length-f.length)}),-1!==t.indexOf("0.")?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+Di(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jr(e,t,-r):Di(""+r)+"."+at("0",n[1].length);if(n=t.match(/^#,#*,#0/))return jr(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ms(jr(e,t.replace(/[\\-]/g,""),r)),o=0,Ms(Ms(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<s.length?s.charAt(o++):"0"===p?"0":""}));if(t.match(tu))return"("+(s=jr(e,"##########",r)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),a=ko(l,Math.pow(10,o)-1,!1),s=""+c," "==(d=li("n",n[1],a[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],(d=Fo(a[2],o)).length<n[4].length&&(d=Ut(n[4].substr(n[4].length-d.length))+d),s+=d;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),c+((a=ko(l,Math.pow(10,o)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?$a(a[1],o)+n[2]+"/"+n[3]+Fo(a[2],o):at(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return t.length<=(s=""+r).length?s:Ut(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var u=t.indexOf(".")-o,h=t.length-s.length-u;return Ut(t.substr(0,u)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+jr(e,t,-r):Di(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Or(0,3-p.length):"")+p})+"."+Or(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Di(""+l);return"0"!==g?c+g:"";default:if(t.match(/\.[0#?]*$/))return jr(e,t.slice(0,t.lastIndexOf(".")),r)+Ut(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function li(e,t,r){return(0|r)===r?jr(e,t,r):wr(e,t,r)}var nu=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ls(e){for(var t=0,r="",i="";t<e.length;)switch(r=e.charAt(t)){case"G":Ro(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase()||"AM/PM"===e.substr(t,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(i=r;"]"!==e.charAt(t++)&&t<e.length;)i+=e.charAt(t);if(i.match(nu))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(" "==e.charAt(t)||"*"==e.charAt(t))&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var ou=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function au(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function ur(e,t,r){null==r&&(r={});var i="";switch(typeof e){case"string":i="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(i=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Se)[e])&&(i=r.table&&r.table[Kd[e]]||Se[Kd[e]]),null==i&&(i=km[e]||"General")}if(Ro(i,0))return Qi(t,r);t instanceof Date&&(t=qd(t,r.date1904));var s=function jm(e,t){var r=function Wm(e){for(var t=[],r=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=e.substr(s,i-s),s=i+1}if(t[t.length]=e.substr(s),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),i=r.length,s=r[i-1].indexOf("@");if(i<4&&s>-1&&--i,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var n=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[i,n];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var o=r[0].match(ou),a=r[1].match(ou);return au(t,o)?[i,r[0]]:au(t,a)?[i,r[1]]:[i,r[null!=o&&null!=a?2:1]]}return[i,n]}(i,t);if(Ro(s[1]))return Qi(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function Um(e,t,r,i){for(var c,d,u,s=[],n="",o=0,a="",l="t",h="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!Ro(e,o))throw new Error("unrecognized character "+a+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(n="";34!==(u=e.charCodeAt(++o))&&o<e.length;)n+=String.fromCharCode(u);s[s.length]={t:"t",v:n},++o;break;case"\\":var g=e.charAt(++o);s[s.length]={t:"("===g||")"===g?g:"t",v:g},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if("1"===e.charAt(o+1)||"2"===e.charAt(o+1)){if(null==c&&null==(c=Ti(t,r,"2"===e.charAt(o+1))))return"";s[s.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||null==c&&null==(c=Ti(t,r)))return"";for(n=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)n+=a;"m"===a&&"h"===l.toLowerCase()&&(a="M"),"h"===a&&(a=h),s[s.length]={t:a,v:n},l=a;break;case"A":case"a":case"\u4e0a":var f={t:a,v:a};if(null==c&&(c=Ti(t,r)),"A/P"===e.substr(o,3).toUpperCase()?(null!=c&&(f.v=c.H>=12?"P":"A"),f.t="T",h="h",o+=3):"AM/PM"===e.substr(o,5).toUpperCase()?(null!=c&&(f.v=c.H>=12?"PM":"AM"),f.t="T",o+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(o,5).toUpperCase()?(null!=c&&(f.v=c.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),f.t="T",o+=5,h="h"):(f.t="t",++o),null==c&&"T"===f.t)return"";s[s.length]=f,l=a;break;case"[":for(n=a;"]"!==e.charAt(o++)&&o<e.length;)n+=e.charAt(o);if("]"!==n.slice(-1))throw'unterminated "[" block: |'+n+"|";if(n.match(nu)){if(null==c&&null==(c=Ti(t,r)))return"";s[s.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ls(e)||(s[s.length]={t:"t",v:n}));break;case".":if(null!=c){for(n=a;++o<e.length&&"0"===(a=e.charAt(o));)n+=a;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)n+=a;s[s.length]={t:"n",v:n};break;case"?":for(n=a;e.charAt(++o)===a;)n+=a;s[s.length]={t:a,v:n},l=a;break;case"*":++o,(" "==e.charAt(o)||"*"==e.charAt(o))&&++o;break;case"(":case")":s[s.length]={t:1===i?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)n+=e.charAt(o);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:a,v:a},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(a))throw new Error("unrecognized character "+a+" in "+e);s[s.length]={t:"t",v:a},++o}var C,m=0,w=0;for(o=s.length-1,l="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,l="h",m<1&&(m=1);break;case"s":(C=s[o].v.match(/\.0+$/))&&(w=Math.max(w,C[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=s[o].t;break;case"m":"s"===l&&(s[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&s[o].v.match(/[Hh]/)&&(m=1),m<2&&s[o].v.match(/[Mm]/)&&(m=2),m<3&&s[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M)}var k,v="";for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=Lm(s[o].t.charCodeAt(0),s[o].v,c,w),s[o].t="t";break;case"n":case"?":for(k=o+1;null!=s[k]&&("?"===(a=s[k].t)||"D"===a||(" "===a||"t"===a)&&null!=s[k+1]&&("?"===s[k+1].t||"t"===s[k+1].t&&"/"===s[k+1].v)||"("===s[o].t&&(" "===a||"n"===a||")"===a)||"t"===a&&("/"===s[k].v||" "===s[k].v&&null!=s[k+1]&&"?"==s[k+1].t));)s[o].v+=s[k].v,s[k]={v:"",t:";"},++k;v+=s[o].v,o=k-1;break;case"G":s[o].t="t",s[o].v=Qi(t,r)}var O,y,M="";if(v.length>0){40==v.charCodeAt(0)?(O=t<0&&45===v.charCodeAt(0)?-t:t,y=li("n",v,O)):(y=li("n",v,O=t<0&&i>1?-t:t),O<0&&s[0]&&"t"==s[0].t&&(y=y.substr(1),s[0].v="-"+s[0].v)),k=y.length-1;var L=s.length;for(o=0;o<s.length;++o)if(null!=s[o]&&"t"!=s[o].t&&s[o].v.indexOf(".")>-1){L=o;break}var _=s.length;if(L===s.length&&-1===y.indexOf("E")){for(o=s.length-1;o>=0;--o)null==s[o]||-1==="n?".indexOf(s[o].t)||(k>=s[o].v.length-1?s[o].v=y.substr(1+(k-=s[o].v.length),s[o].v.length):k<0?s[o].v="":(s[o].v=y.substr(0,k+1),k=-1),s[o].t="t",_=o);k>=0&&_<s.length&&(s[_].v=y.substr(0,k+1)+s[_].v)}else if(L!==s.length&&-1===y.indexOf("E")){for(k=y.indexOf(".")-1,o=L;o>=0;--o)if(null!=s[o]&&-1!=="n?".indexOf(s[o].t)){for(d=s[o].v.indexOf(".")>-1&&o===L?s[o].v.indexOf(".")-1:s[o].v.length-1,M=s[o].v.substr(d+1);d>=0;--d)k>=0&&("0"===s[o].v.charAt(d)||"#"===s[o].v.charAt(d))&&(M=y.charAt(k--)+M);s[o].v=M,s[o].t="t",_=o}for(k>=0&&_<s.length&&(s[_].v=y.substr(0,k+1)+s[_].v),k=y.indexOf(".")+1,o=L;o<s.length;++o)if(null!=s[o]&&(-1!=="n?(".indexOf(s[o].t)||o===L)){for(d=s[o].v.indexOf(".")>-1&&o===L?s[o].v.indexOf(".")+1:0,M=s[o].v.substr(0,d);d<s[o].v.length;++d)k<y.length&&(M+=y.charAt(k++));s[o].v=M,s[o].t="t",_=o}}}for(o=0;o<s.length;++o)null!=s[o]&&"n?".indexOf(s[o].t)>-1&&(s[o].v=li(s[o].t,s[o].v,O=i>1&&t<0&&o>0&&"-"===s[o-1].v?-t:t),s[o].t="t");var j="";for(o=0;o!==s.length;++o)null!=s[o]&&(j+=s[o].v);return j}(s[1],t,r,s[0])}function $r(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null!=Se[r]){if(Se[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Se[t]=e,t}function xn(e){for(var t=0;392!=t;++t)void 0!==e[t]&&$r(e[t],t)}function _s(){Se=function Rm(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var lu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Xm=function(){var e={version:"1.2.0"},r=function t(){for(var y=0,L=new Array(256),_=0;256!=_;++_)L[_]=y=1&(y=1&(y=1&(y=1&(y=1&(y=1&(y=1&(y=1&(y=_)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1)?-306674912^y>>>1:y>>>1;return typeof Int32Array<"u"?new Int32Array(L):L}(),s=function i(y){var L=0,_=0,j=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;256!=j;++j)K[j]=y[j];for(j=0;256!=j;++j)for(_=y[j],L=256+j;L<4096;L+=256)_=K[L]=_>>>8^y[255&_];var B=[];for(j=1;16!=j;++j)B[j-1]=typeof Int32Array<"u"?K.subarray(256*j,256*j+256):K.slice(256*j,256*j+256);return B}(r),n=s[0],o=s[1],a=s[2],l=s[3],c=s[4],d=s[5],u=s[6],h=s[7],g=s[8],p=s[9],f=s[10],m=s[11],w=s[12],C=s[13],v=s[14];return e.table=r,e.bstr=function k(y,L){for(var _=-1^L,j=0,K=y.length;j<K;)_=_>>>8^r[255&(_^y.charCodeAt(j++))];return~_},e.buf=function M(y,L){for(var _=-1^L,j=y.length-15,K=0;K<j;)_=v[y[K++]^255&_]^C[y[K++]^_>>8&255]^w[y[K++]^_>>16&255]^m[y[K++]^_>>>24]^f[y[K++]]^p[y[K++]]^g[y[K++]]^h[y[K++]]^u[y[K++]]^d[y[K++]]^c[y[K++]]^l[y[K++]]^a[y[K++]]^o[y[K++]]^n[y[K++]]^r[y[K++]];for(j+=15;K<j;)_=_>>>8^r[255&(_^y[K++])];return~_},e.str=function O(y,L){for(var _=-1^L,j=0,K=y.length,B=0,ae=0;j<K;)(B=y.charCodeAt(j++))<128?_=_>>>8^r[255&(_^B)]:B<2048?_=(_=_>>>8^r[255&(_^(192|B>>6&31))])>>>8^r[255&(_^(128|63&B))]:B>=55296&&B<57344?(B=64+(1023&B),ae=1023&y.charCodeAt(j++),_=(_=(_=(_=_>>>8^r[255&(_^(240|B>>8&7))])>>>8^r[255&(_^(128|B>>2&63))])>>>8^r[255&(_^(128|ae>>6&15|(3&B)<<4))])>>>8^r[255&(_^(128|63&ae))]):_=(_=(_=_>>>8^r[255&(_^(224|B>>12&15))])>>>8^r[255&(_^(128|B>>6&63))])>>>8^r[255&(_^(128|63&B))];return~_},e}(),we=function(){var l,t={};function i(x){if("/"==x.charAt(x.length-1))return-1===x.slice(0,-1).indexOf("/")?x:i(x.slice(0,-1));var E=x.lastIndexOf("/");return-1===E?x:x.slice(0,E+1)}function s(x){if("/"==x.charAt(x.length-1))return s(x.slice(0,-1));var E=x.lastIndexOf("/");return-1===E?x:x.slice(E+1)}function n(x,E){"string"==typeof E&&(E=new Date(E));var S=E.getHours();S=(S=S<<6|E.getMinutes())<<5|E.getSeconds()>>>1,x.write_shift(2,S);var b=E.getFullYear()-1980;b=(b=b<<4|E.getMonth()+1)<<5|E.getDate(),x.write_shift(2,b)}function a(x){At(x,0);for(var E={},S=0;x.l<=x.length-4;){var b=x.read_shift(2),F=x.read_shift(2),R=x.l+F,G={};21589===b&&(1&(S=x.read_shift(1))&&(G.mtime=x.read_shift(4)),F>5&&(2&S&&(G.atime=x.read_shift(4)),4&S&&(G.ctime=x.read_shift(4))),G.mtime&&(G.mt=new Date(1e3*G.mtime))),x.l=R,E[b]=G}return E}function c(){return l||(l={})}function d(x,E){if(80==x[0]&&75==x[1])return im(x,E);if(109==(32|x[0])&&105==(32|x[1]))return function XL(x,E){if("mime-version:"!=pe(x.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var S=E&&E.root||"",b=(Pe&&Buffer.isBuffer(x)?x.toString("binary"):pe(x)).split("\r\n"),F=0,R="";for(F=0;F<b.length;++F)if(/^Content-Location:/i.test(R=b[F])&&(R=R.slice(R.indexOf("file")),S||(S=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,S.length)!=S))for(;S.length>0&&(S=(S=S.slice(0,S.length-1)).slice(0,S.lastIndexOf("/")+1),R.slice(0,S.length)!=S););var G=(b[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var X="--"+(G[1]||""),W={FileIndex:[],FullPaths:[]};y(W);var re,le=0;for(F=0;F<b.length;++F){var ve=b[F];ve!==X&&ve!==X+"--"||(le++&&qL(W,b.slice(re,F),S),re=F)}return W}(x,E);if(x.length<512)throw new Error("CFB file size "+x.length+" < 512");var S,F,R,G,X,z,b=512,H=[],W=x.slice(0,512);At(W,0);var re=function u(x){if(80==x[x.l]&&75==x[x.l+1])return[0,0];x.chk(me,"Header Signature: "),x.l+=16;var E=x.read_shift(2,"u");return[x.read_shift(2,"u"),E]}(W);switch(S=re[0]){case 3:b=512;break;case 4:b=4096;break;case 0:if(0==re[1])return im(x,E);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}512!==b&&At(W=x.slice(0,b),28);var le=x.slice(0,b);!function h(x,E){var S;switch(x.l+=2,S=x.read_shift(2)){case 9:if(3!=E)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(4!=E)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}x.chk("0600","Mini Sector Shift: "),x.chk("000000000000","Reserved: ")}(W,S);var ve=W.read_shift(4,"i");if(3===S&&0!==ve)throw new Error("# Directory Sectors: Expected 0 saw "+ve);W.l+=4,G=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),X=W.read_shift(4,"i"),F=W.read_shift(4,"i"),z=W.read_shift(4,"i"),R=W.read_shift(4,"i");for(var ce=-1,he=0;he<109&&!((ce=W.read_shift(4,"i"))<0);++he)H[he]=ce;var Fe=function g(x,E){for(var S=Math.ceil(x.length/E)-1,b=[],F=1;F<S;++F)b[F-1]=x.slice(F*E,(F+1)*E);return b[S-1]=x.slice(S*E),b}(x,b);m(z,R,Fe,b,H);var tt=function C(x,E,S,b){var F=x.length,R=[],G=[],X=[],z=[],H=b-1,W=0,re=0,le=0,ve=0;for(W=0;W<F;++W)if(X=[],(le=W+E)>=F&&(le-=F),!G[le]){z=[];var ce=[];for(re=le;re>=0;){ce[re]=!0,G[re]=!0,X[X.length]=re,z.push(x[re]);var he=S[Math.floor(4*re/b)];if(b<4+(ve=4*re&H))throw new Error("FAT boundary crossed: "+re+" 4 "+b);if(!x[he]||ce[re=Ji(x[he],ve)])break}R[le]={nodes:X,data:Au([z])}}return R}(Fe,G,H,b);tt[G].name="!Directory",F>0&&X!==ae&&(tt[X].name="!MiniFAT"),tt[H[0]].name="!FAT",tt.fat_addrs=H,tt.ssz=b;var St=[],vr=[],wo=[];(function v(x,E,S,b,F,R,G,X){for(var ve,z=0,H=b.length?2:0,W=E[x].data,re=0,le=0;re<W.length;re+=128){var ce=W.slice(re,re+128);At(ce,64),le=ce.read_shift(2),ve=Mo(ce,0,le-H),b.push(ve);var he={name:ve,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0};0!==ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)&&(he.ct=k(ce,ce.l-8)),0!==ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)&&(he.mt=k(ce,ce.l-8)),he.start=ce.read_shift(4,"i"),he.size=ce.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=ae,he.name=""),5===he.type?(z=he.start,F>0&&z!==ae&&(E[z].name="!StreamData")):he.size>=4096?(he.storage="fat",void 0===E[he.start]&&(E[he.start]=w(S,he.start,E.fat_addrs,E.ssz)),E[he.start].name=he.name,he.content=E[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:z!==ae&&he.start!==ae&&E[z]&&(he.content=f(he,E[z].data,(E[X]||{}).data))),he.content&&At(he.content,0),R[ve]=he,G.push(he)}})(G,tt,Fe,St,F,{},vr,X),function p(x,E,S){for(var b=0,F=0,R=0,G=0,X=0,z=S.length,H=[],W=[];b<z;++b)H[b]=W[b]=b,E[b]=S[b];for(;X<W.length;++X)F=x[b=W[X]].L,R=x[b].R,G=x[b].C,H[b]===b&&(-1!==F&&H[F]!==F&&(H[b]=H[F]),-1!==R&&H[R]!==R&&(H[b]=H[R])),-1!==G&&(H[G]=b),-1!==F&&b!=H[b]&&(H[F]=H[b],W.lastIndexOf(F)<X&&W.push(F)),-1!==R&&b!=H[b]&&(H[R]=H[b],W.lastIndexOf(R)<X&&W.push(R));for(b=1;b<z;++b)H[b]===b&&(-1!==R&&H[R]!==R?H[b]=H[R]:-1!==F&&H[F]!==F&&(H[b]=H[F]));for(b=1;b<z;++b)if(0!==x[b].type){if((X=b)!=H[X])do{E[b]=E[X=H[X]]+"/"+E[b]}while(0!==X&&-1!==H[X]&&X!=H[X]);H[b]=-1}for(E[0]+="/",b=1;b<z;++b)2!==x[b].type&&(E[b]+="/")}(vr,wo,St),St.shift();var xo={FileIndex:vr,FullPaths:wo};return E&&E.raw&&(xo.raw={header:le,sectors:Fe}),xo}function f(x,E,S){for(var F=x.size,R=[],G=x.start;S&&F>0&&G>=0;)R.push(E.slice(G*B,G*B+B)),F-=B,G=Ji(S,4*G);return 0===R.length?Y(0):bt(R).slice(0,x.size)}function m(x,E,S,b,F){var R=ae;if(x===ae){if(0!==E)throw new Error("DIFAT chain shorter than expected")}else if(-1!==x){var G=S[x],X=(b>>>2)-1;if(!G)return;for(var z=0;z<X&&(R=Ji(G,4*z))!==ae;++z)F.push(R);m(Ji(G,b-4),E-1,S,b,F)}}function w(x,E,S,b,F){var R=[],G=[];F||(F=[]);var X=b-1,z=0,H=0;for(z=E;z>=0;){F[z]=!0,R[R.length]=z,G.push(x[z]);var W=S[Math.floor(4*z/b)];if(b<4+(H=4*z&X))throw new Error("FAT boundary crossed: "+z+" 4 "+b);if(!x[W])break;z=Ji(x[W],H)}return{nodes:R,data:Au([G])}}function k(x,E){return new Date(1e3*(Ft(x,E+4)/1e7*Math.pow(2,32)+Ft(x,E)/1e7-11644473600))}function y(x,E){var S=E||{},b=S.root||"Root Entry";if(x.FullPaths||(x.FullPaths=[]),x.FileIndex||(x.FileIndex=[]),x.FullPaths.length!==x.FileIndex.length)throw new Error("inconsistent CFB structure");0===x.FullPaths.length&&(x.FullPaths[0]=b+"/",x.FileIndex[0]={name:b,type:5}),S.CLSID&&(x.FileIndex[0].clsid=S.CLSID),function L(x){var E="\x01Sh33tJ5";if(!we.find(x,"/"+E)){var S=Y(4);S[0]=55,S[1]=S[3]=50,S[2]=54,x.FileIndex.push({name:E,type:2,content:S,size:4,L:69,R:69,C:69}),x.FullPaths.push(x.FullPaths[0]+E),_(x)}}(x)}function _(x,E){y(x);for(var S=!1,b=!1,F=x.FullPaths.length-1;F>=0;--F){var R=x.FileIndex[F];switch(R.type){case 0:b?S=!0:(x.FileIndex.pop(),x.FullPaths.pop());break;case 1:case 2:case 5:b=!0,isNaN(R.R*R.L*R.C)&&(S=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(S=!0);break;default:S=!0}}if(S||E){var G=new Date(1987,1,19),X=0,z=Object.create?Object.create(null):{},H=[];for(F=0;F<x.FullPaths.length;++F)z[x.FullPaths[F]]=!0,0!==x.FileIndex[F].type&&H.push([x.FullPaths[F],x.FileIndex[F]]);for(F=0;F<H.length;++F){var W=i(H[F][0]);(b=z[W])||(H.push([W,{name:s(W).replace("/",""),type:1,clsid:ye,ct:G,mt:G,content:null}]),z[W]=!0)}for(H.sort(function(ve,ce){return function r(x,E){for(var S=x.split("/"),b=E.split("/"),F=0,R=0,G=Math.min(S.length,b.length);F<G;++F){if(R=S[F].length-b[F].length)return R;if(S[F]!=b[F])return S[F]<b[F]?-1:1}return S.length-b.length}(ve[0],ce[0])}),x.FullPaths=[],x.FileIndex=[],F=0;F<H.length;++F)x.FullPaths[F]=H[F][0],x.FileIndex[F]=H[F][1];for(F=0;F<H.length;++F){var re=x.FileIndex[F],le=x.FullPaths[F];if(re.name=s(le).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||ye,0===F)re.C=H.length>1?1:-1,re.size=0,re.type=5;else if("/"==le.slice(-1)){for(X=F+1;X<H.length&&i(x.FullPaths[X])!=le;++X);for(re.C=X>=H.length?-1:X,X=F+1;X<H.length&&i(x.FullPaths[X])!=i(le);++X);re.R=X>=H.length?-1:X,re.type=1}else i(x.FullPaths[F+1]||"")==i(le)&&(re.R=F+1),re.type=2}}}function j(x,E){var S=E||{};if("mad"==S.fileType)return function QL(x,E){for(var S=E||{},b=S.boundary||"SheetJS",F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(b="------="+b).slice(2)+'"',"","",""],R=x.FullPaths[0],G=R,X=x.FileIndex[0],z=1;z<x.FullPaths.length;++z)if(G=x.FullPaths[z].slice(R.length),(X=x.FileIndex[z]).size&&X.content&&"\x01Sh33tJ5"!=G){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var H=X.content,W=Pe&&Buffer.isBuffer(H)?H.toString("binary"):pe(H),re=0,le=Math.min(1024,W.length),ve=0,ce=0;ce<=le;++ce)(ve=W.charCodeAt(ce))>=32&&ve<128&&++re;var he=re>=4*le/5;F.push(b),F.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+G),F.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),F.push("Content-Type: "+jL(X,G)),F.push(""),F.push(he?KL(W):$L(W))}return F.push(b+"--\r\n"),F.join("\r\n")}(x,S);if("zip"===(_(x),S.fileType))return function UL(x,E){var S=E||{},b=[],F=[],R=Y(1),G=S.compression?8:0,X=0,H=0,W=0,re=0,le=0,ve=x.FullPaths[0],ce=ve,he=x.FileIndex[0],Fe=[],tt=0;for(H=1;H<x.FullPaths.length;++H)if(ce=x.FullPaths[H].slice(ve.length),(he=x.FileIndex[H]).size&&he.content&&"\x01Sh33tJ5"!=ce){var or=re,St=Y(ce.length);for(W=0;W<ce.length;++W)St.write_shift(1,127&ce.charCodeAt(W));St=St.slice(0,St.l),Fe[le]=Xm.buf(he.content,0);var vr=he.content;8==G&&(vr=I(vr)),(R=Y(30)).write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,X),R.write_shift(2,G),he.mt?n(R,he.mt):R.write_shift(4,0),R.write_shift(-4,8&X?0:Fe[le]),R.write_shift(4,8&X?0:vr.length),R.write_shift(4,8&X?0:he.content.length),R.write_shift(2,St.length),R.write_shift(2,0),re+=R.length,b.push(R),re+=St.length,b.push(St),re+=vr.length,b.push(vr),8&X&&((R=Y(12)).write_shift(-4,Fe[le]),R.write_shift(4,vr.length),R.write_shift(4,he.content.length),re+=R.l,b.push(R)),(R=Y(46)).write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,X),R.write_shift(2,G),R.write_shift(4,0),R.write_shift(-4,Fe[le]),R.write_shift(4,vr.length),R.write_shift(4,he.content.length),R.write_shift(2,St.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,or),tt+=R.l,F.push(R),tt+=St.length,F.push(St),++le}return(R=Y(22)).write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,le),R.write_shift(2,le),R.write_shift(4,tt),R.write_shift(4,re),R.write_shift(2,0),bt([bt(b),bt(F),R])}(x,S);var b=function(ve){for(var ce=0,he=0,Fe=0;Fe<ve.FileIndex.length;++Fe){var tt=ve.FileIndex[Fe];if(tt.content){var or=tt.content.length;or>0&&(or<4096?ce+=or+63>>6:he+=or+511>>9)}}for(var St=ve.FullPaths.length+3>>2,wo=ce+127>>7,xo=(ce+7>>3)+he+St+wo,Ts=xo+127>>7,Ld=Ts<=109?0:Math.ceil((Ts-109)/127);xo+Ts+Ld+127>>7>Ts;)Ld=++Ts<=109?0:Math.ceil((Ts-109)/127);var Ei=[1,Ld,Ts,wo,St,he,ce,0];return ve.FileIndex[0].size=ce<<6,Ei[7]=(ve.FileIndex[0].start=Ei[0]+Ei[1]+Ei[2]+Ei[3]+Ei[4]+Ei[5])+(Ei[6]+7>>3),Ei}(x),F=Y(b[7]<<9),R=0,G=0;for(R=0;R<8;++R)F.write_shift(1,ue[R]);for(R=0;R<8;++R)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),R=0;R<3;++R)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,b[2]),F.write_shift(4,b[0]+b[1]+b[2]+b[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,b[3]?b[0]+b[1]+b[2]-1:ae),F.write_shift(4,b[3]),F.write_shift(-4,b[1]?b[0]-1:ae),F.write_shift(4,b[1]),R=0;R<109;++R)F.write_shift(-4,R<b[2]?b[1]+R:-1);if(b[1])for(G=0;G<b[1];++G){for(;R<236+127*G;++R)F.write_shift(-4,R<b[2]?b[1]+R:-1);F.write_shift(-4,G===b[1]-1?ae:G+1)}var X=function(ve){for(G+=ve;R<G-1;++R)F.write_shift(-4,R+1);ve&&(++R,F.write_shift(-4,ae))};for(G=R=0,G+=b[1];R<G;++R)F.write_shift(-4,Ce.DIFSECT);for(G+=b[2];R<G;++R)F.write_shift(-4,Ce.FATSECT);X(b[3]),X(b[4]);for(var z=0,H=0,W=x.FileIndex[0];z<x.FileIndex.length;++z)(W=x.FileIndex[z]).content&&!((H=W.content.length)<4096)&&(W.start=G,X(H+511>>9));for(X(b[6]+7>>3);511&F.l;)F.write_shift(-4,Ce.ENDOFCHAIN);for(G=R=0,z=0;z<x.FileIndex.length;++z)(W=x.FileIndex[z]).content&&(H=W.content.length)&&!(H>=4096)&&(W.start=G,X(H+63>>6));for(;511&F.l;)F.write_shift(-4,Ce.ENDOFCHAIN);for(R=0;R<b[4]<<2;++R){var re=x.FullPaths[R];if(re&&0!==re.length){W=x.FileIndex[R],0===R&&(W.start=W.size?W.start-1:ae);var le=0===R&&S.root||W.name;if(H=2*(le.length+1),F.write_shift(64,le,"utf16le"),F.write_shift(2,H),F.write_shift(1,W.type),F.write_shift(1,W.color),F.write_shift(-4,W.L),F.write_shift(-4,W.R),F.write_shift(-4,W.C),W.clsid)F.write_shift(16,W.clsid,"hex");else for(z=0;z<4;++z)F.write_shift(4,0);F.write_shift(4,W.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,W.start),F.write_shift(4,W.size),F.write_shift(4,0)}else{for(z=0;z<17;++z)F.write_shift(4,0);for(z=0;z<3;++z)F.write_shift(4,-1);for(z=0;z<12;++z)F.write_shift(4,0)}}for(R=1;R<x.FileIndex.length;++R)if((W=x.FileIndex[R]).size>=4096)if(F.l=W.start+1<<9,Pe&&Buffer.isBuffer(W.content))W.content.copy(F,F.l,0,W.size),F.l+=W.size+511&-512;else{for(z=0;z<W.size;++z)F.write_shift(1,W.content[z]);for(;511&z;++z)F.write_shift(1,0)}for(R=1;R<x.FileIndex.length;++R)if((W=x.FileIndex[R]).size>0&&W.size<4096)if(Pe&&Buffer.isBuffer(W.content))W.content.copy(F,F.l,0,W.size),F.l+=W.size+63&-64;else{for(z=0;z<W.size;++z)F.write_shift(1,W.content[z]);for(;63&z;++z)F.write_shift(1,0)}if(Pe)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}t.version="1.2.1";var ee,B=64,ae=-2,me="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],ye="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ye,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(x){for(var E=new Array(x.length),S=0;S<x.length;++S)E[S]=String.fromCharCode(x[S]);return E.join("")}function I(x){return ee?ee.deflateRawSync(x):_e(x)}for(var x,E,P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ne=typeof Uint8Array<"u",J=ne?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)J[Ae]=(void 0,255&((E=139536&((x=Ae)<<1|x<<11)|558144&(x<<5|x<<15))>>16|E>>8|E));function T(x,E){var S=J[255&x];return E<=8?S>>>8-E:(S=S<<8|J[x>>8&255],E<=16?S>>>16-E:(S=S<<8|J[x>>16&255])>>>24-E)}function Ye(x,E){var S=7&E,b=E>>>3;return(x[b]|(S<=6?0:x[b+1]<<8))>>>S&3}function Be(x,E){var S=7&E,b=E>>>3;return(x[b]|(S<=5?0:x[b+1]<<8))>>>S&7}function Ne(x,E){var S=7&E,b=E>>>3;return(x[b]|(S<=3?0:x[b+1]<<8))>>>S&31}function fe(x,E){var S=7&E,b=E>>>3;return(x[b]|(S<=1?0:x[b+1]<<8))>>>S&127}function pt(x,E,S){var b=7&E,F=E>>>3,G=x[F]>>>b;return S<8-b||(G|=x[F+1]<<8-b,S<16-b)||(G|=x[F+2]<<16-b,S<24-b)||(G|=x[F+3]<<24-b),G&(1<<S)-1}function Ir(x,E,S){var b=7&E,F=E>>>3;return b<=5?x[F]|=(7&S)<<b:(x[F]|=S<<b&255,x[F+1]=(7&S)>>8-b),E+3}function si(x,E,S){return x[E>>>3]|=S=(1&S)<<(7&E),E+1}function yi(x,E,S){var F=E>>>3;return x[F]|=255&(S<<=7&E),x[F+1]=S>>>=8,E+8}function vo(x,E,S){var F=E>>>3;return x[F]|=255&(S<<=7&E),x[F+1]=255&(S>>>=8),x[F+2]=S>>>8,E+16}function Ki(x,E){var S=x.length,b=2*S>E?2*S:E+5,F=0;if(S>=E)return x;if(Pe){var R=Ud(b);if(x.copy)x.copy(R);else for(;F<x.length;++F)R[F]=x[F];return R}if(ne){var G=new Uint8Array(b);if(G.set)G.set(x);else for(;F<S;++F)G[F]=x[F];return G}return x.length=b,x}function mr(x){for(var E=new Array(x),S=0;S<x;++S)E[S]=0;return E}function bi(x,E,S){var b=1,F=0,R=0,G=0,X=0,z=x.length,H=ne?new Uint16Array(32):mr(32);for(R=0;R<32;++R)H[R]=0;for(R=z;R<S;++R)x[R]=0;z=x.length;var W=ne?new Uint16Array(z):mr(z);for(R=0;R<z;++R)H[F=x[R]]++,b<F&&(b=F),W[R]=0;for(H[0]=0,R=1;R<=b;++R)H[R+16]=X=X+H[R-1]<<1;for(R=0;R<z;++R)0!=(X=x[R])&&(W[R]=H[X+16]++);var re=0;for(R=0;R<z;++R)if(0!=(re=x[R]))for(X=T(W[R],b)>>b-re,G=(1<<b+4-re)-1;G>=0;--G)E[X|G<<re]=15&re|R<<4;return b}var Yi=ne?new Uint16Array(512):mr(512),Co=ne?new Uint16Array(32):mr(32);if(!ne){for(var er=0;er<512;++er)Yi[er]=0;for(er=0;er<32;++er)Co[er]=0}!function(){for(var x=[],E=0;E<32;E++)x.push(5);bi(x,Co,32);var S=[];for(E=0;E<=143;E++)S.push(8);for(;E<=255;E++)S.push(9);for(;E<=279;E++)S.push(7);for(;E<=287;E++)S.push(8);bi(S,Yi,288)}();var ni=function(){for(var E=ne?new Uint8Array(32768):[],S=0,b=0;S<ge.length-1;++S)for(;b<ge[S+1];++b)E[b]=S;for(;b<32768;++b)E[b]=29;var F=ne?new Uint8Array(259):[];for(S=0,b=0;S<Q.length-1;++S)for(;b<Q[S+1];++b)F[b]=S;return function(z,H){return z.length<8?function R(X,z){for(var H=0;H<X.length;){var W=Math.min(65535,X.length-H);for(z.write_shift(1,+(H+W==X.length)),z.write_shift(2,W),z.write_shift(2,65535&~W);W-- >0;)z[z.l++]=X[H++]}return z.l}(z,H):function G(X,z){for(var H=0,W=0,re=ne?new Uint16Array(32768):[];W<X.length;){var le=Math.min(65535,X.length-W);if(le<10){for(7&(H=Ir(z,H,+(W+le==X.length)))&&(H+=8-(7&H)),z.l=H/8|0,z.write_shift(2,le),z.write_shift(2,65535&~le);le-- >0;)z[z.l++]=X[W++];H=8*z.l}else{H=Ir(z,H,+(W+le==X.length)+2);for(var ve=0;le-- >0;){var ce=X[W],he=-1,Fe=0;if((he=re[ve=32767&(ve<<5^ce)])&&((he|=-32768&W)>W&&(he-=32768),he<W))for(;X[he+Fe]==X[W+Fe]&&Fe<250;)++Fe;if(Fe>2){(ce=F[Fe])<=22?H=yi(z,H,J[ce+1]>>1)-1:(yi(z,H,3),yi(z,H+=5,J[ce-23]>>5),H+=3);var tt=ce<8?0:ce-4>>2;tt>0&&(vo(z,H,Fe-Q[ce]),H+=tt),H=yi(z,H,J[ce=E[W-he]]>>3),H-=3;var or=ce<4?0:ce-2>>1;or>0&&(vo(z,H,W-he-ge[ce]),H+=or);for(var St=0;St<Fe;++St)re[ve]=32767&W,ve=32767&(ve<<5^X[W]),++W;le-=Fe-1}else ce<=143?ce+=48:H=si(z,H,1),H=yi(z,H,J[ce]),re[ve]=32767&W,++W}H=yi(z,H,0)-1}}return z.l=(H+7)/8|0,z.l}(z,H)}}();function _e(x){var E=Y(50+Math.floor(1.1*x.length)),S=ni(x,E);return E.slice(0,S)}var mt=ne?new Uint16Array(32768):mr(32768),Lr=ne?new Uint16Array(32768):mr(32768),yt=ne?new Uint16Array(128):mr(128),ks=1,em=1;function zL(x,E){var S=Ne(x,E)+257,b=Ne(x,E+=5)+1,F=function qe(x,E){var S=7&E,b=E>>>3;return(x[b]|(S<=4?0:x[b+1]<<8))>>>S&15}(x,E+=5)+4;E+=4;for(var R=0,G=ne?new Uint8Array(19):mr(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,H=ne?new Uint8Array(8):mr(8),W=ne?new Uint8Array(8):mr(8),re=G.length,le=0;le<F;++le)G[P[le]]=R=Be(x,E),z<R&&(z=R),H[R]++,E+=3;var ve=0;for(H[0]=0,le=1;le<=z;++le)W[le]=ve=ve+H[le-1]<<1;for(le=0;le<re;++le)0!=(ve=G[le])&&(X[le]=W[ve]++);var ce=0;for(le=0;le<re;++le)if(0!=(ce=G[le])){ve=J[X[le]]>>8-ce;for(var he=(1<<7-ce)-1;he>=0;--he)yt[ve|he<<ce]=7&ce|le<<3}var Fe=[];for(z=1;Fe.length<S+b;)switch(ve=yt[fe(x,E)],E+=7&ve,ve>>>=3){case 16:for(R=3+Ye(x,E),E+=2,ve=Fe[Fe.length-1];R-- >0;)Fe.push(ve);break;case 17:for(R=3+Be(x,E),E+=3;R-- >0;)Fe.push(0);break;case 18:for(R=11+fe(x,E),E+=7;R-- >0;)Fe.push(0);break;default:Fe.push(ve),z<ve&&(z=ve)}var tt=Fe.slice(0,S),or=Fe.slice(S);for(le=S;le<286;++le)tt[le]=0;for(le=b;le<30;++le)or[le]=0;return ks=bi(tt,mt,286),em=bi(or,Lr,30),E}function tm(x,E){var b=function VL(x,E){if(3==x[0]&&!(3&x[1]))return[Ri(E),2];for(var S=0,b=0,F=Ud(E||1<<18),R=0,G=F.length>>>0,X=0,z=0;!(1&b);)if(b=Be(x,S),S+=3,b>>>1)for(b>>1==1?(X=9,z=5):(S=zL(x,S),X=ks,z=em);;){!E&&G<R+32767&&(G=(F=Ki(F,R+32767)).length);var W=pt(x,S,X),re=b>>>1==1?Yi[W]:mt[W];if(S+=15&re,(re>>>=4)>>>8&255){if(256==re)break;var le=(re-=257)<8?0:re-4>>2;le>5&&(le=0);var ve=R+Q[re];le>0&&(ve+=pt(x,S,le),S+=le),W=pt(x,S,z),S+=15&(re=b>>>1==1?Co[W]:Lr[W]);var ce=(re>>>=4)<4?0:re-2>>1,he=ge[re];for(ce>0&&(he+=pt(x,S,ce),S+=ce),!E&&G<ve&&(G=(F=Ki(F,ve+100)).length);R<ve;)F[R]=F[R-he],++R}else F[R++]=re}else{7&S&&(S+=8-(7&S));var H=x[S>>>3]|x[1+(S>>>3)]<<8;if(S+=32,H>0)for(!E&&G<R+H&&(G=(F=Ki(F,R+H)).length);H-- >0;)F[R++]=x[S>>>3],S+=8}return E?[F,S+7>>>3]:[F.slice(0,R),S+7>>>3]}(x.slice(x.l||0),E);return x.l+=b[1],b[0]}function rm(x,E){if(!x)throw new Error(E);typeof console<"u"&&console.error(E)}function im(x,E){var S=x;At(S,0);var R={FileIndex:[],FullPaths:[]};y(R,{root:E.root});for(var G=S.length-4;(80!=S[G]||75!=S[G+1]||5!=S[G+2]||6!=S[G+3])&&G>=0;)--G;S.l=G+4,S.l+=4;var X=S.read_shift(2);S.l+=6;var z=S.read_shift(4);for(S.l=z,G=0;G<X;++G){S.l+=20;var H=S.read_shift(4),W=S.read_shift(4),re=S.read_shift(2),le=S.read_shift(2),ve=S.read_shift(2);S.l+=8;var ce=S.read_shift(4),he=a(S.slice(S.l+re,S.l+re+le));S.l+=re+le+ve;var Fe=S.l;S.l=ce+4,WL(S,H,W,R,he),S.l=Fe}return R}function WL(x,E,S,b,F){x.l+=2;var R=x.read_shift(2),G=x.read_shift(2),X=function o(x){var E=65535&x.read_shift(2),S=65535&x.read_shift(2),b=new Date,F=31&S,R=15&(S>>>=5);S>>>=4,b.setMilliseconds(0),b.setFullYear(S+1980),b.setMonth(R-1),b.setDate(F);var G=31&E,X=63&(E>>>=5);return b.setHours(E>>>=6),b.setMinutes(X),b.setSeconds(G<<1),b}(x);if(8257&R)throw new Error("Unsupported ZIP encryption");x.read_shift(4);for(var H=x.read_shift(4),W=x.read_shift(4),re=x.read_shift(2),le=x.read_shift(2),ve="",ce=0;ce<re;++ce)ve+=String.fromCharCode(x[x.l++]);if(le){var he=a(x.slice(x.l,x.l+le));(he[21589]||{}).mt&&(X=he[21589].mt),((F||{})[21589]||{}).mt&&(X=F[21589].mt)}x.l+=le;var Fe=x.slice(x.l,x.l+H);switch(G){case 8:Fe=function V(x,E){if(!ee)return tm(x,E);var b=new(0,ee.InflateRaw),F=b._processChunk(x.slice(x.l),b._finishFlushFlag);return x.l+=b.bytesRead,F}(x,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var tt=!1;8&R&&(134695760==x.read_shift(4)&&(x.read_shift(4),tt=!0),H=x.read_shift(4),W=x.read_shift(4)),H!=E&&rm(tt,"Bad compressed size: "+E+" != "+H),W!=S&&rm(tt,"Bad uncompressed size: "+S+" != "+W),Id(b,ve,Fe,{unsafe:!0,mt:X})}var Va={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jL(x,E){if(x.ctype)return x.ctype;var S=x.name||"",b=S.match(/\.([^\.]+)$/);return b&&Va[b[1]]||E&&(b=(S=E).match(/[\.\\]([^\.\\])+$/))&&Va[b[1]]?Va[b[1]]:"application/octet-stream"}function $L(x){for(var E=mn(x),S=[],b=0;b<E.length;b+=76)S.push(E.slice(b,b+76));return S.join("\r\n")+"\r\n"}function KL(x){var E=x.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(H){var W=H.charCodeAt(0).toString(16).toUpperCase();return"="+(1==W.length?"0"+W:W)});"\n"==(E=E.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(E="=0D"+E.slice(1));for(var S=[],b=(E=E.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),F=0;F<b.length;++F){var R=b[F];if(0!=R.length)for(var G=0;G<R.length;){var X=76,z=R.slice(G,G+X);"="==z.charAt(X-1)?X--:"="==z.charAt(X-2)?X-=2:"="==z.charAt(X-3)&&(X-=3),z=R.slice(G,G+X),(G+=X)<R.length&&(z+="="),S.push(z)}else S.push("")}return S.join("\r\n")}function qL(x,E,S){for(var G,b="",F="",R="",X=0;X<10;++X){var z=E[X];if(!z||z.match(/^\s*$/))break;var H=z.match(/^(.*?):\s*([^\s].*)$/);if(H)switch(H[1].toLowerCase()){case"content-location":b=H[2].trim();break;case"content-type":R=H[2].trim();break;case"content-transfer-encoding":F=H[2].trim()}}switch(++X,F.toLowerCase()){case"base64":G=dr(cr(E.slice(X).join("")));break;case"quoted-printable":G=function YL(x){for(var E=[],S=0;S<x.length;++S){for(var b=x[S];S<=x.length&&"="==b.charAt(b.length-1);)b=b.slice(0,b.length-1)+x[++S];E.push(b)}for(var F=0;F<E.length;++F)E[F]=E[F].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return dr(E.join("\r\n"))}(E.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var W=Id(x,b.slice(S.length),G,{unsafe:!0});R&&(W.ctype=R)}function Id(x,E,S,b){var F=b&&b.unsafe;F||y(x);var R=!F&&we.find(x,E);if(!R){var G=x.FullPaths[0];E.slice(0,G.length)==G?G=E:("/"!=G.slice(-1)&&(G+="/"),G=(G+E).replace("//","/")),R={name:s(E),type:2},x.FileIndex.push(R),x.FullPaths.push(G),F||we.utils.cfb_gc(x)}return R.content=S,R.size=S?S.length:0,b&&(b.CLSID&&(R.clsid=b.CLSID),b.mt&&(R.mt=b.mt),b.ct&&(R.ct=b.ct)),R}return t.find=function K(x,E){var S=x.FullPaths.map(function(z){return z.toUpperCase()}),b=S.map(function(z){var H=z.split("/");return H[H.length-("/"==z.slice(-1)?2:1)]}),F=!1;47===E.charCodeAt(0)?(F=!0,E=S[0].slice(0,-1)+E):F=-1!==E.indexOf("/");var R=E.toUpperCase(),G=!0===F?S.indexOf(R):b.indexOf(R);if(-1!==G)return x.FileIndex[G];var X=!R.match(Cn);for(R=R.replace(Mt,""),X&&(R=R.replace(Cn,"!")),G=0;G<S.length;++G)if((X?S[G].replace(Cn,"!"):S[G]).replace(Mt,"")==R||(X?b[G].replace(Cn,"!"):b[G]).replace(Mt,"")==R)return x.FileIndex[G];return null},t.read=function O(x,E){var S=E&&E.type;switch(S||Pe&&Buffer.isBuffer(x)&&(S="buffer"),S||"base64"){case"file":return function M(x,E){return c(),d(l.readFileSync(x),E)}(x,E);case"base64":return d(dr(cr(x)),E);case"binary":return d(dr(x),E)}return d(x,E)},t.parse=d,t.write=function Ee(x,E){var S=j(x,E);switch(E&&E.type||"buffer"){case"file":return c(),l.writeFileSync(E.filename,S),S;case"binary":return"string"==typeof S?S:pe(S);case"base64":return mn("string"==typeof S?S:pe(S));case"buffer":if(Pe)return Buffer.isBuffer(S)?S:ai(S);case"array":return"string"==typeof S?dr(S):S}return S},t.writeFile=function Oe(x,E,S){c();var b=j(x,S);l.writeFileSync(E,b)},t.utils={cfb_new:function ZL(x){var E={};return y(E,x),E},cfb_add:Id,cfb_del:function JL(x,E){y(x);var S=we.find(x,E);if(S)for(var b=0;b<x.FileIndex.length;++b)if(x.FileIndex[b]==S)return x.FileIndex.splice(b,1),x.FullPaths.splice(b,1),!0;return!1},cfb_mov:function e5(x,E,S){y(x);var b=we.find(x,E);if(b)for(var F=0;F<x.FileIndex.length;++F)if(x.FileIndex[F]==b)return x.FileIndex[F].name=s(S),x.FullPaths[F]=S,!0;return!1},cfb_gc:function t5(x){_(x,!0)},ReadShift:Fn,CheckField:Vu,prep_blob:At,bconcat:bt,use_zlib:function A(x){try{var S=new(0,x.InflateRaw);if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),!S.bytesRead)throw new Error("zlib does not expose bytesRead");ee=x}catch(b){console.error("cannot use native zlib: "+(b.message||b))}},_deflateRaw:_e,_inflateRaw:tm,consts:Ce},t}();let Ai;function Qm(e){return"string"==typeof e?vn(e):Array.isArray(e)?function ym(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Sn(e,t,r){if(typeof Ai<"u"&&Ai.writeFileSync)return r?Ai.writeFileSync(e,t,r):Ai.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=vn(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var i="utf8"==r?Yr(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,e);if(typeof Blob<"u"){var s=new Blob([Qm(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(s);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=ki(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function ot(e){for(var t=Object.keys(e),r=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(e,t[i])&&r.push(t[i]);return r}function cu(e,t){for(var r=[],i=ot(e),s=0;s!==i.length;++s)null==r[e[i[s]][t]]&&(r[e[i[s]][t]]=i[s]);return r}function To(e){for(var t=[],r=ot(e),i=0;i!==r.length;++i)t[e[r[i]]]=r[i];return t}function Do(e){for(var t=[],r=ot(e),i=0;i!==r.length;++i)t[e[r[i]]]=parseInt(r[i],10);return t}var Ao=new Date(1899,11,30,0,0,0);function Et(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Ao.getTime()+6e4*(e.getTimezoneOffset()-Ao.getTimezoneOffset())))/864e5}var du=new Date,ev=Ao.getTime()+6e4*(du.getTimezoneOffset()-Ao.getTimezoneOffset()),uu=du.getTimezoneOffset();function qa(e){var t=new Date;return t.setTime(24*e*60*60*1e3+ev),t.getTimezoneOffset()!==uu&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-uu)),t}var hu=new Date("2017-02-19T19:06:09.000Z"),gu=isNaN(hu.getFullYear())?new Date("2/19/17"):hu,rv=2017==gu.getFullYear();function st(e,t){var r=new Date(e);if(rv)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==gu.getFullYear()&&!isNaN(r.getFullYear())){var i=r.getFullYear();return e.indexOf(""+i)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function Zi(e,t){if(Pe&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Yr(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Yr(function Wd(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(255==e[0]&&254==e[1])return Yr(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Yr(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(n){return r[n]||n})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function Xe(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xe(e[r]));return t}function at(e,t){for(var r="";r.length<t;)r+=e;return r}function Br(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(i))&&(i=i.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),isNaN(t=Number(i)))?t:t/r}var iv=["january","february","march","april","may","june","july","august","september","october","november","december"];function Os(e){var t=new Date(e),r=new Date(NaN),i=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==iv.indexOf(o))return r}else if(o.match(/[a-z]/))return r;return i<0||i>8099?r:(s>0||n>1)&&101!=i?t:e.match(/[^-0-9:,\/\\]/)?r:t}function De(e,t,r){if(e.FullPaths){var i;if("string"==typeof r)return i=Pe?ai(r):function bm(e){for(var t=[],r=0,i=e.length+250,s=Ri(e.length+255),n=0;n<e.length;++n){var o=e.charCodeAt(n);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var a=1023&e.charCodeAt(++n);s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|a>>6&15|(3&o)<<4,s[r++]=128|63&a}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|63&o;r>i&&(t.push(s.slice(0,r)),r=0,s=Ri(65535),i=65530)}return t.push(s.slice(0,r)),bt(t)}(r),we.utils.cfb_add(e,t,i);we.utils.cfb_add(e,t,r)}else e.file(t,r)}function Qa(){return we.utils.cfb_new()}var lt='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Za=To({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),Ja=/[&<>'"]/g,uv=/[\u0000-\u0008\u000b-\u001f]/g;function Ke(e){return(e+"").replace(Ja,function(r){return Za[r]}).replace(uv,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xu(e){return Ke(e).replace(/ /g,"_x0020_")}var Su=/[\u0000-\u001f]/g;function yu(e){return(e+"").replace(Ja,function(r){return Za[r]}).replace(/\n/g,"<br/>").replace(Su,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function el(e){for(var t="",r=0,i=0,s=0,n=0,o=0,a=0;r<e.length;)(i=e.charCodeAt(r++))<128?t+=String.fromCharCode(i):(s=e.charCodeAt(r++),i>191&&i<224?(o=(31&i)<<6,o|=63&s,t+=String.fromCharCode(o)):(n=e.charCodeAt(r++),i<240?t+=String.fromCharCode((15&i)<<12|(63&s)<<6|63&n):(a=((7&i)<<18|(63&s)<<12|(63&n)<<6|63&(o=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(1023&a)))));return t}function Eu(e){var r,i,a,t=Ri(2*e.length),s=1,n=0,o=0;for(i=0;i<e.length;i+=s)s=1,(a=e.charCodeAt(i))<128?r=a:a<224?(r=64*(31&a)+(63&e.charCodeAt(i+1)),s=2):a<240?(r=4096*(15&a)+64*(63&e.charCodeAt(i+1))+(63&e.charCodeAt(i+2)),s=3):(s=4,r=262144*(7&a)+4096*(63&e.charCodeAt(i+1))+64*(63&e.charCodeAt(i+2))+(63&e.charCodeAt(i+3)),o=55296+((r-=65536)>>>10&1023),r=56320+(1023&r)),0!==o&&(t[n++]=255&o,t[n++]=o>>>8,o=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function Fu(e){return ai(e,"binary").toString("utf8")}var Po="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Qe=Pe&&(Fu(Po)==el(Po)&&Fu||Eu(Po)==el(Po)&&Eu)||el,Yr=Pe?function(e){return ai(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,i=0,s=0;r<e.length;)switch(i=e.charCodeAt(r++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(63&i)));break;case i>=55296&&i<57344:i-=55296,s=e.charCodeAt(r++)-56320+(i<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(63&s)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)))}return t.join("")},Ru=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var i=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}}(),Tu=/(^\s|\s$|\n)/;function Dt(e,t){return"<"+e+(t.match(Tu)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function bn(e){return ot(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ie(e,t,r){return"<"+e+(null!=r?bn(r):"")+(null!=t?(t.match(Tu)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function tl(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}var Ct={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],gr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},Du=function(e){for(var t=[],i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,n=e[0][i].length;s<n;s+=10240)t.push.apply(t,e[0][i].slice(s,s+10240));return t},Au=Pe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ai(t)})):Du(e)}:Du,Pu=function(e,t,r){for(var i=[],s=t;s<r;s+=2)i.push(String.fromCharCode(ci(e,s)));return i.join("").replace(Mt,"")},Mo=Pe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Mt,""):Pu(e,t,r)}:Pu,Mu=function(e,t,r){for(var i=[],s=t;s<t+r;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},Iu=Pe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Mu(e,t,r)}:Mu,Lu=function(e,t,r){for(var i=[],s=t;s<r;s++)i.push(String.fromCharCode(Ns(e,s)));return i.join("")},Bs=Pe?function(t,r,i){return Buffer.isBuffer(t)?t.toString("utf8",r,i):Lu(t,r,i)}:Lu,_u=function(e,t){var r=Ft(e,t);return r>0?Bs(e,t+4,t+4+r-1):""},il=_u,Ou=function(e,t){var r=Ft(e,t);return r>0?Bs(e,t+4,t+4+r-1):""},sl=Ou,Bu=function(e,t){var r=2*Ft(e,t);return r>0?Bs(e,t+4,t+4+r-1):""},nl=Bu,Nu=function(t,r){var i=Ft(t,r);return i>0?Mo(t,r+4,r+4+i):""},ol=Nu,Gu=function(e,t){var r=Ft(e,t);return r>0?Bs(e,t+4,t+4+r):""},al=Gu,Hu=function(e,t){return function wv(e,t){for(var r=1-2*(e[t+7]>>>7),i=((127&e[t+7])<<4)+(e[t+6]>>>4&15),s=15&e[t+6],n=5;n>=0;--n)s=256*s+e[t+n];return 2047==i?0==s?r*(1/0):NaN:(0==i?i=-1022:(i-=1023,s+=Math.pow(2,52)),r*Math.pow(2,i-52)*s)}(e,t)},Io=Hu,ll=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Pe&&(il=function(t,r){if(!Buffer.isBuffer(t))return _u(t,r);var i=t.readUInt32LE(r);return i>0?t.toString("utf8",r+4,r+4+i-1):""},sl=function(t,r){if(!Buffer.isBuffer(t))return Ou(t,r);var i=t.readUInt32LE(r);return i>0?t.toString("utf8",r+4,r+4+i-1):""},nl=function(t,r){if(!Buffer.isBuffer(t))return Bu(t,r);var i=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+i-1)},ol=function(t,r){if(!Buffer.isBuffer(t))return Nu(t,r);var i=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+i)},al=function(t,r){if(!Buffer.isBuffer(t))return Gu(t,r);var i=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+i)},Io=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Hu(t,r)},ll=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array}),typeof ze<"u"&&function zu(){Mo=function(e,t,r){return ze.utils.decode(1200,e.slice(t,r)).replace(Mt,"")},Bs=function(e,t,r){return ze.utils.decode(65001,e.slice(t,r))},il=function(e,t){var r=Ft(e,t);return r>0?ze.utils.decode(Xi,e.slice(t+4,t+4+r-1)):""},sl=function(e,t){var r=Ft(e,t);return r>0?ze.utils.decode(lr,e.slice(t+4,t+4+r-1)):""},nl=function(e,t){var r=2*Ft(e,t);return r>0?ze.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},ol=function(e,t){var r=Ft(e,t);return r>0?ze.utils.decode(1200,e.slice(t+4,t+4+r)):""},al=function(e,t){var r=Ft(e,t);return r>0?ze.utils.decode(65001,e.slice(t+4,t+4+r)):""}}();var Ns=function(e,t){return e[t]},ci=function(e,t){return 256*e[t+1]+e[t]},Sv=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Ft=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ji=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},yv=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Fn(e,t){var i,s,o,a,l,c,r="",n=[];switch(t){case"dbcs":if(c=this.l,Pe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ci(this,c)),c+=2;e*=2;break;case"utf8":r=Bs(this,this.l,this.l+e);break;case"utf16le":r=Mo(this,this.l,this.l+(e*=2));break;case"wstr":if(!(typeof ze<"u"))return Fn.call(this,e,"dbcs");r=ze.utils.decode(lr,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":r=il(this,this.l),e=4+Ft(this,this.l);break;case"lpstr-cp":r=sl(this,this.l),e=4+Ft(this,this.l);break;case"lpwstr":r=nl(this,this.l),e=4+2*Ft(this,this.l);break;case"lpp4":e=4+Ft(this,this.l),r=ol(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Ft(this,this.l),r=al(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,r="";0!==(o=Ns(this,this.l+e++));)n.push(fn(o));r=n.join("");break;case"_wstr":for(e=0,r="";0!==(o=ci(this,this.l+e));)n.push(fn(o)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&-1!==this.lens.indexOf(c))return o=Ns(this,c),this.l=c+1,a=Fn.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),n.join("")+a;n.push(fn(ci(this,c))),c+=2}r=n.join(""),e*=2;break;case"cpstr":if(typeof ze<"u"){r=ze.utils.decode(lr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&-1!==this.lens.indexOf(c))return o=Ns(this,c),this.l=c+1,a=Fn.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),n.join("")+a;n.push(fn(Ns(this,c))),c+=1}r=n.join("");break;default:switch(e){case 1:return i=Ns(this,this.l),this.l++,i;case 2:return i=("i"===t?Sv:ci)(this,this.l),this.l+=2,i;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(s=Ft(this,this.l),this.l+=4,s):(i=(e>0?Ji:yv)(this,this.l),this.l+=4,i);case 8:case-8:if("f"===t)return s=8==e?Io(this,this.l):Io([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Iu(this,this.l,e)}}return this.l+=e,r}var bv=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ev=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Fv=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Rv(e,t,r){var i=0,s=0;if("dbcs"===r){for(s=0;s!=t.length;++s)Fv(this,t.charCodeAt(s),this.l+2*s);i=2*t.length}else if("sbcs"===r){if(typeof ze<"u"&&874==Xi)for(s=0;s!=t.length;++s){var n=ze.utils.encode(Xi,t.charAt(s));this[this.l+s]=n[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=255&t.charCodeAt(s);i=t.length}else{if("hex"===r){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}if("utf16le"===r){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:i=1,this[this.l]=255&t;break;case 2:i=2,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8);break;case 3:i=3,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8),this[this.l+2]=255&(t>>>=8);break;case 4:i=4,bv(this,t,this.l);break;case 8:if(i=8,"f"===r){!function xv(e,t,r){var i=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,o=i?-t:t;isFinite(o)?0==o?s=n=0:(s=Math.floor(Math.log(o)/Math.LN2),n=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var a=0;a<=5;++a,n/=256)e[r+a]=255&n;e[r+6]=(15&s)<<4|15&n,e[r+7]=s>>4|i}(this,t,this.l);break}case 16:break;case-4:i=4,Ev(this,t,this.l)}}return this.l+=i,this}function Vu(e,t){var r=Iu(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function At(e,t){e.l=t,e.read_shift=Fn,e.chk=Vu,e.write_shift=Rv}function Lt(e,t){e.l+=t}function Y(e){var t=Ri(e);return At(t,0),t}function jt(){var e=[],t=Pe?256:2048,r=function(c){var d=Y(c);return At(d,0),d},i=r(t),s=function(){i&&(i.length>i.l&&((i=i.slice(0,i.l)).l=i.length),i.length>0&&e.push(i),i=null)},n=function(c){return i&&c<i.length-i.l?i:(s(),i=r(Math.max(c+1,t)))};return{next:n,push:function(c){s(),null==(i=c).l&&(i.l=i.length),n(t)},end:function(){return s(),bt(e)},_bufs:e}}function Z(e,t,r,i){var n,s=+t;if(!isNaN(s)){i||(i=Wn[s].p||(r||[]).length||0),n=1+(s>=128?1:0)+1,i>=128&&++n,i>=16384&&++n,i>=2097152&&++n;var o=e.next(n);s<=127?o.write_shift(1,s):(o.write_shift(1,128+(127&s)),o.write_shift(1,s>>7));for(var a=0;4!=a;++a){if(!(i>=128)){o.write_shift(1,i);break}o.write_shift(1,128+(127&i)),i>>=7}i>0&&ll(r)&&e.push(r)}}function Rn(e,t,r){var i=Xe(e);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!r||r.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Wu(e,t,r){var i=Xe(e);return i.s=Rn(i.s,t.s,r),i.e=Rn(i.e,t.s,r),i}function kn(e,t){if(e.cRel&&e.c<0)for(e=Xe(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xe(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=be(e);return!e.cRel&&null!=e.cRel&&(r=function Dv(e){return e.replace(/^([A-Z])/,"$$$1")}(r)),!e.rRel&&null!=e.rRel&&(r=function kv(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function cl(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?kn(e.s,t.biff)+":"+kn(e.e,t.biff):(e.s.rRel?"":"$")+ct(e.s.r)+":"+(e.e.rRel?"":"$")+ct(e.e.r):(e.s.cRel?"":"$")+Ze(e.s.c)+":"+(e.e.cRel?"":"$")+Ze(e.e.c)}function dl(e){return parseInt(function Tv(e){return e.replace(/\$(\d+)$/,"$1")}(e),10)-1}function ct(e){return""+(e+1)}function ul(e){for(var t=function Av(e){return e.replace(/^\$([A-Z])/,"$1")}(e),r=0,i=0;i!==t.length;++i)r=26*r+t.charCodeAt(i)-64;return r-1}function Ze(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ut(e){for(var t=0,r=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $t(e){var t=e.indexOf(":");return-1==t?{s:ut(e),e:ut(e)}:{s:ut(e.slice(0,t)),e:ut(e.slice(t+1))}}function ke(e,t){return typeof t>"u"||"number"==typeof t?ke(e.s,e.e):("string"!=typeof e&&(e=be(e)),"string"!=typeof t&&(t=be(t)),e==t?e:e+":"+t)}function He(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,i=0,s=0,n=e.length;for(r=0;i<n&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(t.s.c=--r,r=0;i<n&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;if(t.s.r=--r,i===n||10!=s)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,r=0;i!=n&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(t.e.c=--r,r=0;i!=n&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;return t.e.r=--r,t}function qr(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?ui[e.v]||e.v:function Uu(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=ur(e.z,r?Et(t):t)}catch{}try{return e.w=ur((e.XF||{}).numFmtId||(r?14:0),r?Et(t):t)}catch{return""+t}}(e,null==t?e.v:t))}function Mi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",i={};return i[r]=e,{SheetNames:[r],Sheets:i}}function ju(e,t,r){var i=r||{},s=e?Array.isArray(e):i.dense;null!=nt&&null==s&&(s=nt);var n=e||(s?[]:{}),o=0,a=0;if(n&&null!=i.origin){if("number"==typeof i.origin)o=i.origin;else{var l="string"==typeof i.origin?ut(i.origin):i.origin;o=l.r,a=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=He(n["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==o&&(c.e.r=o=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(!(typeof t[u][h]>"u")){var g={v:t[u][h]},p=o+u,f=a+h;if(c.s.r>p&&(c.s.r=p),c.s.c>f&&(c.s.c=f),c.e.r<p&&(c.e.r=p),c.e.c<f&&(c.e.c=f),!t[u][h]||"object"!=typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(g.v)&&(g.f=t[u][h][1],g.v=g.v[0]),null===g.v)if(g.f)g.t="n";else if(i.nullError)g.t="e",g.v=0;else{if(!i.sheetStubs)continue;g.t="z"}else"number"==typeof g.v?g.t="n":"boolean"==typeof g.v?g.t="b":g.v instanceof Date?(g.z=i.dateNF||Se[14],i.cellDates?(g.t="d",g.w=ur(g.z,Et(g.v))):(g.t="n",g.v=Et(g.v),g.w=ur(g.z,g.v))):g.t="s";else g=t[u][h];if(s)n[p]||(n[p]=[]),n[p][f]&&n[p][f].z&&(g.z=n[p][f].z),n[p][f]=g;else{var m=be({c:f,r:p});n[m]&&n[m].z&&(g.z=n[m].z),n[m]=g}}}return c.s.c<1e7&&(n["!ref"]=ke(c)),n}function Gs(e,t){return ju(null,e,t)}function Nr(e,t){return t||(t=Y(4)),t.write_shift(4,e),t}function _t(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Rt(e,t){var r=!1;return null==t&&(r=!0,t=Y(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Iv(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hl(e,t){var r=e.l,i=e.read_shift(1),s=_t(e),n=[],o={t:s,h:s};if(1&i){for(var a=e.read_shift(4),l=0;l!=a;++l)n.push(Iv(e));o.r=n}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var Ov=hl;function Sr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function es(e,t){return null==t&&(t=Y(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ts(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function rs(e,t){return null==t&&(t=Y(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Nv=_t,$u=Rt;function gl(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Lo(e,t){var r=!1;return null==t&&(r=!0,t=Y(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Gv=_t,fl=gl,pl=Lo;function ml(e){var t=e.slice(e.l,e.l+4),r=1&t[0],i=2&t[0];e.l+=4;var s=0===i?Io([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Ji(t,0)>>2;return r?s/100:s}function Ku(e,t){null==t&&(t=Y(4));var r=0,i=0,s=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?i=1:s==(0|s)&&s>=-(1<<29)&&s<1<<29&&(i=1,r=1),!i)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?s:e)<<2)+(r+2))}function Yu(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var is=Yu,Hs=function Hv(e,t){return t||(t=Y(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Ot(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ss(e,t){return(t||Y(8)).write_shift(8,e,"f")}function _o(e,t){if(t||(t=Y(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var i=e.rgb||"FFFFFF";"number"==typeof i&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var Cl={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},wl={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function Zv(e){return e.map(function(t){return[t>>16&255,t>>8&255,255&t]})}var ns=Xe(Zv([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xl={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Go={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ju(e,t){var s,r=function Jm(e){for(var t=[],r=ot(e),i=0;i!==r.length;++i)null==t[e[r[i]]]&&(t[e[r[i]]]=[]),t[e[r[i]]].push(r[i]);return t}(xl),i=[];i[i.length]=lt,i[i.length]=ie("Types",null,{xmlns:Ct.CT,"xmlns:xsd":Ct.xsd,"xmlns:xsi":Ct.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ie("Default",null,{Extension:l[0],ContentType:l[1]})}));var n=function(l){e[l]&&e[l].length>0&&(i[i.length]=ie("Override",null,{PartName:("/"==(s=e[l][0])[0]?"":"/")+s,ContentType:Go[l][t.bookType]||Go[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(c){i[i.length]=ie("Override",null,{PartName:("/"==c[0]?"":"/")+c,ContentType:Go[l][t.bookType]||Go[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(c){i[i.length]=ie("Override",null,{PartName:("/"==c[0]?"":"/")+c,ContentType:r[l][0]})})};return n("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Te={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tn(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function zs(e){var t=[lt,ie("Relationships",null,{xmlns:Ct.RELS})];return ot(e["!id"]).forEach(function(r){t[t.length]=ie("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ue(e,t,r,i,s,n){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=i,s.Target=r,n?s.TargetMode=n:[Te.HLINK,Te.XPATH,Te.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function eh(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function nC(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function th(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gn.version+"</meta:generator></office:meta></office:document-meta>"}var hi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function yl(e,t,r,i,s){null!=s[e]||null==t||""===t||(s[e]=t,t=Ke(t),i[i.length]=r?ie(e,t,r):Dt(e,t))}function ih(e,t){var r=t||{},i=[lt,ie("cp:coreProperties",null,{"xmlns:cp":Ct.CORE_PROPS,"xmlns:dc":Ct.dc,"xmlns:dcterms":Ct.dcterms,"xmlns:dcmitype":Ct.dcmitype,"xmlns:xsi":Ct.xsi})],s={};if(!e&&!r.Props)return i.join("");e&&(null!=e.CreatedDate&&yl("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:tl(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),null!=e.ModifiedDate&&yl("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:tl(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var n=0;n!=hi.length;++n){var o=hi[n],a=r.Props&&null!=r.Props[o[1]]?r.Props[o[1]]:e?e[o[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&yl(o[0],a,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var os=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],sh=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function oh(e){var t=[],r=ie;return e||(e={}),e.Application="SheetJS",t[t.length]=lt,t[t.length]=ie("Properties",null,{xmlns:Ct.EXT_PROPS,"xmlns:vt":Ct.vt}),os.forEach(function(i){if(void 0!==e[i[1]]){var s;switch(i[2]){case"string":s=Ke(String(e[i[1]]));break;case"bool":s=e[i[1]]?"true":"false"}void 0!==s&&(t[t.length]=r(i[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(i){return"<vt:lpstr>"+Ke(i)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function ah(e){var t=[lt,ie("Properties",null,{xmlns:Ct.CUST_PROPS,"xmlns:vt":Ct.vt})];if(!e)return t.join("");var r=1;return ot(e).forEach(function(s){++r,t[t.length]=ie("property",function Cv(e,t){switch(typeof e){case"string":var r=ie("vt:lpwstr",Ke(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return ie((0|e)==e?"vt:i4":"vt:r8",Ke(String(e)));case"boolean":return ie("vt:bool",e?"true":"false")}if(e instanceof Date)return ie("vt:filetime",tl(e));throw new Error("Unable to serialize "+e)}(e[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ke(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var bl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function gh(e,t){var r=Y(4),i=Y(4);switch(r.write_shift(4,80==e?31:e),e){case 3:i.write_shift(-4,t);break;case 5:(i=Y(8)).write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=function fC(e){var r=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,i=r%Math.pow(2,32),s=(r-i)/Math.pow(2,32);s*=1e7;var n=(i*=1e7)/Math.pow(2,32)|0;n>0&&(i%=Math.pow(2,32),s+=n);var o=Y(8);return o.write_shift(4,i),o.write_shift(4,s),o}(t);break;case 31:case 80:for((i=Y(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return bt([r,i])}var ph=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function SC(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function mh(e,t,r){var i=Y(8),s=[],n=[],o=8,a=0,l=Y(8),c=Y(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),n.push(l),s.push(c),o+=8+l.length,!t){(c=Y(8)).write_shift(4,0),s.unshift(c);var d=[Y(4)];for(d[0].write_shift(4,e.length),a=0;a<e.length;++a){var u=e[a][0];for((l=Y(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,a+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=bt(d),n.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if((!t||t[e[a][0]])&&!(ph.indexOf(e[a][0])>-1||sh.indexOf(e[a][0])>-1)&&null!=e[a][1]){var h=e[a][1],g=0;if(t){var p=r[g=+t[e[a][0]]];if("version"==p.p&&"string"==typeof h){var f=h.split(".");h=(+f[0]<<16)+(+f[1]||0)}l=gh(p.t,h)}else{var m=SC(h);-1==m&&(m=31,h=String(h)),l=gh(m,h)}n.push(l),(c=Y(8)).write_shift(4,t?g:2+a),s.push(c),o+=8+l.length}var w=8*(n.length+1);for(a=0;a<n.length;++a)s[a].write_shift(4,w),w+=n[a].length;return i.write_shift(4,o),i.write_shift(4,n.length),bt([i].concat(s).concat(n))}function Ch(e,t,r,i,s,n){var o=Y(s?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,we.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var l=mh(e,r,i);if(a.push(l),s){var c=mh(s,null,null);o.write_shift(16,n,"hex"),o.write_shift(4,68+l.length),a.push(c)}return bt(a)}function Kt(e,t){return t||(t=Y(2)),t.write_shift(2,+!!e),t}function wt(e){return e.read_shift(2,"u")}function yr(e,t){return t||(t=Y(2)),t.write_shift(2,e),t}function xh(e,t,r){return r||(r=Y(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function An(e,t,r){var i=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",n=lr;r&&r.biff>=8&&(lr=1200),r&&8!=r.biff?12==r.biff&&(s="wstr"):e.read_shift(1)&&(s="dbcs-cont"),r.biff>=2&&r.biff<=5&&(s="cpstr");var a=i?e.read_shift(i,s):"";return lr=n,a}function RC(e){var t=e.t||"",i=Y(3);i.write_shift(2,t.length),i.write_shift(1,1);var s=Y(2*t.length);return s.write_shift(2*t.length,t,"utf16le"),bt([i,s])}function Sh(e,t,r){return r||(r=Y(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function yh(e,t){t||(t=Y(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function MC(e){var t=Y(512),r=0,i=e.Target;"file://"==i.slice(0,7)&&(i=i.slice(7));var s=i.indexOf("#"),n=s>-1?31:23;switch(i.charAt(0)){case"#":n=28;break;case".":n&=-3}t.write_shift(4,2),t.write_shift(4,n);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(28==n)yh(i=i.slice(1),t);else if(2&n){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var a=s>-1?i.slice(0,s):i;for(t.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)t.write_shift(2,a.charCodeAt(r));t.write_shift(2,0),8&n&&yh(s>-1?i.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var l=0;"../"==i.slice(3*l,3*l+3)||"..\\"==i.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,i.length-3*l+1),r=0;r<i.length-3*l;++r)t.write_shift(1,255&i.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function cs(e,t,r,i){return i||(i=Y(6)),i.write_shift(2,e),i.write_shift(2,t),i.write_shift(2,r||0),i}function _C(e,t,r){var i=r.biff>8?4:2;return[e.read_shift(i),e.read_shift(i,"i"),e.read_shift(i,"i")]}function Vo(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r}}}function Rh(e,t){return t||(t=Y(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function kl(e,t,r){var i=1536,s=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;default:throw new Error("unsupported BIFF version")}var n=Y(s);return n.write_shift(2,i),n.write_shift(2,t),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function KC(e,t){var r=!t||t.biff>=8?2:1,i=Y(8+r*e.name.length);i.write_shift(4,e.pos),i.write_shift(1,e.hs||0),i.write_shift(1,e.dt),i.write_shift(1,e.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function hw(e,t,r,i){var s=r&&5==r.biff;i||(i=Y(s?3+t.length:5+2*t.length)),i.write_shift(2,e),i.write_shift(s?1:2,t.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var n=i.length>i.l?i.slice(0,i.l):i;return null==n.l&&(n.l=n.length),n}function Ph(e,t,r,i){var s=r&&5==r.biff;i||(i=Y(s?16:20)),i.write_shift(2,0),e.style?(i.write_shift(2,e.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,e.numFmtId||0),i.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&s&&(n|=1024),i.write_shift(4,n),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function Hw(e){var t=Y(24),r=ut(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(i[s],16));return bt([t,MC(e[1])])}function Vw(e){var t=e[1].Tooltip,r=Y(10+2*(t.length+1));r.write_shift(2,2048);var i=ut(e[0]);r.write_shift(2,i.r),r.write_shift(2,i.r),r.write_shift(2,i.c),r.write_shift(2,i.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}var Tl=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=To({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function i(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Gs(function r(a,l){var c=[],d=Ri(1);switch(l.type){case"base64":d=dr(cr(a));break;case"binary":d=dr(a);break;case"buffer":case"array":d=a}At(d,0);var u=d.read_shift(1),h=!!(136&u),g=!1,p=!1;switch(u){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:g=!0,h=!0;break;case 140:p=!0;break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var f=0,m=521;2==u&&(f=d.read_shift(2)),d.l+=3,2!=u&&(f=d.read_shift(4)),f>1048576&&(f=1e6),2!=u&&(m=d.read_shift(2));var w=d.read_shift(2),C=l.codepage||1252;2!=u&&(d.l+=16,d.read_shift(1),0!==d[d.l]&&(C=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var v=[],k={},M=Math.min(d.length,2==u?521:m-10-(g?264:0)),O=p?32:11;d.l<M&&13!=d[d.l];)switch(k={},k.name=ze.utils.decode(C,d.slice(d.l,d.l+O)).replace(/[\u0000\r\n].*$/g,""),d.l+=O,k.type=String.fromCharCode(d.read_shift(1)),2!=u&&!p&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),2==u&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&v.push(k),2!=u&&(d.l+=p?13:14),k.type){case"B":(!g||8!=k.len)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(13!==d[d.l]&&(d.l=m-1),13!==d.read_shift(1))throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=m;var y=0,L=0;for(c[0]=[],L=0;L!=v.length;++L)c[0][L]=v[L].name;for(;f-- >0;)if(42!==d[d.l])for(++d.l,c[++y]=[],L=0,L=0;L!=v.length;++L){var _=d.slice(d.l,d.l+v[L].len);d.l+=v[L].len,At(_,0);var j=ze.utils.decode(C,_);switch(v[L].type){case"C":j.trim().length&&(c[y][L]=j.replace(/\s+$/,""));break;case"D":c[y][L]=8===j.length?new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):j;break;case"F":c[y][L]=parseFloat(j.trim());break;case"+":case"I":c[y][L]=p?2147483648^_.read_shift(-4,"i"):_.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":c[y][L]=!0;break;case"N":case"F":c[y][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));c[y][L]="##MEMO##"+(p?parseInt(j.trim(),10):_.read_shift(4));break;case"N":(j=j.replace(/\u0000/g,"").trim())&&"."!=j&&(c[y][L]=+j||0);break;case"@":c[y][L]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":c[y][L]=new Date(864e5*(_.read_shift(4)-2440588)+_.read_shift(4));break;case"Y":c[y][L]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[y][L]=-_.read_shift(-8,"f");break;case"B":if(g&&8==v[L].len){c[y][L]=_.read_shift(8,"f");break}case"G":case"P":_.l+=v[L].len;break;case"0":if("_NullFlags"===v[L].name)break;default:throw new Error("DBF Unsupported data type "+v[L].type)}}else d.l+=w;if(2!=u&&d.l<d.length&&26!=d[d.l++])throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}(a,c),c);return d["!cols"]=c.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete c.DBF,d}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function s(a,l){try{return Mi(i(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}},to_sheet:i,from_sheet:function o(a,l){var c=l||{};if(+c.codepage>=0&&Cr(+c.codepage),"string"==c.type)throw new Error("Cannot write DBF to JS string");var d=jt(),u=ta(a,{header:1,raw:!0,cellDates:!0}),h=u[0],g=u.slice(1),p=a["!cols"]||[],f=0,m=0,w=0,C=1;for(f=0;f<h.length;++f)if(((p[f]||{}).DBF||{}).name)h[f]=p[f].DBF.name,++w;else if(null!=h[f]){if(++w,"number"==typeof h[f]&&(h[f]=h[f].toString(10)),"string"!=typeof h[f])throw new Error("DBF Invalid column name "+h[f]+" |"+typeof h[f]+"|");if(h.indexOf(h[f])!==f)for(m=0;m<1024;++m)if(-1==h.indexOf(h[f]+"_"+m)){h[f]+="_"+m;break}}var v=He(a["!ref"]),k=[],M=[],O=[];for(f=0;f<=v.e.c-v.s.c;++f){var y="",L="",_=0,j=[];for(m=0;m<g.length;++m)null!=g[m][f]&&j.push(g[m][f]);if(0!=j.length&&null!=h[f]){for(m=0;m<j.length;++m){switch(typeof j[m]){case"number":L="B";break;case"string":default:L="C";break;case"boolean":L="L";break;case"object":L=j[m]instanceof Date?"D":"C"}_=Math.max(_,String(j[m]).length),y=y&&y!=L?"C":L}_>250&&(_=250),"C"==(L=((p[f]||{}).DBF||{}).type)&&p[f].DBF.len>_&&(_=p[f].DBF.len),"B"==y&&"N"==L&&(y="N",O[f]=p[f].DBF.dec,_=p[f].DBF.len),M[f]="C"==y||"N"==L?_:n[y]||0,C+=M[f],k[f]=y}else k[f]="?"}var K=d.next(32);for(K.write_shift(4,318902576),K.write_shift(4,g.length),K.write_shift(2,296+32*w),K.write_shift(2,C),f=0;f<4;++f)K.write_shift(4,0);for(K.write_shift(4,0|(+t[Xi]||3)<<8),f=0,m=0;f<h.length;++f)if(null!=h[f]){var B=d.next(32),ae=(h[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,ae,"sbcs"),B.write_shift(1,"?"==k[f]?"C":k[f],"sbcs"),B.write_shift(4,m),B.write_shift(1,M[f]||n[k[f]]||0),B.write_shift(1,O[f]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),m+=M[f]||n[k[f]]||0}var me=d.next(264);for(me.write_shift(4,13),f=0;f<65;++f)me.write_shift(4,0);for(f=0;f<g.length;++f){var ue=d.next(C);for(ue.write_shift(1,0),m=0;m<h.length;++m)if(null!=h[m])switch(k[m]){case"L":ue.write_shift(1,null==g[f][m]?63:g[f][m]?84:70);break;case"B":ue.write_shift(8,g[f][m]||0,"f");break;case"N":var ye="0";for("number"==typeof g[f][m]&&(ye=g[f][m].toFixed(O[m]||0)),w=0;w<M[m]-ye.length;++w)ue.write_shift(1,32);ue.write_shift(1,ye,"sbcs");break;case"D":g[f][m]?(ue.write_shift(4,("0000"+g[f][m].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(g[f][m].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+g[f][m].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(null!=g[f][m]?g[f][m]:"").slice(0,M[m]);for(ue.write_shift(1,Ce,"sbcs"),w=0;w<M[m]-Ce.length;++w)ue.write_shift(1,32)}}return d.next(1).write_shift(1,26),d.end()}}}(),Gh=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+ot(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,g){var p=e[g];return"number"==typeof p?Ua(p):p},i=function(h,g,p){var f=g.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return 59==f?h:Ua(f)};function n(h,g){var K,p=h.split(/[\n\r]+/),f=-1,m=-1,w=0,C=0,v=[],k=[],M=null,O={},y=[],L=[],_=[],j=0;for(+g.codepage>=0&&Cr(+g.codepage);w!==p.length;++w){j=0;var ue,B=p[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,r),ae=B.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")});if(B.length>0)switch(ae[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==ae[1].charAt(0)&&k.push(B.slice(3).replace(/;;/g,";"));break;case"C":var ye=!1,Ce=!1,Oe=!1,pe=!1,Ee=-1,ee=-1;for(C=1;C<ae.length;++C)switch(ae[C].charAt(0)){case"A":case"G":break;case"X":m=parseInt(ae[C].slice(1))-1,Ce=!0;break;case"Y":for(f=parseInt(ae[C].slice(1))-1,Ce||(m=0),K=v.length;K<=f;++K)v[K]=[];break;case"K":'"'===(ue=ae[C].slice(1)).charAt(0)?ue=ue.slice(1,ue.length-1):"TRUE"===ue?ue=!0:"FALSE"===ue?ue=!1:isNaN(Br(ue))?isNaN(Os(ue).getDate())||(ue=st(ue)):(ue=Br(ue),null!==M&&Ls(M)&&(ue=qa(ue))),typeof ze<"u"&&"string"==typeof ue&&"string"!=(g||{}).type&&(g||{}).codepage&&(ue=ze.utils.decode(g.codepage,ue)),ye=!0;break;case"E":pe=!0;var A=Us(ae[C].slice(1),{r:f,c:m});v[f][m]=[v[f][m],A];break;case"S":Oe=!0,v[f][m]=[v[f][m],"S5S"];break;case"R":Ee=parseInt(ae[C].slice(1))-1;break;case"C":ee=parseInt(ae[C].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}if(ye&&(v[f][m]&&2==v[f][m].length?v[f][m][0]=ue:v[f][m]=ue,M=null),Oe){if(pe)throw new Error("SYLK shared formula cannot have own formula");var V=Ee>-1&&v[Ee][ee];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");v[f][m][1]=og(V[1],{r:f-Ee,c:m-ee})}break;case"F":var I=0;for(C=1;C<ae.length;++C)switch(ae[C].charAt(0)){case"X":m=parseInt(ae[C].slice(1))-1,++I;break;case"Y":for(f=parseInt(ae[C].slice(1))-1,K=v.length;K<=f;++K)v[K]=[];break;case"M":j=parseInt(ae[C].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":M=k[parseInt(ae[C].slice(1))];break;case"W":for(_=ae[C].slice(1).split(" "),K=parseInt(_[0],10);K<=parseInt(_[1],10);++K)j=parseInt(_[2],10),L[K-1]=0===j?{hidden:!0}:{wch:j},Li(L[K-1]);break;case"C":L[m=parseInt(ae[C].slice(1))-1]||(L[m]={});break;case"R":y[f=parseInt(ae[C].slice(1))-1]||(y[f]={}),j>0?(y[f].hpt=j,y[f].hpx=$o(j)):0===j&&(y[f].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}I<1&&(M=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}}return y.length>0&&(O["!rows"]=y),L.length>0&&(O["!cols"]=L),g&&g.sheetRows&&(v=v.slice(0,g.sheetRows)),[v,O]}function o(h,g){var p=function s(h,g){switch(g.type){case"base64":return n(cr(h),g);case"binary":return n(h,g);case"buffer":return n(Pe&&Buffer.isBuffer(h)?h.toString("binary"):ki(h),g);case"array":return n(Zi(h),g)}throw new Error("Unrecognized type "+g.type)}(h,g),m=p[1],w=Gs(p[0],g);return ot(m).forEach(function(C){w[C]=m[C]}),w}function l(h,g,p,f){var m="C;Y"+(p+1)+";X"+(f+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+_l(h.f,{r:p,c:f}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return m}return e["|"]=254,{to_workbook:function a(h,g){return Mi(o(h,g),g)},to_sheet:o,from_sheet:function u(h,g){var w,p=["ID;PWXL;N;E"],f=[],m=He(h["!ref"]),C=Array.isArray(h),v="\r\n";p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&function c(h,g){g.forEach(function(p,f){var m="F;W"+(f+1)+" "+(f+1)+" ";p.hidden?m+="0":("number"==typeof p.width&&!p.wpx&&(p.wpx=In(p.width)),"number"==typeof p.wpx&&!p.wch&&(p.wch=Ln(p.wpx)),"number"==typeof p.wch&&(m+=Math.round(p.wch)))," "!=m.charAt(m.length-1)&&h.push(m)})}(p,h["!cols"]),h["!rows"]&&function d(h,g){g.forEach(function(p,f){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*_n(p.hpx)+";"),m.length>2&&h.push(m+"R"+(f+1))})}(p,h["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var k=m.s.r;k<=m.e.r;++k)for(var M=m.s.c;M<=m.e.c;++M){var O=be({r:k,c:M});(w=C?(h[k]||[])[M]:h[O])&&(null!=w.v||w.f&&!w.F)&&f.push(l(w,0,k,M))}return p.join(v)+v+f.join(v)+v+"E"+v}}}(),Hh=function(){function t(n,o){for(var a=n.split("\n"),l=-1,c=-1,d=0,u=[];d!==a.length;++d)if("BOT"!==a[d].trim()){if(!(l<0)){for(var h=a[d].trim().split(","),g=h[0],p=h[1],f=a[++d]||"";1&(f.match(/["]/g)||[]).length&&d<a.length-1;)f+="\n"+a[++d];switch(f=f.trim(),+g){case-1:if("BOT"===f){u[++l]=[],c=0;continue}if("EOD"!==f)throw new Error("Unrecognized DIF special command "+f);break;case 0:u[l][c]="TRUE"===f||"FALSE"!==f&&(isNaN(Br(p))?isNaN(Os(p).getDate())?p:st(p):Br(p)),++c;break;case 1:(f=(f=f.slice(1,f.length-1)).replace(/""/g,'"'))&&f.match(/^=".*"$/)&&(f=f.slice(2,-1)),u[l][c++]=""!==f?f:null}if("EOD"===f)break}}else u[++l]=[],c=0;return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),u}function r(n,o){return Gs(function e(n,o){switch(o.type){case"base64":return t(cr(n),o);case"binary":return t(n,o);case"buffer":return t(Pe&&Buffer.isBuffer(n)?n.toString("binary"):ki(n),o);case"array":return t(Zi(n),o)}throw new Error("Unrecognized type "+o.type)}(n,o),o)}return{to_workbook:function i(n,o){return Mi(r(n,o),o)},to_sheet:r,from_sheet:function(){var n=function(l,c,d,u,h){l.push(c),l.push(d+","+u),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,c,d,u){l.push(c+","+d),l.push(1==c?'"'+u.replace(/"/g,'""')+'"':u)};return function(l){var u,c=[],d=He(l["!ref"]),h=Array.isArray(l);n(c,"TABLE",0,1,"sheetjs"),n(c,"VECTORS",0,d.e.r-d.s.r+1,""),n(c,"TUPLES",0,d.e.c-d.s.c+1,""),n(c,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){o(c,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var f=be({r:g,c:p});if(u=h?(l[g]||[])[p]:l[f])switch(u.t){case"n":var m=u.w;!m&&null!=u.v&&(m=u.v),null==m?o(c,1,0,u.f&&!u.F?"="+u.f:""):o(c,0,m,"V");break;case"b":o(c,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=ur(u.z||Se[14],Et(st(u.v)))),o(c,0,u.w,"V");break;default:o(c,1,0,"")}else o(c,1,0,"")}}return o(c,-1,0,"EOD"),c.join("\r\n")}}()}}(),zh=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function i(u,h){return Gs(function r(u,h){for(var g=u.split("\n"),p=-1,f=-1,m=0,w=[];m!==g.length;++m){var C=g[m].trim().split(":");if("cell"===C[0]){var v=ut(C[1]);if(w.length<=v.r)for(p=w.length;p<=v.r;++p)w[p]||(w[p]=[]);switch(p=v.r,f=v.c,C[2]){case"t":w[p][f]=e(C[3]);break;case"v":w[p][f]=+C[3];break;case"vtf":var k=C[C.length-1];case"vtc":w[p][f]="nl"===C[3]?!!+C[4]:+C[4],"vtf"==C[2]&&(w[p][f]=[w[p][f],k])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}(u,h),h)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),l="--SocialCalcSpreadsheetControlSave--";function c(u){if(!u||!u["!ref"])return"";for(var p,h=[],g=[],f="",m=$t(u["!ref"]),w=Array.isArray(u),C=m.s.r;C<=m.e.r;++C)for(var v=m.s.c;v<=m.e.c;++v)if(f=be({r:C,c:v}),(p=w?(u[C]||[])[v]:u[f])&&null!=p.v&&"z"!==p.t){switch(g=["cell",f,"t"],p.t){case"s":case"str":g.push(t(p.v));break;case"n":p.f?(g[2]="vtf",g[3]="n",g[4]=p.v,g[5]=t(p.f)):(g[2]="v",g[3]=p.v);break;case"b":g[2]="vt"+(p.f?"f":"c"),g[3]="nl",g[4]=p.v?"1":"0",g[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var k=Et(st(p.v));g[2]="vtc",g[3]="nd",g[4]=""+k,g[5]=p.w||ur(p.z||Se[14],k);break;case"e":continue}h.push(g.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join("\n")}return{to_workbook:function s(u,h){return Mi(i(u,h),h)},to_sheet:i,from_sheet:function d(u){return[n,o,a,o,c(u),l].join("\n")}}}(),Vs=function(){function e(d,u,h,g,p){p.raw?u[h][g]=d:""===d||(u[h][g]="TRUE"===d||"FALSE"!==d&&(isNaN(Br(d))?isNaN(Os(d).getDate())?d:st(d):Br(d)))}var r={44:",",9:"\t",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(d){for(var u={},h=!1,g=0,p=0;g<d.length;++g)34==(p=d.charCodeAt(g))?h=!h:!h&&p in r&&(u[p]=(u[p]||0)+1);for(g in p=[],u)Object.prototype.hasOwnProperty.call(u,g)&&p.push([u[g],g]);if(!p.length)for(g in u=i)Object.prototype.hasOwnProperty.call(u,g)&&p.push([u[g],g]);return p.sort(function(f,m){return f[0]-m[0]||i[f[1]]-i[m[1]]}),r[p.pop()[1]]||44}function o(d,u){return!u||!u.PRN||u.FS||"sep="==d.slice(0,4)||d.indexOf("\t")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?function n(d,u){var h=u||{},g="";null!=nt&&null==h.dense&&(h.dense=nt);var p=h.dense?[]:{},f={s:{c:0,r:0},e:{c:0,r:0}};"sep="==d.slice(0,4)?13==d.charCodeAt(5)&&10==d.charCodeAt(6)?(g=d.charAt(4),d=d.slice(7)):13==d.charCodeAt(5)||10==d.charCodeAt(5)?(g=d.charAt(4),d=d.slice(6)):g=s(d.slice(0,1024)):g=h&&h.FS?h.FS:s(d.slice(0,1024));var m=0,w=0,C=0,v=0,k=0,M=g.charCodeAt(0),O=!1,y=0,L=d.charCodeAt(0);d=d.replace(/\r\n/gm,"\n");var _=null!=h.dateNF?function Ym(e){var t="number"==typeof e?Se[e]:e;return t=t.replace(lu,"(\\d+)"),new RegExp("^"+t+"$")}(h.dateNF):null;function j(){var K=d.slice(v,k),B={};if('"'==K.charAt(0)&&'"'==K.charAt(K.length-1)&&(K=K.slice(1,-1).replace(/""/g,'"')),0===K.length)B.t="z";else if(h.raw)B.t="s",B.v=K;else if(0===K.trim().length)B.t="s",B.v=K;else if(61==K.charCodeAt(0))34==K.charCodeAt(1)&&34==K.charCodeAt(K.length-1)?(B.t="s",B.v=K.slice(2,-1).replace(/""/g,'"')):function CS(e){return 1!=e.length}(K)?(B.t="n",B.f=K.slice(1)):(B.t="s",B.v=K);else if("TRUE"==K)B.t="b",B.v=!0;else if("FALSE"==K)B.t="b",B.v=!1;else if(isNaN(C=Br(K)))if(!isNaN(Os(K).getDate())||_&&K.match(_)){B.z=h.dateNF||Se[14];var ae=0;_&&K.match(_)&&(K=function qm(e,t,r){var i=-1,s=-1,n=-1,o=-1,a=-1,l=-1;(t.match(lu)||[]).forEach(function(u,h){var g=parseInt(r[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":i=g;break;case"d":n=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:s=g}}),l>=0&&-1==a&&s>=0&&(a=s,s=-1);var c=(""+(i>=0?i:(new Date).getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==o&&-1==a&&-1==l?c:-1==i&&-1==s&&-1==n?d:c+"T"+d}(0,h.dateNF,K.match(_)||[]),ae=1),h.cellDates?(B.t="d",B.v=st(K,ae)):(B.t="n",B.v=Et(st(K,ae))),!1!==h.cellText&&(B.w=ur(B.z,B.v instanceof Date?Et(B.v):B.v)),h.cellNF||delete B.z}else B.t="s",B.v=K;else B.t="n",!1!==h.cellText&&(B.w=K),B.v=C;if("z"==B.t||(h.dense?(p[m]||(p[m]=[]),p[m][w]=B):p[be({c:w,r:m})]=B),L=d.charCodeAt(v=k+1),f.e.c<w&&(f.e.c=w),f.e.r<m&&(f.e.r=m),y==M)++w;else if(w=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;k<d.length;++k)switch(y=d.charCodeAt(k)){case 34:34===L&&(O=!O);break;case M:case 10:case 13:if(!O&&j())break e}return k-v>0&&j(),p["!ref"]=ke(f),p}(d,u):Gs(function t(d,u){var h=u||{},g=[];if(!d||0===d.length)return g;for(var p=d.split(/[\r\n]/),f=p.length-1;f>=0&&0===p[f].length;)--f;for(var m=10,w=0,C=0;C<=f;++C)-1==(w=p[C].indexOf(" "))?w=p[C].length:w++,m=Math.max(m,w);for(C=0;C<=f;++C){g[C]=[];var v=0;for(e(p[C].slice(0,m).trim(),g,C,v,h),v=1;v<=(p[C].length-m)/10+1;++v)e(p[C].slice(m+10*(v-1),m+10*v).trim(),g,C,v,h)}return h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}(d,u),u)}function a(d,u){var h="",g="string"==u.type?[0,0,0,0]:function Zl(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cr(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}(d,u);switch(u.type){case"base64":h=cr(d);break;case"binary":case"string":h=d;break;case"buffer":h=65001==u.codepage?d.toString("utf8"):u.codepage&&typeof ze<"u"?ze.utils.decode(u.codepage,d):Pe&&Buffer.isBuffer(d)?d.toString("binary"):ki(d);break;case"array":h=Zi(d);break;default:throw new Error("Unrecognized type "+u.type)}return 239==g[0]&&187==g[1]&&191==g[2]?h=Qe(h.slice(3)):"string"!=u.type&&"buffer"!=u.type&&65001==u.codepage?h=Qe(h):"binary"==u.type&&typeof ze<"u"&&u.codepage&&(h=ze.utils.decode(u.codepage,ze.utils.encode(28591,h))),"socialcalc:version:"==h.slice(0,19)?zh.to_sheet("string"==u.type?h:Qe(h),u):o(h,u)}return{to_workbook:function l(d,u){return Mi(a(d,u),u)},to_sheet:a,from_sheet:function c(d){for(var g,u=[],h=He(d["!ref"]),p=Array.isArray(d),f=h.s.r;f<=h.e.r;++f){for(var m=[],w=h.s.c;w<=h.e.c;++w){var C=be({r:f,c:w});if((g=p?(d[f]||[])[w]:d[C])&&null!=g.v){for(var v=(g.w||(qr(g),g.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(0===w?" ":""))}else m.push("          ")}u.push(m.join(""))}return u.join("\n")}}}(),ds=function(){function e(A,V,I){if(A){At(A,A.l||0);for(var P=I.Enum||Ee;A.l<A.length;){var Q=A.read_shift(2),ge=P[Q]||P[65535],se=A.read_shift(2),ne=A.l+se,J=ge.f&&ge.f(A,se,I);if(A.l=ne,V(J,ge,Q))return}}}function r(A,V){if(!A)return A;var I=V||{};null!=nt&&null==I.dense&&(I.dense=nt);var P=I.dense?[]:{},Q="Sheet1",ge="",se=0,ne={},J=[],Ae=[],T={s:{r:0,c:0},e:{r:0,c:0}},Ye=I.sheetRows||0;if(0==A[2]&&(8==A[3]||9==A[3])&&A.length>=16&&5==A[14]&&108===A[15])throw new Error("Unsupported Works 3 for Mac file");if(2==A[2])I.Enum=Ee,e(A,function(fe,pt,Ir){switch(Ir){case 0:I.vers=fe,fe>=4096&&(I.qpro=!0);break;case 6:T=fe;break;case 204:fe&&(ge=fe);break;case 222:ge=fe;break;case 15:case 51:I.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:14==Ir&&112==(112&fe[2])&&(15&fe[2])>1&&(15&fe[2])<15&&(fe[1].z=I.dateNF||Se[14],I.cellDates&&(fe[1].t="d",fe[1].v=qa(fe[1].v))),I.qpro&&fe[3]>se&&(P["!ref"]=ke(T),ne[Q]=P,J.push(Q),P=I.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},se=fe[3],Q=ge||"Sheet"+(se+1),ge="");var si=I.dense?(P[fe[0].r]||[])[fe[0].c]:P[be(fe[0])];if(si){si.t=fe[1].t,si.v=fe[1].v,null!=fe[1].z&&(si.z=fe[1].z),null!=fe[1].f&&(si.f=fe[1].f);break}I.dense?(P[fe[0].r]||(P[fe[0].r]=[]),P[fe[0].r][fe[0].c]=fe[1]):P[be(fe[0])]=fe[1]}},I);else{if(26!=A[2]&&14!=A[2])throw new Error("Unrecognized LOTUS BOF "+A[2]);I.Enum=ee,14==A[2]&&(I.qpro=!0,A.l=0),e(A,function(fe,pt,Ir){switch(Ir){case 204:Q=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>se&&(P["!ref"]=ke(T),ne[Q]=P,J.push(Q),P=I.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},Q="Sheet"+((se=fe[3])+1)),Ye>0&&fe[0].r>=Ye)break;I.dense?(P[fe[0].r]||(P[fe[0].r]=[]),P[fe[0].r][fe[0].c]=fe[1]):P[be(fe[0])]=fe[1],T.e.c<fe[0].c&&(T.e.c=fe[0].c),T.e.r<fe[0].r&&(T.e.r=fe[0].r);break;case 27:fe[14e3]&&(Ae[fe[14e3][0]]=fe[14e3][1]);break;case 1537:Ae[fe[0]]=fe[1],fe[0]==se&&(Q=fe[1])}},I)}if(P["!ref"]=ke(T),ne[ge||Q]=P,J.push(ge||Q),!Ae.length)return{SheetNames:J,Sheets:ne};for(var Be={},qe=[],Ne=0;Ne<Ae.length;++Ne)ne[J[Ne]]?(qe.push(Ae[Ne]||J[Ne]),Be[Ae[Ne]]=ne[Ae[Ne]]||ne[J[Ne]]):(qe.push(Ae[Ne]),Be[Ae[Ne]]={"!ref":"A1"});return{SheetNames:qe,Sheets:Be}}function c(A,V,I){var P=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&20768!=I.vers?(P[0].c=A.read_shift(1),P[3]=A.read_shift(1),P[0].r=A.read_shift(2),A.l+=2):(P[2]=A.read_shift(1),P[0].c=A.read_shift(2),P[0].r=A.read_shift(2)),P}function d(A,V,I){var P=A.l+V,Q=c(A,0,I);if(Q[1].t="s",20768==I.vers){A.l++;var ge=A.read_shift(1);return Q[1].v=A.read_shift(ge,"utf8"),Q}return I.qpro&&A.l++,Q[1].v=A.read_shift(P-A.l,"cstr"),Q}function u(A,V,I){var P=Y(7+I.length);P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,A),P.write_shift(1,39);for(var Q=0;Q<P.length;++Q){var ge=I.charCodeAt(Q);P.write_shift(1,ge>=128?95:ge)}return P.write_shift(1,0),P}function g(A,V,I){var P=Y(7);return P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,A),P.write_shift(2,I,"i"),P}function f(A,V,I){var P=Y(13);return P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,A),P.write_shift(8,I,"f"),P}function w(A,V,I){var P=32768&V;return V=(P?A:0)+((V&=-32769)>=8192?V-16384:V),(P?"":"$")+(I?Ze(V):ct(V))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(A){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=A.read_shift(2),V[3]=A[A.l++],V[0].c=A[A.l++],V}function y(A,V,I,P){var Q=Y(6+P.length);Q.write_shift(2,A),Q.write_shift(1,I),Q.write_shift(1,V),Q.write_shift(1,39);for(var ge=0;ge<P.length;++ge){var se=P.charCodeAt(ge);Q.write_shift(1,se>=128?95:se)}return Q.write_shift(1,0),Q}function _(A,V){var I=M(A),P=A.read_shift(4),Q=A.read_shift(4),ge=A.read_shift(2);if(65535==ge)return 0===P&&3221225472===Q?(I[1].t="e",I[1].v=15):0===P&&3489660928===Q?(I[1].t="e",I[1].v=42):I[1].v=0,I;var se=32768&ge;return ge=(32767&ge)-16446,I[1].v=(1-2*se)*(Q*Math.pow(2,ge+32)+P*Math.pow(2,ge)),I}function j(A,V,I,P){var Q=Y(14);if(Q.write_shift(2,A),Q.write_shift(1,I),Q.write_shift(1,V),0==P)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var ge=0,se=0,J=0;return P<0&&(ge=1,P=-P),se=0|Math.log2(P),2147483648&(J=(P/=Math.pow(2,se-31))>>>0)||(++se,J=(P/=2)>>>0),P-=J,J|=2147483648,J>>>=0,P*=Math.pow(2,32),Q.write_shift(4,P>>>0),Q.write_shift(4,J),Q.write_shift(2,se+=16383+(ge?32768:0)),Q}function ae(A,V){var I=M(A),P=A.read_shift(8,"f");return I[1].v=P,I}function ue(A,V){return 0==A[A.l+V-1]?A.read_shift(V,"cstr"):""}function pe(A,V){var I=Y(5+A.length);I.write_shift(2,14e3),I.write_shift(2,V);for(var P=0;P<A.length;++P){var Q=A.charCodeAt(P);I[I.l++]=Q>127?95:Q}return I[I.l++]=0,I}var Ee={0:{n:"BOF",f:wt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function a(A,V,I){var P={s:{c:0,r:0},e:{c:0,r:0}};return 8==V&&I.qpro?(P.s.c=A.read_shift(1),A.l++,P.s.r=A.read_shift(2),P.e.c=A.read_shift(1),A.l++,P.e.r=A.read_shift(2),P):(P.s.c=A.read_shift(2),P.s.r=A.read_shift(2),12==V&&I.qpro&&(A.l+=2),P.e.c=A.read_shift(2),P.e.r=A.read_shift(2),12==V&&I.qpro&&(A.l+=2),65535==P.s.c&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function h(A,V,I){var P=c(A,0,I);return P[1].v=A.read_shift(2,"i"),P}},14:{n:"NUMBER",f:function p(A,V,I){var P=c(A,0,I);return P[1].v=A.read_shift(8,"f"),P}},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:function m(A,V,I){var P=A.l+V,Q=c(A,0,I);if(Q[1].v=A.read_shift(8,"f"),I.qpro)A.l=P;else{var ge=A.read_shift(2);(function k(A,V){At(A,0);for(var I=[],P=0,Q="",ge="",se="",ne="";A.l<A.length;){var J=A[A.l++];switch(J){case 0:I.push(A.read_shift(8,"f"));break;case 1:ge=w(V[0].c,A.read_shift(2),!0),Q=w(V[0].r,A.read_shift(2),!1),I.push(ge+Q);break;case 2:var Ae=w(V[0].c,A.read_shift(2),!0),T=w(V[0].r,A.read_shift(2),!1);ge=w(V[0].c,A.read_shift(2),!0),Q=w(V[0].r,A.read_shift(2),!1),I.push(Ae+T+":"+ge+Q);break;case 3:if(A.l<A.length)return void console.error("WK1 premature formula end");break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(A.read_shift(2));break;case 6:for(var Ye="";J=A[A.l++];)Ye+=String.fromCharCode(J);I.push('"'+Ye.replace(/"/g,'""')+'"');break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ne=I.pop(),se=I.pop(),I.push(["AND","OR"][J-20]+"("+se+","+ne+")");break;default:if(J<32&&v[J])ne=I.pop(),se=I.pop(),I.push(se+v[J]+ne);else{if(!C[J])return J<=7?console.error("WK1 invalid opcode "+J.toString(16)):J<=24?console.error("WK1 unsupported op "+J.toString(16)):J<=30?console.error("WK1 invalid opcode "+J.toString(16)):J<=115?console.error("WK1 unsupported function opcode "+J.toString(16)):console.error("WK1 unrecognized opcode "+J.toString(16));if(69==(P=C[J][1])&&(P=A[A.l++]),P>I.length)return void console.error("WK1 bad formula parse 0x"+J.toString(16)+":|"+I.join("|")+"|");var Be=I.slice(-P);I.length-=P,I.push(C[J][0]+"("+Be.join(",")+")")}}}1==I.length?V[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")})(A.slice(A.l,A.l+ge),Q),A.l+=ge}return Q}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:function ye(A,V){var I=A[A.l++];I>V-1&&(I=V-1);for(var P="";P.length<I;)P+=String.fromCharCode(A[A.l++]);return P}},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function O(A,V){var I=M(A);return I[1].t="s",I[1].v=A.read_shift(V-4,"cstr"),I}},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:function L(A,V){var I=M(A);I[1].v=A.read_shift(2);var P=I[1].v>>1;if(1&I[1].v)switch(7&P){case 0:P=5e3*(P>>3);break;case 1:P=500*(P>>3);break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64}return I[1].v=P,I}},25:{n:"FORMULA19",f:function K(A,V){var I=_(A);return A.l+=V-14,I}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Oe(A,V){for(var I={},P=A.l+V;A.l<P;){var Q=A.read_shift(2);if(14e3==Q){for(I[Q]=[0,""],I[Q][0]=A.read_shift(2);A[A.l];)I[Q][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return I}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function B(A,V){var I=M(A),P=A.read_shift(4);return I[1].v=P>>6,I}},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:function me(A,V){var I=ae(A);return A.l+=V-10,I}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function Ce(A,V,I){if(I.qpro&&!(V<21)){var P=A.read_shift(1);return A.l+=17,A.l+=1,A.l+=2,[P,A.read_shift(V-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function i(A,V){var I=V||{};if(+I.codepage>=0&&Cr(+I.codepage),"string"==I.type)throw new Error("Cannot write WK1 to JS string");var P=jt(),Q=He(A["!ref"]),ge=Array.isArray(A),se=[];oe(P,0,function n(A){var V=Y(2);return V.write_shift(2,A),V}(1030)),oe(P,6,function l(A){var V=Y(8);return V.write_shift(2,A.s.c),V.write_shift(2,A.s.r),V.write_shift(2,A.e.c),V.write_shift(2,A.e.r),V}(Q));for(var ne=Math.min(Q.e.r,8191),J=Q.s.r;J<=ne;++J)for(var Ae=ct(J),T=Q.s.c;T<=Q.e.c;++T){J===Q.s.r&&(se[T]=Ze(T));var Be=ge?(A[J]||[])[T]:A[se[T]+Ae];Be&&"z"!=Be.t&&("n"==Be.t?(0|Be.v)==Be.v&&Be.v>=-32768&&Be.v<=32767?oe(P,13,g(J,T,Be.v)):oe(P,14,f(J,T,Be.v)):oe(P,15,u(J,T,qr(Be).slice(0,239))))}return oe(P,1),P.end()},book_to_wk3:function s(A,V){var I=V||{};if(+I.codepage>=0&&Cr(+I.codepage),"string"==I.type)throw new Error("Cannot write WK3 to JS string");var P=jt();oe(P,0,function o(A){var V=Y(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var I=0,P=0,Q=0,ge=0;ge<A.SheetNames.length;++ge){var ne=A.Sheets[A.SheetNames[ge]];if(ne&&ne["!ref"]){++Q;var J=$t(ne["!ref"]);I<J.e.r&&(I=J.e.r),P<J.e.c&&(P=J.e.c)}}return I>8191&&(I=8191),V.write_shift(2,I),V.write_shift(1,Q),V.write_shift(1,P),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}(A));for(var Q=0,ge=0;Q<A.SheetNames.length;++Q)(A.Sheets[A.SheetNames[Q]]||{})["!ref"]&&oe(P,27,pe(A.SheetNames[Q],ge++));var se=0;for(Q=0;Q<A.SheetNames.length;++Q){var ne=A.Sheets[A.SheetNames[Q]];if(ne&&ne["!ref"]){for(var J=He(ne["!ref"]),Ae=Array.isArray(ne),T=[],Ye=Math.min(J.e.r,8191),Be=J.s.r;Be<=Ye;++Be)for(var qe=ct(Be),Ne=J.s.c;Ne<=J.e.c;++Ne){Be===J.s.r&&(T[Ne]=Ze(Ne));var pt=Ae?(ne[Be]||[])[Ne]:ne[T[Ne]+qe];pt&&"z"!=pt.t&&("n"==pt.t?oe(P,23,j(Be,Ne,se,pt.v)):oe(P,22,y(Be,Ne,se,qr(pt).slice(0,239))))}++se}}return oe(P,1),P.end()},to_workbook:function t(A,V){switch(V.type){case"base64":return r(dr(cr(A)),V);case"binary":return r(dr(A),V);case"buffer":case"array":return r(A,V)}throw"Unsupported type "+V.type}}}(),S1=/^\s|\s$|[\t\n\r]/;function Wh(e,t){if(!t.bookSST)return"";var r=[lt];r[r.length]=ie("sst",null,{xmlns:Pi[0],count:e.Count,uniqueCount:e.Unique});for(var i=0;i!=e.length;++i)if(null!=e[i]){var s=e[i],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(S1)&&(n+=' xml:space="preserve"'),n+=">"+Ke(s.t)+"</t>"),r[r.length]=n+="</si>"}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var F1=function _v(e,t){var r=!1;return null==t&&(r=!0,t=Y(15+4*e.t.length)),t.write_shift(1,0),Rt(e.t,t),r?t.slice(0,t.l):t};function R1(e){var t=jt();Z(t,159,function E1(e,t){return t||(t=Y(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Z(t,19,F1(e[r]));return Z(t,160),t.end()}function Dl(e){var r,n,t=0,i=function Uh(e){if(typeof ze<"u")return ze.utils.encode(Xi,e);for(var t=[],r=e.split(""),i=0;i<r.length;++i)t[i]=r[i].charCodeAt(0);return t}(e),s=i.length+1;for((r=Ri(s))[0]=i.length,n=1;n!=s;++n)r[n]=i[n-1];for(n=s-1;n>=0;--n)t=((16384&t?1:0)|t<<1&32767)^r[n];return 52811^t}var Yh=function(){function e(s,n){switch(n.type){case"base64":return t(cr(s),n);case"binary":return t(s,n);case"buffer":return t(Pe&&Buffer.isBuffer(s)?s.toString("binary"):ki(s),n);case"array":return t(Zi(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var a=(n||{}).dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,u){Array.isArray(a)&&(a[u]=[]);for(var p,h=/\\\w+\b/g,g=0,f=-1;p=h.exec(d);){if("\\cell"===p[0]){var m=d.slice(g,h.lastIndex-p[0].length);if(" "==m[0]&&(m=m.slice(1)),++f,m.length){var w={v:m,t:"s"};Array.isArray(a)?a[u][f]=w:a[be({r:u,c:f})]=w}}g=h.lastIndex}f>c.e.c&&(c.e.c=f)}),a["!ref"]=ke(c),a}return{to_workbook:function r(s,n){return Mi(e(s,n),n)},to_sheet:e,from_sheet:function i(s){for(var a,n=["{\\rtf1\\ansi"],o=He(s["!ref"]),l=Array.isArray(s),c=o.s.r;c<=o.e.r;++c){n.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)n.push("\\cellx"+(d+1));for(n.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var u=be({r:c,c:d});(a=l?(s[c]||[])[d]:s[u])&&(null!=a.v||a.f&&!a.F)&&(n.push(" "+(a.w||(qr(a),a.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function Mn(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Nt=6;function In(e){return Math.floor((e+Math.round(128/Nt)/256)*Nt)}function Ln(e){return Math.floor((e-5)/Nt*100+.5)/100}function jo(e){return Math.round((e*Nt+5)/Nt*256)/256}function Li(e){e.width?(e.wpx=In(e.width),e.wch=Ln(e.wpx),e.MDW=Nt):e.wpx?(e.wch=Ln(e.wpx),e.width=jo(e.wch),e.MDW=Nt):"number"==typeof e.wch&&(e.width=jo(e.wch),e.wpx=In(e.width),e.MDW=Nt),e.customWidth&&delete e.customWidth}var Xh=96;function _n(e){return 96*e/Xh}function $o(e){return e*Xh/96}function Qh(e,t){var i,r=[lt,ie("styleSheet",null,{xmlns:Pi[0],"xmlns:vt":Ct.vt})];return e.SSF&&null!=(i=function Q1(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=e[i]&&(t[t.length]=ie("numFmt",null,{numFmtId:i,formatCode:Ke(e[i])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=i),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=function Z1(e){var t=[];return t[t.length]=ie("cellXfs",null),e.forEach(function(r){t[t.length]=ie("xf",null,r)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=i),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function tx(e,t,r){r||(r=Y(6+4*t.length)),r.write_shift(2,e),Rt(t,r);var i=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),i}var Ml,sx=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],nx=Lt;function Zh(e,t){t||(t=Y(84)),Ml||(Ml=To(sx));var r=Ml[e.patternType];null==r&&(r=40),t.write_shift(4,r);var i=0;if(40!=r)for(_o({auto:1},t),_o({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Jh(e,t,r){return r||(r=Y(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function On(e,t){return t||(t=Y(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ax=Lt;function Sx(e,t){var r=jt();return Z(r,278),function hx(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)null!=t[s]&&++r}),0!=r&&(Z(e,615,Nr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)null!=t[s]&&Z(e,44,tx(s,t[s]))}),Z(e,616))}}(r,e.SSF),function gx(e){Z(e,611,Nr(1)),Z(e,43,function ix(e,t){t||(t=Y(153)),t.write_shift(2,20*e.sz),function Wv(e,t){t||(t=Y(2)),t.write_shift(1,(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0)),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_o(e.color,t);var i=0;return"major"==e.scheme&&(i=1),"minor"==e.scheme&&(i=2),t.write_shift(1,i),Rt(e.name,t),t.length>t.l?t.slice(0,t.l):t}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Z(e,612)}(r),function fx(e){Z(e,603,Nr(2)),Z(e,45,Zh({patternType:"none"})),Z(e,45,Zh({patternType:"gray125"})),Z(e,604)}(r),function px(e){Z(e,613,Nr(1)),Z(e,46,function lx(e,t){return t||(t=Y(51)),t.write_shift(1,0),On(0,t),On(0,t),On(0,t),On(0,t),On(0,t),t.length>t.l?t.slice(0,t.l):t}()),Z(e,614)}(r),function mx(e){Z(e,626,Nr(1)),Z(e,47,Jh({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Z(e,627)}(r),function vx(e,t){Z(e,617,Nr(t.length)),t.forEach(function(r){Z(e,47,Jh(r,0))}),Z(e,618)}(r,t.cellXfs),function Cx(e){Z(e,619,Nr(1)),Z(e,48,function cx(e,t){return t||(t=Y(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Lo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),Z(e,620)}(r),function wx(e){Z(e,505,Nr(0)),Z(e,506)}(r),function xx(e){Z(e,508,function dx(e,t,r){var i=Y(2052);return i.write_shift(4,e),Lo(t,i),Lo(r,i),i.length>i.l?i.slice(0,i.l):i}(0,"TableStyleMedium9","PivotStyleMedium4")),Z(e,509)}(r),Z(r,279),r.end()}function Il(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[lt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Kx(){var e=jt();return Z(e,332),Z(e,334,Nr(1)),Z(e,335,function Hx(e){var t=Y(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Rt(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Z(e,336),Z(e,339,function Wx(e,t){var r=Y(8+2*t.length);return r.write_shift(4,e),Rt(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Z(e,52),Z(e,35,Nr(514)),Z(e,4096,Nr(0)),Z(e,4097,yr(1)),Z(e,36),Z(e,53),Z(e,340),Z(e,337,function jx(e,t){var r=Y(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Z(e,51,function Vx(e){var t=Y(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Z(e,338),Z(e,333),e.end()}function tg(){var e=[lt];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Ws=1024;function rg(e,t){for(var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[ie("xml",null,{"xmlns:v":gr.v,"xmlns:o":gr.o,"xmlns:x":gr.x,"xmlns:mv":gr.mv}).replace(/\/>/,">"),ie("o:shapelayout",ie("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ie("v:shapetype",[ie("v:stroke",null,{joinstyle:"miter"}),ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:i})];Ws<1e3*e;)Ws+=1e3;return t.forEach(function(n){var o=ut(n[0]),a={color2:"#BEFF82",type:"gradient"};"gradient"==a.type&&(a.angle="-180");var l="gradient"==a.type?ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ie("v:fill",l,a);++Ws,s=s.concat(["<v:shape"+bn({id:"_x0000_s"+Ws,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ie("v:shadow",null,{on:"t",obscured:"t"}),ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Dt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Dt("x:AutoFill","False"),Dt("x:Row",String(o.r)),Dt("x:Column",String(o.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function sg(e){var t=[lt,ie("comments",null,{xmlns:Pi[0]})],r=[];return t.push("<authors>"),e.forEach(function(i){i[1].forEach(function(s){var n=Ke(s.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),s.T&&s.ID&&-1==r.indexOf("tc="+s.ID)&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(i){var s=0,n=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=r.indexOf("tc="+i[1][0].ID):i[1].forEach(function(l){l.a&&(s=r.indexOf(Ke(l.a))),n.push(l.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),n.length<=1)t.push(Dt("t",Ke(n[0]||"")));else{for(var o="Comment:\n    "+n[0]+"\n",a=1;a<n.length;++a)o+="Reply:\n    "+n[a]+"\n";t.push(Dt("t",Ke(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function rS(e,t,r){var i=[lt,ie("ThreadedComments",null,{xmlns:Ct.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var n="";(s[1]||[]).forEach(function(o,a){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==a?n=l.id:l.parentId=n,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),i.push(ie("threadedComment",Dt("text",o.t||""),l))}else delete o.ID})}),i.push("</ThreadedComments>"),i.join("")}var aS=_t;function dS(e){var t=jt(),r=[];return Z(t,628),Z(t,630),e.forEach(function(i){i[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Z(t,632,function lS(e){return Rt(e.slice(0,54))}(s.a)))})}),Z(t,631),Z(t,633),e.forEach(function(i){i[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var n={s:ut(i[0]),e:ut(i[0])};Z(t,635,function oS(e,t){return null==t&&(t=Y(36)),t.write_shift(4,e[1].iauthor),Hs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([n,s])),s.t&&s.t.length>0&&Z(t,637,function Bv(e,t){var r=!1;return null==t&&(r=!0,t=Y(23+4*e.t.length)),t.write_shift(1,1),Rt(e.t,t),t.write_shift(4,1),function Lv(e,t){t||(t=Y(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}(s)),Z(t,636),delete s.iauthor})}),Z(t,634),Z(t,629),t.end()}var ng=["xlsb","xlsm","xlam","biff8","xla"],Us=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(i,s,n,o){var a=!1,l=!1;0==n.length?l=!0:"["==n.charAt(0)&&(l=!0,n=n.slice(1,-1)),0==o.length?a=!0:"["==o.charAt(0)&&(a=!0,o=o.slice(1,-1));var c=n.length>0?0|parseInt(n,10):0,d=o.length>0?0|parseInt(o,10):0;return a?d+=t.c:--d,l?c+=t.r:--c,s+(a?"":"$")+Ze(d)+(l?"":"$")+ct(c)}return function(s,n){return t=n,s.replace(e,r)}}(),Ll=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_l=function(){return function(t,r){return t.replace(Ll,function(i,s,n,o,a,l){var c=ul(o)-(n?0:r.c),d=dl(l)-(a?0:r.r);return s+"R"+(0==d?"":a?d+1:"["+d+"]")+"C"+(0==c?"":n?c+1:"["+c+"]")})}}();function og(e,t){return e.replace(Ll,function(r,i,s,n,o,a){return i+("$"==s?s+n:Ze(ul(n)+t.c))+("$"==o?o+a:ct(dl(a)+t.r))})}function xt(e){e.l+=1}function _i(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function ag(e,t,r){var i=2;if(r){if(r.biff>=2&&r.biff<=5)return lg(e);12==r.biff&&(i=4)}var s=e.read_shift(i),n=e.read_shift(i),o=_i(e,2),a=_i(e,2);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function lg(e){var t=_i(e,2),r=_i(e,2),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function cg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function xS(e){var t=_i(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var i=e.read_shift(r&&12==r.biff?4:2),s=_i(e,2);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function SS(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function dg(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function ug(e){return[e.read_shift(1),e.read_shift(1)]}function XS(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=function ht(e,t){return 1===e.read_shift(t)}(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=ui[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ot(e);break;case 2:r[1]=function ls(e,t,r){if(r.biff>5)return function Pn(e,t,r){var i=e.read_shift(r&&2==r.biff?1:2);return 0===i?(e.l++,""):function as(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return e.read_shift(t,0===s?"sbcs-cont":"dbcs-cont")}(e,i,r)}(e,0,r);var i=e.read_shift(1);return 0===i?(e.l++,""):e.read_shift(i,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function QS(e,t,r){for(var i=e.read_shift(12==r.biff?4:2),s=[],n=0;n!=i;++n)s.push((12==r.biff?is:Vo)(e,8));return s}function ZS(e,t,r){var i=0,s=0;12==r.biff?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--i,0==--s&&(s=256));for(var n=0,o=[];n!=i&&(o[n]=[]);++n)for(var a=0;a!=s;++a)o[n][a]=XS(e,r.biff);return o}function Bn(e,t,r){return e.l+=2,[SS(e)]}function Ol(e){return e.l+=6,[]}function hg(e){return e.l+=2,[wt(e),1&e.read_shift(2)]}var C2=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],gg={1:{n:"PtgExp",f:function US(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Lt},3:{n:"PtgAdd",f:xt},4:{n:"PtgSub",f:xt},5:{n:"PtgMul",f:xt},6:{n:"PtgDiv",f:xt},7:{n:"PtgPower",f:xt},8:{n:"PtgConcat",f:xt},9:{n:"PtgLt",f:xt},10:{n:"PtgLe",f:xt},11:{n:"PtgEq",f:xt},12:{n:"PtgGe",f:xt},13:{n:"PtgGt",f:xt},14:{n:"PtgNe",f:xt},15:{n:"PtgIsect",f:xt},16:{n:"PtgUnion",f:xt},17:{n:"PtgRange",f:xt},18:{n:"PtgUplus",f:xt},19:{n:"PtgUminus",f:xt},20:{n:"PtgPercent",f:xt},21:{n:"PtgParen",f:xt},22:{n:"PtgMissArg",f:xt},23:{n:"PtgStr",f:function qS(e,t,r){return e.l++,An(e,0,r)}},26:{n:"PtgSheet",f:function S2(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function y2(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function jS(e){return e.l++,ui[e.read_shift(1)]}},29:{n:"PtgBool",f:function KS(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function $S(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function YS(e){return e.l++,Ot(e)}},32:{n:"PtgArray",f:function DS(e,t,r){var i=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[i]}},33:{n:"PtgFunc",f:function HS(e,t,r){var i=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[W2[s],mg[s],i]}},34:{n:"PtgFuncVar",f:function zS(e,t,r){var i=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[88==i?-1:0,e.read_shift(1)]:function VS(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[s,(0===n[0]?mg:V2)[n[1]]]}},35:{n:"PtgName",f:function JS(e,t,r){var i=e.read_shift(1)>>>5&3,n=e.read_shift(!r||r.biff>=8?4:2);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[i,0,n]}},36:{n:"PtgRef",f:function BS(e,t,r){var i=(96&e[e.l])>>5;return e.l+=1,[i,cg(e,0,r)]}},37:{n:"PtgArea",f:function ES(e,t,r){return[(96&e[e.l++])>>5,ag(e,0,r)]}},38:{n:"PtgMemArea",f:function r2(e,t,r){var i=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[i,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Lt},40:{n:"PtgMemNoMem",f:Lt},41:{n:"PtgMemFunc",f:function i2(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function s2(e,t,r){var i=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[i]}},43:{n:"PtgAreaErr",f:function RS(e,t,r){var i=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[i]}},44:{n:"PtgRefN",f:function NS(e,t,r){var i=(96&e[e.l])>>5;e.l+=1;var s=function yS(e,t,r){var i=r&&r.biff?r.biff:8;if(i>=2&&i<=5)return function bS(e){var t=e.read_shift(2),r=e.read_shift(1),i=(32768&t)>>15,s=(16384&t)>>14;return t&=16383,1==i&&t>=8192&&(t-=16384),1==s&&r>=128&&(r-=256),{r:t,c:r,cRel:s,rRel:i}}(e);var s=e.read_shift(i>=12?4:2),n=e.read_shift(2),o=(16384&n)>>14,a=(32768&n)>>15;if(n&=16383,1==a)for(;s>524287;)s-=1048576;if(1==o)for(;n>8191;)n-=16384;return{r:s,c:n,cRel:o,rRel:a}}(e,0,r);return[i,s]}},45:{n:"PtgAreaN",f:function TS(e,t,r){var i=(96&e[e.l++])>>5,s=function wS(e,t,r){if(r.biff<8)return lg(e);var i=e.read_shift(12==r.biff?4:2),s=e.read_shift(12==r.biff?4:2),n=_i(e,2),o=_i(e,2);return{s:{r:i,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,r);return[i,s]}},46:{n:"PtgMemAreaN",f:function b2(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function E2(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function e2(e,t,r){return 5==r.biff?function t2(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[t,r,i]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function GS(e,t,r){var i=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[i,s,cg(e,0,r)]}},59:{n:"PtgArea3d",f:function FS(e,t,r){var i=(96&e[e.l++])>>5,s=e.read_shift(2,"i");if(r&&5===r.biff)e.l+=12;return[i,s,ag(e,0,r)]}},60:{n:"PtgRefErr3d",f:function n2(e,t,r){var i=(96&e[e.l++])>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6}return e.l+=n,[i,s]}},61:{n:"PtgAreaErr3d",f:function kS(e,t,r){var i=(96&e[e.l++])>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return e.l+=n,[i,s]}},255:{}},R2={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},k2={1:{n:"PtgElfLel",f:hg},2:{n:"PtgElfRw",f:Bn},3:{n:"PtgElfCol",f:Bn},6:{n:"PtgElfRwV",f:Bn},7:{n:"PtgElfColV",f:Bn},10:{n:"PtgElfRadical",f:Bn},11:{n:"PtgElfRadicalS",f:Ol},13:{n:"PtgElfColS",f:Ol},15:{n:"PtgElfColSV",f:Ol},16:{n:"PtgElfRadicalLel",f:hg},25:{n:"PtgList",f:function w2(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2);return{ixti:t,coltype:3&r,rt:C2[r>>2&31],idx:i,c:s,C:n}}},29:{n:"PtgSxName",f:function x2(e){return e.l+=2,[e.read_shift(4)]}},255:{}},T2={0:{n:"PtgAttrNoop",f:function F2(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function LS(e,t,r){var i=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[i]}},2:{n:"PtgAttrIf",f:function MS(e,t,r){var i=255&e[e.l+1]?1:0;return e.l+=2,[i,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function AS(e,t,r){e.l+=2;for(var i=e.read_shift(r&&2==r.biff?1:2),s=[],n=0;n<=i;++n)s.push(e.read_shift(r&&2==r.biff?1:2));return s}},8:{n:"PtgAttrGoto",f:function PS(e,t,r){var i=255&e[e.l+1]?1:0;return e.l+=2,[i,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function WS(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:dg},33:{n:"PtgAttrBaxcel",f:dg},64:{n:"PtgAttrSpace",f:function _S(e){return e.read_shift(2),ug(e)}},65:{n:"PtgAttrSpaceSemi",f:function OS(e){return e.read_shift(2),ug(e)}},128:{n:"PtgAttrIfError",f:function IS(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Nn(e,t,r,i){if(i.biff<8)return Lt(e,t);for(var s=e.l+t,n=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=ZS(e,0,i),n.push(r[o][1]);break;case"PtgMemArea":r[o][2]=QS(e,0,i),n.push(r[o][2]);break;case"PtgExp":i&&12==i.biff&&(r[o][1][1]=e.read_shift(4),n.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return 0!=(t=s-e.l)&&n.push(Lt(e,t)),n}function D2(e){for(var t=[],r=0;r<e.length;++r){for(var i=e[r],s=[],n=0;n<i.length;++n){var o=i[n];s.push(o?2===o[0]?'"'+o[1].replace(/"/g,'""')+'"':o[1]:"")}t.push(s.join(","))}return t.join(";")}var A2={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!i)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[i[0]][0]){case 357:return s=-1==i[1]?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[i[0]][0];default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=-1==i[1]?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[i[0]][0][3]?(s=-1==i[1]?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function pg(e,t,r){var i=fg(e,t,r);return"#REF"==i?i:function P2(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(i,r)}function Gt(e,t,r,i,s){var l,c,d,g,n=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],u=0,h=0,p="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",w=0,C=e[0].length;w<C;++w){var v=e[0][w];switch(v[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=at(" ",e[0][f][1][1]);break;case 1:m=at("\r",e[0][f][1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}c+=m,f=-1}a.push(c+A2[v[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":d=Rn(v[1][1],o,s),a.push(kn(d,n));break;case"PtgRefN":d=r?Rn(v[1][1],r,s):v[1][1],a.push(kn(d,n));break;case"PtgRef3d":u=v[1][1],d=Rn(v[1][2],o,s),p=pg(i,u,s),a.push(p+"!"+kn(d,n));break;case"PtgFunc":case"PtgFuncVar":var M=v[1][0],O=v[1][1];M||(M=0);var y=0==(M&=127)?[]:a.slice(-M);a.length-=M,"User"===O&&(O=y.shift()),a.push(O+"("+y.join(",")+")");break;case"PtgBool":a.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":a.push(v[1]);break;case"PtgNum":a.push(String(v[1]));break;case"PtgStr":a.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":g=Wu(v[1][1],r?{s:r}:o,s),a.push(cl(g,s));break;case"PtgArea":g=Wu(v[1][1],o,s),a.push(cl(g,s));break;case"PtgArea3d":g=v[1][2],p=pg(i,u=v[1][1],s),a.push(p+"!"+cl(g,s));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgName":var L=(i.names||[])[(h=v[1][2])-1]||(i[0]||[])[h],_=L?L.Name:"SH33TJSNAME"+String(h);_&&"_xlfn."==_.slice(0,6)&&!s.xlfn&&(_=_.slice(6)),a.push(_);break;case"PtgNameX":var K,j=v[1][1];if(h=v[1][2],!(s.biff<=5)){var B="";if(14849==((i[j]||[])[0]||[])[0]||(1025==((i[j]||[])[0]||[])[0]?i[j][h]&&i[j][h].itab>0&&(B=i.SheetNames[i[j][h].itab-1]+"!"):B=i.SheetNames[h-1]+"!"),i[j]&&i[j][h])B+=i[j][h].Name;else if(i[0]&&i[0][h])B+=i[0][h].Name;else{var ae=(fg(i,j,s)||"").split(";;");ae[h-1]?B=ae[h-1]:B+="SH33TJSERRX"}a.push(B);break}j<0&&(j=-j),i[j]&&(K=i[j][h]),K||(K={Name:"SH33TJSERRY"}),a.push(K.Name);break;case"PtgParen":var me="(",ue=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:me=at(" ",e[0][f][1][1])+me;break;case 3:me=at("\r",e[0][f][1][1])+me;break;case 4:ue=at(" ",e[0][f][1][1])+ue;break;case 5:ue=at("\r",e[0][f][1][1])+ue;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}a.push(me+a.pop()+ue);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":a.push("#REF!");break;case"PtgExp":var ye={c:r.c,r:r.r};if(i.sharedf[be(d={c:v[1][1],r:v[1][0]})]){var Ce=i.sharedf[be(d)];a.push(Gt(Ce,0,ye,i,s))}else{var Oe=!1;for(l=0;l!=i.arrayf.length;++l)if(!(d.c<(c=i.arrayf[l])[0].s.c||d.c>c[0].e.c||d.r<c[0].s.r||d.r>c[0].e.r)){a.push(Gt(c[1],0,ye,i,s)),Oe=!0;break}Oe||a.push(v[1])}break;case"PtgArray":a.push("{"+D2(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=w;break;case"PtgMissArg":a.push("");break;case"PtgList":a.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=s.biff&&f>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][w][0])){var Ee=!0;switch((v=e[0][f])[1][0]){case 4:Ee=!1;case 0:m=at(" ",v[1][1]);break;case 5:Ee=!1;case 1:m=at("\r",v[1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}a.push((Ee?m:"")+a.pop()+(Ee?"":m)),f=-1}}if(a.length>1&&s.WTF)throw new Error("bad formula stack");return a[0]}function qo(e,t,r){var i=e.read_shift(4),s=function Gn(e,t,r){for(var s,n,i=e.l+t,o=[];i!=e.l;)t=i-e.l,s=gg[n=e[e.l]]||gg[R2[n]],(24===n||25===n)&&(s=(24===n?k2:T2)[e[e.l+1]]),s&&s.f?o.push([s.n,s.f(e,t,r)]):Lt(e,t);return o}(e,i,r),n=e.read_shift(4);return[s,n>0?Nn(e,n,s,r):null]}var G2=qo,Xo=qo,H2=qo,z2=qo,V2={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},W2={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function U2(e){return("of:="+e.replace(Ll,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function j2(e){return e.replace(/\./,"!")}var Hn=typeof Map<"u";function Gl(e,t,r){var i=0,s=e.length;if(r){if(Hn?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var n=Hn?r.get(t):r[t];i<n.length;++i)if(e[n[i]].t===t)return e.Count++,n[i]}else for(;i<s;++i)if(e[i].t===t)return e.Count++,i;return e[s]={t},e.Count++,e.Unique++,r&&(Hn?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Zo(e,t){var r={min:e+1,max:e+1},i=-1;return t.MDW&&(Nt=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?i=Ln(t.wpx):null!=t.wch&&(i=t.wch),i>-1?(r.width=jo(i),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function us(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function Oi(e,t,r){var i=r.revssf[null!=t.z?t.z:"General"],s=60,n=e.length;if(null==i&&r.ssf)for(;s<392;++s)if(null==r.ssf[s]){$r(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=i=s;break}for(s=0;s!=n;++s)if(e[s].numFmtId===i)return s;return e[n]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function K2(e,t,r){if(e&&e["!ref"]){var i=He(e["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var l3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],c3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function S3(e,t,r,i){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var s="",n=e.t,o=e.v;if("z"!==e.t)switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ui[e.v];break;case"d":i&&i.cellDates?s=st(e.v,-1).toISOString():((e=Xe(e)).t="n",s=""+(e.v=Et(st(e.v)))),typeof e.z>"u"&&(e.z=Se[14]);break;default:s=e.v}var a=Dt("v",Ke(s)),l={r:t},c=Oi(i.cellXfs,e,i);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){a=Dt("v",""+Gl(i.Strings,e.v,i.revStrings)),l.t="s";break}l.t="str"}if(e.t!=n&&(e.t=n,e.v=o),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=ie("f",Ke(e.f),d)+(null!=e.v?a:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ie("c",a,l)}function wg(e,t,r,i){var o,s=[lt,ie("worksheet",null,{xmlns:Pi[0],"xmlns:r":Ct.r})],a="",l=r.Sheets[r.SheetNames[e]];null==l&&(l={});var c=l["!ref"]||"A1",d=He(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=ke(d)}i||(i={}),l["!comments"]=[];var u=[];(function a3(e,t,r,i,s){var n=!1,o={},a=null;if("xlsx"!==i.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}n=!0,o.codeName=Yr(Ke(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+ie("outlinePr",null,c)}!n&&!a||(s[s.length]=ie("sheetPr",a,o))})(l,r,e,t,s),s[s.length]=ie("dimension",null,{ref:c}),s[s.length]=function x3(e,t,r,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),ie("sheetViews",ie("sheetView",null,s),{})}(0,0,0,r),t.sheetFormat&&(s[s.length]=ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function p3(e,t){for(var i,r=["<cols>"],s=0;s!=t.length;++s)(i=t[s])&&(r[r.length]=ie("col",null,Zo(s,i)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),s[o=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(a=function b3(e,t,r,i){var l,m,s=[],n=[],o=He(e["!ref"]),a="",c="",d=[],u=0,h=0,g=e["!rows"],p=Array.isArray(e),f={r:c},w=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Ze(h);for(u=o.s.r;u<=o.e.r;++u){for(n=[],c=ct(u),h=o.s.c;h<=o.e.c;++h){l=d[h]+c;var C=p?(e[u]||[])[h]:e[l];void 0!==C&&null!=(a=S3(C,l,e,t))&&n.push(a)}(n.length>0||g&&g[u])&&(f={r:c},g&&g[u]&&((m=g[u]).hidden&&(f.hidden=1),w=-1,m.hpx?w=_n(m.hpx):m.hpt&&(w=m.hpt),w>-1&&(f.ht=w,f.customHeight=1),m.level&&(f.outlineLevel=m.level)),s[s.length]=ie("row",n.join(""),f))}if(g)for(;u<g.length;++u)g&&g[u]&&(f={r:u+1},(m=g[u]).hidden&&(f.hidden=1),w=-1,m.hpx?w=_n(m.hpx):m.hpt&&(w=m.hpt),w>-1&&(f.ht=w,f.customHeight=1),m.level&&(f.outlineLevel=m.level),s[s.length]=ie("row","",f));return s.join("")}(l,t),a.length>0&&(s[s.length]=a)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),l["!protect"]&&(s[s.length]=function d3(e){var t={sheet:1};return l3.forEach(function(r){null!=e[r]&&e[r]&&(t[r]="1")}),c3.forEach(function(r){null!=e[r]&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Dl(e.password).toString(16).toUpperCase()),ie("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function v3(e,t,r,i){var s="string"==typeof e.ref?e.ref:ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,o=$t(s);o.s.r==o.e.r&&(o.e.r=$t(t["!ref"]).e.r,s=ke(o));for(var a=0;a<n.length;++a){var l=n[a];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==i){l.Ref="'"+r.SheetNames[i]+"'!"+s;break}}return a==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+s}),ie("autoFilter",null,{ref:s})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function n3(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ke(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var g,h=-1,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(f){f[1].Target&&(g={ref:f[0]},"#"!=f[1].Target.charAt(0)&&(p=Ue(i,-1,Ke(f[1].Target).replace(/#.*$/,""),Te.HLINK),g["r:id"]="rId"+p),(h=f[1].Target.indexOf("#"))>-1&&(g.location=Ke(f[1].Target.slice(h+1))),f[1].Tooltip&&(g.tooltip=Ke(f[1].Tooltip)),s[s.length]=ie("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=function g3(e){return us(e),ie("pageMargins",null,e)}(l["!margins"])),(!t||t.ignoreEC||null==t.ignoreEC)&&(s[s.length]=Dt("ignoredErrors",ie("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=Ue(i,-1,"../drawings/drawing"+(e+1)+".xml",Te.DRAW),s[s.length]=ie("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=u),l["!comments"].length>0&&(p=Ue(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Te.VML),s[s.length]=ie("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function R3(e,t,r,i){var s=function F3(e,t,r){var i=Y(145),s=(r["!rows"]||[])[e]||{};i.write_shift(4,e),i.write_shift(4,0);var n=320;s.hpx?n=20*_n(s.hpx):s.hpt&&(n=20*s.hpt),i.write_shift(2,n),i.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),i.write_shift(1,o),i.write_shift(1,0);var a=0,l=i.l;i.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,g=d<<10;g<d+1<<10;++g)c.c=g,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[be(c)])&&(u<0&&(u=g),h=g);u<0||(++a,i.write_shift(4,u),i.write_shift(4,h))}var f=i.l;return i.l=l,i.write_shift(4,a),i.l=f,i.length>i.l?i.slice(0,i.l):i}(i,r,t);(s.length>17||(t["!rows"]||[])[i])&&Z(e,0,s)}var k3=is,T3=Hs;var dy=is,uy=Hs,Sg=["left","right","top","bottom","header","footer"];function Ty(e,t,r,i,s,n,o){if(void 0===t.v)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":(t=Xe(t)).z=t.z||Se[14],t.v=Et(st(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v}var l={r,c:i};switch(l.s=Oi(s.cellXfs,t,s),t.l&&n["!links"].push([be(l),t.l]),t.c&&n["!comments"].push([be(l),t.c]),t.t){case"s":case"str":return s.bookSST?(a=Gl(s.Strings,t.v,s.revStrings),l.t="s",l.v=a,o?Z(e,18,function K3(e,t,r){return null==r&&(r=Y(8)),rs(t,r),r.write_shift(4,t.v),r}(0,l)):Z(e,7,function j3(e,t,r){return null==r&&(r=Y(12)),es(t,r),r.write_shift(4,t.v),r}(0,l))):(l.t="str",o?Z(e,17,function ny(e,t,r){return null==r&&(r=Y(8+4*e.v.length)),rs(t,r),Rt(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l)):Z(e,6,function iy(e,t,r){return null==r&&(r=Y(12+4*e.v.length)),es(t,r),Rt(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?o?Z(e,13,function ey(e,t,r){return null==r&&(r=Y(8)),rs(t,r),Ku(e.v,r),r}(t,l)):Z(e,2,function Z3(e,t,r){return null==r&&(r=Y(12)),es(t,r),Ku(e.v,r),r}(t,l)):o?Z(e,16,function X3(e,t,r){return null==r&&(r=Y(12)),rs(t,r),ss(e.v,r),r}(t,l)):Z(e,5,function q3(e,t,r){return null==r&&(r=Y(16)),es(t,r),ss(e.v,r),r}(t,l)),!0;case"b":return l.t="b",o?Z(e,15,function G3(e,t,r){return null==r&&(r=Y(5)),rs(t,r),r.write_shift(1,e.v?1:0),r}(t,l)):Z(e,4,function B3(e,t,r){return null==r&&(r=Y(9)),es(t,r),r.write_shift(1,e.v?1:0),r}(t,l)),!0;case"e":return l.t="e",o?Z(e,14,function W3(e,t,r){return null==r&&(r=Y(8)),rs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,l)):Z(e,3,function z3(e,t,r){return null==r&&(r=Y(9)),es(t,r),r.write_shift(1,e.v),r}(t,l)),!0}return o?Z(e,12,function _3(e,t,r){return null==r&&(r=Y(4)),rs(t,r)}(0,l)):Z(e,1,function I3(e,t,r){return null==r&&(r=Y(8)),es(t,r)}(0,l)),!0}function Ny(e,t,r,i){var s=jt(),n=r.SheetNames[e],o=r.Sheets[n]||{},a=n;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch{}var l=He(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Z(s,129),(r.vbaraw||o["!outline"])&&Z(s,147,function P3(e,t,r){null==r&&(r=Y(84+4*e.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),r.write_shift(1,i);for(var s=1;s<3;++s)r.write_shift(1,0);return _o({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$u(e,r),r.slice(0,r.l)}(a,o["!outline"])),Z(s,148,T3(l)),function Oy(e,t,r){Z(e,133),Z(e,137,function yy(e,t,r){null==r&&(r=Y(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),r.write_shift(2,i),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Z(e,138),Z(e,134)}(s,0,r.Workbook),function Py(e,t){!t||!t["!cols"]||(Z(e,390),t["!cols"].forEach(function(r,i){r&&Z(e,60,function Cy(e,t,r){null==r&&(r=Y(18));var i=Zo(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(i.width||10)),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),"number"==typeof i.width&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}(i,r))}),Z(e,391))}(s,o),function Dy(e,t,r,i){var s=He(t["!ref"]||"A1"),o="",a=[];Z(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=c;++d){o=ct(d),R3(e,t,s,d);var u=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(a[h]=Ze(h));var g=l?(t[d]||[])[h]:t[a[h]+o];u=!!g&&Ty(e,g,d,h,i,t,u)}}Z(e,146)}(s,o,0,t),function By(e,t){t["!protect"]&&Z(e,535,function Ey(e,t){return null==t&&(t=Y(66)),t.write_shift(2,e.password?Dl(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){t.write_shift(4,r[1]?null==e[r[0]]||e[r[0]]?0:1:null!=e[r[0]]&&e[r[0]]?0:1)}),t}(t["!protect"]))}(s,o),function _y(e,t,r,i){if(t["!autofilter"]){var s=t["!autofilter"],n="string"==typeof s.ref?s.ref:ke(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=$t(n);a.s.r==a.e.r&&(a.e.r=$t(t["!ref"]).e.r,n=ke(a));for(var l=0;l<o.length;++l){var c=o[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==i){c.Ref="'"+r.SheetNames[i]+"'!"+n;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+n}),Z(e,161,Hs(He(n))),Z(e,162)}}(s,o,r,e),function Ay(e,t){!t||!t["!merges"]||(Z(e,177,function hy(e,t){return null==t&&(t=Y(4)),t.write_shift(4,e),t}(t["!merges"].length)),t["!merges"].forEach(function(r){Z(e,176,uy(r))}),Z(e,178))}(s,o),function Iy(e,t,r){t["!links"].forEach(function(i){if(i[1].Target){var s=Ue(r,-1,i[1].Target.replace(/#.*$/,""),Te.HLINK);Z(e,494,function fy(e,t){var r=Y(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Hs({s:ut(e[0]),e:ut(e[0])},r),pl("rId"+t,r);var i=e[1].Target.indexOf("#");return Rt((-1==i?"":e[1].Target.slice(i+1))||"",r),Rt(e[1].Tooltip||"",r),Rt("",r),r.slice(0,r.l)}(i,s))}}),delete t["!links"]}(s,o,i),o["!margins"]&&Z(s,476,function xy(e,t){return null==t&&(t=Y(48)),us(e),Sg.forEach(function(r){ss(e[r],t)}),t}(o["!margins"])),(!t||t.ignoreEC||null==t.ignoreEC)&&function My(e,t){!t||!t["!ref"]||(Z(e,648),Z(e,649,function by(e){var t=Y(24);return t.write_shift(4,4),t.write_shift(4,1),Hs(e,t),t}(He(t["!ref"]))),Z(e,650))}(s,o),function Ly(e,t,r,i){if(t["!comments"].length>0){var s=Ue(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Te.VML);Z(e,551,pl("rId"+s)),t["!legacy"]=s}}(s,o,e,i),Z(s,130),s.end()}var zl=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Xy="][*?/\\".split("");function Fg(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Xy.forEach(function(i){if(-1!=e.indexOf(i)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function kg(e){var t=[lt];t[t.length]=ie("workbook",null,{xmlns:Pi[0],"xmlns:r":Ct.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(zl.forEach(function(a){null!=e.Workbook.WBProps[a[0]]&&e.Workbook.WBProps[a[0]]!=a[1]&&(i[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(i.codeName=e.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=ie("workbookPr",null,i);var s=e.Workbook&&e.Workbook.Sheets||[],n=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&s[n]&&s[n].Hidden;++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var o={name:Ke(e.SheetNames[n].slice(0,31))};if(o.sheetId=""+(n+1),o["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden"}t[t.length]=ie("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),null!=a.Sheet&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=ie("definedName",Ke(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function tb(e,t){return t||(t=Y(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),pl(e.strRelID,t),Rt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ub(e,t){var r=jt();return Z(r,131),Z(r,128,function lb(e,t){t||(t=Y(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return Rt("SheetJS",t),Rt(gn.version,t),Rt(gn.version,t),Rt("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Z(r,153,function ib(e,t){t||(t=Y(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),$u(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),function db(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,i=0,s=-1,n=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&-1==s?s=i:1==r[i].Hidden&&-1==n&&(n=i);n>s||(Z(e,135),Z(e,158,function cb(e,t){return t||(t=Y(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}(s)),Z(e,136))}}(r,e),function ab(e,t){Z(e,143);for(var r=0;r!=t.SheetNames.length;++r)Z(e,156,tb({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Z(e,144)}(r,e),Z(r,132),r.end()}function Fb(e,t,r,i,s){return(".bin"===t.slice(-4)?Ny:wg)(e,r,i,s)}function Tb(e,t,r){return(".bin"===t.slice(-4)?dS:sg)(e,r)}function Ag(e){return ie("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_l(e.Ref,{r:0,c:0})})}function Ub(e,t,r,i,s,n,o){if(!e||null==e.v&&null==e.f)return"";var a={};if(e.f&&(a["ss:Formula"]="="+Ke(_l(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=ut(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=Ke(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=Ke(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=o.c||c[d].s.r!=o.r||(c[d].e.c>c[d].s.c&&(a["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(a["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=ui[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Se[14]);break;case"s":u="String",h=function hv(e){return(e+"").replace(Ja,function(r){return Za[r]}).replace(Su,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}(e.v||"")}var g=Oi(i.cellXfs,e,i);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var f="z"==e.t?"":'<Data ss:Type="'+u+'">'+(null!=e.v?h:"")+"</Data>";return(e.c||[]).length>0&&(f+=function Wb(e){return e.map(function(t){var r=function gv(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}(t.t||""),i=ie("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ie("Comment",i,{"ss:Author":t.a})}).join("")}(e.c)),ie("Cell",f,a)}function jb(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=$o(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Kb(e,t,r){var i=[],n=r.Sheets[r.SheetNames[e]],o=n?function zb(e,t,r,i){if(!e||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,n=[],o=0;o<s.length;++o){var a=s[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||n.push(Ag(a)))}return n.join("")}(n,0,e,r):"";return o.length>0&&i.push("<Names>"+o+"</Names>"),o=n?function $b(e,t,r,i){if(!e["!ref"])return"";var s=He(e["!ref"]),n=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(m,w){Li(m);var C=!!m.width,v=Zo(w,m),k={"ss:Index":w+1};C&&(k["ss:Width"]=In(v.width)),m.hidden&&(k["ss:Hidden"]="1"),a.push(ie("Column",null,k))});for(var l=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var d=[jb(c,(e["!rows"]||[])[c])],u=s.s.c;u<=s.e.c;++u){var h=!1;for(o=0;o!=n.length;++o)if(!(n[o].s.c>u||n[o].s.r>c||n[o].e.c<u||n[o].e.r<c)){(n[o].s.c!=u||n[o].s.r!=c)&&(h=!0);break}if(!h){var g={r:c,c:u},p=be(g);d.push(Ub(l?(e[c]||[])[u]:e[p],p,e,t,0,0,g))}}d.push("</Row>"),d.length>2&&a.push(d.join(""))}return a.join("")}(n,t):"",o.length>0&&i.push("<Table>"+o+"</Table>"),i.push(function Vb(e,t,r,i){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(ie("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(ie("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(ie("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[r])if(i.Workbook.Sheets[r].Hidden)s.push(ie("Visible",1==i.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&(!i.Workbook.Sheets[n]||i.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Dt("ProtectContents","True")),e["!protect"].objects&&s.push(Dt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Dt("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null!=e["!protect"].selectUnlockedCells&&!e["!protect"].selectUnlockedCells&&s.push(Dt("EnableSelection","UnlockedCells")):s.push(Dt("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),0==s.length?"":ie("WorksheetOptions",s.join(""),{xmlns:gr.x})}(n,0,e,r)),i.join("")}function Yb(e,t){t||(t={}),e.SSF||(e.SSF=Xe(Se)),e.SSF&&(_s(),xn(e.SSF),t.revssf=Do(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Oi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(function Bb(e,t){var r=[];return e.Props&&r.push(function hC(e,t){var r=[];return ot(bl).map(function(i){for(var s=0;s<hi.length;++s)if(hi[s][1]==i)return hi[s];for(s=0;s<os.length;++s)if(os[s][1]==i)return os[s];throw i}).forEach(function(i){if(null!=e[i[1]]){var s=t&&t.Props&&null!=t.Props[i[1]]?t.Props[i[1]]:e[i[1]];"date"===i[2]&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof s?s=String(s):!0===s||!1===s?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Dt(bl[i[1]]||i[1],s))}}),ie("DocumentProperties",r.join(""),{xmlns:gr.o})}(e.Props,t)),e.Custprops&&r.push(function gC(e,t){var r=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return e&&ot(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)){for(var o=0;o<hi.length;++o)if(n==hi[o][1])return;for(o=0;o<os.length;++o)if(n==os[o][1])return;for(o=0;o<r.length;++o)if(n==r[o])return;var a=e[n],l="string";"number"==typeof a?(l="float",a=String(a)):!0===a||!1===a?(l="boolean",a=a?"1":"0"):a=String(a),s.push(ie(xu(n),a,{"dt:dt":l}))}}),t&&ot(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var o=t[n],a="string";"number"==typeof o?(a="float",o=String(o)):!0===o||!1===o?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),s.push(ie(xu(n),o,{"dt:dt":a}))}}),"<"+i+' xmlns="'+gr.o+'">'+s.join("")+"</"+i+">"}(e.Props,e.Custprops)),r.join("")}(e,t)),r.push(""),r.push(""),r.push("");for(var i=0;i<e.SheetNames.length;++i)r.push(ie("Worksheet",Kb(i,t,e),{"ss:Name":Ke(e.SheetNames[i])}));return r[2]=function Gb(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,s){var n=[];n.push(ie("NumberFormat",null,{"ss:Format":Ke(Se[i.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(ie("Style",n.join(""),o))}),ie("Styles",r.join(""))}(0,t),r[3]=function Hb(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],i=0;i<t.length;++i){var s=t[i];null==s.Sheet&&(s.Name.match(/^_xlfn\./)||r.push(Ag(s)))}return ie("Names",r.join(""))}(e),lt+ie("Workbook",r.join(""),{xmlns:gr.ss,"xmlns:o":gr.o,"xmlns:x":gr.x,"xmlns:ss":gr.ss,"xmlns:dt":gr.dt,"xmlns:html":gr.html})}var Vn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};var Wn={0:{f:function E3(e,t){var r={},i=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=i,7&n&&(r.level=7&n),16&n&&(r.hidden=!0),32&n&&(r.hpt=s/20),r}},1:{f:function M3(e){return[Sr(e)]}},2:{f:function Q3(e){return[Sr(e),ml(e),"n"]}},3:{f:function H3(e){return[Sr(e),e.read_shift(1),"e"]}},4:{f:function O3(e){return[Sr(e),e.read_shift(1),"b"]}},5:{f:function Y3(e){return[Sr(e),Ot(e),"n"]}},6:{f:function ry(e){return[Sr(e),_t(e),"str"]}},7:{f:function U3(e){return[Sr(e),e.read_shift(4),"s"]}},8:{f:function cy(e,t,r){var i=e.l+t,s=Sr(e);s.r=r["!row"];var o=[s,_t(e),"str"];if(r.cellFormula){e.l+=2;var a=Xo(e,i-e.l,r);o[3]=Gt(a,0,s,r.supbooks,r)}else e.l=i;return o}},9:{f:function ly(e,t,r){var i=e.l+t,s=Sr(e);s.r=r["!row"];var o=[s,Ot(e),"n"];if(r.cellFormula){e.l+=2;var a=Xo(e,i-e.l,r);o[3]=Gt(a,0,s,r.supbooks,r)}else e.l=i;return o}},10:{f:function oy(e,t,r){var i=e.l+t,s=Sr(e);s.r=r["!row"];var o=[s,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var a=Xo(e,i-e.l,r);o[3]=Gt(a,0,s,r.supbooks,r)}else e.l=i;return o}},11:{f:function ay(e,t,r){var i=e.l+t,s=Sr(e);s.r=r["!row"];var o=[s,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var a=Xo(e,i-e.l,r);o[3]=Gt(a,0,s,r.supbooks,r)}else e.l=i;return o}},12:{f:function L3(e){return[ts(e)]}},13:{f:function J3(e){return[ts(e),ml(e),"n"]}},14:{f:function V3(e){return[ts(e),e.read_shift(1),"e"]}},15:{f:function N3(e){return[ts(e),e.read_shift(1),"b"]}},16:{f:function xg(e){return[ts(e),Ot(e),"n"]}},17:{f:function sy(e){return[ts(e),_t(e),"str"]}},18:{f:function $3(e){return[ts(e),e.read_shift(4),"s"]}},19:{f:hl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function nb(e,t,r){var i=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=Gv(e),o=H2(e,0,r),a=gl(e);e.l=i;var l={Name:n,Ptg:o};return s<268435455&&(l.Sheet=s),a&&(l.Comment=a),l}},40:{},42:{},43:{f:function rx(e,t,r){var i={};i.sz=e.read_shift(2)/20;var s=function Vv(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1),700===e.read_shift(2)&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(i.underline=o);var a=e.read_shift(1);a>0&&(i.family=a);var l=e.read_shift(1);switch(l>0&&(i.charset=l),e.l++,i.color=function zv(e){var t={},i=e.read_shift(1)>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,i){case 0:t.auto=1;break;case 1:t.index=s;var c=ns[s];c&&(t.rgb=Mn(c));break;case 2:t.rgb=Mn([o,a,l]);break;case 3:t.theme=s}return 0!=n&&(t.tint=n>0?n/32767:n/32768),t}(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor"}return i.name=_t(e),i}},44:{f:function ex(e,t){return[e.read_shift(2),_t(e)]}},45:{f:nx},46:{f:ax},47:{f:function ox(e,t){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:i,numFmtId:s}}},48:{},49:{f:function Mv(e){return e.read_shift(4,"i")}},50:{},51:{f:function zx(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:function Nh(e,t,r){if(!r.cellStyles)return Lt(e,t);var i=r&&r.biff>=12?4:2,s=e.read_shift(i),n=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(i),l=e.read_shift(2);2==i&&(e.l+=2);var c={s,e:n,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}},62:{f:function ty(e){return[Sr(e),hl(e),"is"]}},63:{f:function Xx(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=be(r);var i=e.read_shift(1);return 2&i&&(t.l="1"),8&i&&(t.a="1"),t}},64:{f:function Fy(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Lt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function Sy(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function A3(e,t){var r={},i=e[e.l];return++e.l,r.above=!(64&i),r.left=!(128&i),e.l+=18,r.name=Nv(e,t-19),r}},148:{f:k3,p:16},151:{f:function py(){}},152:{},153:{f:function rb(e,t){var r={},i=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?_t(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(65536&i),r.backupFile=!!(64&i),r.checkCompatibility=!!(4096&i),r.date1904=!!(1&i),r.filterPrivacy=!!(8&i),r.hidePivotFieldList=!!(1024&i),r.promptedSolutions=!!(16&i),r.publishItems=!!(2048&i),r.refreshAllConnections=!!(262144&i),r.saveExternalLinkValues=!!(128&i),r.showBorderUnselectedTables=!!(4&i),r.showInkAnnotation=!!(32&i),r.showObjects=["all","placeholders","none"][i>>13&3],r.showPivotChartFilter=!!(32768&i),r.updateLinks=["userSet","never","always"][i>>8&3],r}},154:{},155:{},156:{f:function eb(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=fl(e,t-8),r.name=_t(e),r}},157:{},158:{},159:{T:1,f:function y1(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:is},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function Gx(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_t(e)}}},336:{T:-1},337:{f:function Ux(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:function Oh(e,t,r){if(r.biff<8)return function kw(e,t,r){3==e[e.l+1]&&e[e.l]++;var i=An(e,0,r);return 3==i.charCodeAt(0)?i.slice(1):i}(e,0,r);for(var i=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);0!=n--;)i.push(_C(e,0,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function my(e,t,r){var i=e.l+t,s=Yu(e),n=e.read_shift(1),o=[s];if(o[2]=n,r.cellFormula){var a=G2(e,i-e.l,r);o[1]=a}else e.l=i;return o}},427:{f:function vy(e,t,r){var i=e.l+t,n=[is(e,16)];if(r.cellFormula){var o=z2(e,i-e.l,r);n[1]=o,e.l=i}else e.l=i;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function wy(e){var t={};return Sg.forEach(function(r){t[r]=Ot(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function D3(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function gy(e,t){var r=e.l+t,i=is(e,16),s=gl(e),n=_t(e),o=_t(e),a=_t(e);e.l=r;var l={rfx:i,relId:s,loc:n,display:a};return o&&(l.Tooltip=o),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aS},633:{T:1},634:{T:-1},635:{T:1,f:function nS(e){var t={};t.iauthor=e.read_shift(4);var r=is(e,16);return t.rfx=r.s,t.ref=be(r.s),e.l+=16,t}},636:{T:-1},637:{f:Ov},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function Wy(e,t){return e.l+=10,{name:_t(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function Ry(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function oe(e,t,r,i){var s=t;if(!isNaN(s)){var n=i||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,n),n>0&&ll(r)&&e.push(r)}}function Un(e,t,r){return e||(e=Y(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function nE(e,t,r,i){if(null!=t.v)switch(t.t){case"d":case"n":var s="d"==t.t?Et(st(t.v)):t.v;return void(s==(0|s)&&s>=0&&s<65536?oe(e,2,function o1(e,t,r){var i=Y(9);return Un(i,e,t),i.write_shift(2,r),i}(r,i,s)):oe(e,3,function s1(e,t,r){var i=Y(15);return Un(i,e,t),i.write_shift(8,r,"f"),i}(r,i,s)));case"b":case"e":return void oe(e,5,function iE(e,t,r,i){var s=Y(9);return Un(s,e,t),xh(r,i||"b",s),s}(r,i,t.v,t.t));case"s":case"str":return void oe(e,4,function sE(e,t,r){var i=Y(8+2*r.length);return Un(i,e,t),i.write_shift(1,r.length),i.write_shift(r.length,r,"sbcs"),i.l<i.length?i.slice(0,i.l):i}(r,i,(t.v||"").slice(0,255)))}oe(e,1,Un(null,r,i))}function fE(e,t,r,i,s){var n=16+Oi(s.cellXfs,t,s);if(null!=t.v||t.bf)if(t.bf)oe(e,6,function N2(e,t,r,i,s){var n=cs(t,r,s),o=function B2(e){if(null==e){var t=Y(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return ss("number"==typeof e?e:0)}(e.v),a=Y(6);a.write_shift(2,33),a.write_shift(4,0);for(var c=Y(e.bf.length),d=0;d<e.bf.length;++d)c[d]=e.bf[d];return bt([n,o,a,c])}(t,r,i,0,n));else switch(t.t){case"d":case"n":oe(e,515,function Ew(e,t,r,i){var s=Y(14);return cs(e,t,i,s),ss(r,s),s}(r,i,"d"==t.t?Et(st(t.v)):t.v,n));break;case"b":case"e":oe(e,517,function yw(e,t,r,i,s,n){var o=Y(8);return cs(e,t,i,o),xh(r,n,o),o}(r,i,t.v,n,0,t.t));break;case"s":case"str":s.bookSST?oe(e,253,function lw(e,t,r,i){var s=Y(10);return cs(e,t,i,s),s.write_shift(4,r),s}(r,i,Gl(s.Strings,t.v,s.revStrings),n)):oe(e,516,function dw(e,t,r,i,s){var n=!s||8==s.biff,o=Y(+n+8+(1+n)*r.length);return cs(e,t,i,o),o.write_shift(2,r.length),n&&o.write_shift(1,1),o.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),o}(r,i,(t.v||"").slice(0,255),n,s));break;default:oe(e,513,cs(r,i,n))}else oe(e,513,cs(r,i,n))}function pE(e,t,r){var d,i=jt(),s=r.SheetNames[e],n=r.Sheets[s]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(n),c=8==t.biff,u="",h=[],g=He(n["!ref"]||"A1"),p=c?65536:16384;if(g.e.c>255||g.e.r>=p){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,p-1)}oe(i,2057,kl(0,16,t)),oe(i,13,yr(1)),oe(i,12,yr(100)),oe(i,15,Kt(!0)),oe(i,17,Kt(!1)),oe(i,16,ss(.001)),oe(i,95,Kt(!0)),oe(i,42,Kt(!1)),oe(i,43,Kt(!1)),oe(i,130,yr(1)),oe(i,128,function Sw(e){var t=Y(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),oe(i,131,Kt(!1)),oe(i,132,Kt(!1)),c&&function gE(e,t){if(t){var r=0;t.forEach(function(i,s){++r<=256&&i&&oe(e,125,function Yw(e,t){var r=Y(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var i=0;return e.hidden&&(i|=1),r.write_shift(1,i),r.write_shift(1,i=e.level||0),r.write_shift(2,0),r}(Zo(s,i),s))})}}(i,n["!cols"]),oe(i,512,function fw(e,t){var r=8!=t.biff&&t.biff?2:4,i=Y(2*r+6);return i.write_shift(r,e.s.r),i.write_shift(r,e.e.r+1),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c+1),i.write_shift(2,0),i}(g,t)),c&&(n["!links"]=[]);for(var f=g.s.r;f<=g.e.r;++f){u=ct(f);for(var m=g.s.c;m<=g.e.c;++m){f===g.s.r&&(h[m]=Ze(m)),d=h[m]+u;var w=l?(n[f]||[])[m]:n[d];w&&(fE(i,w,f,m,t),c&&w.l&&n["!links"].push([d,w.l]))}}var C=a.CodeName||a.name||s;return c&&oe(i,574,function iw(e){var t=Y(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),c&&(n["!merges"]||[]).length&&oe(i,229,function Lw(e){var t=Y(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Rh(e[r],t);return t}(n["!merges"])),c&&function hE(e,t){for(var r=0;r<t["!links"].length;++r){var i=t["!links"][r];oe(e,440,Hw(i)),i[1].Tooltip&&oe(e,2048,Vw(i))}delete t["!links"]}(i,n),oe(i,442,Sh(C)),c&&function dE(e,t){var r=Y(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),oe(e,2151,r),(r=Y(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Rh(He(t["!ref"]||"A1"),r),r.write_shift(4,4),oe(e,2152,r)}(i,n),oe(i,10),i.end()}function mE(e,t,r){var i=jt(),s=(e||{}).Workbook||{},n=s.Sheets||[],o=s.WBProps||{},a=8==r.biff,l=5==r.biff;oe(i,2057,kl(0,5,r)),"xla"==r.bookType&&oe(i,135),oe(i,225,a?yr(1200):null),oe(i,193,function yC(e,t){t||(t=Y(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),l&&oe(i,191),l&&oe(i,192),oe(i,226),oe(i,92,function UC(e,t){var r=!t||8==t.biff,i=Y(r?112:54);for(i.write_shift(8==t.biff?2:1,7),r&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(r?0:536870912));i.l<i.length;)i.write_shift(1,r?0:32);return i}(0,r)),oe(i,66,yr(a?1200:1252)),a&&oe(i,353,yr(0)),a&&oe(i,448),oe(i,317,function Qw(e){for(var t=Y(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),a&&e.vbaraw&&oe(i,211),a&&e.vbaraw&&oe(i,442,Sh(o.CodeName||"ThisWorkbook")),oe(i,156,yr(17)),oe(i,25,Kt(!1)),oe(i,18,Kt(!1)),oe(i,19,yr(0)),a&&oe(i,431,Kt(!1)),a&&oe(i,444,yr(0)),oe(i,61,function tw(){var e=Y(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),oe(i,64,Kt(!1)),oe(i,141,yr(0)),oe(i,34,Kt("true"==function qy(e){return e.Workbook&&e.Workbook.WBProps&&function rt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}(e.Workbook.WBProps.date1904)?"true":"false"}(e))),oe(i,14,Kt(!0)),a&&oe(i,439,Kt(!1)),oe(i,218,yr(0)),function lE(e,t,r){oe(e,49,function ow(e,t){var r=e.name||"Arial",i=t&&5==t.biff,n=Y(i?15+r.length:16+2*r.length);return n.write_shift(2,20*(e.sz||12)),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le"),n}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}(i,0,r),function cE(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)null!=t[s]&&oe(e,1054,hw(s,t[s],r))})}(i,e.SSF,r),function uE(e,t){for(var r=0;r<16;++r)oe(e,224,Ph({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){oe(e,224,Ph(i,0,t))})}(i,r),a&&oe(i,352,Kt(!1));var d=i.end(),u=jt();a&&oe(u,140,function Uw(e){return e||(e=Y(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),a&&r.Strings&&function rE(e,t,r,i){var s=i||(r||[]).length||0;if(s<=8224)return oe(e,t,r,s);var n=t;if(!isNaN(n)){for(var o=r.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var d=e.next(4);for(d.write_shift(2,n),d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<s;){for((d=e.next(4)).write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}(u,252,function qC(e,t){var r=Y(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var i=[],s=0;s<e.length;++s)i[s]=RC(e[s]);var n=bt([r].concat(i));return n.parts=[r.length].concat(i.map(function(o){return o.length})),n}(r.Strings)),oe(u,10);var h=u.end(),g=jt(),p=0,f=0;for(f=0;f<e.SheetNames.length;++f)p+=(a?12:11)+(a?2:1)*e.SheetNames[f].length;var m=d.length+p+h.length;for(f=0;f<e.SheetNames.length;++f)oe(g,133,KC({pos:m,hs:(n[f]||{}).Hidden||0,dt:0,name:e.SheetNames[f]},r)),m+=t[f].length;var C=g.end();if(p!=C.length)throw new Error("BS8 "+p+" != "+C.length);var v=[];return d.length&&v.push(d),C.length&&v.push(C),h.length&&v.push(h),bt(v)}function Mg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var i=e.Sheets[e.SheetNames[r]];i&&i["!ref"]&&$t(i["!ref"]).e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var n=t||{};switch(n.biff||2){case 8:case 5:return function vE(e,t){var r=t||{},i=[];e&&!e.SSF&&(e.SSF=Xe(Se)),e&&e.SSF&&(_s(),xn(e.SSF),r.revssf=Do(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ql(r),r.cellXfs=[],Oi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)i[i.length]=pE(s,r,e);return i.unshift(mE(e,i,r)),bt(i)}(e,t);case 4:case 3:case 2:return function aE(e,t){var r=t||{};null!=nt&&null==r.dense&&(r.dense=nt);for(var i=jt(),s=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==r.sheet&&(s=n);if(0==s&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return oe(i,4==r.biff?1033:3==r.biff?521:9,kl(0,16,r)),function oE(e,t,r,i){var o,s=Array.isArray(t),n=He(t["!ref"]||"A1"),a="",l=[];if(n.e.c>255||n.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),o=ke(n)}for(var c=n.s.r;c<=n.e.r;++c){a=ct(c);for(var d=n.s.c;d<=n.e.c;++d){c===n.s.r&&(l[d]=Ze(d)),o=l[d]+a;var u=s?(t[c]||[])[d]:t[o];u&&nE(e,u,c,d)}}}(i,e.Sheets[e.SheetNames[s]],0,r),oe(i,10),i.end()}(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function Lg(e,t,r,i){for(var s=e["!merges"]||[],n=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>o||s[c].e.r<r||s[c].e.c<o)){if(s[c].s.r<r||s[c].s.c<o){a=-1;break}a=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(a<0)){var d=be({r,c:o}),u=i.dense?(e[r]||[])[o]:e[d],h=u&&null!=u.v&&(u.h||yu(u.w||(qr(u),u.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),i.editable?h='<span contenteditable="true">'+h+"</span>":u&&(g["data-t"]=u&&u.t||"z",null!=u.v&&(g["data-v"]=u.v),null!=u.z&&(g["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),g.id=(i.id||"sjs")+"-"+d,n.push(ie("td",h,g))}}return"<tr>"+n.join("")+"</tr>"}var _g='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Og="</body></html>";function Ng(e,t){var r=t||{},s=null!=r.footer?r.footer:Og,n=[null!=r.header?r.header:_g],o=$t(e["!ref"]);r.dense=Array.isArray(e),n.push(function Bg(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}(0,0,r));for(var a=o.s.r;a<=o.e.r;++a)n.push(Lg(e,o,a,r));return n.push("</table>"+s),n.join("")}function Gg(e,t,r){var i=r||{};null!=nt&&(i.dense=nt);var s=0,n=0;if(null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var o="string"==typeof i.origin?ut(i.origin):i.origin;s=o.r,n=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var d=$t(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==s&&(c.e.r=s=d.e.r+1)}var u=[],h=0,g=e["!rows"]||(e["!rows"]=[]),p=0,f=0,m=0,w=0,C=0,v=0;for(e["!cols"]||(e["!cols"]=[]);p<a.length&&f<l;++p){var k=a[p];if(zg(k)){if(i.display)continue;g[f]={hidden:!0}}var M=k.children;for(m=w=0;m<M.length;++m){var O=M[m];if(!i.display||!zg(O)){var y=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):Ru(O.innerHTML),L=O.getAttribute("data-z")||O.getAttribute("z");for(h=0;h<u.length;++h){var _=u[h];_.s.c==w+n&&_.s.r<f+s&&f+s<=_.e.r&&(w=_.e.c+1-n,h=-1)}v=+O.getAttribute("colspan")||1,((C=+O.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:f+s,c:w+n},e:{r:f+s+(C||1)-1,c:w+n+(v||1)-1}});var j={t:"s",v:y},K=O.getAttribute("data-t")||O.getAttribute("t")||"";null!=y&&(0==y.length?j.t=K||"z":i.raw||0==y.trim().length||"s"==K||("TRUE"===y?j={t:"b",v:!0}:"FALSE"===y?j={t:"b",v:!1}:isNaN(Br(y))?isNaN(Os(y).getDate())||(j={t:"d",v:st(y)},i.cellDates||(j={t:"n",v:Et(j.v)}),j.z=i.dateNF||Se[14]):j={t:"n",v:Br(y)})),void 0===j.z&&null!=L&&(j.z=L);var B="",ae=O.getElementsByTagName("A");if(ae&&ae.length)for(var me=0;me<ae.length&&(!ae[me].hasAttribute("href")||"#"==(B=ae[me].getAttribute("href")).charAt(0));++me);B&&"#"!=B.charAt(0)&&(j.l={Target:B}),i.dense?(e[f+s]||(e[f+s]=[]),e[f+s][w+n]=j):e[be({c:w+n,r:f+s})]=j,c.e.c<w+n&&(c.e.c=w+n),w+=v}}++f}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,f-1+s),e["!ref"]=ke(c),f>=l&&(e["!fullref"]=ke((c.e.r=a.length-p+f-1+s,c))),e}function Hg(e,t){return Gg((t||{}).dense?[]:{},e,t)}function zg(e){var t="",r=function xE(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var yE=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+bn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return lt+t}}(),$g=function(){var e=function(n){return Ke(n).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",i=function(n,o,a){var l=[];l.push('      <table:table table:name="'+Ke(o.SheetNames[a])+'" table:style-name="ta1">\n');var c=0,d=0,u=$t(n["!ref"]||"A1"),h=n["!merges"]||[],g=0,p=Array.isArray(n);if(n["!cols"])for(d=0;d<=u.e.c;++d)l.push("        <table:table-column"+(n["!cols"][d]?' table:style-name="co'+n["!cols"][d].ods+'"':"")+"></table:table-column>\n");var m=n["!rows"]||[];for(c=0;c<u.s.r;++c)l.push("        <table:table-row"+(m[c]?' table:style-name="ro'+m[c].ods+'"':"")+"></table:table-row>\n");for(;c<=u.e.r;++c){for(l.push("        <table:table-row"+(m[c]?' table:style-name="ro'+m[c].ods+'"':"")+">\n"),d=0;d<u.s.c;++d)l.push(t);for(;d<=u.e.c;++d){var w=!1,C={},v="";for(g=0;g!=h.length;++g)if(!(h[g].s.c>d||h[g].s.r>c||h[g].e.c<d||h[g].e.r<c)){(h[g].s.c!=d||h[g].s.r!=c)&&(w=!0),C["table:number-columns-spanned"]=h[g].e.c-h[g].s.c+1,C["table:number-rows-spanned"]=h[g].e.r-h[g].s.r+1;break}if(w)l.push("          <table:covered-table-cell/>\n");else{var k=be({r:c,c:d}),M=p?(n[c]||[])[d]:n[k];if(M&&M.f&&(C["table:formula"]=Ke(U2(M.f)),M.F&&M.F.slice(0,k.length)==k)){var O=$t(M.F);C["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,C["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(M){switch(M.t){case"b":v=M.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=M.v?"true":"false";break;case"n":v=M.w||String(M.v||0),C["office:value-type"]="float",C["office:value"]=M.v||0;break;case"s":case"str":v=null==M.v?"":M.v,C["office:value-type"]="string";break;case"d":v=M.w||st(M.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=st(M.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(t);continue}var y=e(v);if(M.l&&M.l.Target){var L=M.l.Target;"#"!=(L="#"==L.charAt(0)?"#"+j2(L.slice(1)):L).charAt(0)&&!L.match(/^\w+:/)&&(L="../"+L),y=ie("text:a",y,{"xlink:href":L.replace(/&/g,"&amp;")})}l.push("          "+ie("table:table-cell",ie("text:p",y,{}),C)+"\n")}else l.push(t)}}l.push("        </table:table-row>\n")}return l.push("      </table:table>\n"),l.join("")};return function(o,a){var l=[lt],c=bn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=bn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==a.bookType?(l.push("<office:document"+c+d+">\n"),l.push(th().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+">\n"),function(n,o){n.push(" <office:automatic-styles>\n"),n.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),n.push('   <number:month number:style="long"/>\n'),n.push("   <number:text>/</number:text>\n"),n.push('   <number:day number:style="long"/>\n'),n.push("   <number:text>/</number:text>\n"),n.push("   <number:year/>\n"),n.push("  </number:date-style>\n");var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"])for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var u=c["!cols"][d];if(null==u.width&&null==u.wpx&&null==u.wch)continue;Li(u),u.ods=a;var h=c["!cols"][d].wpx+"px";n.push('  <style:style style:name="co'+a+'" style:family="table-column">\n'),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+'"/>\n'),n.push("  </style:style>\n"),++a}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"])for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var u=c["!rows"][d].hpx+"px";n.push('  <style:style style:name="ro'+l+'" style:family="table-row">\n'),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+'"/>\n'),n.push("  </style:style>\n"),++l}}),n.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),n.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),n.push("  </style:style>\n"),n.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),n.push(" </office:automatic-styles>\n")}(l,o),l.push("  <office:body>\n"),l.push("    <office:spreadsheet>\n");for(var u=0;u!=o.SheetNames.length;++u)l.push(i(o.Sheets[o.SheetNames[u]],o,u));return l.push("    </office:spreadsheet>\n"),l.push("  </office:body>\n"),l.push("fods"==a.bookType?"</office:document>":"</office:document-content>"),l.join("")}}();function Kg(e,t){if("fods"==t.bookType)return $g(e,t);var r=Qa(),i="",s=[],n=[];return De(r,i="mimetype","application/vnd.oasis.opendocument.spreadsheet"),De(r,i="content.xml",$g(e,t)),s.push([i,"text/xml"]),n.push([i,"ContentFile"]),De(r,i="styles.xml",yE(e,t)),s.push([i,"text/xml"]),n.push([i,"StylesFile"]),De(r,i="meta.xml",lt+th()),s.push([i,"text/xml"]),n.push([i,"MetadataFile"]),De(r,i="manifest.rdf",function oC(e){var t=[lt];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(eh(e[r][0],e[r][1])),t.push(nC("",e[r][0]));return t.push(eh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(n)),s.push([i,"application/rdf+xml"]),De(r,i="META-INF/manifest.xml",function sC(e){var t=[lt];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(s)),r}function hs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bE(e){return typeof TextEncoder<"u"?(new TextEncoder).encode(e):dr(Yr(e))}function Bi(e){var t=e.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(t),i=0;return e.forEach(function(s){r.set(s,i),i+=s.length}),r}function jn(e,t){var r=t?t[0]:0,i=127&e[r];e:if(e[r++]>=128&&(i|=(127&e[r])<<7,e[r++]<128||(i|=(127&e[r])<<14,e[r++]<128)||(i|=(127&e[r])<<21,e[r++]<128)||(i+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)||(i+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)||(i+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),i}function je(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function dt(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128||(r|=(127&e[t])<<14,e[t++]<128)||(r|=(127&e[t])<<21,e[t++]<128))break e;r|=(127&e[t])<<28}return r}function Ve(e){for(var t=[],r=[0];r[0]<e.length;){var a,i=r[0],s=jn(e,r),n=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(n){case 0:for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0]);break;case 5:a=e.slice(r[0],r[0]+(o=4)),r[0]+=o;break;case 1:a=e.slice(r[0],r[0]+(o=8)),r[0]+=o;break;case 2:o=jn(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(i))}var c={data:a,type:n};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function Tt(e){var t=[];return e.forEach(function(r,i){r.forEach(function(s){s.data&&(t.push(je(8*i+s.type)),2==s.type&&t.push(je(s.data.length)),t.push(s.data))})}),Bi(t)}function br(e){for(var t,r=[],i=[0];i[0]<e.length;){var s=jn(e,i),n=Ve(e.slice(i[0],i[0]+s));i[0]+=s;var o={id:dt(n[1][0].data),messages:[]};n[2].forEach(function(a){var l=Ve(a.data),c=dt(l[3][0].data);o.messages.push({meta:l,data:e.slice(i[0],i[0]+c)}),i[0]+=c}),null!=(t=n[3])&&t[0]&&(o.merge=dt(n[3][0].data)>>>0>0),r.push(o)}return r}function $s(e){var t=[];return e.forEach(function(r){var i=[];i[1]=[{data:je(r.id),type:0}],i[2]=[],null!=r.merge&&(i[3]=[{data:je(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:je(o.data.length)}],i[2].push({data:Tt(o.meta),type:2})});var n=Tt(i);t.push(je(n.length)),t.push(n),s.forEach(function(o){return t.push(o)})}),Bi(t)}function kE(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],i=jn(t,r),s=[];r[0]<t.length;){var n=3&t[r[0]];if(0!=n){var l=0,c=0;if(1==n?(c=4+(t[r[0]]>>2&7),l=(224&t[r[0]++])<<3,l|=t[r[0]++]):(c=1+(t[r[0]++]>>2),2==n?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Bi(s)],0==l)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}else{var o=t[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[r[0]],a>1&&(o|=t[r[0]+1]<<8),a>2&&(o|=t[r[0]+2]<<16),a>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}s.push(t.slice(r[0],r[0]+o)),r[0]+=o}}var d=Bi(s);if(d.length!=i)throw new Error("Unexpected length: ".concat(d.length," != ").concat(i));return d}function Er(e){for(var t=[],r=0;r<e.length;){var i=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;t.push(kE(i,e.slice(r+=3,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Bi(t)}function Ks(e){for(var t=[],r=0;r<e.length;){var i=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var n=je(i),o=n.length;t.push(n),i<=60?(o++,t.push(new Uint8Array([i-1<<2]))):i<=256?(o+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(o+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(o+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(o+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(e.slice(r,r+i)),o+=i,s[0]=0,s[1]=255&o,s[2]=o>>8&255,s[3]=o>>16&255,r+=i}return Bi(t)}function Kl(e,t){var r=new Uint8Array(32),i=hs(r),s=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,function RE(e,t,r){var i=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,i-6176);e[t+15]|=i>>7,e[t+14]|=(127&i)<<1;for(var n=0;s>=1;++n,s/=256)e[t+n]=255&s;e[t+15]|=r>=0?0:128}(r,s,e.v),n|=1,s+=16;break;case"b":r[1]=6,i.setFloat64(s,e.v?1:0,!0),n|=2,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,i.setUint32(s,t.indexOf(e.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(8,n,!0),r.slice(0,s)}function Yl(e,t){var r=new Uint8Array(32),i=hs(r),s=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,i.setFloat64(s,e.v,!0),n|=32,s+=8;break;case"b":r[2]=6,i.setFloat64(s,e.v?1:0,!0),n|=32,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,i.setUint32(s,t.indexOf(e.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(4,n,!0),r.slice(0,s)}function Ht(e){return jn(Ve(e)[1][0].data)}function BE(e,t,r){var i,s,n,o;if(null==(i=e[6])||!i[0]||null==(s=e[7])||!s[0])throw"Mutation only works on post-BNC storages!";if((null==(o=null==(n=e[8])?void 0:n[0])?void 0:o.data)&&dt(e[8][0].data)>0)throw"Math only works with normal offsets";for(var l=0,c=hs(e[7][0].data),d=0,u=[],h=hs(e[4][0].data),g=0,p=[],f=0;f<t.length;++f)if(null!=t[f]){var m,w;switch(c.setUint16(2*f,d,!0),h.setUint16(2*f,g,!0),typeof t[f]){case"string":m=Kl({t:"s",v:t[f]},r),w=Yl({t:"s",v:t[f]},r);break;case"number":m=Kl({t:"n",v:t[f]},r),w=Yl({t:"n",v:t[f]},r);break;case"boolean":m=Kl({t:"b",v:t[f]},r),w=Yl({t:"b",v:t[f]},r);break;default:throw new Error("Unsupported value "+t[f])}u.push(m),d+=m.length,p.push(w),g+=w.length,++l}else c.setUint16(2*f,65535,!0),h.setUint16(2*f,65535);for(e[2][0].data=je(l);f<e[7][0].data.length/2;++f)c.setUint16(2*f,65535,!0),h.setUint16(2*f,65535,!0);return e[6][0].data=Bi(u),e[3][0].data=Bi(p),l}function Ql(e){!function Xg(e){return function(r){for(var i=0;i!=e.length;++i){var s=e[i];void 0===r[s[0]]&&(r[s[0]]=s[1]),"n"===s[2]&&(r[s[0]]=Number(r[s[0]]))}}}([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function UE(e,t){return"ods"==t.bookType?Kg(e,t):"numbers"==t.bookType?function NE(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=$t(r["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ke(i)));var n=ta(r,{range:i,header:1}),o=["~Sh33tJ5~"];n.forEach(function(I){return I.forEach(function(P){"string"==typeof P&&o.push(P)})});var a={},l=[],c=we.read(t.numbers,{type:"base64"});c.FileIndex.map(function(I,P){return[I,c.FullPaths[P]]}).forEach(function(I){var P=I[0],Q=I[1];2==P.type&&P.name.match(/\.iwa/)&&br(Er(P.content)).forEach(function(J){l.push(J.id),a[J.id]={deps:[],location:Q,type:dt(J.messages[0].meta[1][0].data)}})}),l.sort(function(I,P){return I-P});var d=l.filter(function(I){return I>1}).map(function(I){return[I,je(I)]});c.FileIndex.map(function(I,P){return[I,c.FullPaths[P]]}).forEach(function(I){var P=I[0];P.name.match(/\.iwa/)&&br(Er(P.content)).forEach(function(se){se.messages.forEach(function(ne){d.forEach(function(J){se.messages.some(function(Ae){return 11006!=dt(Ae.meta[1][0].data)&&function EE(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var i=0;i<t.length;++i)if(e[r+i]!=t[i])continue e;return!0}return!1}(Ae.data,J[1])})&&a[J[0]].deps.push(se.id)})})})});for(var p,h=we.find(c,a[1].location),g=br(Er(h.content)),f=0;f<g.length;++f){var m=g[f];1==m.id&&(p=m)}var w=Ht(Ve(p.messages[0].data)[1][0].data);for(g=br(Er((h=we.find(c,a[w].location)).content)),f=0;f<g.length;++f)(m=g[f]).id==w&&(p=m);for(w=Ht(Ve(p.messages[0].data)[2][0].data),g=br(Er((h=we.find(c,a[w].location)).content)),f=0;f<g.length;++f)(m=g[f]).id==w&&(p=m);for(w=Ht(Ve(p.messages[0].data)[2][0].data),g=br(Er((h=we.find(c,a[w].location)).content)),f=0;f<g.length;++f)(m=g[f]).id==w&&(p=m);var C=Ve(p.messages[0].data);C[6][0].data=je(i.e.r+1),C[7][0].data=je(i.e.c+1);for(var v=Ht(C[46][0].data),k=we.find(c,a[v].location),M=br(Er(k.content)),O=0;O<M.length&&M[O].id!=v;++O);if(M[O].id!=v)throw"Bad ColumnRowUIDMapArchive";var y=Ve(M[O].messages[0].data);y[1]=[],y[2]=[],y[3]=[];for(var L=0;L<=i.e.c;++L){var _=[];_[1]=_[2]=[{type:0,data:je(L+420690)}],y[1].push({type:2,data:Tt(_)}),y[2].push({type:0,data:je(L)}),y[3].push({type:0,data:je(L)})}y[4]=[],y[5]=[],y[6]=[];for(var j=0;j<=i.e.r;++j)(_=[])[1]=_[2]=[{type:0,data:je(j+726270)}],y[4].push({type:2,data:Tt(_)}),y[5].push({type:0,data:je(j)}),y[6].push({type:0,data:je(j)});M[O].messages[0].data=Tt(y),k.content=Ks($s(M)),k.size=k.content.length,delete C[46];var K=Ve(C[4][0].data);K[7][0].data=je(i.e.r+1);var ae=Ht(Ve(K[1][0].data)[2][0].data);if((M=br(Er((k=we.find(c,a[ae].location)).content)))[0].id!=ae)throw"Bad HeaderStorageBucket";var me=Ve(M[0].messages[0].data);for(j=0;j<n.length;++j){var ue=Ve(me[2][0].data);ue[1][0].data=je(j),ue[4][0].data=je(n[j].length),me[2][j]={type:me[2][0].type,data:Tt(ue)}}M[0].messages[0].data=Tt(me),k.content=Ks($s(M)),k.size=k.content.length;var ye=Ht(K[2][0].data);if((M=br(Er((k=we.find(c,a[ye].location)).content)))[0].id!=ye)throw"Bad HeaderStorageBucket";for(me=Ve(M[0].messages[0].data),L=0;L<=i.e.c;++L)(ue=Ve(me[2][0].data))[1][0].data=je(L),ue[4][0].data=je(i.e.r+1),me[2][L]={type:me[2][0].type,data:Tt(ue)};M[0].messages[0].data=Tt(me),k.content=Ks($s(M)),k.size=k.content.length;var Ce=Ht(K[4][0].data);!function(){for(var Q,I=we.find(c,a[Ce].location),P=br(Er(I.content)),ge=0;ge<P.length;++ge){var se=P[ge];se.id==Ce&&(Q=se)}var ne=Ve(Q.messages[0].data);ne[3]=[];var J=[];o.forEach(function(Ye,Be){J[1]=[{type:0,data:je(Be)}],J[2]=[{type:0,data:je(1)}],J[3]=[{type:2,data:bE(Ye)}],ne[3].push({type:2,data:Tt(J)})}),Q.messages[0].data=Tt(ne);var T=Ks($s(P));I.content=T,I.size=I.content.length}();var Oe=Ve(K[3][0].data),pe=Oe[1][0];delete Oe[2];var Ee=Ve(pe.data),ee=Ht(Ee[2][0].data);!function(){for(var Q,I=we.find(c,a[ee].location),P=br(Er(I.content)),ge=0;ge<P.length;++ge){var se=P[ge];se.id==ee&&(Q=se)}var ne=Ve(Q.messages[0].data);delete ne[6],delete Oe[7];var J=new Uint8Array(ne[5][0].data);ne[5]=[];for(var Ae=0,T=0;T<=i.e.r;++T){var Ye=Ve(J);Ae+=BE(Ye,n[T],o),Ye[1][0].data=je(T),ne[5].push({data:Tt(Ye),type:2})}ne[1]=[{type:0,data:je(i.e.c+1)}],ne[2]=[{type:0,data:je(i.e.r+1)}],ne[3]=[{type:0,data:je(Ae)}],ne[4]=[{type:0,data:je(i.e.r+1)}],Q.messages[0].data=Tt(ne);var qe=Ks($s(P));I.content=qe,I.size=I.content.length}(),pe.data=Tt(Ee),K[3][0].data=Tt(Oe),C[4][0].data=Tt(K),p.messages[0].data=Tt(C);var V=Ks($s(g));return h.content=V,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function jE(e,t){Ws=1024,e&&!e.SSF&&(e.SSF=Xe(Se)),e&&e.SSF&&(_s(),xn(e.SSF),t.revssf=Do(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hn?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",i=ng.indexOf(t.bookType)>-1,s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Ql(t=t||{});var n=Qa(),o="",a=0;if(t.cellXfs=[],Oi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),De(n,o="docProps/core.xml",ih(e.Props,t)),s.coreprops.push(o),Ue(t.rels,2,o,Te.CORE_PROPS),o="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,De(n,o,oh(e.Props)),s.extprops.push(o),Ue(t.rels,3,o,Te.EXT_PROPS),e.Custprops!==e.Props&&ot(e.Custprops||{}).length>0&&(De(n,o="docProps/custom.xml",ah(e.Custprops)),s.custprops.push(o),Ue(t.rels,4,o,Te.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var d={"!id":{}},u=e.Sheets[e.SheetNames[a-1]];if(De(n,o="xl/worksheets/sheet"+a+"."+r,Fb(a-1,o,t,e,d)),s.sheets.push(o),Ue(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Te.WS[0]),u){var g=u["!comments"],p=!1,f="";g&&g.length>0&&(De(n,f="xl/comments"+a+"."+r,Tb(g,f,t)),s.comments.push(f),Ue(d,-1,"../comments"+a+"."+r,Te.CMNT),p=!0),u["!legacy"]&&p&&De(n,"xl/drawings/vmlDrawing"+a+".vml",rg(a,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&De(n,Tn(o),zs(d))}return null!=t.Strings&&t.Strings.length>0&&(De(n,o="xl/sharedStrings."+r,function kb(e,t,r){return(".bin"===t.slice(-4)?R1:Wh)(e,r)}(t.Strings,o,t)),s.strs.push(o),Ue(t.wbrels,-1,"sharedStrings."+r,Te.SST)),De(n,o="xl/workbook."+r,function Eb(e,t,r){return(".bin"===t.slice(-4)?ub:kg)(e,r)}(e,o,t)),s.workbooks.push(o),Ue(t.rels,1,o,Te.WB),De(n,o="xl/theme/theme1.xml",Il(e.Themes,t)),s.themes.push(o),Ue(t.wbrels,-1,"theme/theme1.xml",Te.THEME),De(n,o="xl/styles."+r,function Rb(e,t,r){return(".bin"===t.slice(-4)?Sx:Qh)(e,r)}(e,o,t)),s.styles.push(o),Ue(t.wbrels,-1,"styles."+r,Te.STY),e.vbaraw&&i&&(De(n,o="xl/vbaProject.bin",e.vbaraw),s.vba.push(o),Ue(t.wbrels,-1,"vbaProject.bin",Te.VBA)),De(n,o="xl/metadata."+r,function Db(e){return(".bin"===e.slice(-4)?Kx:tg)()}(o)),s.metadata.push(o),Ue(t.wbrels,-1,"metadata."+r,Te.XLMETA),De(n,"[Content_Types].xml",Ju(s,t)),De(n,"_rels/.rels",zs(t.rels)),De(n,"xl/_rels/workbook."+r+".rels",zs(t.wbrels)),delete t.revssf,delete t.ssf,n}(e,t):function Qg(e,t){Ws=1024,e&&!e.SSF&&(e.SSF=Xe(Se)),e&&e.SSF&&(_s(),xn(e.SSF),t.revssf=Do(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hn?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",i=ng.indexOf(t.bookType)>-1,s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Ql(t=t||{});var n=Qa(),o="",a=0;if(t.cellXfs=[],Oi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),De(n,o="docProps/core.xml",ih(e.Props,t)),s.coreprops.push(o),Ue(t.rels,2,o,Te.CORE_PROPS),o="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,De(n,o,oh(e.Props)),s.extprops.push(o),Ue(t.rels,3,o,Te.EXT_PROPS),e.Custprops!==e.Props&&ot(e.Custprops||{}).length>0&&(De(n,o="docProps/custom.xml",ah(e.Custprops)),s.custprops.push(o),Ue(t.rels,4,o,Te.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},h=e.Sheets[e.SheetNames[a-1]];if(De(n,o="xl/worksheets/sheet"+a+"."+r,wg(a-1,t,e,u)),s.sheets.push(o),Ue(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Te.WS[0]),h){var p=h["!comments"],f=!1,m="";if(p&&p.length>0){var w=!1;p.forEach(function(C){C[1].forEach(function(v){1==v.T&&(w=!0)})}),w&&(De(n,m="xl/threadedComments/threadedComment"+a+"."+r,rS(p,d,t)),s.threadedcomments.push(m),Ue(u,-1,"../threadedComments/threadedComment"+a+"."+r,Te.TCMNT)),De(n,m="xl/comments"+a+"."+r,sg(p)),s.comments.push(m),Ue(u,-1,"../comments"+a+"."+r,Te.CMNT),f=!0}h["!legacy"]&&f&&De(n,"xl/drawings/vmlDrawing"+a+".vml",rg(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&De(n,Tn(o),zs(u))}return null!=t.Strings&&t.Strings.length>0&&(De(n,o="xl/sharedStrings."+r,Wh(t.Strings,t)),s.strs.push(o),Ue(t.wbrels,-1,"sharedStrings."+r,Te.SST)),De(n,o="xl/workbook."+r,kg(e)),s.workbooks.push(o),Ue(t.rels,1,o,Te.WB),De(n,o="xl/theme/theme1.xml",Il(e.Themes,t)),s.themes.push(o),Ue(t.wbrels,-1,"theme/theme1.xml",Te.THEME),De(n,o="xl/styles."+r,Qh(e,t)),s.styles.push(o),Ue(t.wbrels,-1,"styles."+r,Te.STY),e.vbaraw&&i&&(De(n,o="xl/vbaProject.bin",e.vbaraw),s.vba.push(o),Ue(t.wbrels,-1,"vbaProject.bin",Te.VBA)),De(n,o="xl/metadata."+r,tg()),s.metadata.push(o),Ue(t.wbrels,-1,"metadata."+r,Te.XLMETA),d.length>1&&(De(n,o="xl/persons/person.xml",function sS(e){var t=[lt,ie("personList",null,{xmlns:Ct.TCMNT,"xmlns:x":Pi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,i){t.push(ie("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),s.people.push(o),Ue(t.wbrels,-1,"persons/person.xml",Te.PEOPLE)),De(n,"[Content_Types].xml",Ju(s,t)),De(n,"_rels/.rels",zs(t.rels)),De(n,"xl/_rels/workbook.xml.rels",zs(t.wbrels)),delete t.revssf,delete t.ssf,n}(e,t)}function Jg(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Sn(t.file,we.write(e,{type:Pe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return we.write(e,t)}function Zr(e,t,r){r||(r="");var i=r+e;switch(t.type){case"base64":return mn(Yr(i));case"binary":return Yr(i);case"string":return e;case"file":return Sn(t.file,i,"utf8");case"buffer":return Pe?ai(i,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(i):Zr(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ea(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",i=0;i<e.length;++i)r+=String.fromCharCode(e[i]);return"base64"==t.type?mn(r):"string"==t.type?Qe(r):r;case"file":return Sn(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function tc(e,t){(function bo(){Cr(1200),function xm(){yo(1252)}()})(),function Rg(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");!function Qy(e,t,r){e.forEach(function(i,s){Fg(i);for(var n=0;n<s;++n)if(i==e[n])throw new Error("Duplicate Sheet Name: "+i);if(r){var o=t&&t[s]&&t[s].CodeName||i;if(95==o.charCodeAt(0)&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}(e.SheetNames,e.Workbook&&e.Workbook.Sheets||[],!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)K2(e.Sheets[e.SheetNames[r]],0,r)}(e);var r=Xe(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var i=tc(e,r);return r.type="array",vn(i)}var s=0;if(r.sheet&&(s="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Zr(Yb(e,r),r);case"slk":case"sylk":return Zr(Gh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Zr(Ng(e.Sheets[e.SheetNames[s]],r),r);case"txt":return function eF(e,t){switch(t.type){case"base64":return mn(e);case"binary":case"string":return e;case"file":return Sn(t.file,e,"binary");case"buffer":return Pe?ai(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(of(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Zr(ic(e.Sheets[e.SheetNames[s]],r),r,"\ufeff");case"dif":return Zr(Hh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return ea(Tl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Zr(Vs.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Zr(Yh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Zr(zh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Zr(Kg(e,r),r);case"wk1":return ea(ds.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return ea(ds.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ea(Mg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function JE(e,t){var r=t||{};return Jg(function tE(e,t){var r=t||{},i=we.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return we.utils.cfb_add(i,s,Mg(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function eE(e,t){var o,r=[],i=[],s=[],n=0,a=cu(Cl,"n"),l=cu(wl,"n");if(e.Props)for(o=ot(e.Props),n=0;n<o.length;++n)(Object.prototype.hasOwnProperty.call(a,o[n])?r:Object.prototype.hasOwnProperty.call(l,o[n])?i:s).push([o[n],e.Props[o[n]]]);if(e.Custprops)for(o=ot(e.Custprops),n=0;n<o.length;++n)Object.prototype.hasOwnProperty.call(e.Props||{},o[n])||(Object.prototype.hasOwnProperty.call(a,o[n])?r:Object.prototype.hasOwnProperty.call(l,o[n])?i:s).push([o[n],e.Custprops[o[n]]]);var c=[];for(n=0;n<s.length;++n)ph.indexOf(s[n][0])>-1||sh.indexOf(s[n][0])>-1||null!=s[n][1]&&c.push(s[n]);i.length&&we.utils.cfb_add(t,"/\x05SummaryInformation",Ch(i,Vn.SI,l,wl)),(r.length||c.length)&&we.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Ch(r,Vn.DSI,a,Cl,c.length?c:null,Vn.UDI))}(e,i),8==r.biff&&e.vbaraw&&function gS(e,t){t.FullPaths.forEach(function(r,i){if(0!=i){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==s.slice(-1)&&we.utils.cfb_add(e,s,t.FileIndex[i].content)}})}(i,we.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),i}(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function QE(e,t){var r=Xe(t||{});return function ef(e,t){var r={},i=Pe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=i;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?we.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&"string"==typeof s){if("binary"==t.type||"base64"==t.type)return s;s=new Uint8Array(vn(s))}return t.password&&typeof encrypt_agile<"u"?Jg(encrypt_agile(s,t.password),t):"file"===t.type?Sn(t.file,s):"string"==t.type?Qe(s):s}(UE(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rf(e,t,r,i,s,n,o,a){var l=ct(r),c=a.defval,d=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),u=!0,h=1===s?[]:{};if(1!==s)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var g=t.s.c;g<=t.e.c;++g){var p=o?e[r][g]:e[i[g]+l];if(void 0!==p&&void 0!==p.t){var f=p.v;switch(p.t){case"z":if(null==f)break;continue;case"e":f=0==f?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=n[g]){if(null==f)if("e"==p.t&&null===f)h[n[g]]=null;else if(void 0!==c)h[n[g]]=c;else{if(!d||null!==f)continue;h[n[g]]=null}else h[n[g]]=d&&("n"!==p.t||"n"===p.t&&!1!==a.rawNumbers)?f:qr(p,f,a);null!=f&&(u=!1)}}else{if(void 0===c)continue;null!=n[g]&&(h[n[g]]=c)}}return{row:h,isempty:u}}function ta(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},i=0,s=1,n=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?i=1:"A"===c.header?i=2:Array.isArray(c.header)?i=3:null==c.header&&(i=0),typeof d){case"string":l=He(d);break;case"number":(l=He(e["!ref"])).s.r=d;break;default:l=d}i>0&&(s=0);var u=ct(l.s.r),h=[],g=[],p=0,f=0,m=Array.isArray(e),w=l.s.r,C=0,v={};m&&!e[w]&&(e[w]=[]);var k=c.skipHidden&&e["!cols"]||[],M=c.skipHidden&&e["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(k[C]||{}).hidden)switch(h[C]=Ze(C),r=m?e[w][C]:e[h[C]+u],i){case 1:n[C]=C-l.s.c;break;case 2:n[C]=h[C];break;case 3:n[C]=c.header[C-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),a=o=qr(r,null,c),f=v[o]||0){do{a=o+"_"+f++}while(v[a]);v[o]=f,v[a]=1}else v[o]=1;n[C]=a}for(w=l.s.r+s;w<=l.e.r;++w)if(!(M[w]||{}).hidden){var O=rf(e,l,w,h,i,n,m,c);(!1===O.isempty||(1===i?!1!==c.blankrows:c.blankrows))&&(g[p++]=O.row)}return g.length=p,g}var sf=/"/g;function nf(e,t,r,i,s,n,o,a){for(var l=!0,c=[],d="",u=ct(r),h=t.s.c;h<=t.e.c;++h)if(i[h]){var g=a.dense?(e[r]||[])[h]:e[i[h]+u];if(null==g)d="";else if(null!=g.v){l=!1,d=""+(a.rawNumbers&&"n"==g.t?g.v:qr(g,null,a));for(var p=0,f=0;p!==d.length;++p)if((f=d.charCodeAt(p))===s||f===n||34===f||a.forceQuotes){d='"'+d.replace(sf,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==g.f||g.F?d="":(l=!1,(d="="+g.f).indexOf(",")>=0&&(d='"'+d.replace(sf,'""')+'"'));c.push(d)}return!1===a.blankrows&&l?null:c.join(o)}function ic(e,t){var r=[],i=t??{};if(null==e||null==e["!ref"])return"";var s=He(e["!ref"]),n=void 0!==i.FS?i.FS:",",o=n.charCodeAt(0),a=void 0!==i.RS?i.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==n?"\\|":n)+"+$"),d="",u=[];i.dense=Array.isArray(e);for(var h=i.skipHidden&&e["!cols"]||[],g=i.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(h[p]||{}).hidden||(u[p]=Ze(p));for(var f=0,m=s.s.r;m<=s.e.r;++m)(g[m]||{}).hidden||null!=(d=nf(e,s,m,u,o,l,n,i))&&(i.strip&&(d=d.replace(c,"")),(d||!1!==i.blankrows)&&r.push((f++?a:"")+d));return delete i.dense,r.join("")}function of(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=ic(e,t);if(typeof ze>"u"||"string"==t.type)return r;var i=ze.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+i}function af(e,t,r){var i=r||{},s=+!i.skipHeader,n=e||{},o=0,a=0;if(n&&null!=i.origin)if("number"==typeof i.origin)o=i.origin;else{var l="string"==typeof i.origin?ut(i.origin):i.origin;o=l.r,a=l.c}var c,d={s:{c:0,r:0},e:{c:a,r:o+t.length-1+s}};if(n["!ref"]){var u=He(n["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(d.e.r=(o=u.e.r+1)+t.length-1+s)}else-1==o&&(o=0,d.e.r=t.length-1+s);var h=i.header||[],g=0;t.forEach(function(f,m){ot(f).forEach(function(w){-1==(g=h.indexOf(w))&&(h[g=h.length]=w);var C=f[w],v="z",k="",M=be({c:a+g,r:o+m+s});c=$n(n,M),!C||"object"!=typeof C||C instanceof Date?("number"==typeof C?v="n":"boolean"==typeof C?v="b":"string"==typeof C?v="s":C instanceof Date?(v="d",i.cellDates||(v="n",C=Et(C)),k=i.dateNF||Se[14]):null===C&&i.nullError&&(v="e",C=0),c?(c.t=v,c.v=C,delete c.w,delete c.R,k&&(c.z=k)):n[M]=c={t:v,v:C},k&&(c.z=k)):n[M]=C})}),d.e.c=Math.max(d.e.c,a+h.length-1);var p=ct(o);if(s)for(g=0;g<h.length;++g)n[Ze(g+a)+p]={t:"s",v:h[g]};return n["!ref"]=ke(d),n}function $n(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var i=ut(t);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return $n(e,be("number"!=typeof t?t:{r:t,c:r||0}))}function lf(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var oc={encode_col:Ze,encode_row:ct,encode_cell:be,encode_range:ke,decode_col:ul,decode_row:dl,split_cell:function Pv(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ut,decode_range:$t,format_cell:qr,sheet_add_aoa:ju,sheet_add_json:af,sheet_add_dom:Gg,aoa_to_sheet:Gs,json_to_sheet:function iF(e,t){return af(null,e,t)},table_to_sheet:Hg,table_to_book:function wE(e,t){return Mi(Hg(e,t),t)},sheet_to_csv:ic,sheet_to_txt:of,sheet_to_json:ta,sheet_to_html:Ng,sheet_to_formulae:function rF(e){var r,t="",i="";if(null==e||null==e["!ref"])return[];var a,s=He(e["!ref"]),n="",o=[],l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=Ze(a);for(var d=s.s.r;d<=s.e.r;++d)for(n=ct(d),a=s.s.c;a<=s.e.c;++a)if(t=o[a]+n,i="",void 0!==(r=c?(e[d]||[])[a]:e[t])){if(null!=r.F){if(t=r.F,!r.f)continue;i=r.f,-1==t.indexOf(":")&&(t=t+":"+t)}if(null!=r.f)i=r.f;else{if("z"==r.t)continue;if("n"==r.t&&null!=r.v)i=""+r.v;else if("b"==r.t)i=r.v?"TRUE":"FALSE";else if(void 0!==r.w)i="'"+r.w;else{if(void 0===r.v)continue;i="s"==r.t?"'"+r.v:""+r.v}}l[l.length]=t+"="+i}return l},sheet_to_row_object_array:ta,sheet_get_cell:$n,book_new:function sc(){return{SheetNames:[],Sheets:{}}},book_append_sheet:function nc(e,t,r,i){var s=1;if(!r)for(;s<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+s);++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var o=n&&n[1]||r;for(++s;s<=65535&&-1!=e.SheetNames.indexOf(r=o+s);++s);}if(Fg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r},book_set_sheet_visibility:function nF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=function sF(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[i].Hidden=r},cell_set_number_format:function oF(e,t){return e.z=t,e},cell_set_hyperlink:lf,cell_set_internal_link:function aF(e,t,r){return lf(e,"#"+t,r)},cell_add_comment:function lF(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})},sheet_set_array_formula:function cF(e,t,r,i){for(var s="string"!=typeof t?t:He(t),n="string"==typeof t?t:ke(t),o=s.s.r;o<=s.e.r;++o)for(var a=s.s.c;a<=s.e.c;++a){var l=$n(e,o,a);l.t="n",l.F=n,delete l.v,o==s.s.r&&a==s.s.c&&(l.f=r,i&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},fF=ar(6554),Ys=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const i=t?this.allAsyncListeners:this.allSyncListeners;let s=i.get(e);return!s&&r&&(s=new Set,i.set(e,s)),s}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t,r=!1){this.getListeners(e,r,!0).add(t)}removeEventListener(e,t,r=!1){const i=this.getListeners(e,r,!1);i&&(i.delete(t),0===i.size&&(r?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const r=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const s=this.getListeners(r,t,!1)??new Set,n=new Set(s);n.size>0&&((a,l)=>{a.forEach(c=>{if(!l.has(c))return;const d=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>c(e)):()=>c(e);t?this.dispatchAsync(d):d()})})(n,s),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(a=>{const l=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>a(r,e)):()=>a(r,e);t?this.dispatchAsync(l):l()})}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}},cf=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(cf||{}),df={};function ac(e,t){df[t]||(e(),df[t]=!0)}function Rr(e,...t){console.log("AG Grid: "+e,...t)}function q(e,...t){ac(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function Me(e,...t){ac(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}function lc(e){return!!(e&&e.constructor&&e.call&&e.apply)}var cc=[],dc=!1;function uf(e){cc.push(e),!dc&&(dc=!0,window.setTimeout(()=>{const t=cc.slice();cc.length=0,dc=!1,t.forEach(r=>r())},0))}function Yt(e,t){let r;return function(...i){const s=this;window.clearTimeout(r),r=window.setTimeout(function(){e.apply(s,i)},t)}}function hf(e,t){let r=0;return function(...i){const n=(new Date).getTime();n-r<t||(r=n,e.apply(this,i))}}function fi(e){return null==e||""===e?null:e}function te(e,t=!1){return null!=e&&(""!==e||t)}function Ie(e){return!te(e)}function rr(e){return null==e||0===e.length}function uc(e){return null!=e&&"function"==typeof e.toString?e.toString():null}function gs(e){if(void 0===e)return;if(null===e||""===e)return null;if("number"==typeof e)return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function hc(e){if(void 0!==e)return null!==e&&""!==e&&gc(e)}function gc(e){return"boolean"==typeof e?e:"string"==typeof e&&("TRUE"===e.toUpperCase()||""==e)}function Kn(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function wF(e,t,r=!1){const i=null==e,s=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&s)return 0;if(i)return-1;if(s)return 1;function n(o,a){return o>a?1:o<a?-1:0}if("string"!=typeof e||!r)return n(e,t);try{return e.localeCompare(t)}catch{return n(e,t)}}function ia(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(r=>t.push(r)),t}return Object.values(e)}function gf(e,t){return e.get("rowModelType")===t}function it(e){return gf(e,"clientSide")}function pi(e){return gf(e,"serverSide")}function Pt(e,t){return e.get("domLayout")===t}function sa(e){return void 0!==ca(e)}function na(e){return!e.get("suppressAsyncEvents")}function ff(e){return"function"==typeof e.get("getRowHeight")}function Ni(e,t,r=!1,i){if(null==i&&(i=e.environment.getDefaultRowHeight()),ff(e)){if(r)return{height:i,estimated:!0};const o={node:t,data:t.data},a=e.getCallback("getRowHeight")(o);if(fc(a))return 0===a&&q("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,a),estimated:!1}}if(t.detail&&e.get("masterDetail"))return function SF(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return fc(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}(e);const s=e.get("rowHeight");return{height:s&&fc(s)?s:i,estimated:!1}}function fs(e){const{environment:t}=e,r=e.get("rowHeight");if(!r||Ie(r))return t.getDefaultRowHeight();const i=t.refreshRowHeightVariable();return-1!==i?i:(q("row height must be a number if not using standard row model"),t.getDefaultRowHeight())}function fc(e){return!isNaN(e)&&"number"==typeof e&&isFinite(e)}function Yn(e,t,r){const i=t[e.getDomDataKey()];return i?i[r]:void 0}function ps(e,t,r,i){const s=e.getDomDataKey();let n=t[s];Ie(n)&&(n={},t[s]=n),n[r]=i}function gt(e){let t=null;const r=e.get("getDocument");return r&&te(r)?t=r():e.eGridDiv&&(t=e.eGridDiv.ownerDocument),t&&te(t)?t:document}function pf(e){return gt(e).defaultView||window}function qn(e){return e.eGridDiv.getRootNode()}function Je(e){return qn(e).activeElement}function mf(e){const t=gt(e),r=Je(e);return null===r||r===t.body}function qs(e){return!e.get("ensureDomOrder")&&e.get("animateRows")}function oa(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||Pt(e,"print"))}function Jr(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function pc(e){const t=e.get("groupAggFiltering");return"function"==typeof t?e.getCallback("groupAggFiltering"):!0===t?()=>!0:void 0}function vf(e){return e.get("grandTotalRow")||(e.get("groupIncludeTotalFooter")?"bottom":void 0)}function Cf(e){const t=e.get("groupTotalRow");if("function"==typeof t)return e.getCallback("groupTotalRow");if(t)return()=>t;const r=e.get("groupIncludeFooter");if("function"==typeof r){const i=e.getCallback("groupIncludeFooter");return s=>i(s)?"bottom":void 0}return()=>r?"bottom":void 0}function wf(e){return e.exists("groupDisplayType")?"multipleColumns"===e.get("groupDisplayType"):e.get("groupHideOpenParents")}function aa(e,t){return!t&&"groupRows"===e.get("groupDisplayType")}function Xs(e){const t=e.getCallback("getRowId");return void 0===t?t:r=>{let i=t(r);return"string"!=typeof i&&(q("The getRowId callback must return a string. The ID ",i," is being cast to a string."),i=String(i)),i}}function Qs(e){return e?.checkboxes??!0}function la(e){return"multiRow"===e?.mode&&(e.headerCheckbox??!0)}function ei(e){const t=e.get("cellSelection");return void 0!==t?!!t:e.get("enableRangeSelection")}function xf(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!=typeof t&&"fill"===t.handle?.mode:e.get("enableFillHandle")}function Sf(e){const t=e.get("rowSelection")??"single";if("string"==typeof t){const r=e.get("suppressRowClickSelection"),i=e.get("suppressRowDeselection");return(!r||!i)&&(r?"enableDeselection":!i||"enableSelection")}return("singleRow"===t.mode||"multiRow"===t.mode)&&(t.enableClickSelection??!1)}function mc(e){const t=Sf(e);return!0===t||"enableDeselection"===t}function vc(e){const t=e.get("rowSelection");return"string"==typeof t?e.get("isRowSelectable"):t?.isRowSelectable}function ca(e){const t=e.get("rowSelection");if("string"==typeof t)switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}return t?.mode}function Cc(e){return"multiRow"===ca(e)}function wc(e){const t=e.get("rowSelection");if("string"==typeof t){const r=e.get("groupSelectsChildren"),i=e.get("groupSelectsFiltered");return r&&i?"filteredDescendants":r?"descendants":"self"}return"multiRow"===t?.mode?t.groupSelects:void 0}function ms(e){const t=wc(e);return"descendants"===t||"filteredDescendants"===t}function xc(e){return e.isModuleRegistered("@ag-grid-enterprise/set-filter")&&!e.get("suppressSetFilterByDefault")}function Le(e){if(e&&e.length)return e[e.length-1]}function mi(e,t,r){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every((i,s)=>r?r(i,t[s]):t[s]===i)}function yf(e,t){const r=e.indexOf(t);r>=0&&(e[r]=e[e.length-1],e.pop())}function qt(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function Xn(e,t,r){e.splice(r,0,t)}function bf(e,t,r){(function PF(e,t){for(let r=0;r<t.length;r++)qt(e,t[r])})(e,t),t.slice().reverse().forEach(i=>Xn(e,i,r))}function vs(e,t){return e.indexOf(t)>-1}function MF(e){return e?.flatMap(t=>t)??[]}function Ef(e,t){null==t||null==e||t.forEach(r=>e.push(r))}var Ff="__ag_Grid_Stop_Propagation",IF=["touchstart","touchend","touchmove","touchcancel","scroll"],Sc={};function Zs(e){e[Ff]=!0}function vi(e){return!0===e[Ff]}var Rf=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r=>{if("boolean"==typeof Sc[r])return Sc[r];const i=document.createElement(e[r]||"div");return Sc[r="on"+r]=r in i}})();function yc(e,t,r){let i=t;for(;i;){const s=Yn(e,i,r);if(s)return s;i=i.parentElement}return null}function LF(e,t){return!(!t||!e)&&function OF(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():function _F(e){const t=[];let r=e.target;for(;r;)t.push(r),r=r.parentElement;return t}(t)}(t).indexOf(e)>=0}var U=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.frameworkOverrides=e.frameworkOverrides,this.stubContext=e.context,this.eventService=e.eventService,this.gos=e.gos,this.localeService=e.localeService}getFrameworkOverrides(){return this.frameworkOverrides}destroy(){for(let e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,r){this.localEventService||(this.localEventService=new Ys),this.localEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.localEventService&&this.localEventService.removeEventListener(e,t,r)}dispatchLocalEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventService,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const i in t){const s=t[i];s&&r.push(this._setupListener(e,i,s))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;e instanceof HTMLElement?function BF(e,t,r,i){const n=vs(IF,r)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,r,i,n)}(this.getFrameworkOverrides(),e,t,r):e.addEventListener(t,r);const i=()=>(e.removeEventListener(t,r),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(s=>s!==i),null)}setupGridOptionListener(e,t){this.gos.addPropertyEventListener(e,t);const r=()=>(this.gos.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==r),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,i=s=>{if(s.changeSet){if(s.changeSet&&s.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=s.changeSet.id}t({type:"gridPropertyChanged",changeSet:s.changeSet,source:s.source})};e.forEach(s=>this.setupGridOptionListener(s,i))}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function Xt(e){return e instanceof da}var da=class extends U{constructor(e,t,r,i){super(),this.isColumn=!1,this.expandable=!1,this.instanceId=Df(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=r,this.level=i}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some(e=>e.isVisible())}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach(t=>{zi(t)?e.push(t):Xt(t)&&t.addLeafColumns(e)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(t=>t.addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(t=>t.removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const i=this.findChildrenRemovingPadding();for(let n=0,o=i.length;n<o;n++){const a=i[n];if(!a.isVisible())continue;const l=a.getColumnGroupShow();"open"===l?(e=!0,r=!0):"closed"===l?(t=!0,r=!0):(e=!0,t=!0)}const s=e&&t&&r;this.expandable!==s&&(this.expandable=s,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{r.forEach(i=>{Xt(i)&&i.isPadding()?t(i.children):e.push(i)})};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},kf="ag-Grid-ControlsColumn",NF=class extends U{constructor(){super(...arguments),this.beanName="controlsColService"}createControlsCols(){const e=this.gos.get("rowSelection");if(!e||"string"==typeof e)return[];const t=Qs(e),r=la(e);if(t||r){const i=this.gos.get("selectionColumnDef"),n={maxWidth:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:this.gos.get("enableRtl")?"right":"left",comparator(a,l,c,d){const u=c.isSelected(),h=d.isSelected();return u&&h?0:u?1:-1},editable:!1,suppressFillHandle:!0,...i,colId:`${kf}`},o=new Dc(n,null,n.colId,!1);return this.createBean(o),[o]}return[]}},ua="ag-Grid-AutoColumn";function bc(e){const t=[],r=i=>{for(let s=0;s<i.length;s++){const n=i[s];zi(n)?t.push(n):Xt(n)&&r(n.getChildren())}};return r(e),t}function Ci(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}function Gi(e,t,r){const i={};if(!t)return;wi(null,t,n=>{i[n.getInstanceId()]=n}),r&&wi(null,r,n=>{i[n.getInstanceId()]=null});const s=Object.values(i).filter(n=>null!=n);e.destroyBeans(s)}function Ec(e){return e.getId().startsWith(ua)}function Js(e){return e.getColId().startsWith(kf)}function ha(e){let t=[];return e instanceof Array?e.some(i=>"string"!=typeof i)?q("if colDef.type is supplied an array it should be of type 'string[]'"):t=e:"string"==typeof e?t=e.split(","):q("colDef.type should be of type 'string' | 'string[]'"),t}var Fc=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=r=>{this.frameworkOverrides.wrapOutgoing(()=>e(r))},this.wrappedListeners.set(e,t)),t}wrapGlobal(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=(r,i)=>{this.frameworkOverrides.wrapOutgoing(()=>e(r,i))},this.wrappedGlobalListeners.set(e,t)),t}unwrap(e){return this.wrappedListeners.get(e)??e}unwrapGlobal(e){return this.wrappedGlobalListeners.get(e)??e}},Rc=new Set(["__proto__","constructor","prototype"]);function kr(e,t){if(null!=e){if(Array.isArray(e)){for(let r=0;r<e.length;r++)t(r.toString(),e[r]);return}for(const[r,i]of Object.entries(e))t(r,i)}}function Tf(e){const t={},r=Object.keys(e);for(let i=0;i<r.length;i++){if(Rc.has(r[i]))continue;const s=r[i];t[s]=e[s]}return t}function kc(e,t){if(!e)return;const r=e,i={};return Object.keys(r).forEach(s=>{if(t&&t.indexOf(s)>=0||Rc.has(s))return;const n=r[s];i[s]=Tc(n)&&n.constructor===Object?kc(n):n}),i}function Hi(e){if(!e)return[];const t=Object;if("function"==typeof t.values)return t.values(e);const r=[];for(const i in e)e.hasOwnProperty(i)&&e.propertyIsEnumerable(i)&&r.push(e[i]);return r}function Qt(e,t,r=!0,i=!1){te(t)&&kr(t,(s,n)=>{if(Rc.has(s))return;let o=e[s];o!==n&&(i&&null==o&&null!=n&&"object"==typeof n&&n.constructor===Object&&(o={},e[s]=o),Tc(n)&&Tc(o)&&!Array.isArray(o)?Qt(o,n,r,i):(r||void 0!==n)&&(e[s]=n))})}function Qn(e,t,r){if(!t||!e)return;if(!r)return e[t];const i=t.split(".");let s=e;for(let n=0;n<i.length;n++){if(null==s)return;s=s[i[n]]}return s}function Tc(e){return"object"==typeof e&&null!==e}var GF={resizable:!0,sortable:!0},HF=0;function Df(){return HF++}function zi(e){return e instanceof Dc}var Dc=class extends U{constructor(e,t,r,i){super(),this.isColumn=!0,this.instanceId=Df(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.columnEventService=new Ys,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=i,this.setState(e)}wireBeans(e){this.columnHoverService=e.columnHoverService}getInstanceId(){return this.instanceId}setState(e){void 0!==e.sort?("asc"===e.sort||"desc"===e.sort)&&(this.sort=e.sort):("asc"===e.initialSort||"desc"===e.initialSort)&&(this.sort=e.initialSort);const t=e.sortIndex,r=e.initialSortIndex;void 0!==t?null!==t&&(this.sortIndex=t):null!==r&&(this.sortIndex=r);const i=e.hide;this.visible=void 0!==i?!i:!e.initialHide,this.setPinned(void 0!==e.pinned?e.pinned:e.initialPinned);const n=e.flex,o=e.initialFlex;void 0!==n?this.flex=n:void 0!==o&&(this.flex=o)}setColDef(e,t,r){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.columnEventService.dispatchEvent(this.createColumnEvent("colDefChanged",r))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}postConstruct(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const e=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=te(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=te(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.gos.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=te(this.colDef.tooltipField)||te(this.colDef.tooltipValueGetter)||te(this.colDef.tooltipComponent)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=gs(e.width),i=gs(e.initialWidth);return t=null!=r?r:null!=i?i:200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return!Ie(this.colDef)&&!Ie(this.colDef.showRowGroup)&&(!0===this.colDef.showRowGroup||this.colDef.showRowGroup===e)}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}addEventListener(e,t){this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.columnEventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new Fc(this.frameworkOverrides));const r=this.frameworkEventListenerService?.wrap(t)??t;this.columnEventService.addEventListener(e,r)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(t)??t;this.columnEventService.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"==typeof this.colDef.suppressNavigable){const t=this.createColumnFunctionCallbackParams(e);return(0,this.colDef.suppressNavigable)(t)}return!1}isCellEditable(e){if(e.group)if(this.gos.get("treeData")){if(!e.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1;return this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){const t=this.gos.get("rowSelection");if(t&&"string"!=typeof t){const r=Js(this)&&Qs(t);return this.isColumnFunc(e,r)}return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??GF[e]}isColumnFunc(e,t){return"boolean"==typeof t?t:"function"==typeof t&&t(this.createColumnFunctionCallbackParams(e))}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.columnEventService.dispatchEvent(this.createColumnEvent("headerHighlightChanged","uiColumnMoved")))}setMoving(e,t){this.moving=e,this.columnEventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return this.gos.addGridCommonParams({type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t){this.sort!==e&&(this.sort=e,this.columnEventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return Ie(this.sort)}isSorting(){return te(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setMenuVisible(e,t){this.menuVisible!==e&&(this.menuVisible=e,this.columnEventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.columnEventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t,r){this.filterActive!==e&&(this.filterActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const i=this.createColumnEvent("filterChanged",t);r&&Qt(i,r),this.columnEventService.dispatchEvent(i)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t){const r=!0===e;this.visible!==r&&(this.visible=r,this.columnEventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const e=this.getColDef();return!e.suppressSpanHeaderHeight&&!e.autoHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Ie(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(Ie(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t,r=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.columnEventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e){this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t){this.pivotActive!==e&&(this.pivotActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t){this.aggregationActive!==e&&(this.aggregationActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}dispatchStateUpdatedEvent(e){this.columnEventService.dispatchEvent({type:"columnStateUpdated",key:e})}},zF={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},WF=class extends U{constructor(){super(...arguments),this.beanName="columnFactory"}wireBeans(e){this.dataTypeService=e.dataTypeService}createColumnTree(e,t,r,i){const s=new class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=uc(e);let r=0;for(;;){let i;if(e?(i=e,0!==r&&(i+="_"+r)):t?(i=t,0!==r&&(i+="_"+r)):i=r,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);r++}}},{existingCols:n,existingGroups:o,existingColKeys:a}=this.extractExistingTreeData(r);s.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,n,s,o,i),c=this.findMaxDept(l,0),d=this.balanceColumnTree(l,0,c,s);return wi(null,d,(h,g)=>{Xt(h)&&h.setupExpandable(),h.setOriginalParent(g)}),{columnTree:d,treeDept:c}}extractExistingTreeData(e){const t=[],r=[],i=[];return e&&wi(null,e,s=>{if(Xt(s))r.push(s);else{const n=s;i.push(n.getId()),t.push(n)}}),{existingCols:t,existingGroups:r,existingColKeys:i}}balanceTreeForAutoCols(e,t){const r=[],i=this.findDepth(t);return e.forEach(s=>{let n=s;for(let o=i-1;o>=0;o--){const a=new da(null,`FAKE_PATH_${s.getId()}}_${o}`,!0,o);this.createBean(a),a.setChildren([n]),n.setOriginalParent(a),n=a}0===i&&s.setOriginalParent(null),r.push(n)}),[r,i]}findDepth(e){let t=0,r=e;for(;r&&r[0]&&Xt(r[0]);)t++,r=r[0].getChildren();return t}balanceColumnTree(e,t,r,i){const s=[];for(let n=0;n<e.length;n++){const o=e[n];if(Xt(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,r,i);a.setChildren(l),s.push(a)}else{let a,l;for(let c=r-1;c>=t;c--){const d=i.getUniqueKey(null,null),u=this.createMergedColGroupDef(null),h=new da(u,d,!0,t);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l){if(s.push(a),e.some(d=>Xt(d))){l.setChildren([o]);continue}l.setChildren(e);break}s.push(o)}}return s}findMaxDept(e,t){let r=t;for(let i=0;i<e.length;i++){const s=e[i];if(Xt(s)){const o=this.findMaxDept(s.getChildren(),t+1);r<o&&(r=o)}}return r}recursivelyCreateColumns(e,t,r,i,s,n,o){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const c=e[l];a[l]=this.isColumnGroup(c)?this.createColumnGroup(r,c,t,i,s,n,o):this.createColumn(r,c,i,s,o)}return a}createColumnGroup(e,t,r,i,s,n,o){const a=this.createMergedColGroupDef(t),l=s.getUniqueKey(a.groupId||null,null),c=new da(a,l,!1,r);this.createBean(c);const d=this.findExistingGroup(t,n);d&&n.splice(d.idx,1);const u=d?.group;u&&c.setExpanded(u.isExpanded());const h=this.recursivelyCreateColumns(a.children,r+1,e,i,s,n,o);return c.setChildren(h),c}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,r,i,s){const n=this.findExistingColumn(t,r);n&&r?.splice(n.idx,1);let o=n?.column;if(o){const a=this.addColumnDefaultAndTypes(t,o.getColId());o.setColDef(a,t,s),this.applyColumnState(o,a,s)}else{const a=i.getUniqueKey(t.colId,t.field),l=this.addColumnDefaultAndTypes(t,a);o=new Dc(l,t,a,e),this.createBean(o)}return this.dataTypeService?.addColumnListeners(o),o}applyColumnState(e,t,r){const i=gs(t.flex);if(void 0!==i&&e.setFlex(i),e.getFlex()<=0){const a=gs(t.width);if(null!=a)e.setActualWidth(a,r);else{const l=e.getActualWidth();e.setActualWidth(l,r)}}void 0!==t.sort&&e.setSort("asc"==t.sort||"desc"==t.sort?t.sort:void 0,r);const n=gs(t.sortIndex);void 0!==n&&e.setSortIndex(n);const o=hc(t.hide);void 0!==o&&e.setVisible(!o,r),void 0!==t.pinned&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let r=0;r<t.length;r++){const i=t[r].getUserProvidedColDef();if(i)if(null==e.colId){if(null==e.field){if(i===e)return{idx:r,column:t[r]}}else if(i.field===e.field)return{idx:r,column:t[r]}}else if(t[r].getId()===e.colId)return{idx:r,column:t[r]}}}findExistingGroup(e,t){if(null!=e.groupId)for(let i=0;i<t.length;i++){const s=t[i];if(s.getColGroupDef()&&s.getId()===e.groupId)return{idx:i,group:s}}}addColumnDefaultAndTypes(e,t){const r={};Qt(r,this.gos.get("defaultColDef"),!1,!0);const s=this.updateColDefAndGetColumnType(r,e,t);s&&this.assignColumnTypes(s,r),Qt(r,e,!1,!0);const n=this.gos.get("autoGroupColumnDef"),o=Jr(this.gos);return e.rowGroup&&n&&o&&Qt(r,{sort:n.sort,initialSort:n.initialSort},!1,!0),this.dataTypeService?.validateColDef(r),r}updateColDefAndGetColumnType(e,t,r){const i=this.dataTypeService?.updateColDefAndGetColumnType(e,t,r),s=t.type??i??e.type;return e.type=s,s?ha(s):void 0}assignColumnTypes(e,t){if(!e.length)return;const r=Object.assign({},zF);kr(this.gos.get("columnTypes")||{},(s,n)=>{s in r?q(`the column type '${s}' is a default column type and cannot be overridden.`):(n.type&&q("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),r[s]=n)}),e.forEach(s=>{const n=r[s.trim()];n?Qt(t,n,!1,!0):q("colDef.type '"+s+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return void 0!==e.children}};function wi(e,t,r){if(t)for(let i=0;i<t.length;i++){const s=t[i];Xt(s)&&wi(s,s.getChildren(),r),r(s,e)}}var UF=class extends U{constructor(){super(...arguments),this.beanName="columnModel",this.pivotMode=!1,this.autoHeightActiveAtLeastOnce=!1,this.ready=!1,this.changeEventsDispatching=!1,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}wireBeans(e){this.context=e.context,this.ctrlsService=e.ctrlsService,this.columnFactory=e.columnFactory,this.columnSizeService=e.columnSizeService,this.visibleColsService=e.visibleColsService,this.columnViewportService=e.columnViewportService,this.pivotResultColsService=e.pivotResultColsService,this.columnAnimationService=e.columnAnimationService,this.autoColService=e.autoColService,this.controlsColService=e.controlsColService,this.valueCache=e.valueCache,this.columnDefFactory=e.columnDefFactory,this.columnApplyStateService=e.columnApplyStateService,this.columnGroupStateService=e.columnGroupStateService,this.eventDispatcher=e.columnEventDispatcher,this.columnMoveService=e.columnMoveService,this.columnAutosizeService=e.columnAutosizeService,this.funcColsService=e.funcColsService,this.quickFilterService=e.quickFilterService,this.showRowGroupColsService=e.showRowGroupColsService,this.environment=e.environment}postConstruct(){const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],t=>this.refreshAll(Cs(t.source))),this.addManagedPropertyListener("rowSelection",t=>{this.onSelectionOptionsChanged(t.currentValue,t.previousValue,Cs(t.source))}),this.addManagedPropertyListener("autoGroupColumnDef",t=>this.onAutoGroupColumnDefChanged(Cs(t.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],t=>this.recreateColumnDefs(Cs(t.source))),this.addManagedPropertyListener("pivotMode",t=>this.setPivotMode(this.gos.get("pivotMode"),Cs(t.source))),this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}createColsFromColDefs(e){const t=this.colDefs?this.columnApplyStateService.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire();const r=this.colDefCols?.list,i=this.colDefCols?.tree,s=this.columnFactory.createColumnTree(this.colDefs,!0,i,e);Gi(this.context,this.colDefCols?.tree,s.columnTree);const n=s.columnTree,o=s.treeDept,a=bc(n),l={};a.forEach(c=>l[c.getId()]=c),this.colDefCols={tree:n,treeDepth:o,list:a,map:l},this.funcColsService.extractCols(e,r),this.ready=!0,this.refreshCols(!0),this.visibleColsService.refresh(e),this.columnViewportService.checkViewportColumns(),this.eventDispatcher.everythingChanged(e),t&&(this.changeEventsDispatching=!0,t(),this.changeEventsDispatching=!1),this.eventDispatcher.newColumnsLoaded(e),"gridInitializing"===e&&this.columnSizeService.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;const t=this.cols?.tree;this.saveColOrder(),this.selectCols(),this.createAutoCols(),this.addAutoCols(),this.createControlsCols(),this.addControlsCols();const r=function xF(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}(this.gos,this.showingPivotResult);(!e||r)&&this.restoreColOrder(),this.positionLockedCols(),this.showRowGroupColsService?.refresh(),this.quickFilterService?.refreshQuickFilterCols(),this.setColSpanActive(),this.setAutoHeightActive(),this.visibleColsService.clear(),this.columnViewportService.clear(),!mi(t,this.cols.tree)&&this.eventDispatcher.gridColumns()}selectCols(){const e=this.pivotResultColsService.getPivotResultCols();if(this.showingPivotResult=null!=e,e){const{map:t,list:r,tree:i,treeDepth:s}=e;this.cols={list:r.slice(),map:{...t},tree:i.slice(),treeDepth:s},e.list.some(o=>void 0!==this.cols?.map[o.getColId()])||(this.lastPivotOrder=null)}else{const{map:t,list:r,tree:i,treeDepth:s}=this.colDefCols;this.cols={list:r.slice(),map:{...t},tree:i.slice(),treeDepth:s}}}getColsToShow(){const e=this.isPivotMode()&&!this.isShowingPivotResult(),t=this.funcColsService.getValueColumns();return this.cols.list.filter(i=>{const s=Ec(i);if(e){const n=t&&vs(t,i);return s||n}return s||i.isVisible()})}addAutoCols(){null!=this.autoCols&&(this.cols.list=this.autoCols.list.concat(this.cols.list),this.cols.tree=this.autoCols.tree.concat(this.cols.tree),Af(this.cols))}createAutoCols(){const e=aa(this.gos,this.pivotMode),t=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),r=this.funcColsService.getRowGroupColumns(),n=()=>{this.autoCols&&(Gi(this.context,this.autoCols.tree),this.autoCols=null)};if(!(r.length>0||this.gos.get("treeData"))||t||e||!this.autoColService)return void n();const o=this.autoColService.createAutoCols(r)??[],a=function jF(e,t){return mi(e,t,(r,i)=>r.getColId()===i.getColId())}(o,this.autoCols?.list||null);if(a&&(this.autoCols?this.autoCols.treeDepth:-1)==this.cols.treeDepth)return;n();const[u,h]=this.columnFactory.balanceTreeForAutoCols(o,this.cols?.tree);this.autoCols={list:o,tree:u,treeDepth:h,map:{}};const g=p=>{if(!p)return null;const f=p.filter(m=>!Ec(m));return[...o,...f]};this.lastOrder=g(this.lastOrder),this.lastPivotOrder=g(this.lastPivotOrder)}createControlsCols(){Gi(this.context,this.controlsCols?.tree),this.controlsCols=null;const e=this.controlsColService?.createControlsCols()??[],[t,r]=this.columnFactory.balanceTreeForAutoCols(e,this.cols.tree);function i(s,n){const o=Js(s),a=Js(n);return o&&!a?-1:!o&&a?1:0}this.controlsCols={list:e,tree:t,treeDepth:r,map:{}},this.lastOrder?.sort(i),this.lastPivotOrder?.sort(i)}addControlsCols(){null!=this.controlsCols&&(this.cols.list=this.controlsCols.list.concat(this.cols.list),this.cols.tree=this.controlsCols.tree.concat(this.cols.tree),Af(this.cols))}refreshAll(e){this.isReady()&&(this.refreshCols(!1),this.visibleColsService.refresh(e))}setColsVisible(e,t=!1,r){this.columnApplyStateService.applyColumnState({state:e.map(i=>({colId:"string"==typeof i?i:i.getColId(),hide:!t}))},r)}setColsPinned(e,t,r){if(!this.cols||rr(e))return;if(Pt(this.gos,"print"))return void q("Changing the column pinning status is not allowed with domLayout='print'");let i;this.columnAnimationService.start(),i=!0===t||"left"===t?"left":"right"===t?"right":null;const s=[];e.forEach(n=>{if(!n)return;const o=this.getCol(n);o&&o.getPinned()!==i&&(o.setPinned(i),s.push(o))}),s.length&&(this.visibleColsService.refresh(r),this.eventDispatcher.columnPinned(s,r)),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,r){let i;i=Xt(e)?e.getId():e||"",this.columnGroupStateService.setColumnGroupState([{groupId:i,open:t}],r)}getProvidedColGroup(e){let t=null;return wi(null,this.cols?.tree,r=>{Xt(r)&&r.getId()===e&&(t=r)}),t}isColGroupLocked(e){const t=this.gos.get("groupLockGroupColumns");return!(!e.isRowGroupActive()||0===t)&&(-1===t||t>this.funcColsService.getRowGroupColumns().findIndex(s=>s.getColId()===e.getColId()))}isSuppressAutoCol(){return"custom"===this.gos.get("groupDisplayType")||"custom"===this.gos.get("treeDataDisplayType")}setAutoHeightActive(){this.autoHeightActive=this.cols.list.some(e=>e.isVisible()&&e.isAutoHeight()),this.autoHeightActive&&(this.autoHeightActiveAtLeastOnce=!0,it(this.gos)||pi(this.gos)||q("autoHeight columns only work with Client Side Row Model and Server Side Row Model."))}restoreColOrder(){const e=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!e)return;const t=new Map(e.map((l,c)=>[l,c]));if(!this.cols.list.some(l=>t.has(l)))return;const i=new Map(this.cols.list.map(l=>[l,!0])),s=e.filter(l=>i.has(l)),n=new Map(s.map(l=>[l,!0])),o=this.cols.list.filter(l=>!n.has(l)),a=s.slice();o.forEach(l=>{let c=l.getOriginalParent();if(!c)return void a.push(l);const d=[];for(;!d.length&&c;)c.getLeafColumns().forEach(p=>{const f=a.indexOf(p)>=0,m=d.indexOf(p)<0;f&&m&&d.push(p)}),c=c.getOriginalParent();if(!d.length)return void a.push(l);const u=d.map(g=>a.indexOf(g)),h=Math.max(...u);Xn(a,l,h+1)}),this.cols.list=a}sortColsLikeKeys(e){if(null==this.cols)return;let t=[];const r={};e.forEach(s=>{if(r[s])return;const n=this.cols.map[s];n&&(t.push(n),r[s]=!0)});let i=0;this.cols.list.forEach(s=>{const n=s.getColId();null==r[n]&&(n.startsWith(ua)?Xn(t,s,i++):t.push(s))}),t=this.columnMoveService.placeLockedColumns(t),this.columnMoveService.doesMovePassMarryChildren(t)?this.cols.list=t:q("Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}sortColsLikeCols(e){!e||e.length<=1||e.filter(r=>this.cols.list.indexOf(r)<0).length>0||e.sort((r,i)=>this.cols.list.indexOf(r)-this.cols.list.indexOf(i))}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const i=this.columnFactory.addColumnDefaultAndTypes(r,e.getColId());return e.setColDef(i,r,t),!0}queueResizeOperations(){this.shouldQueueResizeOperations=!0}isShouldQueueResizeOperations(){return this.shouldQueueResizeOperations}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}moveInCols(e,t,r){bf(this.cols?.list,e,t),this.visibleColsService.refresh(r)}positionLockedCols(){this.cols.list=this.columnMoveService.placeLockedColumns(this.cols.list)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list:this.lastOrder=this.cols?.list}getColumnDefs(){if(!this.colDefCols)return;const e=this.colDefCols.list.slice();this.showingPivotResult?e.sort((i,s)=>this.lastOrder.indexOf(i)-this.lastOrder.indexOf(s)):this.lastOrder&&e.sort((i,s)=>this.cols.list.indexOf(i)-this.cols.list.indexOf(s));const t=this.funcColsService.getRowGroupColumns(),r=this.funcColsService.getPivotColumns();return this.columnDefFactory.buildColumnDefs(e,t,r)}isShowingPivotResult(){return this.showingPivotResult}isChangeEventsDispatching(){return this.changeEventsDispatching}isColSpanActive(){return this.colSpanActive}isProvidedColGroupsPresent(){return this.colDefCols?.treeDepth>0}setColSpanActive(){this.colSpanActive=this.cols.list.some(e=>null!=e.getColDef().colSpan)}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}getHeaderRowCount(){return this.cols?this.cols.treeDepth+1:-1}isReady(){return this.ready}isPivotMode(){return this.pivotMode}setPivotMode(e,t){e===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode)||(this.pivotMode=e,this.ready&&(this.refreshCols(!1),this.visibleColsService.refresh(t),this.eventDispatcher.pivotModeChanged()))}isPivotSettingAllowed(e){return!e||!this.gos.get("treeData")||(q("Pivot mode not available with treeData."),!1)}isPivotActive(){const e=this.funcColsService.getPivotColumns();return this.pivotMode&&!rr(e)}recreateColumnDefs(e){this.cols&&(this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e),this.createColsFromColDefs(e))}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){Gi(this.context,this.colDefCols?.tree),Gi(this.context,this.autoCols?.tree),Gi(this.context,this.controlsCols?.tree),super.destroy()}getColTree(){return this.cols.tree}getColDefColTree(){return this.colDefCols.tree}getColDefCols(){return this.colDefCols?.list?this.colDefCols.list:null}getCols(){return this.cols?.list??[]}getAllCols(){const t=this.pivotResultColsService.getPivotResultCols()?.list;return[this.colDefCols?.list??[],this.autoCols?.list??[],this.controlsCols?.list??[],t??[]].flat()}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>null!=t):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return null==e?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(null==t)return null;const{map:r,list:i}=t;if("string"==typeof e&&r[e])return r[e];for(let s=0;s<i.length;s++)if(Pf(i[s],e))return i[s];return this.getAutoCol(e)}getAutoCol(e){return this.autoCols?.list.find(t=>Pf(t,e))??null}getAutoCols(){return this.autoCols?.list??null}setColHeaderHeight(e,t){e.setAutoHeaderHeight(t)&&(e.isColumn?this.eventDispatcher.headerHeight(e):this.eventDispatcher.groupHeaderHeight(e))}getGroupRowsHeight(){const e=[],t=this.ctrlsService.getHeaderRowContainerCtrls();for(const r of t){if(!r)continue;const i=r.getGroupRowCount()||0;for(let s=0;s<i;s++){const n=r.getGroupRowCtrlAtIndex(s),o=e[s];if(n){const a=this.getColumnGroupHeaderRowHeight(n);(null==o||a>o)&&(e[s]=a)}}}return e}getColumnGroupHeaderRowHeight(e){const t=this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight();let r=0;const i=e.getHeaderCtrls();for(const s of i){const n=s.getColumn();if(n.isAutoHeaderHeight()){const o=n.getAutoHeaderHeight();null!=o&&o>r&&(r=o)}}return Math.max(t,r)}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),r=this.visibleColsService.getAllCols().filter(i=>i.isAutoHeaderHeight()).map(i=>i.getAutoHeaderHeight()||0);return Math.max(e,...r)}getHeaderHeight(){return this.gos.get("headerHeight")??this.environment.getDefaultHeaderHeight()}getFloatingFiltersHeight(){return this.gos.get("floatingFiltersHeight")??this.getHeaderHeight()}getGroupHeaderHeight(){return this.gos.get("groupHeaderHeight")??this.getHeaderHeight()}getPivotHeaderHeight(){return this.gos.get("pivotHeaderHeight")??this.getHeaderHeight()}getPivotGroupHeaderHeight(){return this.gos.get("pivotGroupHeaderHeight")??this.getGroupHeaderHeight()}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if("fitCellContents"!==e?.type)return;const{colIds:t,skipHeader:r}=e;setTimeout(()=>{t?this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:r,source:"autosizeColumns"}):this.columnAutosizeService.autoSizeAllColumns("autosizeColumns",r)})}onAutoGroupColumnDefChanged(e){this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e)}onSelectionOptionsChanged(e,t,r){if("string"==typeof e||"string"==typeof t)return;const n=(t?Qs(t):void 0)!==(e?Qs(e):void 0),o=t?la(t):void 0,a=e?la(e):void 0;(n||o!==a)&&this.refreshAll(r)}};function Cs(e){return"gridOptionsUpdated"===e?"gridOptionsChanged":e}function Af(e){e.map={},e.list.forEach(t=>e.map[t.getId()]=t)}function Pf(e,t){const r=e===t,i=e.getColDef()===t,s=e.getColId()==t;return r||i||s}var $F=class extends U{constructor(){super(...arguments),this.beanName="columnAutosizeService",this.timesDelayed=0}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.animationFrameService=e.animationFrameService,this.autoWidthCalculator=e.autoWidthCalculator,this.eventDispatcher=e.columnEventDispatcher,this.ctrlsService=e.ctrlsService,this.renderStatusService=e.renderStatusService}autoSizeCols(e){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation(()=>this.autoSizeCols(e));const{colKeys:t,skipHeader:r,skipHeaderGroups:i,stopAtGroup:s,source:n="api"}=e;if(this.animationFrameService.flushAllFrames(),this.timesDelayed<5&&this.renderStatusService&&!this.renderStatusService.areHeaderCellsRendered())return this.timesDelayed++,void setTimeout(()=>this.autoSizeCols(e));this.timesDelayed=0;const o=[];let a=-1;const l=r??this.gos.get("skipHeaderOnAutoSize"),c=i??l;for(;0!==a;){a=0;const d=[];t.forEach(u=>{if(!u)return;const h=this.columnModel.getCol(u);if(!h||o.indexOf(h)>=0)return;const g=this.autoWidthCalculator.getPreferredWidthForColumn(h,l);if(g>0){const p=this.normaliseColumnWidth(h,g);h.setActualWidth(p,n),o.push(h),a++}d.push(h)}),d.length&&this.visibleColsService.refresh(n)}c||this.autoSizeColumnGroupsByColumns(t,n,s),this.eventDispatcher.columnResized(o,!0,"autosizeColumns")}autoSizeColumn(e,t,r){e&&this.autoSizeCols({colKeys:[e],skipHeader:r,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,r){const i=new Set;let n;this.columnModel.getColsForKeys(e).forEach(a=>{let l=a.getParent();for(;l&&l!=r;)l.isPadding()||i.add(l),l=l.getParent()});for(const a of i){for(const l of this.ctrlsService.getHeaderRowContainerCtrls())if(n=l.getHeaderCtrlForColumn(a),n)break;n&&n.resizeLeafColumnsToFit(t)}return[]}autoSizeAllColumns(e,t){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation(()=>this.autoSizeAllColumns(e,t));const r=this.visibleColsService.getAllCols();this.autoSizeCols({colKeys:r,skipHeader:t,source:e})}normaliseColumnWidth(e,t){const r=e.getMinWidth();t<r&&(t=r);const i=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=i),t}},KF=class extends U{constructor(){super(...arguments),this.beanName="funcColsService",this.rowGroupCols=[],this.valueCols=[],this.pivotCols=[]}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.aggFuncService=e.aggFuncService,this.visibleColsService=e.visibleColsService}getModifyColumnsNoEventsCallbacks(){return{addGroupCol:e=>this.rowGroupCols.push(e),removeGroupCol:e=>qt(this.rowGroupCols,e),addPivotCol:e=>this.pivotCols.push(e),removePivotCol:e=>qt(this.pivotCols,e),addValueCol:e=>this.valueCols.push(e),removeValueCol:e=>qt(this.valueCols,e)}}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupCols.slice(0);const r=this.columnModel.getColDefCol(t);return r?[r]:null}sortRowGroupColumns(e){this.rowGroupCols.sort(e)}sortPivotColumns(e){this.pivotCols.sort(e)}getValueColumns(){return this.valueCols?this.valueCols:[]}getPivotColumns(){return this.pivotCols?this.pivotCols:[]}getRowGroupColumns(){return this.rowGroupCols?this.rowGroupCols:[]}isRowGroupEmpty(){return rr(this.rowGroupCols)}setColumnAggFunc(e,t,r){if(!e)return;const i=this.columnModel.getColDefCol(e);i&&(i.setAggFunc(t),this.eventDispatcher.columnChanged("columnValueChanged",[i],r))}setRowGroupColumns(e,t){this.setColList(e,this.rowGroupCols,"columnRowGroupChanged",!0,!0,(r,i)=>this.setRowGroupActive(r,i,t),t)}setRowGroupActive(e,t,r){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,r),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.columnModel.setColsVisible([t],!1,r),!e&&!this.gos.get("suppressMakeColumnVisibleAfterUnGroup")&&this.columnModel.setColsVisible([t],!0,r))}addRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!0,!0,r=>this.setRowGroupActive(!0,r,t),"columnRowGroupChanged",t)}removeRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!1,!0,r=>this.setRowGroupActive(!1,r,t),"columnRowGroupChanged",t)}addPivotColumns(e,t){this.updateColList(e,this.pivotCols,!0,!1,r=>r.setPivotActive(!0,t),"columnPivotChanged",t)}setPivotColumns(e,t){this.setColList(e,this.pivotCols,"columnPivotChanged",!0,!1,(r,i)=>{i.setPivotActive(r,t)},t)}removePivotColumns(e,t){this.updateColList(e,this.pivotCols,!1,!1,r=>r.setPivotActive(!1,t),"columnPivotChanged",t)}setValueColumns(e,t){this.setColList(e,this.valueCols,"columnValueChanged",!1,!1,(r,i)=>this.setValueActive(r,i,t),t)}setValueActive(e,t,r){if(e!==t.isValueActive()&&(t.setValueActive(e,r),e&&!t.getAggFunc()&&this.aggFuncService)){const i=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(i)}}addValueColumns(e,t){this.updateColList(e,this.valueCols,!0,!1,r=>this.setValueActive(!0,r,t),"columnValueChanged",t)}removeValueColumns(e,t){this.updateColList(e,this.valueCols,!1,!1,r=>this.setValueActive(!1,r,t),"columnValueChanged",t)}moveRowGroupColumn(e,t,r){if(this.isRowGroupEmpty())return;const i=this.rowGroupCols[e],s=this.rowGroupCols.slice(e,t);this.rowGroupCols.splice(e,1),this.rowGroupCols.splice(t,0,i),this.eventDispatcher.rowGroupChanged(s,r)}setColList(e,t,r,i,s,n,o){if(rr(this.columnModel.getCols()))return;const l=new Map;t.forEach((d,u)=>l.set(d,u)),t.length=0,te(e)&&e.forEach(d=>{const u=this.columnModel.getColDefCol(d);u&&t.push(u)}),t.forEach((d,u)=>{const h=l.get(d);void 0!==h?i&&h!==u||l.delete(d):l.set(d,0)}),(this.columnModel.getColDefCols()||[]).forEach(d=>{const u=t.indexOf(d)>=0;n(u,d)}),s&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(o),this.eventDispatcher.columnChanged(r,[...l.keys()],o)}updateColList(e,t,r,i,s,n,o){if(!e||rr(e))return;let a=!1;const l=new Set;e.forEach(c=>{if(!c)return;const d=this.columnModel.getColDefCol(c);if(d){if(l.add(d),r){if(t.indexOf(d)>=0)return;t.push(d)}else{const u=t.indexOf(d);if(u<0)return;for(let h=u+1;h<t.length;h++)l.add(t[h]);qt(t,d)}s(d),a=!0}}),a&&(i&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(o),this.eventDispatcher.genericColumnEvent(n,Array.from(l),o))}extractCols(e,t){this.extractRowGroupCols(e,t),this.extractPivotCols(e,t),this.extractValueCols(e,t)}extractValueCols(e,t){this.valueCols=this.extractColsCommon(t,this.valueCols,(r,i)=>r.setValueActive(i,e),()=>{},()=>{},r=>{const i=r.aggFunc;return null===i||""===i?null:void 0!==i?!!i:void 0},r=>null!=r.initialAggFunc&&""!=r.initialAggFunc),this.valueCols.forEach(r=>{const i=r.getColDef();null!=i.aggFunc&&""!=i.aggFunc?r.setAggFunc(i.aggFunc):r.getAggFunc()||r.setAggFunc(i.initialAggFunc)})}extractRowGroupCols(e,t){this.rowGroupCols=this.extractColsCommon(t,this.rowGroupCols,(r,i)=>r.setRowGroupActive(i,e),r=>r.rowGroupIndex,r=>r.initialRowGroupIndex,r=>r.rowGroup,r=>r.initialRowGroup)}extractPivotCols(e,t){this.pivotCols=this.extractColsCommon(t,this.pivotCols,(r,i)=>r.setPivotActive(i,e),r=>r.pivotIndex,r=>r.initialPivotIndex,r=>r.pivot,r=>r.initialPivot)}extractColsCommon(e=[],t=[],r,i,s,n,o){const a=[],l=[];(this.columnModel.getColDefCols()||[]).forEach(h=>{const g=e.indexOf(h)<0,p=h.getColDef(),f=hc(n(p)),m=hc(o(p)),w=gs(i(p)),C=gs(s(p));let v;v=void 0!==f?f:void 0!==w?null!==w&&w>=0:g?void 0!==m?m:void 0!==C&&null!=C&&C>=0:t.indexOf(h)>=0,v&&((g?null!=w||null!=C:null!=w)?a.push(h):l.push(h))});const d=h=>{const g=i(h.getColDef()),p=s(h.getColDef());return g??p};a.sort((h,g)=>{const p=d(h),f=d(g);return p===f?0:p<f?-1:1});const u=[].concat(a);return t.forEach(h=>{l.indexOf(h)>=0&&u.push(h)}),l.forEach(h=>{u.indexOf(h)<0&&u.push(h)}),t.forEach(h=>{u.indexOf(h)<0&&r(h,!1)}),u.forEach(h=>{t.indexOf(h)<0&&r(h,!0)}),u}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},i=(s,n,o,a,l,c)=>{const d=this.columnModel.getColDefCols();if(!n.length||!d)return[];const u=Object.keys(s),h=new Set(u),g=new Set(u),p=new Set(n.map(O=>{const y=O.getColId();return g.delete(y),y}).concat(u)),f=[],m={};let w=0;for(let O=0;O<d.length;O++){const y=d[O].getColId();p.has(y)&&(f.push(y),m[y]=w++)}let C=1e3,v=!1,k=0;const M=O=>{const y=m[O];for(let L=k;L<y;L++){const _=f[L];g.has(_)&&(s[_][l]=C++,g.delete(_))}k=y};n.forEach(O=>{const y=O.getColId();if(h.has(y))M(y),s[y][l]=C++;else{const L=O.getColDef();(null===L[l]||void 0===L[l]&&null==L[c])&&(v||(L[o]||void 0===L[o]&&L[a]?M(y):(g.forEach(K=>{s[K][l]=C+m[K]}),C+=f.length,v=!0)),r[y]||(r[y]={colId:y}),r[y][l]=C++)}})};return i(e,this.rowGroupCols,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotCols,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(r)}},YF=class extends U{constructor(){super(...arguments),this.beanName="columnApplyStateService"}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.sortController=e.sortController,this.columnGetStateService=e.columnGetStateService,this.funcColsService=e.funcColsService,this.visibleColsService=e.visibleColsService,this.columnAnimationService=e.columnAnimationService,this.pivotResultColsService=e.pivotResultColsService}applyColumnState(e,t){const r=this.columnModel.getColDefCols()||[];if(rr(r))return!1;if(e&&e.state&&!e.state.forEach)return q("applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const i=this.funcColsService.getModifyColumnsNoEventsCallbacks(),s=(a,l,c)=>{const d=this.compareColumnStatesAndDispatchEvents(t),u=l.slice(),h={},g={},p=[],f=[];let m=0;const w=this.funcColsService.getRowGroupColumns().slice(),C=this.funcColsService.getPivotColumns().slice();a.forEach(O=>{const y=O.colId||"";if(y.startsWith(ua))return p.push(O),void f.push(O);const _=c(y);_?(this.syncColumnWithStateItem(_,O,e.defaultState,h,g,!1,t,i),qt(u,_)):(f.push(O),m+=1)});const v=O=>this.syncColumnWithStateItem(O,null,e.defaultState,h,g,!1,t,i);u.forEach(v),this.funcColsService.sortRowGroupColumns(Mf.bind(this,h,w)),this.funcColsService.sortPivotColumns(Mf.bind(this,g,C)),this.columnModel.refreshCols(!1);const M=(this.columnModel.getAutoCols()||[]).slice();return p.forEach(O=>{const y=this.columnModel.getAutoCol(O.colId);qt(M,y),this.syncColumnWithStateItem(y,O,e.defaultState,null,null,!0,t,i)}),M.forEach(v),this.orderLiveColsLikeState(e),this.visibleColsService.refresh(t),this.eventDispatcher.everythingChanged(t),d(),{unmatchedAndAutoStates:f,unmatchedCount:m}};this.columnAnimationService.start();let{unmatchedAndAutoStates:n,unmatchedCount:o}=s(e.state||[],r,a=>this.columnModel.getColDefCol(a));if(n.length>0||te(e.defaultState)){const l=this.pivotResultColsService.getPivotResultCols()?.list;o=s(n,l||[],c=>this.pivotResultColsService.getPivotResultCol(c)).unmatchedCount}return this.columnAnimationService.finish(),0===o}resetColumnState(e){if(rr(this.columnModel.getColDefCols()))return;const i=bc(this.columnModel.getColDefColTree()),s=[];let n=1e3,o=1e3,a=[];const l=this.columnModel.getAutoCols();l&&(a=a.concat(l)),i&&(a=a.concat(i)),a.forEach(c=>{const d=this.getColumnStateFromColDef(c);Ie(d.rowGroupIndex)&&d.rowGroup&&(d.rowGroupIndex=n++),Ie(d.pivotIndex)&&d.pivot&&(d.pivotIndex=o++),s.push(d)}),this.applyColumnState({state:s,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(p,f)=>p??f??null,r=e.getColDef(),i=t(r.sort,r.initialSort),s=t(r.sortIndex,r.initialSortIndex),n=t(r.hide,r.initialHide),o=t(r.pinned,r.initialPinned),a=t(r.width,r.initialWidth),l=t(r.flex,r.initialFlex);let c=t(r.rowGroupIndex,r.initialRowGroupIndex),d=t(r.rowGroup,r.initialRowGroup);null==c&&(null==d||0==d)&&(c=null,d=null);let u=t(r.pivotIndex,r.initialPivotIndex),h=t(r.pivot,r.initialPivot);null==u&&(null==h||0==h)&&(u=null,h=null);const g=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:s,hide:n,pinned:o,width:a,flex:l,rowGroup:d,rowGroupIndex:c,pivot:h,pivotIndex:u,aggFunc:g}}syncColumnWithStateItem(e,t,r,i,s,n,o,a){if(!e)return;const l=(k,M)=>{const O={value1:void 0,value2:void 0};let y=!1;return t&&(void 0!==t[k]&&(O.value1=t[k],y=!0),te(M)&&void 0!==t[M]&&(O.value2=t[M],y=!0)),!y&&r&&(void 0!==r[k]&&(O.value1=r[k]),te(M)&&void 0!==r[M]&&(O.value2=r[M])),O},c=l("hide").value1;void 0!==c&&e.setVisible(!c,o);const d=l("pinned").value1;void 0!==d&&e.setPinned(d);const u=e.getColDef().minWidth??this.gos.environment.getDefaultColumnMinWidth(),h=l("flex").value1;if(void 0!==h&&e.setFlex(h),null==h){const k=l("width").value1;null!=k&&null!=u&&k>=u&&e.setActualWidth(k,o)}const g=l("sort").value1;void 0!==g&&e.setSort("desc"===g||"asc"===g?g:void 0,o);const p=l("sortIndex").value1;if(void 0!==p&&e.setSortIndex(p),n||!e.isPrimary())return;const f=l("aggFunc").value1;void 0!==f&&("string"==typeof f?(e.setAggFunc(f),e.isValueActive()||(e.setValueActive(!0,o),a.addValueCol(e))):(te(f)&&q("stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,o),a.removeValueCol(e))));const{value1:m,value2:w}=l("rowGroup","rowGroupIndex");(void 0!==m||void 0!==w)&&("number"==typeof w||m?(e.isRowGroupActive()||(e.setRowGroupActive(!0,o),a.addGroupCol(e)),i&&"number"==typeof w&&(i[e.getId()]=w)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,o),a.removeGroupCol(e)));const{value1:C,value2:v}=l("pivot","pivotIndex");(void 0!==C||void 0!==v)&&("number"==typeof v||C?(e.isPivotActive()||(e.setPivotActive(!0,o),a.addPivotCol(e)),s&&"number"==typeof v&&(s[e.getId()]=v)):e.isPivotActive()&&(e.setPivotActive(!1,o),a.removePivotCol(e)))}orderLiveColsLikeState(e){if(!e.applyOrder||!e.state)return;const t=[];e.state.forEach(r=>{null!=r.colId&&t.push(r.colId)}),this.columnModel.sortColsLikeKeys(t)}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.funcColsService.getRowGroupColumns().slice(),pivotColumns:this.funcColsService.getPivotColumns().slice(),valueColumns:this.funcColsService.getValueColumns().slice()},r=this.columnGetStateService.getColumnState(),i={};return r.forEach(s=>{i[s.colId]=s}),()=>{const s=this.columnModel.getAllCols(),n=(f,m,w,C)=>{if(mi(m.map(C),w.map(C)))return;const O=new Set(m);w.forEach(L=>{O.delete(L)||O.add(L)});const y=[...O];this.eventService.dispatchEvent({type:f,columns:y,column:1===y.length?y[0]:null,source:e})},o=f=>{const m=[];return s.forEach(w=>{const C=i[w.getColId()];C&&f(C,w)&&m.push(w)}),m},a=f=>f.getColId();n("columnRowGroupChanged",t.rowGroupColumns,this.funcColsService.getRowGroupColumns(),a),n("columnPivotChanged",t.pivotColumns,this.funcColsService.getPivotColumns(),a);const c=o((f,m)=>{const w=null!=f.aggFunc,C=w!=m.isValueActive(),v=w&&f.aggFunc!=m.getAggFunc();return C||v});c.length>0&&this.eventDispatcher.columnChanged("columnValueChanged",c,e),this.eventDispatcher.columnResized(o((f,m)=>f.width!=m.getActualWidth()),!0,e),this.eventDispatcher.columnPinned(o((f,m)=>f.pinned!=m.getPinned()),e),this.eventDispatcher.columnVisible(o((f,m)=>f.hide==m.isVisible()),e);const p=o((f,m)=>f.sort!=m.getSort()||f.sortIndex!=m.getSortIndex());p.length>0&&this.sortController.dispatchSortChangedEvents(e,p),this.normaliseColumnMovedEventForColumnState(r,e)}}normaliseColumnMovedEventForColumnState(e,t){const r=this.columnGetStateService.getColumnState(),i={};r.forEach(l=>i[l.colId]=l);const s={};e.forEach(l=>{i[l.colId]&&(s[l.colId]=!0)});const n=e.filter(l=>s[l.colId]),o=r.filter(l=>s[l.colId]),a=[];o.forEach((l,c)=>{const d=n&&n[c];if(d&&d.colId!==l.colId){const u=this.columnModel.getCol(d.colId);u&&a.push(u)}}),a.length&&this.eventDispatcher.columnMoved({movedColumns:a,source:t,finished:!0})}},Mf=(e,t,r,i)=>{const s=e[r.getId()],n=e[i.getId()],o=null!=s,a=null!=n;if(o&&a)return s-n;if(o)return-1;if(a)return 1;const l=t.indexOf(r),c=t.indexOf(i),d=l>=0;return d&&c>=0?l-c:d?-1:1},qF=class extends U{constructor(){super(...arguments),this.beanName="columnMoveService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher}moveColumnByIndex(e,t,r){const i=this.columnModel.getCols();i&&this.moveColumns([i[e]],t,r)}moveColumns(e,t,r,i=!0){const s=this.columnModel.getCols();if(!s)return;if(t>s.length-e.length)return q("tried to insert columns in invalid location, toIndex = ",t),void q("remember that you should not count the moving columns when calculating the new index");this.columnAnimationService.start();const n=this.columnModel.getColsForKeys(e);this.doesMovePassRules(n,t)&&(this.columnModel.moveInCols(n,t,r),this.eventDispatcher.columnMoved({movedColumns:n,source:r,toIndex:t,finished:i})),this.columnAnimationService.finish()}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){return!(!this.doesMovePassMarryChildren(e)||!this.doesMovePassLockedPositions(e))}getProposedColumnOrder(e,t){const i=this.columnModel.getCols().slice();return bf(i,e,t),i}doesMovePassLockedPositions(e){const r=this.gos.get("enableRtl");let i=r?1:-1,s=!0;return e.forEach(n=>{const o=(n=>n?"left"===n||!0===n?-1:1:0)(n.getColDef().lockPosition);r?o>i&&(s=!1):o<i&&(s=!1),i=o}),s}doesMovePassMarryChildren(e){let t=!0;return wi(null,this.columnModel.getColTree(),i=>{if(!Xt(i))return;const s=i,n=s.getColGroupDef();if(!n||!n.marryChildren)return;const a=[];s.getLeafColumns().forEach(h=>{const g=e.indexOf(h);a.push(g)}),Math.max.apply(Math,a)-Math.min.apply(Math,a)>s.getLeafColumns().length-1&&(t=!1)}),t}placeLockedColumns(e){const t=[],r=[],i=[];return e.forEach(n=>{const o=n.getColDef().lockPosition;"right"===o?i.push(n):"left"===o||!0===o?t.push(n):r.push(n)}),this.gos.get("enableRtl")?[...i,...r,...t]:[...t,...r,...i]}},XF=/[&<>"']/g,QF={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function ti(e,t){if(null==e)return null;const r=e.toString().toString();return t?r:r.replace(XF,i=>QF[i])}function eR(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}var tR=class extends U{constructor(){super(...arguments),this.beanName="columnNameService"}wireBeans(e){this.expressionService=e.expressionService,this.funcColsService=e.funcColsService,this.columnModel=e.columnModel}getDisplayNameForColumn(e,t,r=!1){if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t);return r?this.wrapHeaderNameWithAggFunc(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,r){const i=t?t.getColGroupDef():null;return i?this.getHeaderName(i,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,i,s){const n=e.headerValueGetter;if(n){const o=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:r,providedColumnGroup:i,location:s});return"function"==typeof n?n(o):"string"==typeof n?this.expressionService.evaluate(n,o):(q("headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?function JF(e){return e&&null!=e?e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map(s=>s.substring(0,1).toUpperCase()+(s.length>1?s.substring(1,s.length):"")).join(" "):null}(e.field):""}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const r=e.getColDef().pivotValueColumn;let n,s=null;if(te(r)){const o=this.funcColsService.getValueColumns(),a=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===o.length,l=void 0!==e.getColDef().pivotTotalColumnIds;if(a&&!l)return t;s=r?r.getAggFunc():null,n=!0}else{const o=e.isValueActive(),a=this.columnModel.isPivotMode()||!this.funcColsService.isRowGroupEmpty();o&&a?(s=e.getAggFunc(),n=!0):n=!1}if(n){const o="string"==typeof s?s:"func";return`${this.localeService.getLocaleTextFunc()(o,o)}(${t})`}return t}},rR=class extends U{constructor(){super(...arguments),this.beanName="pivotResultColsService"}wireBeans(e){this.context=e.context,this.columnModel=e.columnModel,this.columnFactory=e.columnFactory,this.visibleColsService=e.visibleColsService}destroy(){Gi(this.context,this.pivotResultCols?.tree),super.destroy()}isPivotResultColsPresent(){return null!=this.pivotResultCols}lookupPivotResultCol(e,t){if(null==this.pivotResultCols)return null;const r=this.columnModel.getColDefCol(t);let i=null;return this.pivotResultCols.list.forEach(s=>{const n=s.getColDef().pivotKeys,o=s.getColDef().pivotValueColumn;mi(n,e)&&o===r&&(i=s)}),i}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.columnModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){if(this.columnModel.isReady()&&(null!=e||null!=this.pivotResultCols)){if(e){this.processPivotResultColDef(e);const r=this.columnFactory.createColumnTree(e,!1,this.pivotResultCols?.tree||this.previousPivotResultCols||void 0,t);Gi(this.context,this.pivotResultCols?.tree,r.columnTree);const i=r.columnTree,s=r.treeDept,n=bc(i);this.pivotResultCols={tree:i,treeDepth:s,list:n,map:{}},this.pivotResultCols.list.forEach(l=>this.pivotResultCols.map[l.getId()]=l);const a=!!this.previousPivotResultCols;this.previousPivotResultCols=null,this.columnModel.refreshCols(!a)}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null,this.columnModel.refreshCols(!1);this.visibleColsService.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),r=this.gos.get("processPivotResultColGroupDef");if(!t&&!r)return;const i=s=>{s.forEach(n=>{if(te(n.children)){const a=n;r&&r(a),i(a.children)}else t&&t(n)})};e&&i(e)}},iR=class extends U{constructor(){super(...arguments),this.beanName="columnSizeService"}wireBeans(e){this.columnModel=e.columnModel,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}setColumnWidths(e,t,r,i){const s=[];e.forEach(n=>{const o=this.columnModel.getColDefCol(n.key)||this.columnModel.getCol(n.key);if(o&&(s.push({width:n.newWidth,ratios:[1],columns:[o]}),"shift"===this.gos.get("colResizeDefault")&&(t=!t),t)){const l=this.visibleColsService.getColAfter(o);if(!l)return;const c=o.getActualWidth()-n.newWidth,d=l.getActualWidth()+c;s.push({width:d,ratios:[1],columns:[l]})}}),0!==s.length&&this.resizeColumnSets({resizeSets:s,finished:r,source:i})}resizeColumnSets(e){const{resizeSets:t,finished:r,source:i}=e;if(t&&!t.every(d=>this.checkMinAndMaxWidthsForSet(d)))return void(r&&this.eventDispatcher.columnResized(t&&t.length>0?t[0].columns:null,r,i));const n=[],o=[];t.forEach(d=>{const{width:u,columns:h,ratios:g}=d,p={},f={};h.forEach(C=>o.push(C));let m=!0,w=0;for(;m;){if(w++,w>1e3){Me("infinite loop in resizeColumnSets");break}m=!1;const C=[];let v=0,k=u;h.forEach((O,y)=>{f[O.getId()]?k-=p[O.getId()]:(C.push(O),v+=g[y])});const M=1/v;C.forEach((O,y)=>{let _;y===C.length-1?_=k:(_=Math.round(g[y]*u*M),k-=_);const j=O.getMinWidth(),K=O.getMaxWidth();_<j?(_=j,f[O.getId()]=!0,m=!0):K>0&&_>K&&(_=K,f[O.getId()]=!0,m=!0),p[O.getId()]=_})}h.forEach(C=>{const v=p[C.getId()];C.getActualWidth()!==v&&(C.setActualWidth(v,i),n.push(C))})});const a=n.length>0;let l=[];a&&(l=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.visibleColsService.setLeftValues(i),this.visibleColsService.updateBodyWidths(),this.columnViewportService.checkViewportColumns());const c=o.concat(l);(a||r)&&this.eventDispatcher.columnResized(c,r,i,l)}checkMinAndMaxWidthsForSet(e){const{columns:t,width:r}=e;let i=0,s=0,n=!0;return t.forEach(l=>{const c=l.getMinWidth();i+=c||0;const d=l.getMaxWidth();d>0?s+=d:n=!1}),r>=i&&(!n||r<=s)}refreshFlexedColumns(e={}){const t=e.source?e.source:"flex";if(null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];const r=this.visibleColsService.getCenterCols();let i=-1;if(e.resizingCols){const h=new Set(e.resizingCols);for(let g=r.length-1;g>=0;g--)if(h.has(r[g])){i=g;break}}let s=0,n=[],o=0,a=0;for(let h=0;h<r.length;h++)r[h].getFlex()&&h>i?(n.push(r[h]),a+=r[h].getFlex(),o+=r[h].getMinWidth()):s+=r[h].getActualWidth();if(!n.length)return[];let l=[];s+o>this.flexViewportWidth&&(n.forEach(h=>h.setActualWidth(h.getMinWidth(),t)),l=n,n=[]);const c=[];let d;e:for(;;){d=this.flexViewportWidth-s;const h=d/a;for(let g=0;g<n.length;g++){const p=n[g],f=h*p.getFlex();let m=0;const w=p.getMinWidth(),C=p.getMaxWidth();if(f<w?m=w:f>C&&(m=C),m){p.setActualWidth(m,t),yf(n,p),a-=p.getFlex(),l.push(p),s+=p.getActualWidth();continue e}c[g]=Math.floor(f)}break}let u=d;return n.forEach((h,g)=>{const p=g<n.length-1?Math.min(c[g],u):Math.max(c[g],u);h.setActualWidth(p,t),l.push(h),u-=c[g]}),e.skipSetLeft||this.visibleColsService.setLeftValues(t),e.updateBodyWidths&&this.visibleColsService.updateBodyWidths(),e.fireResizedEvent&&this.eventDispatcher.columnResized(l,!0,t,n),n}sizeColumnsToFit(e,t="sizeColumnsToFit",r,i){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,r,i));const s={};i&&i?.columnLimits?.forEach(({key:h,...g})=>{s["string"==typeof h?h:h.getColId()]=g});const n=this.visibleColsService.getAllCols(),o=e===Ci(n);if(e<=0||!n.length||o)return;const a=[],l=[];n.forEach(h=>{!0===h.getColDef().suppressSizeToFit?l.push(h):a.push(h)});const c=a.slice(0);let d=!1;const u=h=>{qt(a,h),l.push(h)};for(a.forEach(h=>{h.resetActualWidth(t);const g=s?.[h.getId()],p=g?.minWidth??i?.defaultMinWidth,f=g?.maxWidth??i?.defaultMaxWidth,m=h.getActualWidth();"number"==typeof p&&m<p?h.setActualWidth(p,t,!0):"number"==typeof f&&m>f&&h.setActualWidth(f,t,!0)});!d;){d=!0;const h=e-Ci(l);if(h<=0)a.forEach(g=>{const p=s?.[g.getId()]?.minWidth??i?.defaultMinWidth;"number"!=typeof p?g.setMinimum(t):g.setActualWidth(p,t,!0)});else{const g=h/Ci(a);let p=h;for(let f=a.length-1;f>=0;f--){const m=a[f],w=s?.[m.getId()],C=w?.minWidth??i?.defaultMinWidth,v=w?.maxWidth??i?.defaultMaxWidth,k=m.getMinWidth(),M=m.getMaxWidth(),O="number"==typeof C&&C>k?C:k,y="number"==typeof v&&v<M?v:M;let L=Math.round(m.getActualWidth()*g);L<O?(L=O,u(m),d=!1):L>y?(L=y,u(m),d=!1):0===f&&(L=p),m.setActualWidth(L,t,!0),p-=L}}}c.forEach(h=>{h.fireColumnWidthChangedEvent(t)}),this.visibleColsService.setLeftValues(t),this.visibleColsService.updateBodyWidths(),!r&&this.eventDispatcher.columnResized(c,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if("fitGridWidth"===t){const{columnLimits:r,defaultMinWidth:i,defaultMaxWidth:s}=e,n=r?.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:i,defaultMaxWidth:s,columnLimits:n})}else"fitProvidedWidth"===t&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}};function If(e,t){return e+"_"+t}function ft(e){return e instanceof Lf}var Lf=class extends U{constructor(e,t,r,i){super(),this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.groupId=t,this.partId=r,this.providedColumnGroup=e,this.pinned=i}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return If(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every(t=>t.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{ft(e)&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=Le(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren&&this.displayedChildren.forEach(t=>{e+=t.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(t=>{t.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(t=>{e+=t.getMinWidth()}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach(t=>{zi(t)?e.push(t):ft(t)&&t.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(t=>{zi(t)?e.push(t):ft(t)&&t.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;null!=e&&e.isPadding();)e=e.getParent();if(!e||!e.getProvidedColumnGroup().isExpandable())return this.displayedChildren=this.children,void this.dispatchLocalEvent({type:"displayedChildrenChanged"});this.children.forEach(r=>{if(!ft(r)||r.displayedChildren&&r.displayedChildren.length)switch(r.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(r);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(r);break;default:this.displayedChildren.push(r)}}),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},_f=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return r="number"!=typeof t?0:t+1,this.existingIds[e]=r,r}},sR=class extends U{constructor(){super(...arguments),this.beanName="visibleColsService",this.colsAndGroupsMap={},this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher}refresh(e,t=!1){t||this.buildTrees(),this.updateOpenClosedVisibilityInColumnGroups(),this.columnsLeft=Ac(this.treeLeft),this.columnsCenter=Ac(this.treeCenter),this.columnsRight=Ac(this.treeRight),this.joinColsAriaOrder(),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.columns.filter(r=>r.isAutoHeight()),this.columnSizeService.refreshFlexedColumns(),this.updateBodyWidths(),this.columnViewportService.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(e),this.eventDispatcher.visibleCols(e)}updateBodyWidths(){const e=Ci(this.columnsCenter),t=Ci(this.columnsLeft),r=Ci(this.columnsRight);this.bodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r,this.eventService.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventService.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e){let t,r;this.gos.get("enableRtl")?(t=this.columnsLeft?this.columnsLeft[0]:null,r=this.columnsRight?Le(this.columnsRight):null):(t=this.columnsLeft?Le(this.columnsLeft):null,r=this.columnsRight?this.columnsRight[0]:null),this.columnModel.getCols().forEach(i=>{i.setLastLeftPinned(i===t,e),i.setFirstRightPinned(i===r,e)})}buildTrees(){const e=this.columnModel.getColsToShow(),t=e.filter(n=>"left"==n.getPinned()),r=e.filter(n=>"right"==n.getPinned()),i=e.filter(n=>"left"!=n.getPinned()&&"right"!=n.getPinned()),s=new _f;this.treeLeft=this.createGroups({columns:t,idCreator:s,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=this.createGroups({columns:r,idCreator:s,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=this.createGroups({columns:i,idCreator:s,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.ariaOrderColumns=[]}joinColsAriaOrder(){const e=this.columnModel.getCols(),t=[],r=[],i=[];for(const s of e){const n=s.getPinned();n?!0===n||"left"===n?t.push(s):i.push(s):r.push(s)}this.ariaOrderColumns=t.concat(r).concat(i)}getAriaColIndex(e){let t;return t=ft(e)?e.getLeafColumns()[0]:e,this.ariaOrderColumns.indexOf(t)+1}getAllAutoHeightCols(){return this.autoHeightCols}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach(e=>{e.forEach(t=>{ft(t)&&t.checkLeft()})})}setLeftValuesOfCols(e){if(!this.columnModel.getColDefCols())return;const r=this.columnModel.getCols().slice(0),i=this.gos.get("enableRtl");[this.columnsLeft,this.columnsRight,this.columnsCenter].forEach(s=>{if(i){let n=Ci(s);s.forEach(o=>{n-=o.getActualWidth(),o.setLeft(n,e)})}else{let n=0;s.forEach(o=>{o.setLeft(n,e),n+=o.getActualWidth()})}!function AF(e,t){for(let r=0;r<t.length;r++)yf(e,t[r])}(r,s)}),r.forEach(s=>{s.setLeft(null,e)})}joinCols(){this.columns=this.gos.get("enableRtl")?this.columnsRight.concat(this.columnsCenter).concat(this.columnsLeft):this.columnsLeft.concat(this.columnsCenter).concat(this.columnsRight)}getColsCenter(){return this.columnsCenter}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}getTreeLeft(){return this.treeLeft}getTreeRight(){return this.treeRight}getTreeCenter(){return this.treeCenter}getAllCols(){return this.columns}isColDisplayed(e){return this.getAllCols().indexOf(e)>=0}getLeftColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsLeft):this.columnsLeft}getRightColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsRight):this.columnsRight}getColsForRow(e,t,r,i){const s=[];let n=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),d=[a];if(c>1){const h=c-1;for(let g=1;g<=h;g++)d.push(t[o+g]);o+=h}let u;r?(u=!1,d.forEach(h=>{r(h)&&(u=!0)})):u=!0,u&&(0===s.length&&n&&i&&i(a)&&s.push(n),s.push(a)),n=a}return s}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getCenterCols(){return this.columnsCenter}getLeftCols(){return this.columnsLeft}getRightCols(){return this.columnsRight}getColBefore(e){const t=this.getAllCols(),r=t.indexOf(e);return r>0?t[r-1]:null}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),s="After"===t?Le(i):i[0],n=`getCol${t}`;for(;;){const o=this[n](s);if(!o)return null;const a=this.getColGroupAtLevel(o,r);if(a!==e)return a}}getColGroupAtLevel(e,t){let i,s,r=e.getParent();for(;i=r.getProvidedColumnGroup().getLevel(),s=r.getPaddingLevel(),!(i+s<=t);)r=r.getParent();return r}isPinningLeft(){return this.columnsLeft.length>0}isPinningRight(){return this.columnsRight.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};ws(this.treeCenter,!1,e),ws(this.treeLeft,!1,e),ws(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){ws(this.getAllTrees(),!1,t=>{ft(t)&&t.calculateDisplayedColumns()})}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["getLeftCols","getCenterCols","getRightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const i=this[t[r]]();if(i.length)return e?Le(i):i[0]}return null}getColumnGroup(e,t){if(!e)return null;if(ft(e))return e;const r=this.getAllTrees(),i="number"==typeof t;let s=null;return ws(r,!1,n=>{if(ft(n)){const o=n;let a;a=i?e===o.getGroupId()&&t===o.getPartId():e===o.getGroupId(),a&&(s=o)}}),s}getColAfter(e){const t=this.getAllCols(),r=t.indexOf(e);return r<t.length-1?t[r+1]:null}isBodyWidthDirty(){return this.bodyWidthDirty}setBodyWidthDirty(){this.bodyWidthDirty=!0}getColsLeftWidth(){return Ci(this.columnsLeft)}getDisplayedColumnsRightWidth(){return Ci(this.columnsRight)}isColAtEdge(e,t){const r=this.getAllCols();if(!r.length)return!1;const i="first"===t;let s;if(ft(e)){const n=e.getDisplayedLeafColumns();if(!n.length)return!1;s=i?n[0]:Le(n)}else s=e;return(i?r[0]:Le(r))===s}createGroups(e){const{columns:t,idCreator:r,pinned:i,oldDisplayedGroups:s,isStandaloneStructure:n}=e,o=this.mapOldGroupsById(s),a=[];let l=t;for(;l.length;){const c=l;l=[];let d=0;const u=h=>{const g=d;d=h;const p=c[g],m=(ft(p)?p.getProvidedColumnGroup():p).getOriginalParent();if(null==m){for(let C=g;C<h;C++)a.push(c[C]);return}const w=this.createColGroup(m,r,o,i,n);for(let C=g;C<h;C++)w.addChild(c[C]);l.push(w)};for(let h=1;h<c.length;h++){const g=c[h],f=(ft(g)?g.getProvidedColumnGroup():g).getOriginalParent(),m=c[d];f!==(ft(m)?m.getProvidedColumnGroup():m).getOriginalParent()&&u(h)}d<c.length&&u(c.length)}return n||this.setupParentsIntoCols(a,null),a}createColGroup(e,t,r,i,s){const n=e.getGroupId(),o=t.getInstanceIdForKey(n);let l=r[If(n,o)];return l&&l.getProvidedColumnGroup()!==e&&(l=null),te(l)?l.reset():(l=new Lf(e,n,o,i),s||this.createBean(l)),l}mapOldGroupsById(e){const t={},r=i=>{i.forEach(s=>{if(ft(s)){const n=s;t[s.getUniqueId()]=n,r(n.getChildren())}})};return e&&r(e),t}setupParentsIntoCols(e,t){e.forEach(r=>{if(r.setParent(t),ft(r)){const i=r;this.setupParentsIntoCols(i.getChildren(),i)}})}};function ws(e,t,r){if(e)for(let i=0;i<e.length;i++){const s=e[i];ft(s)&&ws(t?s.getDisplayedChildren():s.getChildren(),t,r),r(s)}}function Ac(e){const t=[];return ws(e,!0,r=>{zi(r)&&t.push(r)}),t}var Of=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel"],oR=[...Of,"scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged"],aR={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0},zt=class{};zt.STRING_PROPERTIES=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"],zt.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","theme","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","cellSelection","selectionColumnDef"],zt.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],zt.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],zt.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],zt.OTHER_PROPERTIES=["suppressStickyTotalRow","loadThemeGoogleFonts","rowSelection"],zt.FUNCTION_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"],zt.ALL_PROPERTIES=[...zt.ARRAY_PROPERTIES,...zt.OBJECT_PROPERTIES,...zt.STRING_PROPERTIES,...zt.NUMBER_PROPERTIES,...zt.FUNCTION_PROPERTIES,...zt.BOOLEAN_PROPERTIES,...zt.OTHER_PROPERTIES];var Zn=zt,Tr=class{static getCallbackForEvent(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substring(1)}};Tr.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY",Tr.PUBLIC_EVENTS=Of,Tr.EVENT_CALLBACKS=oR.map(e=>Tr.getCallbackForEvent(e)),Tr.BOOLEAN_PROPERTIES=Zn.BOOLEAN_PROPERTIES,Tr.ALL_PROPERTIES=Zn.ALL_PROPERTIES,Tr.ALL_PROPERTIES_AND_CALLBACKS=[...Tr.ALL_PROPERTIES,...Tr.EVENT_CALLBACKS],Tr.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(Tr.ALL_PROPERTIES_AND_CALLBACKS);var Lc,pa,_c,Oc,Bc,Nc,Gc,Hc,zc,ma,Jn=Tr;function eo(e,t,r){return r&&e.addDestroyFunc(()=>t.destroyBean(r)),r??e}function Dr(e,t,r){null==r||"string"==typeof r&&""==r?Pc(e,t):Ar(e,t,r)}function Ar(e,t,r){e.setAttribute(Bf(t),r.toString())}function Pc(e,t){e.removeAttribute(Bf(t))}function Bf(e){return`aria-${e}`}function ir(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function en(e,t){Dr(e,"label",t)}function to(e,t){Dr(e,"labelledby",t)}function Nf(e,t){Dr(e,"live",t)}function Mc(e,t){Dr(e,"hidden",t)}function ga(e,t){Ar(e,"expanded",t)}function Gf(e,t){Ar(e,"rowindex",t)}function Hf(e,t){Ar(e,"colindex",t)}function fa(e,t){Dr(e,"selected",t)}function Ic(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}function ri(){return void 0===Lc&&(Lc=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Lc}function zf(){if(void 0===pa)if(ri()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(pa=null!=e[1]?parseFloat(e[1]):0)}else pa=0;return pa}function Vc(){if(void 0===_c){const e=window;_c=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return _c}function Wc(){return void 0===Oc&&(Oc=/(firefox)/i.test(navigator.userAgent)),Oc}function Vf(){return void 0===Bc&&(Bc=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Bc}function Vi(){return void 0===Nc&&(Nc=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),Nc}function Uc(){return!ri()||zf()>=15}function jc(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return-1!==t||null!==r&&(""!==r||Wc())?t.toString():null}function Wf(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;0===r&&0===t.clientWidth&&(r=null),t.parentNode&&t.parentNode.removeChild(t),null!=r&&(Hc=r,Gc=0===r)}function Uf(){return null==Gc&&Wf(),Gc}var jf="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function $c(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),s=t.call(e,jf),n=zr(e);return i&&!s&&n}function et(e,t,r={}){const{skipAriaHidden:i}=r;e.classList.toggle("ag-hidden",!t),i||Mc(e,!t)}function ro(e,t){const r="disabled",i=t?s=>s.setAttribute(r,""):s=>s.removeAttribute(r);i(e),Zf(e.querySelectorAll("input"),s=>i(s))}function tn(e,t,r){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof r){if(++i>r)break}else if(e===r)break}return!1}function xs(e){const{height:t,width:r,borderTopWidth:i,borderRightWidth:s,borderBottomWidth:n,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:d,marginTop:u,marginRight:h,marginBottom:g,marginLeft:p,boxSizing:f}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(r||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(s||"0"),borderBottomWidth:parseFloat(n||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(c||"0"),paddingLeft:parseFloat(d||"0"),marginTop:parseFloat(u||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(g||"0"),marginLeft:parseFloat(p||"0"),boxSizing:f}}function Kc(e){const t=xs(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function io(e){const t=xs(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function $f(e){const{height:t,marginBottom:r,marginTop:i}=xs(e);return Math.floor(t+r+i)}function va(e){const{width:t,marginLeft:r,marginRight:i}=xs(e);return Math.floor(t+r+i)}function Kf(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:i,borderRightWidth:s,borderBottomWidth:n}=xs(e);return{top:t.top+(r||0),left:t.left+(i||0),right:t.right+(s||0),bottom:t.bottom+(n||0)}}function Ca(){if("boolean"==typeof ma)return ma;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,ma=0===Math.floor(e.scrollLeft),document.body.removeChild(e),ma}function wa(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r),Vc()&&!Ca()&&(r=e.scrollWidth-e.clientWidth-r)),r}function xa(e,t,r){r&&(Ca()?t*=-1:(ri()||Vc())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function Vt(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function Hr(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Yf(e){return!!e.offsetParent}function zr(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!Yf(e)||"visible"!==window.getComputedStyle(e).visibility)}function so(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function qf(e,t,r){r&&r.nextSibling===t||(r?r.nextSibling?e.insertBefore(t,r.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t))}function Xf(e,t){for(let r=0;r<t.length;r++){const i=t[r],s=e.children[r];s!==i&&e.insertBefore(i,s)}}function Qf(e,t){if(t)for(const[r,i]of Object.entries(t)){if(!r||!r.length||null==i)continue;const s=eR(r),n=i.toString(),o=n.replace(/\s*!important/g,"");e.style.setProperty(s,o,o.length!=n.length?"important":void 0)}}function Sa(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Vr(e,t)}function Vr(e,t){t=Yc(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function no(e,t){t=Yc(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function Yc(e){return"number"==typeof e?`${e}px`:e}function qc(e){return e instanceof Node||e instanceof HTMLElement}function Pr(e,t,r){null==r||""===r?e.removeAttribute(t):e.setAttribute(t,r.toString())}function Zf(e,t){if(null!=e)for(let r=0;r<e.length;r++)t(e[r])}var rn=class{constructor(e=0,t=1){this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}},ep=class Ds extends U{constructor(t,r,i,s){super(),this.parentComp=t,this.tooltipShowDelayOverride=r,this.tooltipHideDelayOverride=i,this.shouldDisplayTooltip=s,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(t){this.popupService=t.popupService,this.userComponentFactory=t.userComponentFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const t=this.parentComp.getGui();0===this.tooltipTrigger&&this.addManagedListeners(t,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),1===this.tooltipTrigger&&this.addManagedListeners(t,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(t,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(t,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(t){const r=this.gos.get(t);return r<0&&q(`${t} should not be lower than 0`),Math.max(200,r)}getTooltipDelay(t){return"show"===t?this.tooltipShowDelayOverride??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipHideDelayOverride??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const t=this.gos.get("tooltipTrigger");return t&&"hover"!==t?1:0}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Vi()&&(Ds.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(t)},100):this.prepareToShowTooltip(t))}onMouseMove(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&2===this.state&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(t){const r=t.relatedTarget,i=this.parentComp.getGui(),s=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(r)||this.interactionEnabled&&s?.contains(r)||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(t){if(0!=this.state||Ds.isLocked)return;let r=0;t&&(r=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),r),this.state=1}isLastTooltipHiddenRecently(){return(new Date).getTime()-Ds.lastTooltipHideTime<1e3}setToDoNothing(t){!t&&2===this.state&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const t={...this.parentComp.getTooltipParams()};if(!te(t.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip())return void this.setToDoNothing();this.state=2,this.tooltipInstanceCount++;const r=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(r)}hideTooltip(t){!t&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),Ds.lastTooltipHideTime=(new Date).getTime()),this.eventService.dispatchEvent({type:"tooltipHide",parentGui:this.parentComp.getGui()}),t&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(t,r){if(2!==this.state||this.tooltipInstanceCount!==t)return void this.destroyBean(r);const s=r.getGui();this.tooltipComp=r,s.classList.contains("ag-tooltip")||s.classList.add("ag-tooltip-custom"),0===this.tooltipTrigger&&s.classList.add("ag-tooltip-animate"),this.interactionEnabled&&s.classList.add("ag-tooltip-interactive");const n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({eChild:s,ariaLabel:n("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),1===this.tooltipTrigger){const a=()=>this.setToDoNothing();[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:a,columnMoved:a})}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(s,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),1===this.tooltipTrigger&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(s,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventService.dispatchEvent({type:"tooltipShow",tooltipGui:s,parentGui:this.parentComp.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const t=this.tooltipComp?.getGui(),r=Je(this.gos);return!!t&&t.contains(r)}onTooltipFocusOut(t){const r=this.parentComp.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,r.contains(t.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent({...t,mouseEvent:this.lastMouseEvent}):this.popupService.positionPopupByComponent({...t,eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const t=this.tooltipPopupDestroyFunc,r=this.tooltipComp;window.setTimeout(()=>{t(),this.destroyBean(r)},0===this.tooltipTrigger?1e3:0),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(t=>{t&&t()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){Ds.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},100)}unlockService(){Ds.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};ep.isLocked=!1;var NR=ep,sn=class extends U{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}wireBeans(e){this.beans=e}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",r=this.ctrl.getGui();r&&(null!=e&&""!=e?r.setAttribute(t,e):r.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){null==this.tooltipManager&&(this.tooltipManager=this.createBean(new NR({getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()},this.ctrl.getTooltipShowDelayOverride?.(),this.ctrl.getTooltipHideDelayOverride?.(),this.ctrl.shouldDisplayTooltip),this.beans.context))}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const e=this.ctrl,t=e.getColumn?.(),r=e.getColDef?.(),i=e.getRowNode?.();return{location:e.getLocation(),colDef:r,column:t,rowIndex:e.getRowIndex?.(),node:i,data:i?.data,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?.(),hideTooltipCallback:()=>this.tooltipManager?.hideTooltip(!0)}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}},GR=new rn,de=null,Ge=class sm extends U{constructor(t,r){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=GR.next(),this.cssClassManager=new class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1)t.forEach(i=>this.addCssClass(i));else if(!0!==this.cssClassStates[e]&&e.length){const i=this.getGui();i&&i.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1)t.forEach(i=>this.removeCssClass(i));else if(!1!==this.cssClassStates[e]&&e.length){const i=this.getGui();i&&i.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(e,t){if(e){if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1)return void i.forEach(s=>this.addOrRemoveCssClass(s,t))}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}}}(()=>this.eGui),this.componentSelectors=new Map((r??[]).map(i=>[i.selector,i])),t&&this.setTemplate(t)}preWireBeans(t){super.preWireBeans(t)}preConstruct(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips"),this.wireTemplate(this.getGui())}wireTemplate(t,r){t&&this.gos&&(this.applyElementsToComponent(t),this.createChildComponentsFromTags(t,r))}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(t){const{newTooltipText:r,showDelayOverride:i,hideDelayOverride:s,location:n,shouldDisplayTooltip:o}=t||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==r&&(this.tooltipText=r),null!=r&&(this.tooltipFeature=this.createBean(new sn({getTooltipValue:()=>this.tooltipText,getGui:()=>this.getGui(),getLocation:()=>n??"UNKNOWN",getColDef:t?.getColDef,getColumn:t?.getColumn,getTooltipShowDelayOverride:null!=i?()=>i:void 0,getTooltipHideDelayOverride:null!=s?()=>s:void 0,shouldDisplayTooltip:o})))}getDataRefAttribute(t){return t.getAttribute?t.getAttribute("data-ref"):null}applyElementsToComponent(t,r,i,s=null){if(void 0===r&&(r=this.getDataRefAttribute(t)),r){const n=this[r];n===de?this[r]=s??t:!this.suppressDataRefValidation&&(!i||!i[r])&&q(`Issue with data-ref: ${r} on ${this.constructor.name} with ${n}`)}}createChildComponentsFromTags(t,r){(function LR(e){if(null==e)return[];const t=[];return Zf(e,r=>t.push(r)),t})(t.childNodes).forEach(s=>{if(!(s instanceof HTMLElement))return;const n=this.createComponentFromElement(s,o=>{o.getGui()&&this.copyAttributesFromNode(s,o.getGui())},r);if(n){if(n.addItems&&s.children.length){this.createChildComponentsFromTags(s,r);const o=Array.prototype.slice.call(s.children);n.addItems(o)}this.swapComponentForNode(n,t,s)}else s.childNodes&&this.createChildComponentsFromTags(s,r)})}createComponentFromElement(t,r,i){const s=t.nodeName,n=this.getDataRefAttribute(t),o=0===s.indexOf("AG-"),a=o?this.componentSelectors.get(s):null;let l=null;return a?(sm.elementGettingCreated=t,l=new a.component(i&&n?i[n]:void 0),l.setParentComponent(this),this.createBean(l,null,r)):o&&q(`Missing selector: ${s}`),this.applyElementsToComponent(t,n,i,l),l}copyAttributesFromNode(t,r){!function _R(e,t){if(e)for(let r=0;r<e.length;r++){const i=e[r];t(i.name,i.value)}}(t.attributes,(i,s)=>r.setAttribute(i,s))}swapComponentForNode(t,r,i){const s=t.getGui();r.replaceChild(s,i),r.insertBefore(document.createComment(i.nodeName),s),this.addDestroyFunc(this.destroyBean.bind(this,t))}activateTabIndex(t){const r=this.gos.get("tabIndex");t||(t=[]),t.length||t.push(this.getGui()),t.forEach(i=>i.setAttribute("tabindex",r.toString()))}setTemplate(t,r,i){const s=so(t);this.setTemplateFromElement(s,r,i)}setTemplateFromElement(t,r,i,s=!1){if(this.eGui=t,this.suppressDataRefValidation=s,r)for(let n=0;n<r.length;n++){const o=r[n];this.componentSelectors.set(o.selector,o)}this.wireTemplate(t,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(t){this.parentComponent=t}getParentComponent(){return this.parentComponent}setGui(t){this.eGui=t}queryForHtmlElement(t){return this.eGui.querySelector(t)}getContainerAndElement(t,r){let i=r;return null==t?null:(i||(i=this.eGui),qc(t)?{element:t,parent:i}:{element:t.getGui(),parent:i})}prependChild(t,r){const{element:i,parent:s}=this.getContainerAndElement(t,r)||{};!i||!s||s.insertAdjacentElement("afterbegin",i)}appendChild(t,r){const{element:i,parent:s}=this.getContainerAndElement(t,r)||{};!i||!s||s.appendChild(i)}isDisplayed(){return this.displayed}setVisible(t,r={}){if(t!==this.visible){this.visible=t;const{skipAriaHidden:i}=r;!function AR(e,t,r={}){const{skipAriaHidden:i}=r;e.classList.toggle("ag-invisible",!t),i||Mc(e,!t)}(this.eGui,t,{skipAriaHidden:i})}}setDisplayed(t,r={}){if(t!==this.displayed){this.displayed=t;const{skipAriaHidden:i}=r;et(this.eGui,t,{skipAriaHidden:i}),this.dispatchLocalEvent({type:"displayChanged",visible:this.displayed})}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}addGuiEventListener(t,r,i){this.eGui.addEventListener(t,r,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(t,r))}addCssClass(t){this.cssClassManager.addCssClass(t)}removeCssClass(t){this.cssClassManager.removeCssClass(t)}containsCssClass(t){return this.cssClassManager.containsCssClass(t)}addOrRemoveCssClass(t,r){this.cssClassManager.addOrRemoveCssClass(t,r)}},tp={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus",checkboxChecked:"checkbox-checked",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off"},HR=(()=>{const e=new Set(Object.values(tp));return e.add("eye"),e})();function fr(e,t,r,i){let s=null;const n=r&&r.getColDef().icons;if(n&&(s=n[e]),t&&!s){const o=t.get("icons");o&&(s=o[e])}if(!s){const o=document.createElement("span");let a=tp[e]??(HR.has(e)?e:void 0);return a||(i?a=e:(q(`Did not find icon ${e}`),a="")),o.setAttribute("class",`ag-icon ag-icon-${a}`),o.setAttribute("unselectable","on"),ir(o,"presentation"),o}{let o;if("function"==typeof s)o=s();else{if("string"!=typeof s)throw new Error("icon from grid options needs to be a string or a function");o=s}if("string"==typeof o)return so(o);if(qc(o))return o;q("iconRenderer should return back a string or a dom object")}}var VR=class extends Ge{constructor(){super(...arguments),this.dragSource=null,this.eIcon=de,this.eLabel=de}postConstruct(){const e=t=>function zR(e,t,r){const i=fr(e,t,r);if(i){const{className:n}=i;if("string"==typeof n&&n.indexOf("ag-icon")>-1||"object"==typeof n&&n["ag-icon"])return i}const s=document.createElement("span");return s.appendChild(i),s}(t,this.gos,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate('<div class="ag-dnd-ghost ag-unselectable">\n                <span data-ref="eIcon" class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n                <div data-ref="eLabel" class="ag-dnd-ghost-label"></div>\n            </div>')}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t=!1){Vt(this.eIcon);let r=null;e||(e=this.dragSource?.getDefaultIconName?this.dragSource?.getDefaultIconName():"notAllowed"),r=this.dropIconMap[e],this.eIcon.classList.toggle("ag-shake-left-to-right",t),(r!==this.dropIconMap.hide||!this.gos.get("suppressDragLeaveHidesColumns"))&&r&&this.eIcon.appendChild(r)}setLabel(e){this.eLabel.textContent=ti(e)}};function rp(e,t,r){if(0===r)return!1;const i=Math.abs(e.clientX-t.clientX),s=Math.abs(e.clientY-t.clientY);return Math.max(i,s)<=r}var Wi=class{constructor(e,t=!1){this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new Ys,this.eElement=e,this.preventMouseClick=t;const r=this.onTouchStart.bind(this),i=this.onTouchMove.bind(this),s=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",r,{passive:!0}),this.eElement.addEventListener("touchmove",i,{passive:!0}),this.eElement.addEventListener("touchend",s,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",r,{passive:!0}),this.eElement.removeEventListener("touchmove",i,{passive:!0}),this.eElement.removeEventListener("touchend",s,{passive:!1})})}getActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout(()=>{this.touching&&this.touchStart===t&&!this.moved&&(this.moved=!0,this.localEventService.dispatchEvent({type:"longTap",touchStart:this.touchStart,touchEvent:e}))},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);t&&!rp(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){this.touching&&(this.moved||(this.localEventService.dispatchEvent({type:"tap",touchStart:this.touchStart}),this.checkForDoubleTap()),this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1)}checkForDoubleTap(){const e=(new Date).getTime();this.lastTapTime&&this.lastTapTime>0&&e-this.lastTapTime>this.DOUBLE_TAP_MILLIS?(this.localEventService.dispatchEvent({type:"doubleTap",touchStart:this.touchStart}),this.lastTapTime=null):this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}};function oo(e,t){return`<span data-ref="eSort${e}" class="ag-sort-indicator-icon ag-sort-${t} ag-hidden" aria-hidden="true"></span>`}var WR=`<span class="ag-sort-indicator-container">\n        ${oo("Order","order")}\n        ${oo("Asc","ascending-icon")}\n        ${oo("Desc","descending-icon")}\n        ${oo("Mixed","mixed-icon")}\n        ${oo("None","none-icon")}\n    </span>`,Xc=class extends Ge{constructor(e){super(),this.eSortOrder=de,this.eSortAsc=de,this.eSortDesc=de,this.eSortMixed=de,this.eSortNone=de,e||this.setTemplate(WR)}wireBeans(e){this.sortController=e.sortController}attachCustomElements(e,t,r,i,s){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=i,this.eSortNone=s}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!this.column.isSortable()&&!this.column.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const r=this.updateIcons.bind(this),i=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",r),this.addManagedEventListeners({newColumnsLoaded:r,sortChanged:i,columnRowGroupChanged:i}),this.onSortChanged()}addInIcon(e,t,r){if(null==t)return;const i=fr(e,this.gos,r);i&&t.appendChild(i)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc&&et(this.eSortAsc,"asc"===e,{skipAriaHidden:!0}),this.eSortDesc&&et(this.eSortDesc,"desc"===e,{skipAriaHidden:!0}),this.eSortNone){const t=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon");et(this.eSortNone,!t&&null==e,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;Jr(this.gos)&&e&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e="mixed"===this.sortController.getDisplaySortForColumn(this.column);et(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){if(!this.eSortOrder)return;const e=this.sortController.getColumnsWithSortingOrdered(),t=this.sortController.getDisplaySortIndexForColumn(this.column)??-1,r=e.some(s=>this.sortController.getDisplaySortIndexForColumn(s)??!1);et(this.eSortOrder,t>=0&&r,{skipAriaHidden:!0}),t>=0?this.eSortOrder.textContent=(t+1).toString():Vt(this.eSortOrder)}},UR={selector:"AG-SORT-INDICATOR",component:Xc},Qc=class extends Ge{constructor(){super(...arguments),this.eFilter=de,this.eFilterButton=de,this.eSortIndicator=de,this.eMenu=de,this.eLabel=de,this.eText=de,this.eSortOrder=de,this.eSortAsc=de,this.eSortDesc=de,this.eSortMixed=de,this.eSortNone=de,this.lastMovingChanged=0}wireBeans(e){this.sortController=e.sortController,this.menuService=e.menuService,this.funcColsService=e.funcColsService}destroy(){super.destroy()}refresh(e){const t=this.params;return this.params=e,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&this.shouldSuppressMenuHide()==this.currentSuppressMenuHide&&t.enableFilterButton==e.enableFilterButton&&t.enableFilterIcon==e.enableFilterIcon&&(this.setDisplayName(e),!0)}workOutTemplate(){let e=this.params.template??'<div class="ag-cell-label-container" role="presentation">\n        <span data-ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n        <span data-ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>\n        <div data-ref="eLabel" class="ag-header-cell-label" role="presentation">\n            <span data-ref="eText" class="ag-header-cell-text"></span>\n            <span data-ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n            <ag-sort-indicator data-ref="eSortIndicator"></ag-sort-indicator>\n        </div>\n    </div>';return e=e&&e.trim?e.trim():e,e}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate,[UR]),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(e)}setDisplayName(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;const t=ti(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=t)}}addInIcon(e,t,r){if(null==t)return;const i=fr(e,this.gos,r);i&&t.appendChild(i)}setupTap(){const{gos:e}=this;if(e.get("suppressTouch"))return;const t=new Wi(this.getGui(),!0),r=this.shouldSuppressMenuHide(),i=r&&te(this.eMenu),s=i?new Wi(this.eMenu,!0):t;if(this.params.enableMenu&&this.addManagedListeners(s,{[i?"tap":"longTap"]:a=>this.params.showColumnMenuAfterMouseClick(a.touchStart)}),this.params.enableSorting&&this.addManagedListeners(t,{tap:o=>{const a=o.touchStart.target;r&&(this.eMenu?.contains(a)||this.eFilterButton?.contains(a))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")}}),this.params.enableFilterButton){const n=new Wi(this.eFilterButton,!0);this.addManagedListeners(n,{tap:()=>this.params.showFilter(this.eFilterButton)}),this.addDestroyFunc(()=>n.destroy())}this.addDestroyFunc(()=>t.destroy()),i&&this.addDestroyFunc(()=>s.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return Hr(this.eMenu),void(this.eMenu=void 0);const e=this.menuService.isLegacyMenuEnabled();this.addInIcon(e?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!e),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedElementListeners(this.eMenu,{click:()=>this.params.showColumnMenu(this.eMenu)}),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(e){const t=this.params.column,r=this.menuService.isLegacyMenuEnabled();if(e&&!r){if(this.menuService.isFilterMenuInHeaderEnabled(t))return this.params.showFilter(this.eFilterButton??this.eMenu??this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu(this.eMenu??this.eFilterButton??this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.createBean(new Xc(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListeners(this.params.column,{movingChanged:()=>{this.lastMovingChanged=(new Date).getTime()}}),this.eLabel&&this.addManagedElementListeners(this.eLabel,{click:t=>{if(!(this.params.column.isMoving()||(new Date).getTime()-this.lastMovingChanged<50)){const a="ctrl"===this.gos.get("multiSortKey")?t.ctrlKey||t.metaKey:t.shiftKey;this.params.progressSort(a)}}});const e=()=>{const t=this.params.column.getSort();if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc","asc"===t),this.addOrRemoveCssClass("ag-header-cell-sorted-desc","desc"===t),this.addOrRemoveCssClass("ag-header-cell-sorted-none",!t),this.params.column.getColDef().showRowGroup){const s=!this.funcColsService.getSourceColumnsForGroupColumn(this.params.column)?.every(n=>this.params.column.getSort()==n.getSort());this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",s)}};this.addManagedEventListeners({sortChanged:e,columnRowGroupChanged:e})}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){this.eFilterButton&&(this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedElementListeners(this.eFilterButton,{click:()=>this.params.showFilter(this.eFilterButton)}):this.eFilterButton=void 0)}configureFilter(e,t,r){if(!e)return Hr(t),!1;const i=this.params.column;return this.addInIcon("filter",t,i),this.addManagedListeners(i,{filterChanged:r}),r(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();et(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){return e?this.eFilterButton??this.eMenu??this.getGui():this.eMenu??this.eFilterButton??this.getGui()}},$R=class extends Ge{constructor(){super('<div class="ag-header-group-cell-label" role="presentation">\n            <span data-ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span data-ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span data-ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>'),this.agOpened=de,this.agClosed=de,this.agLabel=de}wireBeans(e){this.columnModel=e.columnModel}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&q("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened",this.agOpened),this.addInIcon("columnGroupClosed",this.agClosed);const e=s=>{if(vi(s))return;const n=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")};this.addTouchAndClickListeners(this.agClosed,e),this.addTouchAndClickListeners(this.agOpened,e);const t=s=>{Zs(s)};this.addManagedElementListeners(this.agClosed,{dblclick:t}),this.addManagedElementListeners(this.agOpened,{dblclick:t}),this.addManagedElementListeners(this.getGui(),{dblclick:e}),this.updateIconVisibility();const r=this.params.columnGroup.getProvidedColumnGroup(),i=this.updateIconVisibility.bind(this);this.addManagedListeners(r,{expandedChanged:i,expandableChanged:i})}addTouchAndClickListeners(e,t){const r=new Wi(e,!0);this.addManagedListeners(r,{tap:t}),this.addDestroyFunc(()=>r.destroy()),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const t=this.params.columnGroup.isExpanded();et(this.agOpened,t),et(this.agClosed,!t)}else et(this.agOpened,!1),et(this.agClosed,!1)}addInIcon(e,t){const r=fr(e,this.gos,null);r&&t.appendChild(r)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return et(this.agOpened,!1),void et(this.agClosed,!1)}setupLabel(){const{displayName:e,columnGroup:t}=this.params;if(te(e)){const r=ti(e,!0);this.agLabel.textContent=r}this.addOrRemoveCssClass("ag-sticky-label",!t.getColGroupDef()?.suppressStickyLabel)}},qR=class extends Ge{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const r=document.createElement("span");r.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(r),this.setTemplateFromElement(e)}wireBeans(e){this.filterManager=e.filterManager}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const r=Math.abs(t),i=e.formatValue(r),s=te(i)?i:r,n=t>=0;this.eDelta.textContent=n?"\u2191"+s:"\u2193"+s,this.eDelta.classList.toggle("ag-value-change-delta-up",n),this.eDelta.classList.toggle("ag-value-change-delta-down",!n)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Vt(this.eDelta)}refresh(e,t=!1){const r=e.value;return r!==this.lastValue&&(te(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:te(e.value)?this.eValue.textContent=r:Vt(this.eValue),!this.filterManager?.isSuppressFlashingCellsBecauseFiltering())&&("number"==typeof r&&"number"==typeof this.lastValue&&this.showDelta(e,r-this.lastValue),this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=r,!0)}},XR=class extends Ge{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}wireBeans(e){this.filterManager=e.filterManager}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let r=e.value;return Ie(r)&&(r=""),r!==this.lastValue&&!this.filterManager?.isSuppressFlashingCellsBecauseFiltering()&&(t||this.addSlideAnimation(),this.lastValue=r,te(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:te(e.value)?this.eCurrent.textContent=r:Vt(this.eCurrent),!0)}},N=class{};N.BACKSPACE="Backspace",N.TAB="Tab",N.ENTER="Enter",N.ESCAPE="Escape",N.SPACE=" ",N.LEFT="ArrowLeft",N.UP="ArrowUp",N.RIGHT="ArrowRight",N.DOWN="ArrowDown",N.DELETE="Delete",N.F2="F2",N.PAGE_UP="PageUp",N.PAGE_DOWN="PageDown",N.PAGE_HOME="Home",N.PAGE_END="End",N.A="KeyA",N.C="KeyC",N.D="KeyD",N.V="KeyV",N.X="KeyX",N.Y="KeyY",N.Z="KeyZ";var QR=class extends Ge{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:i,disabled:s}=this.config;null!=s&&this.setDisabled(s),null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=r&&this.setLabelWidth(r),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){Vt(this.eLabel),"string"==typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(et(this.eLabel,!1),ir(this.eLabel,"presentation")):(et(this.eLabel,!0),ir(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const r=this.getGui().classList;return r.toggle("ag-label-align-left","left"===e),r.toggle("ag-label-align-right","right"===e),r.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||Sa(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return ro(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},ip=class extends QR{constructor(e,t,r,i){super(e,t,r),this.className=i}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),null!=r&&this.onValueChange(r),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();null==r||""==r||null!==function hR(e){return e.getAttribute("aria-label")}(e)?to(e,""):to(e,t??"")}setAriaLabel(e){return en(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Vr(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"})),this}},Ss=class extends ip{constructor(e,t,r="text",i="input"){super(e,e?.template??`\n            <div role="presentation">\n                <div data-ref="eLabel" class="ag-input-field-label"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <${i} data-ref="eInput" class="ag-input-field-input"></${i}>\n                </div>\n            </div>`,[],t),this.inputType=r,this.displayFieldTag=i,this.eLabel=de,this.eWrapper=de,this.eInput=de}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:e,inputWidth:t}=this.config;null!=e&&this.setInputName(e),null!=t&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return Sa(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return Pr(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return en(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return ro(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){return Pr(this.eInput,"autocomplete",!0===e?null:"string"==typeof e?e:"off"),this}},ya=class extends Ss{constructor(e,t="ag-checkbox",r="checkbox"){super(e,t,r),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;"boolean"==typeof e&&this.setReadOnly(e),"boolean"==typeof t&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"==typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const i=this.getInputElement();this.eventService.dispatchEvent({type:"checkboxChanged",id:i.id,name:i.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}},Zc={selector:"AG-CHECKBOX",component:ya},ZR=class extends Ge{constructor(){super('\n            <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[Zc]),this.eCheckbox=de}init(e){this.refresh(e);const t=this.eCheckbox.getInputElement();t.setAttribute("tabindex","-1"),Nf(t,"polite"),this.addManagedListeners(t,{click:r=>{if(Zs(r),this.eCheckbox.isDisabled())return;const i=this.eCheckbox.getValue();this.onCheckboxChanged(i)},dblclick:r=>{Zs(r)}}),this.addManagedElementListeners(this.params.eGridCell,{keydown:r=>{if(r.key===N.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===Je(this.gos)&&this.eCheckbox.toggle();const i=this.eCheckbox.getValue();this.onCheckboxChanged(i),r.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,r=!0;if(e.node.group&&e.column)if("boolean"==typeof e.value)t=e.value;else{const a=e.column.getColId();a.startsWith(ua)?t=null==e.value||""===e.value?void 0:"true"===e.value:e.node.aggData&&void 0!==e.node.aggData[a]?t=e.value??void 0:r=!1}else t=e.value??void 0;if(!r)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(t);const i=null!=e.disabled?e.disabled:!e.column?.isCellEditable(e.node);this.eCheckbox.setDisabled(i);const s=this.localeService.getLocaleTextFunc(),n=Ic(s,t),o=i?n:`${s("ariaToggleCellValue","Press SPACE to toggle cell value")} (${n})`;this.eCheckbox.setInputAriaLabel(o)}onCheckboxChanged(e){const{column:t,node:r,value:i}=this.params;this.eventService.dispatchEvent({type:"cellEditingStarted",column:t,colDef:t?.getColDef(),data:r.data,node:r,rowIndex:r.rowIndex,rowPinned:r.rowPinned,value:i});const s=this.params.node.setDataValue(this.params.column,e,"edit");this.eventService.dispatchEvent({type:"cellEditingStopped",column:t,colDef:t?.getColDef(),data:r.data,node:r,rowIndex:r.rowIndex,rowPinned:r.rowPinned,value:i,oldValue:i,newValue:e,valueChanged:s}),s||this.updateCheckbox(this.params)}},JR=class extends Ge{constructor(){super('<div class="ag-loading">\n            <span class="ag-loading-icon" data-ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" data-ref="eLoadingText"></span>\n        </div>'),this.eLoadingIcon=de,this.eLoadingText=de}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=fr("groupLoading",this.gos,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}},ek=class extends Ge{constructor(){super('<div class="ag-skeleton-container"></div>')}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>to(e.eParentOfValue)),to(e.eParentOfValue,t),e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.getGui().innerText=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");en(this.getGui(),t)}setupLoading(e){const r=gt(this.gos).createElement("div");r.classList.add("ag-skeleton-effect");const i=e.node.rowIndex;if(null!=i){const o=75+25*(i%2==0?Math.sin(i):Math.cos(i));r.style.width=`${o}%`}this.getGui().appendChild(r);const n=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");en(this.getGui(),n)}refresh(e){return!1}destroy(){super.destroy()}},sp=class extends Ge{constructor(){super()}destroy(){super.destroy()}},tk=class extends sp{init(){const e=fi(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??'<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>'),!e){const t=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("loadingOoo","Loading...")})}}},rk=class extends sp{init(){const e=fi(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??'<span class="ag-overlay-no-rows-center"></span>'),!e){const t=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=t("noRowsToShow","No Rows To Show")})}}},nn=class extends Ge{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},ik=class extends nn{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=ti(t,!0)}};function np(e,t,r,i){let s=t.map((a,l)=>({value:a,relevance:nk(e.toLowerCase(),a.toLocaleLowerCase()),idx:l}));if(s.sort((a,l)=>l.relevance-a.relevance),r&&(s=s.filter(a=>0!==a.relevance)),s.length>0&&i&&i>0){const l=s[0].relevance*i;s=s.filter(c=>l-c.relevance<0)}const n=[],o=[];for(const a of s)n.push(a.value),o.push(a.idx);return{values:n,indices:o}}function nk(e,t){const r=e.replace(/\s/g,""),i=t.replace(/\s/g,"");let s=0,n=-1;for(let o=0;o<r.length;o++){const a=i.indexOf(r[o],n+1);-1!==a&&(n=a,s+=100-100*n/1e4*100)}return s}var ok=class extends U{constructor(){super(...arguments),this.beanName="userComponentRegistry",this.agGridDefaults={agDragAndDropImage:VR,agColumnHeader:Qc,agColumnGroupHeader:$R,agSortIndicator:Xc,agAnimateShowChangeCellRenderer:qR,agAnimateSlideCellRenderer:XR,agLoadingCellRenderer:JR,agSkeletonCellRenderer:ek,agCheckboxCellRenderer:ZR,agLoadingOverlay:tk,agNoRowsOverlay:rk,agTooltipComponent:ik},this.agGridDefaultParams={},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agGroupCellRenderer:"@ag-grid-enterprise/row-grouping",agGroupRowRenderer:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}postConstruct(){const e=this.gos.get("components");null!=e&&kr(e,(t,r)=>this.registerJsComponent(t,r))}registerDefaultComponent(e,t,r){this.agGridDefaults[e]=t,r&&(this.agGridDefaultParams[e]=r)}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const r=(a,l,c)=>({componentFromFramework:l,component:a,params:c}),i=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(null!=i)return r(i,!0);const s=this.jsComps[t];if(s)return r(s,this.getFrameworkOverrides().isFrameworkComponent(s));const n=this.agGridDefaults[t];if(n)return r(n,!1,this.agGridDefaultParams[t]);const o=this.enterpriseAgDefaultCompsModule[t];return o?this.gos.assertModuleRegistered(o,`AG Grid '${e}' component: ${t}`):ac(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const i=np(t,[...Object.keys(this.agGridDefaults).filter(s=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(s)),...Object.keys(this.jsComps)],!0,.8).values;q(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&q(`         Did you mean: [${i.slice(0,3)}]?`),q(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}},pr=class So{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(r=>this.onDone(r),r=>this.onReject(r))}static all(t){return t.length?new So(r=>{let i=t.length;const s=new Array(i);t.forEach((n,o)=>{n.then(a=>{s[o]=a,i--,0===i&&r(s)})})}):So.resolve()}static resolve(t=null){return new So(r=>r(t))}then(t){return new So(r=>{1===this.status?r(t(this.resolution)):this.waiters.push(i=>r(t(i)))})}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(r=>r(t))}onReject(t){}},ak={propertyName:"dateComponent",cellRenderer:!1},lk={propertyName:"dragAndDropImageComponent",cellRenderer:!1},ck={propertyName:"headerComponent",cellRenderer:!1},dk={propertyName:"headerGroupComponent",cellRenderer:!1},op={propertyName:"cellRenderer",cellRenderer:!0},uk={propertyName:"cellRenderer",cellRenderer:!1},hk={propertyName:"loadingCellRenderer",cellRenderer:!0},gk={propertyName:"cellEditor",cellRenderer:!1},ap={propertyName:"innerRenderer",cellRenderer:!0},fk={propertyName:"loadingOverlayComponent",cellRenderer:!1},pk={propertyName:"noRowsOverlayComponent",cellRenderer:!1},mk={propertyName:"tooltipComponent",cellRenderer:!1},Jc={propertyName:"filter",cellRenderer:!1},vk={propertyName:"floatingFilterComponent",cellRenderer:!1},Ck={propertyName:"toolPanel",cellRenderer:!1},wk={propertyName:"statusPanel",cellRenderer:!1},xk={propertyName:"fullWidthCellRenderer",cellRenderer:!0},Sk={propertyName:"loadingCellRenderer",cellRenderer:!0},yk={propertyName:"groupRowRenderer",cellRenderer:!0},bk={propertyName:"detailCellRenderer",cellRenderer:!0},Ek={propertyName:"menuItem",cellRenderer:!1},lp=class nm extends U{constructor(){super(...arguments),this.beanName="userComponentFactory"}wireBeans(t){this.agComponentUtils=t.agComponentUtils,this.componentMetadataProvider=t.componentMetadataProvider,this.userComponentRegistry=t.userComponentRegistry,this.frameworkComponentWrapper=t.frameworkComponentWrapper,this.gridOptions=t.gridOptions}getDragAndDropImageCompDetails(t){return this.getCompDetails(this.gridOptions,lk,"agDragAndDropImage",t,!0)}getHeaderCompDetails(t,r){return this.getCompDetails(t,ck,"agColumnHeader",r)}getHeaderGroupCompDetails(t){const r=t.columnGroup.getColGroupDef();return this.getCompDetails(r,dk,"agColumnGroupHeader",t)}getFullWidthCellRendererDetails(t){return this.getCompDetails(this.gridOptions,xk,null,t,!0)}getFullWidthLoadingCellRendererDetails(t){return this.getCompDetails(this.gridOptions,Sk,"agLoadingCellRenderer",t,!0)}getFullWidthGroupCellRendererDetails(t){return this.getCompDetails(this.gridOptions,yk,"agGroupRowRenderer",t,!0)}getFullWidthDetailCellRendererDetails(t){return this.getCompDetails(this.gridOptions,bk,"agDetailCellRenderer",t,!0)}getInnerRendererDetails(t,r){return this.getCompDetails(t,ap,null,r)}getFullWidthGroupRowInnerCellRenderer(t,r){return this.getCompDetails(t,ap,null,r)}getCellRendererDetails(t,r){return this.getCompDetails(t,op,null,r)}getEditorRendererDetails(t,r){return this.getCompDetails(t,uk,null,r)}getLoadingCellRendererDetails(t,r){return this.getCompDetails(t,hk,"agSkeletonCellRenderer",r,!0)}getCellEditorDetails(t,r){return this.getCompDetails(t,gk,"agCellEditor",r,!0)}getFilterDetails(t,r,i){return this.getCompDetails(t,Jc,i,r,!0)}getDateCompDetails(t){return this.getCompDetails(this.gridOptions,ak,"agDateInput",t,!0)}getLoadingOverlayCompDetails(t){return this.getCompDetails(this.gridOptions,fk,"agLoadingOverlay",t,!0)}getNoRowsOverlayCompDetails(t){return this.getCompDetails(this.gridOptions,pk,"agNoRowsOverlay",t,!0)}getTooltipCompDetails(t){return this.getCompDetails(t.colDef,mk,"agTooltipComponent",t,!0)}getSetFilterCellRendererDetails(t,r){return this.getCompDetails(t,op,null,r)}getFloatingFilterCompDetails(t,r,i){return this.getCompDetails(t,vk,i,r)}getToolPanelCompDetails(t,r){return this.getCompDetails(t,Ck,null,r,!0)}getStatusPanelCompDetails(t,r){return this.getCompDetails(t,wk,null,r,!0)}getMenuItemCompDetails(t,r){return this.getCompDetails(t,Ek,"agMenuItem",r,!0)}getCompDetails(t,r,i,s,n=!1){const{propertyName:o,cellRenderer:a}=r;let p,{compName:l,jsComp:c,fwComp:d,paramsFromSelector:u,popupFromSelector:h,popupPositionFromSelector:g}=nm.getCompKeys(this.frameworkOverrides,t,r,s);const f=v=>{const k=this.userComponentRegistry.retrieve(o,v);k&&(c=k.componentFromFramework?void 0:k.component,d=k.componentFromFramework?k.component:void 0,p=k.params)};if(null!=l&&f(l),null==c&&null==d&&null!=i&&f(i),c&&a&&!this.agComponentUtils.doesImplementIComponent(c)&&(c=this.agComponentUtils.adaptFunction(o,c)),!c&&!d)return void(n&&Me(`Could not find component ${l}, did you forget to configure this component?`));const m=this.mergeParamsWithApplicationProvidedParams(t,r,s,u,p),w=null==c,C=c||d;return{componentFromFramework:w,componentClass:C,params:m,type:r,popupFromSelector:h,popupPositionFromSelector:g,newAgStackInstance:()=>this.newAgStackInstance(C,w,m,r)}}static getCompKeys(t,r,i,s){const{propertyName:n}=i;let o,a,l,c,d,u;if(r){const h=r,g=h[n+"Selector"],p=g?g(s):null,f=m=>{"string"==typeof m?o=m:null!=m&&!0!==m&&(t.isFrameworkComponent(m)?l=m:a=m)};p?(f(p.component),c=p.params,d=p.popup,u=p.popupPosition):f(h[n])}return{compName:o,jsComp:a,fwComp:l,paramsFromSelector:c,popupFromSelector:d,popupPositionFromSelector:u}}newAgStackInstance(t,r,i,s){let a;if(r){const c=this.componentMetadataProvider.retrieve(s.propertyName);a=this.frameworkComponentWrapper.wrap(t,c.mandatoryMethodList,c.optionalMethodList,s)}else a=new t;const l=this.initComponent(a,i);return null==l?pr.resolve(a):l.then(()=>a)}mergeParamsWithApplicationProvidedParams(t,r,i,s=null,n){const o=this.gos.getGridCommonParams();Qt(o,i),n&&Qt(o,n);const l=t&&t[r.propertyName+"Params"];return"function"==typeof l?Qt(o,l(i)):"object"==typeof l&&Qt(o,l),Qt(o,s),o}initComponent(t,r){if(this.createBean(t),null!=t.init)return t.init(r)}};function ao(e){return null!=e&&null!=e.getFrameworkComponentInstance?e.getFrameworkComponentInstance():e}var ba=class We{static register(t){We.__register(t,!0,void 0)}static registerModules(t){We.__registerModules(t,!0,void 0)}static __register(t,r,i){We.runVersionChecks(t),void 0!==i?(We.areGridScopedModules=!0,void 0===We.gridModulesMap[i]&&(We.gridModulesMap[i]={}),We.gridModulesMap[i][t.moduleName]=t):We.globalModulesMap[t.moduleName]=t,We.setModuleBased(r)}static __unRegisterGridModules(t){delete We.gridModulesMap[t]}static __registerModules(t,r,i){We.setModuleBased(r),t&&t.forEach(s=>We.__register(s,r,i))}static isValidModuleVersion(t){const[r,i]=t.version.split(".")||[],[s,n]=We.currentModuleVersion.split(".")||[];return r===s&&i===n}static runVersionChecks(t){We.currentModuleVersion||(We.currentModuleVersion=t.version);const r=i=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${i} Please update all modules to the same version.`;if(t.version?We.isValidModuleVersion(t)||Me(r(`'${t.moduleName}' is version ${t.version} but the other modules are version ${We.currentModuleVersion}.`)):Me(r(`'${t.moduleName}' is incompatible.`)),t.validate){const i=t.validate();i.isValid||Me(`${i.message}`)}}static setModuleBased(t){void 0===We.moduleBased?We.moduleBased=t:We.moduleBased!==t&&(Me("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),Me("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information."))}static __setIsBundled(){We.isBundled=!0}static __assertRegistered(t,r,i){if(this.__isRegistered(t,i))return!0;let s;if(We.isBundled)s=`AG Grid: unable to use ${r} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(We.moduleBased||void 0===We.moduleBased){const n=Object.entries(cf).find(([o,a])=>a===t)?.[0];s=`AG Grid: unable to use ${r} as the ${n} is not registered${We.areGridScopedModules?` for gridId: ${i}`:""}. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ${n} } from '${t}';\n    \n    ModuleRegistry.registerModules([ ${n} ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/`}else s=`AG Grid: unable to use ${r} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';`;return Me(s),!1}static __isRegistered(t,r){return!!We.globalModulesMap[t]||!!We.gridModulesMap[r]?.[t]}static __getRegisteredModules(t){return[...ia(We.globalModulesMap),...ia(We.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){return ia(We.gridModulesMap[t]??{})||[]}static __isPackageBased(){return!We.moduleBased}};ba.globalModulesMap={},ba.gridModulesMap={},ba.areGridScopedModules=!1;var xi=ba,Fk=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,e&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){Object.entries(e.providedBeanInstances).forEach(([t,r])=>{this.beans[t]=r}),e.beanClasses.forEach(t=>{const r=new t;r.beanName?this.beans[r.beanName]=r:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(r)}),e.derivedBeans?.forEach(t=>{const{beanName:r,bean:i}=t(this);this.beans[r]=i,this.createdBeans.push(i)}),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.initBeans([e],t),e}initBeans(e,t){e.forEach(r=>{r.preWireBeans?.(this.beans),r.wireBeans?.(this.beans)}),e.forEach(r=>r.preConstruct?.()),t&&e.forEach(t),e.forEach(r=>r.postConstruct?.())}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},Rk=class extends Fk{init(e){this.gridId=e.gridId,this.beans.context=this,super.init(e)}destroy(){super.destroy(),xi.__unRegisterGridModules(this.gridId)}getGridId(){return this.gridId}},cp=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(cp||{}),Ak=class extends U{constructor(){super(...arguments),this.beanName="dragAndDropService",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.dragService=e.dragService,this.mouseEventService=e.mouseEventService,this.environment=e.environment,this.userComponentFactory=e.userComponentFactory}addDragSource(e,t=!1){const r={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:r,dragSource:e}),this.dragService.addDragSource(r)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return e&&e.comp?e.comp:null}removeDragSource(e){const t=this.dragSourceAndParamsList.find(r=>r.dragSource===e);t&&(this.dragService.removeDragSource(t.params),qt(this.dragSourceAndParamsList,t))}destroy(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.dragSource.onDragStarted?.(),this.createDragAndDropImageComponent()}onDragStop(e){if(this.dragSource?.onDragStopped?.(),this.lastDropTarget?.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.clearDragAndDropProperties()}onDragCancel(){this.dragSource?.onDragCancelled?.(),this.lastDropTarget?.onDragCancel&&this.lastDropTarget.onDragCancel(this.createDropTargetEvent(this.lastDropTarget,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e,t=!1){const r=this.getHorizontalDirection(e),i=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const s=this.dropTargets.filter(o=>this.isMouseOnDropTarget(e,o)),n=this.findCurrentDropTarget(e,s);if(n!==this.lastDropTarget){if(this.leaveLastTargetIfExists(e,r,i,t),null!==this.lastDropTarget&&null===n&&this.dragSource?.onGridExit?.(this.dragItem),null===this.lastDropTarget&&null!==n&&this.dragSource?.onGridEnter?.(this.dragItem),this.enterDragTargetIfExists(n,e,r,i,t),n&&this.dragAndDropImageComp){const{comp:o,promise:a}=this.dragAndDropImageComp;o?o.setIcon(n.getIconName?n.getIconName():null):a.then(l=>{l&&l.setIcon(n.getIconName?n.getIconName():null)})}this.lastDropTarget=n}else if(n&&n.onDragging){const o=this.createDropTargetEvent(n,e,r,i,t);n.onDragging(o)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,r=[[e.getContainer()]];return t?r.concat(t):r}allContainersIntersect(e,t){for(const r of t){const{width:i,height:s,left:n,right:o,top:a,bottom:l}=r.getBoundingClientRect();if(0===i||0===s)return!1;if(!(e.clientX>=n&&e.clientX<o&&e.clientY>=a&&e.clientY<l))return!1}return!0}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let i=!1;for(const o of r)if(this.allContainersIntersect(e,o)){i=!0;break}const{eElement:s,type:n}=this.dragSource;return!(t.targetContainsSource&&!t.getContainer().contains(s))&&i&&t.isInterestedIn(n,s)}findCurrentDropTarget(e,t){const r=t.length;if(0===r)return null;if(1===r)return t[0];const s=qn(this.gos).elementsFromPoint(e.clientX,e.clientY);for(const n of s)for(const o of t)if(-1!==MF(this.getAllContainersFromDropTarget(o)).indexOf(n))return o;return null}enterDragTargetIfExists(e,t,r,i,s){if(e&&e.onDragEnter){const n=this.createDropTargetEvent(e,t,r,i,s);e.onDragEnter(n)}}leaveLastTargetIfExists(e,t,r,i){if(!this.lastDropTarget)return;if(this.lastDropTarget.onDragLeave){const n=this.createDropTargetEvent(this.lastDropTarget,e,t,r,i);this.lastDropTarget.onDragLeave(n)}const s=this.getDragAndDropImageComponent();s&&s.setIcon(null)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(r=>r.external).find(r=>r.getContainer()===e.getContainer())||null}isDropZoneWithinThisGrid(e){const r=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return r.contains(i)}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,r=e.clientX;return t===r?null:t>r?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,r=e.clientY;return t===r?null:t>r?0:1}createDropTargetEvent(e,t,r,i,s){const n=e.getContainer(),o=n.getBoundingClientRect(),{dragItem:a,dragSource:l}=this;return this.gos.addGridCommonParams({event:t,x:t.clientX-o.left,y:t.clientY-o.top,vDirection:i,hDirection:r,dragSource:l,fromNudge:s,dragItem:a,dropZoneTarget:n})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();if(!t)return;const r=t.getGui(),s=r.getBoundingClientRect().height,n=function RR(){return document.body?.clientWidth??(window.innerHeight||document.documentElement?.clientWidth||-1)}()-2,o=function kR(){return document.body?.clientHeight??(window.innerHeight||document.documentElement?.clientHeight||-1)}()-2;if(!r.offsetParent)return;const l=Kf(r.offsetParent),{clientY:c,clientX:d}=e;let u=c-l.top-s/2,h=d-l.left-10;const g=gt(this.gos),p=g.defaultView||window,f=p.pageYOffset||g.documentElement.scrollTop,m=p.pageXOffset||g.documentElement.scrollLeft;n>0&&h+r.clientWidth>n+m&&(h=n+m-r.clientWidth),h<0&&(h=0),o>0&&u+r.clientHeight>o+f&&(u=o+f-r.clientHeight),u<0&&(u=0),r.style.left=`${h}px`,r.style.top=`${u}px`}removeDragAndDropImageComponent(){if(this.dragAndDropImageComp){const{comp:e}=this.dragAndDropImageComp;if(e){const t=e.getGui();this.dragAndDropImageParent&&this.dragAndDropImageParent.removeChild(t),this.destroyBean(e)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e}=this;if(!e)return;const r=this.userComponentFactory.getDragAndDropImageCompDetails({dragSource:e}).newAgStackInstance();this.dragAndDropImageComp={promise:r},r.then(i=>{!i||!this.isAlive()||(this.processDragAndDropImageComponent(i),this.dragAndDropImageComp.comp=i)})}processDragAndDropImageComponent(e){const{dragSource:t,mouseEventService:r,environment:i}=this;if(!t)return;const s=e.getGui();s.style.setProperty("position","absolute"),s.style.setProperty("z-index","9999"),r.stampTopLevelGridCompWithGridInstance(s),i.applyThemeClasses(s),e.setIcon(null);let{dragItemName:n}=t;lc(n)&&(n=n()),e.setLabel(n||""),s.style.top="20px",s.style.left="20px";const o=gt(this.gos);let a=null,l=null;try{a=o.fullscreenElement}catch{}finally{a||(a=qn(this.gos));l=a.querySelector("body")||(a instanceof ShadowRoot?a:a instanceof Document?a?.documentElement:a)}this.dragAndDropImageParent=l,l?l.appendChild(s):q("Could not find document body, it is needed for drag and drop.")}},Ik=class extends U{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.sortController=e.sortController,this.filterManager=e.filterManager,this.selectionService=e.selectionService,this.mouseEventService=e.mouseEventService,this.ctrlsService=e.ctrlsService,this.funcColsService=e.funcColsService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){it(this.gos)&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(this,e=>{const t=e.gridBodyCtrl;this.autoScrollService=new class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const r=t||this.shouldSkipVerticalScroll();if(r&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),s=this.scrollByTick;this.tickLeft=e.clientX<i.left+s,this.tickRight=e.clientX>i.right-s,this.tickUp=e.clientY<i.top+s&&!r,this.tickDown=e.clientY>i.bottom-s&&!r,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}}({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:r=>t.getScrollFeature().setVerticalScrollPosition(r),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return 2===e}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){return!!(this.funcColsService.getRowGroupColumns().length||this.filterManager?.isAnyFilterPresent()||this.sortController.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const i=[...this.selectionService.getSelectedNodes()].sort((s,n)=>null==s.rowIndex||null==n.rowIndex?0:this.getRowIndexNumber(s)-this.getRowIndexNumber(n));if(-1!==i.indexOf(t))return i}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach(t=>{t.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const r=this.isFromThisGrid(e),i=this.gos.get("rowDragManaged"),s=e.dragItem.rowNodes;i&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!r?this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clientSideRowModel.highlightRowAtPixel(s[0],t):this.moveRows(s,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(Le(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),r=t&&1===t.highlighted,i=this.mouseEventService.getNormalisedPosition(e).y,s=e.dragItem.rowNodes;let n=r?1:0;if(this.isFromThisGrid(e))s.forEach(o=>{o.rowTop<i&&(n-=1)}),this.moveRows(s,i,n);else{const o=Xs(this.gos);let a=this.clientSideRowModel.getRowIndexAtPixel(i)+1;0===this.clientSideRowModel.getHighlightPosition(i)&&a--,this.clientSideRowModel.updateRowData({add:s.filter(l=>!this.clientSideRowModel.getRowNode(o?.({data:l.data,level:0,rowPinned:l.rowPinned})??l.data.id)).map(l=>l.data),addIndex:a})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,r=0){this.clientSideRowModel.ensureRowsAtPixel(e,t,r)&&(this.focusService.clearFocusedCell(),this.rangeService?.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer())return void q("addRowDropZone - A container target needs to be provided");if(this.dragAndDropService.findExternalZone(e))return void q("addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=i=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",i))}),e.onDragLeave&&(t.onDragLeave=i=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",i))}),e.onDragging&&(t.onDragging=i=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",i))}),e.onDragStop&&(t.onDragStop=i=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",i))}),e.onDragCancel&&(t.onDragCancel=i=>{e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",i))}));const r={isInterestedIn:i=>2===i,getIconName:()=>"move",external:!0,...t};this.dragAndDropService.addDropTarget(r),this.addDestroyFunc(()=>this.dragAndDropService.removeDropTarget(r))}getRowDropZone(e){const t=this.getContainer.bind(this),r=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),s=this.onDragging.bind(this),n=this.onDragStop.bind(this),o=this.onDragCancel.bind(this);let a;return a=e?{getContainer:t,onDragEnter:e.onDragEnter?l=>{r(l),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",l))}:r,onDragLeave:e.onDragLeave?l=>{i(l),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",l))}:i,onDragging:e.onDragging?l=>{s(l),e.onDragging(this.draggingToRowDragEvent("rowDragMove",l))}:s,onDragStop:e.onDragStop?l=>{n(l),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",l))}:n,onDragCancel:e.onDragCancel?l=>{o(l),e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",l))}:o,fromGrid:!0}:{getContainer:t,onDragEnter:r,onDragLeave:i,onDragging:s,onDragStop:n,onDragCancel:o,fromGrid:!0},a}draggingToRowDragEvent(e,t){const r=this.mouseEventService.getNormalisedPosition(t).y;let n,o,s=-1;switch(r>this.pageBoundsService.getCurrentPageHeight()||(s=this.rowModel.getRowIndexAtPixel(r),n=this.rowModel.getRow(s)),t.vDirection){case 1:o="down";break;case 0:o="up";break;default:o=null}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:s,overNode:n,y:r,vDirection:o})}dispatchGridEvent(e,t){const r=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(r)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clearRowHighlight()}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(t=>{t.setDragging(!1)})}},Lk=class extends U{constructor(){super(...arguments),this.beanName="dragService",this.dragEndFunctions=[],this.dragSources=[]}wireBeans(e){this.mouseEventService=e.mouseEventService}destroy(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement;t.removeEventListener("mousedown",e.mouseDownListener),e.touchEnabled&&t.removeEventListener("touchstart",e.touchStartListener,{passive:!0})}removeDragSource(e){const t=this.dragSources.find(r=>r.dragSource===e);t&&(this.removeListener(t),qt(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:r,includeTouch:i,stopPropagationForTouch:s}=e;r.addEventListener("mousedown",t);let n=null;const o=this.gos.get("suppressTouch");i&&!o&&(n=a=>{$c(a.target)||(s&&a.stopPropagation(),this.onTouchStart(e,a))},r.addEventListener("touchstart",n,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:n,touchEnabled:!!i})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const r=t.touches[0];this.touchLastTime=r,this.touchStart=r;const s=l=>this.onTouchUp(l,e.eElement),o=t.target,a=[{target:qn(this.gos),type:"touchmove",listener:l=>{l.cancelable&&l.preventDefault()},options:{passive:!1}},{target:o,type:"touchmove",listener:l=>this.onTouchMove(l,e.eElement),options:{passive:!0}},{target:o,type:"touchend",listener:s,options:{passive:!0}},{target:o,type:"touchcancel",listener:s,options:{passive:!0}}];this.addTemporaryEvents(a),0===e.dragStartPixels&&this.onCommonMove(r,this.touchStart,e.eElement)}onMouseDown(e,t){const r=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||r._alreadyProcessedByDragService||(r._alreadyProcessedByDragService=!0,0!==t.button))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const a=qn(this.gos);this.addTemporaryEvents([{target:a,type:"mousemove",listener:c=>this.onMouseMove(c,e.eElement)},{target:a,type:"mouseup",listener:c=>this.onMouseUp(c,e.eElement)},{target:a,type:"contextmenu",listener:c=>c.preventDefault()},{target:a,type:"keydown",listener:c=>{c.key===N.ESCAPE&&this.cancelDrag(e.eElement)}}]),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{const{target:r,type:i,listener:s,options:n}=t;r.addEventListener(i,s,n)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{const{target:r,type:i,listener:s,options:n}=t;r.removeEventListener(i,s,n)})})}isEventNearStartEvent(e,t){const{dragStartPixels:r}=this.currentDragParams;return rp(e,t,te(r)?r:4)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,r){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;this.dragging=!0,this.eventService.dispatchEvent({type:"dragStarted",target:r}),this.currentDragParams.onDragStart(t),this.currentDragParams.onDragging(t)}this.currentDragParams.onDragging(e)}onTouchMove(e,t){const r=this.getFirstActiveTouch(e.touches);r&&this.onCommonMove(r,this.touchStart,t)}onMouseMove(e,t){ri()&&gt(this.gos).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&"mousemove"===e.type&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){return!!e.target?.tagName.toLocaleLowerCase()?.match("^a$|textarea|input|select|button")}onTouchUp(e,t){let r=this.getFirstActiveTouch(e.changedTouches);r||(r=this.touchLastTime),this.onUpCommon(r,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventService.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventService.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(e=>e()),this.dragEndFunctions.length=0}},ed=class extends Ge{constructor(e,t,r,i,s,n){super(),this.cellValueFn=e,this.rowNode=t,this.column=r,this.customGui=i,this.dragStartPixels=s,this.suppressVisibilityChange=n,this.dragSource=null}wireBeans(e){this.beans=e}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(fr("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new Ok(this,this.beans,this.rowNode,this.column):new _k(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const t=this.beans.selectionService.getSelectedNodes();return-1!==t.indexOf(this.rowNode)?t:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&q("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:i=>{i?.preventDefault()}})[0]);const r=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{const i=this.getDragItem(),s=i.rowNodes?.length||1,n=this.getRowDragText(this.column);return n?n(i,s):1===s?this.cellValueFn():`${s} ${r("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},dp=class extends U{constructor(e,t,r){super(),this.parent=e,this.rowNode=t,this.column=r}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let r=!0,i=!1;this.column&&(r=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),i=lc(this.column.getColDef().rowDrag)),i?(this.parent.setDisplayed(!0,t),this.parent.setVisible(r,t)):(this.parent.setDisplayed(r,t),this.parent.setVisible(!0,t))}}},_k=class extends dp{constructor(e,t,r,i){super(e,r,i),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},Ok=class extends dp{constructor(e,t,r,i){super(e,r,i),this.beans=t}postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventService,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const t=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),r=t&&t.shouldPreventRowMove(),i=this.gos.get("suppressRowDrag"),s=this.beans.dragAndDropService.hasExternalDropZones();this.setDisplayedOrVisible(r&&!s||i)}},Bk=new Set(["localEventService","__objectId","sticky","__autoHeights","checkAutoHeightsDebounced"]),lo=class qi{constructor(t){this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=qi.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(t){this.setDataCommon(t,!1)}updateData(t){this.setDataCommon(t,!0)}setDataCommon(t,r){const i=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const s=this.createDataChangedEvent(t,i,r);this.localEventService?.dispatchEvent(s)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(t,r,i){return{type:"dataChanged",node:this,oldData:r,newData:t,update:i}}getRowIndexString(){return null==this.rowIndex?(Me("Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid."),null):"top"===this.rowPinned?qi.ID_PREFIX_TOP_PINNED+this.rowIndex:"bottom"===this.rowPinned?qi.ID_PREFIX_BOTTOM_PINNED+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new qi(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(t,r){const i=te(this.id)?this.createDaemonNode():null,s=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(r),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,i);const n=this.createDataChangedEvent(t,s,!1);this.localEventService?.dispatchEvent(n)}checkRowSelectable(){const t=vc(this.beans.gos);this.setRowSelectable(!t||t(this))}setRowSelectable(t,r){if(this.selectable!==t){if(this.selectable=t,this.dispatchRowEvent("selectableChanged"),r)return;if(ms(this.beans.gos)){const s=this.calculateSelectedFromChildren();return void this.setSelectedParams({newValue:s??!1,source:"selectableChanged"})}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const r=Xs(this.beans.gos);if(r)if(this.data){const i=this.parent?.getRoute()??[];this.id=r({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(qi.ID_PREFIX_ROW_GROUP)&&Me(`Row IDs cannot start with ${qi.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`)}else this.id=void 0;else this.id=t}setRowTop(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.dispatchRowEvent("topChanged"),this.setDisplayed(null!==t))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(t){this.hovered=t}isHovered(){return this.hovered}setMaster(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.dispatchRowEvent("masterChanged"))}setGroup(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.checkRowSelectable(),this.dispatchRowEvent("groupChanged"))}setRowHeight(t,r=!1){this.rowHeight=t,this.rowHeightEstimated=r,this.dispatchRowEvent("heightChanged")}setRowAutoHeight(t,r){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[r.getId()]=t,null!=t&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=Yt(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let t=!1,r=!0,i=0;const s=this.__autoHeights;null==s||(this.beans.visibleColsService.getAllAutoHeightCols().forEach(a=>{let l=s[a.getId()];if(null==l){if(!this.beans.columnModel.isColSpanActive())return void(t=!0);{let c=[];switch(a.getPinned()){case"left":c=this.beans.visibleColsService.getLeftColsForRow(this);break;case"right":c=this.beans.visibleColsService.getRightColsForRow(this);break;case null:c=this.beans.columnViewportService.getColsWithinViewport(this)}if(c.includes(a))return void(t=!0);l=-1}}else r=!1;l>i&&(i=l)}),t)||((r||i<10)&&(i=Ni(this.beans.gos,this).height),i==this.rowHeight)||(this.setRowHeight(i),this.beans.rowModel.onRowHeightChangedDebounced?.())}setExpanded(t,r,i){if(this.expanded===t)return;this.expanded=t,this.dispatchRowEvent("expandedChanged");const s={...this.createGlobalRowEvent("rowGroupOpened"),expanded:t,event:r||null};this.beans.rowNodeEventThrottle.dispatchExpanded(s,i),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(t){return this.beans.gos.addGridCommonParams({type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}setDataValue(t,r,i){const n=(()=>"string"!=typeof t?t:this.beans.columnModel.getCol(t)??this.beans.columnModel.getColDefCol(t))(),o=this.beans.valueService.getValueForDisplay(n,this);if(this.beans.gos.get("readOnlyEdit"))return this.beans.eventService.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:n,colDef:n.getColDef(),data:this.data,node:this,oldValue:o,newValue:r,value:r,source:i}),!1;const a=this.beans.valueService.setValue(this,n,r,i);return this.dispatchCellChangedEvent(n,r,o),this.checkRowSelectable(),a}setGroupValue(t,r){const i=this.beans.columnModel.getCol(t);Ie(this.groupData)&&(this.groupData={});const s=i.getColId(),n=this.groupData[s];n!==r&&(this.groupData[s]=r,this.dispatchCellChangedEvent(i,r,n))}setAggData(t){const r=this.aggData;if(this.aggData=t,this.localEventService){const i=s=>{const n=this.aggData?this.aggData[s]:void 0,o=r?r[s]:void 0;if(n===o)return;const a=this.beans.columnModel.getCol(s);a&&this.dispatchCellChangedEvent(a,n,o)};for(const s in r)i(s);for(const s in t)(!r||!(s in r))&&i(s)}}updateHasChildren(){let t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(pi(this.beans.gos)){const i=this.beans.gos.get("treeData"),s=this.beans.gos.get("isServerSideGroup");t=!this.stub&&!this.footer&&(i?!!s&&s(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(t,r,i){const s={type:"cellChanged",node:this,column:t,newValue:r,oldValue:i};this.localEventService?.dispatchEvent(s)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!this.footer&&(this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(r=>r.depthFirstSearch(t)),t(this)}calculateSelectedFromChildren(){let t=!1,r=!1;if(!this.childrenAfterGroup?.length)return this.selectable?this.selected:null;for(let i=0;i<this.childrenAfterGroup.length;i++){const s=this.childrenAfterGroup[i];let n=s.isSelected();if(!s.selectable){const o=s.calculateSelectedFromChildren();if(null===o)continue;n=o}switch(n){case!0:t=!0;break;case!1:r=!0;break;default:return}}return t&&r?void 0:!!t||!r&&(this.selectable?this.selected:null)}setSelectedInitialValue(t){this.selected=t}dispatchRowEvent(t){this.localEventService?.dispatchEvent({type:t,node:this})}selectThisNode(t,r,i="api"){if(!this.selectable&&t||this.selected===t)return!1;this.selected=t,this.dispatchRowEvent("rowSelected");const o=this.sibling;return o&&o.footer&&o.localEventService&&o.dispatchRowEvent("rowSelected"),this.beans.eventService.dispatchEvent({...this.createGlobalRowEvent("rowSelected"),event:r||null,source:i}),!0}setSelected(t,r=!1,i="api"){"boolean"!=typeof i?this.setSelectedParams({newValue:t,clearSelection:r,rangeSelect:!1,source:i}):q("since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(t){return this.rowPinned?(q("cannot select pinned rows"),0):void 0===this.id?(q("cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected({...t,nodes:[this.footer?this.sibling:this]})}isRowPinned(){return!!this.rowPinned}addEventListener(t,r){this.localEventService||(this.localEventService=new Ys),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.localEventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new Fc(this.beans.frameworkOverrides));const i=this.frameworkEventListenerService?.wrap(r)??r;this.localEventService.addEventListener(t,i)}removeEventListener(t,r){if(!this.localEventService)return;const i=this.frameworkEventListenerService?.unwrap(r)??r;this.localEventService.removeEventListener(t,i),this.localEventService.noRegisteredListenersExist()&&(this.localEventService=null)}onMouseEnter(){this.dispatchRowEvent("mouseEnter")}onMouseLeave(){this.dispatchRowEvent("mouseLeave")}isFullWidthCell(){if(q("since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option."),this.detail)return!0;const t=this.beans.gos.getCallback("isFullWidthRow");return!!t&&t({rowNode:this})}getRoute(){if(-1===this.level)return[];if(null==this.key)return;const t=[];let r=this;for(;r&&null!=r.key;)t.push(r.key),r=r.parent;return t.reverse()}createFooter(){if(this.sibling)return;const t=new qi(this.beans);Object.keys(this).forEach(r=>{Bk.has(r)||(t[r]=this[r])}),t.footer=!0,t.setRowTop(null),t.setRowIndex(null),t.oldRowTop=null,t.id="rowGroupFooter_"+this.id,t.sibling=this,this.sibling=t}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}setFirstChild(t){this.firstChild!==t&&(this.firstChild=t,this.dispatchRowEvent("firstChildChanged"))}setLastChild(t){this.lastChild!==t&&(this.lastChild=t,this.dispatchRowEvent("lastChildChanged"))}setChildIndex(t){this.childIndex!==t&&(this.childIndex=t,this.dispatchRowEvent("childIndexChanged"))}setDisplayed(t){this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}setDragging(t){this.dragging!==t&&(this.dragging=t,this.dispatchRowEvent("draggingChanged"))}setHighlighted(t){this.highlighted!==t&&(this.highlighted=t,this.dispatchRowEvent("rowHighlightChanged"))}setAllChildrenCount(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.dispatchRowEvent("allChildrenCountChanged"))}setRowIndex(t){this.rowIndex!==t&&(this.rowIndex=t,this.dispatchRowEvent("rowIndexChanged"))}setUiLevel(t){this.uiLevel!==t&&(this.uiLevel=t,this.dispatchRowEvent("uiLevelChanged"))}};lo.ID_PREFIX_ROW_GROUP="row-group-",lo.ID_PREFIX_TOP_PINNED="t-",lo.ID_PREFIX_BOTTOM_PINNED="b-",lo.OBJECT_ID_SEQUENCE=0;var Si=lo,Gk=class extends Ge{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}wireBeans(e){this.filterManager=e.filterManager,this.columnModel=e.columnModel}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){return this.filterWrapper?.filterPromise??null}afterInit(){return this.filterWrapper?.filterPromise?.then(()=>{})??pr.resolve()}afterGuiAttached(e){this.filterWrapper?.filterPromise?.then(t=>{t?.afterGuiAttached?.(e)})}afterGuiDetached(){this.filterWrapper?.filterPromise?.then(e=>{e?.afterGuiDetached?.()})}createFilter(e){const{column:t,source:r}=this;this.filterWrapper=this.filterManager?.getOrCreateFilterWrapper(t)??null,this.filterWrapper?.filterPromise&&this.filterWrapper.filterPromise.then(i=>{const s=i.getGui();te(s)||q(`getGui method from filter returned ${s}; it should be a DOM element.`),this.appendChild(s),e&&this.eventService.dispatchEvent({type:"filterOpened",column:t,source:r,eGui:this.getGui()})})}onFilterDestroyed(e){("api"===e.source||"paramsUpdated"===e.source)&&e.column.getId()===this.column.getId()&&this.columnModel.getColDefCol(this.column)&&(Vt(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},up="ag-resizer-wrapper",Ui=(e,t)=>`<div data-ref="${e}Resizer" class="ag-resizer ag-resizer-${t}"></div>`,Hk=`<div class="${up}">\n        ${Ui("eTopLeft","topLeft")}\n        ${Ui("eTop","top")}\n        ${Ui("eTopRight","topRight")}\n        ${Ui("eRight","right")}\n        ${Ui("eBottomRight","bottomRight")}\n        ${Ui("eBottom","bottom")}\n        ${Ui("eBottomLeft","bottomLeft")}\n        ${Ui("eLeft","left")}\n    </div>`,zk=class extends U{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupService=e.popupService,this.resizeObserverService=e.resizeObserverService,this.dragService=e.dragService}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,r=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(r,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:r,width:i,minHeight:s,height:n,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const d=zr(this.element);if(d){const u=this.findBoundaryElement(),h=window.getComputedStyle(u);if(null!=h.minWidth){const g=u.offsetWidth-this.element.offsetWidth;c=parseInt(h.minWidth,10)-g}if(null!=h.minHeight){const g=u.offsetHeight-this.element.offsetHeight;l=parseInt(h.minHeight,10)-g}}if(this.minHeight=s||l,this.minWidth=r||c,i&&this.setWidth(i),n&&this.setHeight(n),(!i||!n)&&this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(d&&t){let u=this.boundaryEl,h=!0;if(u||(u=this.findBoundaryElement(),h=!1),u){const g=parseFloat(u.style.top),p=parseFloat(u.style.left);h?this.offsetElement(isNaN(p)?0:p,isNaN(g)?0:g):this.setPosition(p,g)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const r=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(r),this.moveElementDragListener=r):(this.dragService.removeDragSource(r),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"==typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const i=!!e[t],s=this.getResizerElement(t),n={dragStartPixels:0,eElement:s,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragService.addDragSource(n),this.resizeListeners.push(n),s.style.pointerEvents="all"):s.style.pointerEvents="none",this.resizable[t]=i)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width=`${t}px`),-1!==e&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,r=this.element;let i=!1;if("string"==typeof e&&-1!==e.indexOf("%"))no(r,e),e=$f(r),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const s=this.getAvailableHeight();s&&e>s&&(e=s)}this.getHeight()!==e&&(i?(r.style.maxHeight="unset",r.style.minHeight="unset"):t?no(r,e):(r.style.height=`${e}px`,r.style.flex="0 0 auto",this.lastSize.height="number"==typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:r}=this.offsetParent;if(!r)return null;const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),n=e?this.position.y:i.top,o=e?0:s.top;let a=0;if(t){const c=this.element.parentElement;if(c){const{bottom:d}=c.getBoundingClientRect();a=d-i.bottom}}return r+o-n-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:r}=this.config;let i=!1;if("string"==typeof e&&-1!==e.indexOf("%"))Vr(t,e),e=va(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:s}=this.offsetParent,n=r?this.position.x:this.element.getBoundingClientRect().left;s&&e+n>s&&(e=s-n)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Vr(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width="number"==typeof e?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:r}=this.config,i=r?this.boundaryEl:this.element;i&&(this.popupService.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){this.config.forcePopupParentAsOffsetParent&&(e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),()=>{const r=this.getAvailableHeight();this.element.style.setProperty("max-height",`${r}px`)}):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0)))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:r,isTop:i,anywhereWithin:s,topBuffer:n}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!r,!!s,o)?0:o,movementY:this.shouldSkipY(t,!!i,n,a)?0:a}}shouldSkipX(e,t,r,i){const s=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:s.left;let l=a<=0&&n.left>=e.clientX||n.right<=e.clientX&&n.right<=o.right;return!!l||(l=t?i<0&&e.clientX>a+n.left||i>0&&e.clientX<a+n.left:r?i<0&&e.clientX>o.right||i>0&&e.clientX<a+n.left:i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t,r=0,i){const s=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:s.top;let l=a<=0&&n.top>=e.clientY||n.bottom<=e.clientY&&n.bottom<=o.bottom;return!!l||(l=t?i<0&&e.clientY>a+n.top+r||i>0&&e.clientY<a+n.top:i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[data-ref=eTopLeftResizer]")},top:{element:e.querySelector("[data-ref=eTopResizer]")},topRight:{element:e.querySelector("[data-ref=eTopRightResizer]")},right:{element:e.querySelector("[data-ref=eRightResizer]")},bottomRight:{element:e.querySelector("[data-ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[data-ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[data-ref=eBottomLeftResizer]")},left:{element:e.querySelector("[data-ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const r=(new DOMParser).parseFromString(Hk,"text/html").body;e.appendChild(r.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${up}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:r,forcePopupParentAsOffsetParent:i}=this.config;!r&&!i&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(r=>!r.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,r=0;for(let i=0;i<e.length;i++){const s=e[i],n=!!s.style.flex&&"0 0 auto"!==s.style.flex;if(s===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(n){const l=window.getComputedStyle(s);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=s.offsetHeight,a=s.offsetWidth;t+=o,r+=a}return{height:t,width:r}}applySizeToSiblings(e){let t=null;const r=this.getSiblings();if(r){for(let i=0;i<r.length;i++){const s=r[i];s!==t&&(e?s.style.height=`${s.offsetHeight}px`:s.style.width=`${s.offsetWidth}px`,s.style.flex="0 0 auto",s===this.element&&(t=r[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:r}=this.config,{isTop:i,isRight:s,isBottom:n,isLeft:o}=this.currentResizer,a=s||o,l=n||i,{movementX:c,movementY:d}=this.calculateMouseMovement({e,isLeft:o,isTop:i}),u=this.position.x,h=this.position.y;let g=0,p=0;if(a&&c){const f=o?-1:1,m=this.getWidth(),w=m+c*f;let C=!1;o&&(g=m-w,(u+g<=0||w<=this.minWidth)&&(C=!0,g=0)),C||this.setWidth(w)}if(l&&d){const f=i?-1:1,m=this.getHeight(),w=m+d*f;let C=!1;i?(p=m-w,(h+p<=0||w<=this.minHeight)&&(C=!0,p=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<w&&this.getMinSizeOfSiblings().height+w>this.element.parentElement.offsetHeight&&(C=!0),C||this.setHeight(w)}this.updateDragStartPosition(e.clientX,e.clientY),((t||r)&&g||p)&&this.offsetElement(u+g,h+p)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:r}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:s,movementY:n}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+s,r+n),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.offsetParent=this.config.forcePopupParentAsOffsetParent?this.popupService.getPopupParent():this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},hp=class om extends U{constructor(t,r={}){super(),this.eFocusableElement=t,this.callbacks=r,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;const s=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,i.shiftKey);s&&(s.focus(),i.preventDefault())},...r}}wireBeans(t){this.focusService=t.focusService}postConstruct(){this.eFocusableElement.classList.add(om.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedElementListeners(this.eFocusableElement,{focusin:this.callbacks.onFocusIn}),this.callbacks.onFocusOut&&this.addManagedElementListeners(this.eFocusableElement,{focusout:this.callbacks.onFocusOut})}addKeyDownListeners(t){this.addManagedElementListeners(t,{keydown:r=>{if(!r.defaultPrevented&&!vi(r)){if(this.callbacks.shouldStopEventPropagation(r))return void Zs(r);r.key===N.TAB?this.callbacks.onTabKeyDown(r):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(r)}}})}};hp.FOCUS_MANAGED_CLASS="ag-focus-managed";var ys=hp,gp={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function td(e,t){return Ea(e)?(null!=e.debounceMs&&q("debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}function Ea(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}var Vk=class extends Ge{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=de,this.buttonListeners=[]}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.resetTemplate(),this.createManagedBean(new ys(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new zk(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const r=`\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" data-ref="eFilterBody">\n                    ${this.createBodyTemplate()}\n                </div>\n            </form>`;this.setTemplate(r,this.getAgComponents(),e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.providedFilterParams=e,this.applyActive=Ea(e),this.resetButtonsPanel(e)}updateParams(e){this.providedFilterParams=e,this.applyActive=Ea(e),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(e,t){const{buttons:r,readOnly:i}=t??{},{buttons:s,readOnly:n}=e;if(i===n&&Kn(r,s))return;const o=s&&s.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(Vt(this.eButtonsPanel),this.buttonListeners.forEach(c=>c()),this.buttonListeners=[]):o&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!o)return void(this.eButtonsPanel&&Hr(this.eButtonsPanel));const a=document.createDocumentFragment(),l=c=>{let d,u;switch(c){case"apply":d=this.translate("applyFilter"),u=p=>this.onBtApply(!1,!1,p);break;case"clear":d=this.translate("clearFilter"),u=()=>this.onBtClear();break;case"reset":d=this.translate("resetFilter"),u=()=>this.onBtReset();break;case"cancel":d=this.translate("cancelFilter"),u=p=>{this.onBtCancel(p)};break;default:return void q("Unknown button type specified")}const g=so(`<button\n                    type="${"apply"===c?"submit":"button"}"\n                    data-ref="${c}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${d}\n                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(g,{click:u})),a.append(g)};s.forEach(c=>l(c)),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=td(this.providedFilterParams,this.getDefaultDebounceMs()),t=Yt(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const r=()=>{this.onUiChanged(!1,"prevent"),t?.()};null!=e?this.setModelIntoUi(e).then(r):this.resetUiToDefaults().then(r)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const t=this.getModelFromUi();if(!this.isModelValid(t))return!1;const r=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(r,t)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,t=!1,r){r&&r.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:"columnFilter"});const{closeOnApply:i}=this.providedFilterParams;i&&this.applyActive&&!e&&!t&&this.close(r)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const r=e&&e.key;let i;("Enter"===r||"Space"===r)&&(i={keyboardEvent:e}),this.hidePopup(i),this.hidePopup=null}onUiChanged(e=!1,t){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const r=this.isModelValid(this.getModelFromUi()),i=this.queryForHtmlElement('[data-ref="applyFilterButton"]');i&&ro(i,!r)}e&&!t||"immediately"===t?this.onBtApply(e):(!this.applyActive&&!t||"debounce"===t)&&this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){if(!this.positionableFeature||"toolPanel"===e)return;const t="floatingFilter"===e||"columnFilter"===e,{positionableFeature:r,gos:i}=this;t?(r.restoreLastSize(),r.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.providedFilterParams;return this.providedFilterParams=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,gp[e])}getCellValue(e){return this.providedFilterParams.getValue(e)}getPositionableElement(){return this.eFilterBody}},Wk=class extends ya{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},Uk=class extends Ge{constructor(e="default",t=!1){super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),!this.unFocusable&&this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case N.ENTER:if(this.highlightedEl){const r=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(r)}else this.setValue(this.getValue());break;case N.DOWN:case N.UP:e.preventDefault(),this.navigate(t);break;case N.PAGE_DOWN:case N.PAGE_UP:case N.PAGE_HOME:case N.PAGE_END:e.preventDefault(),this.navigateToPage(t)}}navigate(e){const t=e===N.DOWN;let r;if(this.highlightedEl){let s=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);s=Math.min(Math.max(s,0),this.itemEls.length-1),r=this.itemEls[s]}else r=this.itemEls[t?0:this.itemEls.length-1];this.highlightItem(r)}navigateToPage(e){if(!this.highlightedEl||0===this.itemEls.length)return;const t=this.itemEls.indexOf(this.highlightedEl),r=this.options.length-1,i=this.itemEls[0].clientHeight,s=Math.floor(this.getGui().clientHeight/i);let n=-1;e===N.PAGE_HOME?n=0:e===N.PAGE_END?n=r:e===N.PAGE_DOWN?n=Math.min(t+s,r):e===N.PAGE_UP&&(n=Math.max(t-s,0)),-1!==n&&this.highlightItem(this.itemEls[n])}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){const{value:t,text:r}=e,i=r||t;return this.options.push({value:t,text:i}),this.renderOption(t,i),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(e=>{Hr(e)}),this.itemEls=[]}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");e.forEach((t,r)=>{(function vR(e,t){Ar(e,"posinset",t)})(t,r+1),function mR(e,t){Ar(e,"setsize",t)}(t,e.length)})}renderOption(e,t){const r=gt(this.gos),i=r.createElement("div");ir(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const s=r.createElement("span");i.appendChild(s),s.textContent=t,this.unFocusable||(i.tabIndex=-1),this.itemEls.push(i),this.addManagedListeners(i,{mouseover:()=>this.highlightItem(i),mousedown:n=>{n.preventDefault(),n.stopPropagation(),this.setValue(e)}}),this.createManagedBean(new sn({getTooltipValue:()=>t,getGui:()=>i,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>s.scrollWidth>s.clientWidth})),this.getGui().appendChild(i)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(t),this;const r=this.options.findIndex(i=>i.value===e);if(-1!==r){const i=this.options[r];this.value=i.value,this.displayValue=i.text,this.highlightItem(this.itemEls[r]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);-1!==e&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!zr(e))return;this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(this.activeClass),fa(this.highlightedEl,!0);const t=this.getGui(),{scrollTop:r,clientHeight:i}=t,{offsetTop:s,offsetHeight:n}=e;(s+n>r+i||s<r)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){!this.highlightedEl||!zr(this.highlightedEl)||(this.highlightedEl.classList.remove(this.activeClass),fa(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},jk=class extends ip{constructor(e){if(super(e,e?.template||'\n            <div class="ag-picker-field" role="presentation">\n                <div data-ref="eLabel"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">\n                    <div data-ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div data-ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=de,this.eWrapper=de,this.eDisplayField=de,this.eIcon=de,this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:r,variableWidth:i,minPickerWidth:s,maxPickerWidth:n}=e;null!=t&&(this.pickerGap=t),this.variableWidth=!!i,null!=r&&this.setPickerMaxHeight(r),null!=s&&this.setPickerMinWidth(s),null!=n&&this.setPickerMaxWidth(n)}wireBeans(e){this.popupService=e.popupService}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:r,inputWidth:i}=this.config;if(r){const s=fr(r,this.gos);s&&this.eIcon.appendChild(s)}null!=i&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),ga(e,!1),this.ariaRole&&ir(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}this.skipClick?this.skipClick=!1:this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case N.UP:case N.DOWN:case N.ENTER:case N.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case N.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:r,pickerAriaLabelValue:i,modalPicker:s=!0}=this.config,n={modal:s,eChild:e,closeOnEsc:!0,closedCallback:()=>{const h=mf(this.gos);this.beforeHidePicker(),h&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(r,i),anchorToElement:this.eWrapper};e.style.position="absolute";const o=this.popupService.addPopup(n),{maxPickerHeight:a,minPickerWidth:l,maxPickerWidth:c,variableWidth:d}=this;d?(l&&(e.style.minWidth=l),e.style.width=Yc(va(this.eWrapper)),c&&(e.style.maxWidth=c)):Sa(e,c??va(this.eWrapper));const u=a??`${Kc(this.popupService.getPopupParent())}px`;return e.style.setProperty("max-height",u),this.alignPickerToComponent(),o.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,r=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:r,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){this.isAlive()&&(ga(this.getAriaElement(),e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e))}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return Sa(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return"number"==typeof e&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return"number"==typeof e&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return"number"==typeof e&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},rd=class extends jk{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox",...e})}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:r}=this.config;null!=e&&this.addOptions(e),null!=t&&this.setValue(t,!0),r&&null==t&&(this.eDisplayField.textContent=r),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new Uk("select",!0)),this.listComponent.setParentComponent(this);const e=this.listComponent.getAriaElement(),t=`ag-select-list-${this.listComponent.getCompId()}`;e.setAttribute("id",t),function ER(e,t){Dr(e,"controls",t.id),to(t,e.id)}(this.getAriaElement(),e),this.listComponent.addManagedListeners(this.listComponent,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})}}),this.listComponent.addManagedListeners(this.listComponent,{fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===N.TAB&&this.hidePicker(),t){case N.ENTER:case N.UP:case N.DOWN:case N.PAGE_UP:case N.PAGE_DOWN:case N.PAGE_HOME:case N.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case N.ESCAPE:super.onKeyDown(e);break;case N.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e)}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this}setValue(e,t,r){if(this.value===e||!this.listComponent)return this;if(r||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue())return this;let s=this.listComponent.getDisplayValue();return null==s&&this.config.placeholder&&(s=this.config.placeholder),this.eDisplayField.textContent=s,this.setTooltip({newTooltipText:s??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(e,t)}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),super.destroy()}},$k={selector:"AG-SELECT",component:rd},fp=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(e=>{"string"!=typeof e&&([["displayKey"],["displayName"],["predicate","test"]].every(i=>!!i.some(s=>null!=e[s])||(q(`ignoring FilterOptionDef as it doesn't contain one of '${i}'`),!1))?this.customFilterOptions[e.displayKey]=e:this.filterOptions=this.filterOptions.filter(i=>i===e)||[])})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const t=this.filterOptions[0];"string"==typeof t?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:q("invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else q("no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},pp=class extends Vk{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:i}=t;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:"inRange"===e?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,r)=>{t.setValue(0===r?e:this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const r=!e.operator,i=!t.operator;if(!r&&i||r&&!i)return!1;let n;return n=r?this.areSimpleModelsEqual(e,t):e.operator===t.operator&&mi(e.conditions,t.conditions,(l,c)=>this.areSimpleModelsEqual(l,c)),n}shouldRefresh(e){const t=this.getModel(),r=t?t.conditions??[t]:null,i=e.filterOptions?.map(n=>"string"==typeof n?n:n.displayKey)??this.getDefaultFilterOptions();return!(r&&!r.every(n=>void 0!==i.find(o=>o===n.type))||"number"==typeof e.maxNumConditions&&r&&r.length>e.maxNumConditions)}refresh(e){return!(!this.shouldRefresh(e)||!super.refresh(e)||(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),0))}setModelIntoUi(e){if(e.operator){const r=e;let i=r.conditions;null==i&&(i=[],q("Filter model is missing 'conditions'"));const s=this.validateAndUpdateConditions(i),n=this.getNumConditions();if(s<n)this.removeConditionsAndOperators(s);else if(s>n)for(let a=n;a<s;a++)this.createJoinOperatorPanel(),this.createOption();const o="OR"===r.operator;this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),i.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const r=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(r.type,!0),this.setConditionIntoUi(r,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),pr.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),q('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),t=this.maxNumConditions),t}doesFilterPass(e){const t=this.getModel();if(null==t)return!0;const{operator:r}=t,i=[];return r?i.push(...t.conditions??[]):i.push(t),i[r&&"OR"===r?"some":"every"](n=>this.individualConditionPasses(e,n))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new fp,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){this.maxNumConditions=e.maxNumConditions??2,this.maxNumConditions<1&&(q('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=e.numAlwaysVisibleConditions??1,this.numAlwaysVisibleConditions<1&&(q('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(q('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new rd);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const r=this.getNumConditions()-1;this.forEachPositionInput(r,i=>this.resetInput(i)),this.addChangedListeners(e,r)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),r=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const i=this.eJoinOperatorPanels.length-1,s=this.joinOperatorId++;this.resetJoinOperatorAnd(t,i,s),this.resetJoinOperatorOr(r,i,s),this.isReadOnly()||(t.onValueChange(this.listener),r.onValueChange(this.listener))}createJoinOperator(e,t,r){const i=this.createManagedBean(new Wk);return e.push(i),i.addCssClass("ag-filter-condition-operator"),i.addCssClass(`ag-filter-condition-operator-${r}`),t.appendChild(i.getGui()),i}getDefaultJoinOperator(e){return"AND"===e||"OR"===e?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map(t=>"string"==typeof t?this.createBoilerplateListOption(t):this.createCustomListOption(t))}putOptionsIntoDropdown(e){this.filterListOptions.forEach(t=>{e.addOption(t)}),e.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,r=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:r?this.localeService.getLocaleTextFunc()(r.displayKey,r.displayName):this.translate(t)}}createBodyTemplate(){return""}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const r=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<r){this.removeConditionsAndOperators(r+1);const i=e+1,s=r-i;s>0&&this.removeConditionsAndOperators(i,s),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((i,s)=>{const n=this.isConditionDisabled(s,e);i.setDisabled(n||this.filterListOptions.length<=1),1===s&&(ro(this.eJoinOperatorPanels[0],n),this.eJoinOperatorsAnd[0].setDisabled(n),this.eJoinOperatorsOr[0].setDisabled(n))}),this.eConditionBodies.forEach((i,s)=>{et(i,this.isConditionBodyVisible(s))});const r="OR"===(t??this.getJoinOperator());this.eJoinOperatorsAnd.forEach(i=>{i.setValue(!r,!0)}),this.eJoinOperatorsOr.forEach(i=>{i.setValue(r,!0)}),this.forEachInput((i,s,n,o)=>{this.setElementDisplayed(i,s<o),this.setElementDisabled(i,this.isConditionDisabled(n,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const r=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,r,t),this.removeComponents(this.eJoinOperatorsAnd,r,t),this.removeComponents(this.eJoinOperatorsOr,r,t)}removeElements(e,t,r){this.removeItems(e,t,r).forEach(s=>Hr(s))}removeComponents(e,t,r){this.removeItems(e,t,r).forEach(s=>{Hr(s.getGui()),this.destroyBean(s)})}removeItems(e,t,r){return null==r?e.splice(t):e.splice(t,r)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus)if(this.isReadOnly())this.eFilterBody.focus();else{const t=this.getInputs(0)[0];if(!t)return;t instanceof Ss&&t.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,r=-1,i=!1;const s=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))-1===t&&(t=o,r=o);else{const l=o<t;(o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1)||l)&&(this.removeConditionsAndOperators(o,1),i=!0,l&&r--)}let n=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),n=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),n=!0),n&&this.updateConditionStatusesAndValues(r,s),i&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}getPlaceholderText(e,t){let r=this.translate(e);if(lc(this.filterPlaceholder)){const i=this.filterPlaceholder,s=this.eTypes[t].getValue();r=i({filterOptionKey:s,filterOption:this.translate(s),placeholder:r})}else"string"==typeof this.filterPlaceholder&&(r=this.filterPlaceholder);return r}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc();this.forEachInput((t,r,i,s)=>{if(!(t instanceof Ss))return;const n=0===r&&s>1?"inRangeStart":0===r?"filterOoo":"inRangeEnd",o=0===r&&s>1?e("ariaFilterFromValue","Filter from value"):0===r?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(n,i)),t.setInputAriaLabel(o)})}setElementValue(e,t,r){e instanceof Ss&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof Ge&&et(e.getGui(),t)}setElementDisabled(e,t){e instanceof Ge&&ro(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Ss&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,r)=>{this.forEachPositionTypeInput(r,t,e)})}forEachPositionInput(e,t){const r=this.getConditionType(e);this.forEachPositionTypeInput(e,r,t)}forEachPositionTypeInput(e,t,r){const i=this.getNumberOfInputs(t),s=this.getInputs(e);for(let n=0;n<s.length;n++){const o=s[n];null!=o&&r(o,n,e,i)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||"empty"===this.getConditionType(e)||this.getValues(e).some(r=>null==r))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinOperatorsAnd.forEach((t,r)=>this.resetJoinOperatorAnd(t,r,this.joinOperatorId+r)),this.eJoinOperatorsOr.forEach((t,r)=>this.resetJoinOperatorOr(t,r,this.joinOperatorId+r)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),pr.resolve()}resetType(e){const r=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(r).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,r){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),r)}resetJoinOperatorOr(e,t,r){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),r)}resetJoinOperator(e,t,r,i,s){this.updateJoinOperatorDisabled(e.setValue(r,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${s}`).setLabel(i),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t)),this.eJoinOperatorsOr.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const r=this.mapValuesFromModel(e);this.forEachInput((i,s,n)=>{n===t&&this.setElementValue(i,null!=r[s]?r[s]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,r,i)=>{this.setElementValue(t,0===r&&0===i?e:null,!0)})}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,r=>{this.attachElementOnChange(r,this.listener)}))}individualConditionPasses(e,t){const r=this.getCellValue(e.node),i=this.mapValuesFromModel(t),s=this.optionsFactory.getCustomOption(t.type);return this.evaluateCustomFilter(s,i,r)??(null==r?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,r,t,e))}evaluateCustomFilter(e,t,r){if(null==e)return;const{predicate:i}=e;return null==i||t.some(s=>null==s)?void 0:i(t,r)}isBlank(e){return null==e||"string"==typeof e&&0===e.trim().length}hasInvalidInputs(){return!1}},mp=class extends pp{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case"equals":if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case"notEqual":if(this.scalarFilterParams.includeBlanksInNotEqual)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case"lessThan":case"lessThanOrEqual":if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case"inRange":if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,r){const i=this.comparator(),s=null!=e[0]?i(e[0],t):0;switch(r.type){case"equals":return 0===s;case"notEqual":return 0!==s;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const n=i(e[1],t);return this.scalarFilterParams.inRangeInclusive?s>=0&&n<=0:s>0&&n<0}case"blank":return this.isBlank(t);case"notBlank":return!this.isBlank(t);default:return q('Unexpected type of filter "'+r.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}};function vp(e){return!(e.altKey||e.ctrlKey||e.metaKey)&&1===e.key?.length}function id(e,t,r,i,s){const n=i?i.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;const o=e.addGridCommonParams({event:t,editing:s,column:i,node:r,data:r.data,colDef:i.getColDef()});return!(!n||!n(o))}var bs=class extends Ss{constructor(e,t="ag-text-field",r="text"){super(e,t,r)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=te(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListeners(this.eInput,{keydown:r=>{vp(r)&&r.key&&!e.test(r.key)&&r.preventDefault()},paste:r=>{const i=r.clipboardData?.getData("text");i&&i.split("").some(s=>!e.test(s))&&r.preventDefault()}})}},Fa={selector:"AG-INPUT-TEXT-FIELD",component:bs},sd=class extends bs{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListeners(this.eInput,{blur:()=>{const s=parseFloat(this.eInput.value),n=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==n&&this.setValue(n)},wheel:this.onWheel.bind(this)}),this.eInput.step="any";const{precision:e,min:t,max:r,step:i}=this.config;"number"==typeof e&&this.setPrecision(e),"number"==typeof t&&this.setMin(t),"number"==typeof r&&this.setMax(r),"number"==typeof i&&this.setStep(i)}onWheel(e){Je(this.gos)===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(null==this.precision)return e;if(t){const i=parseFloat(e).toFixed(this.precision);return parseFloat(i).toString()}const r=String(e).split(".");if(r.length>1){if(r[1].length<=this.precision)return e;if(this.precision>0)return`${r[0]}.${r[1].slice(0,this.precision)}`}return r[0]}setMin(e){return this.min===e||(this.min=e,Pr(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,Pr(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,Pr(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue(r=>super.setValue(r,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,r){if(te(r)){let i=this.isScientificNotation(r);if(i&&this.eInput.validity.valid)return e(r);if(i||(i=(r=this.adjustPrecision(r))!=this.normalizeValue(r)),i)return t(r)}return e(r)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return"string"==typeof e&&e.includes("e")}},rT={selector:"AG-INPUT-NUMBER-FIELD",component:sd},Cp=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],nd=class{constructor(e,t,r){this.localeService=e,this.optionsFactory=t,this.valueFormatter=r}getModelAsString(e){if(!e)return null;const t=null!=e.operator,r=this.localeService.getLocaleTextFunc();if(t){const i=e,n=(i.conditions??[]).map(a=>this.getModelAsString(a)),o="AND"===i.operator?"andCondition":"orCondition";return n.join(` ${r(o,gp[o])} `)}if("blank"===e.type||"notBlank"===e.type)return r(e.type,e.type);{const i=e,s=this.optionsFactory.getCustomOption(i.type),{displayKey:n,displayName:o,numberOfInputs:a}=s||{};return n&&o&&0===a?(r(n,o),o):this.conditionToString(i,s)}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){return this.valueFormatter?this.valueFormatter(e??null)??"":String(e)}},wp=class extends nd{conditionToString(e,t){const{numberOfInputs:r}=t||{};return"inRange"==e.type||2===r?`${this.formatValue(e.filter)}-${this.formatValue(e.filterTo)}`:null!=e.filter?this.formatValue(e.filter):`${e.type}`}};function od(e){const{allowedCharPattern:t}=e??{};return t??null}var xp=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],Sp=class extends nd{conditionToString(e,t){const{numberOfInputs:r}=t||{};return"inRange"==e.type||2===r?`${e.filter}-${e.filterTo}`:null!=e.filter?`${e.filter}`:`${e.type}`}};function yp(e){const t=e&&e.trim();return""===t?e:t}function bp(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseInt(e);return isNaN(t)?void 0:t}}function ii(e,t=Number.MAX_VALUE){return r=>{const i=bp(r);if(!(null==i||i<e||i>t))return i}}function co(e,t){return e.toString().padStart(t,"0")}function Mr(e,t=!0,r="-"){if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(s=>co(s,2)).join(r);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(s=>co(s,2)).join(":")),i}var ad=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function uo(e,t="YYYY-MM-DD"){const r=co(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={YYYY:()=>r.slice(r.length-4,r.length),YY:()=>r.slice(r.length-2,r.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>co(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${ad(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${ad(e.getDate())}`,DD:()=>co(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>s[e.getDay()],ddd:()=>s[e.getDay()].slice(0,3),dd:()=>s[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${ad(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return t.replace(o,a=>a in n?n[a]():a)}function sr(e){if(!e)return null;const[t,r]=e.split(" ");if(!t)return null;const i=t.split("-").map(u=>parseInt(u,10));if(3!==i.filter(u=>!isNaN(u)).length)return null;const[s,n,o]=i,a=new Date(s,n-1,o);if(a.getFullYear()!==s||a.getMonth()!==n-1||a.getDate()!==o)return null;if(!r||"00:00:00"===r)return a;const[l,c,d]=r.split(":").map(u=>parseInt(u,10));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),d>=0&&d<60&&a.setSeconds(d),a}var Fp=class{constructor(e,t,r,i,s){this.alive=!0,this.context=e,this.eParent=i,t.getDateCompDetails(r).newAgStackInstance().then(a=>{this.alive?(this.dateComp=a,a&&(i.appendChild(a.getGui()),a.afterGuiAttached&&a.afterGuiAttached(),this.tempValue&&a.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled),s?.(this))):e.destroyBean(a)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){et(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&"function"==typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}updateParams(e){let t=!1;this.dateComp?.refresh&&"function"==typeof this.dateComp.refresh&&null!==this.dateComp.refresh(e)&&(t=!0),!t&&this.dateComp?.onParamsUpdated&&"function"==typeof this.dateComp.onParamsUpdated&&null!==this.dateComp.onParamsUpdated(e)&&q("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}setDateCompDisabled(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}},Rp=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],kp=class extends nd{constructor(e,t,r){super(t,r),this.dateFilterParams=e}conditionToString(e,t){const{type:r}=e,{numberOfInputs:i}=t||{},s="inRange"==r||2===i,n=sr(e.dateFrom),o=sr(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;return s?`${null!==n?uo(n,a):"null"}-${null!==o?uo(o,a):"null"}`:null!=n?uo(n,a):`${r}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},ld=class extends U{constructor(e,t,r,i){super(),this.columnOrGroup=e,this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=i,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?Le(this.colsSpanning):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=te(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),r=e.getOldLeft(),i=this.modifyLeftForPrintLayout(e,r),s=this.modifyLeftForPrintLayout(e,t);this.setLeft(i),this.actualLeft=s,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===s&&this.setLeft(s)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!Pt(this.beans.gos,"print")||"left"===e.getPinned())return t;const i=this.beans.visibleColsService.getColsLeftWidth();return"right"===e.getPinned()?i+this.beans.visibleColsService.getBodyContainerWidth()+t:i+t}setLeft(e){if(te(e)&&(this.eCell.style.left=`${e}px`),ft(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&function SR(e,t){Ar(e,"colspan",t)}(this.ariaEl,t.length)}}};function Ap(e,t,r,i){return Ie(e)?[]:function Mp(e,t,r,i,s){if(Ie(e))return[];let n;if("function"==typeof e){const o=function cT(e,t,r,i){return t.addGridCommonParams({colDef:e,column:r,columnGroup:i})}(t,r,i,s);n=e(o)}else n=e;return"string"==typeof n?[n]:Array.isArray(n)?[...n]:[]}(e.headerClass,e,t,r,i)}function Pp(e,t,r){e.addOrRemoveCssClass("ag-column-first",r.isColAtEdge(t,"first")),e.addOrRemoveCssClass("ag-column-last",r.isColAtEdge(t,"last"))}var dT=0,Ip=class am extends U{constructor(t,r,i){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=t,this.parentRowCtrl=i,this.beans=r,this.instanceId=t.getUniqueId()+"-"+dT++}wireBeans(t){this.pinnedWidthService=t.pinnedWidthService,this.focusService=t.focusService,this.userComponentFactory=t.userComponentFactory,this.ctrlsService=t.ctrlsService,this.dragAndDropService=t.dragAndDropService,this.menuService=t.menuService}postConstruct(){const t=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],t),this.addManagedEventListeners({overlayExclusiveChanged:t})}shouldStopEventPropagation(t){const{headerRowIndex:r,column:i}=this.focusService.getFocusedHeader();return function Jk(e,t,r,i){const s=i.getDefinition(),n=s&&s.suppressHeaderKeyboardEvent;return!!te(n)&&!!n(e.addGridCommonParams({colDef:s,column:i,headerRowIndex:r,event:t}))}(this.gos,t,r,i)}getWrapperHasFocus(){return Je(this.gos)===this.eGui}setGui(t,r){this.eGui=t,this.addDomData(r),r.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),r.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onGuiFocus(){this.eventService.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(t){const{wrapperElement:r,checkMeasuringCallback:i,compBean:s}=t,{animationFrameService:n,resizeObserverService:o,columnModel:a,gos:l}=this.beans,c=f=>{if(!this.isAlive()||!s.isAlive())return;const{paddingTop:m,paddingBottom:w,borderBottomWidth:C,borderTopWidth:v}=xs(this.getGui()),O=r.offsetHeight+(m+w+C+v);if(f<5){const y=gt(l);if(!y||!y.contains(r)||0==O)return void n.requestAnimationFrame(()=>c(f+1))}a.setColHeaderHeight(this.column,O)};let u,d=!1;const h=()=>{const f=this.column.isAutoHeaderHeight();f&&!d&&g(),!f&&d&&p()},g=()=>{d=!0,c(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),u=o.observeResize(r,()=>c(0))},p=()=>{d=!1,u&&u(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),u=void 0};h(),s.addDestroyFunc(()=>p()),s.addManagedListeners(this.column,{widthChanged:()=>d&&c(0)}),s.addManagedEventListeners({sortChanged:()=>{d&&window.setTimeout(()=>c(0))}}),i&&i(h)}onDisplayedColumnsChanged(){const{comp:t,column:r,beans:i,eGui:s}=this;!t||!r||!s||(Pp(t,r,i.visibleColsService),Hf(s,i.visibleColsService.getAriaColIndex(r)))}addResizeAndMoveKeyboardListeners(t){this.resizeFeature&&t.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const t=this.focusService.isHeaderFocusSuppressed();this.eGui&&Pr(this.eGui,"tabindex",t?null:"-1")}onGuiKeyDown(t){const r=Je(this.gos),i=t.key===N.LEFT||t.key===N.RIGHT;if(this.isResizing&&(t.preventDefault(),t.stopImmediatePropagation()),r!==this.eGui||!t.shiftKey&&!t.altKey||((this.isResizing||i)&&(t.preventDefault(),t.stopImmediatePropagation()),!i))return;const s=t.key===N.LEFT!==this.gos.get("enableRtl"),n=cp[s?"Left":"Right"];if(t.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const o=this.getViewportAdjustedResizeDiff(t);this.resizeHeader(o,t.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(n)}getViewportAdjustedResizeDiff(t){let r=this.getResizeDiff(t);if(this.column.getPinned()){const s=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),o=io(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(s+n+r>o){if(!(o>s+n))return 0;r=o-s-n}}return r}getResizeDiff(t){let r=t.key===N.LEFT!==this.gos.get("enableRtl");const i=this.column.getPinned(),s=this.gos.get("enableRtl");return i&&s!==("right"===i)&&(r=!r),(r?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(t){const r=this.getWrapperHasFocus();switch(t.key){case N.PAGE_DOWN:case N.PAGE_UP:case N.PAGE_HOME:case N.PAGE_END:r&&t.preventDefault()}}addDomData(t){const r=am.DOM_DATA_KEY_HEADER_CTRL;ps(this.gos,this.eGui,r,this),t.addDestroyFunc(()=>ps(this.gos,this.eGui,r,null))}getGui(){return this.eGui}focus(t){return!!this.eGui&&(this.lastFocusEvent=t||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(t,r,i){const s=t??r;this.gos.get("preventDefaultOnContextMenu")&&s.preventDefault(),this.menuService.isHeaderContextMenuEnabled(i)&&this.menuService.showHeaderContextMenu(i,t,r),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(t,r){this.eventService.dispatchEvent({type:t,column:r})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null}};Ip.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";var Ra=Ip,cd=class extends U{wireBeans(e){this.columnHoverService=e.columnHoverService}constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListeners(this.element,{mouseout:this.onMouseOut.bind(this),mouseover:this.onMouseOver.bind(this)})}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}},xe="32.2.1",Lp={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},_p=["january","february","march","april","may","june","july","august","september","october","november","december"],Op=class extends Ge{wireBeans(e){this.columnNameService=e.columnNameService}getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return e?.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.getDefaultOption());let r;r=e.operator?e.conditions[0]:e,this.lastType=r.type}canWeEditAfterModelFromParentFilter(e){return e?!e.operator&&this.isTypeEditable(e.type):this.isTypeEditable(this.lastType)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){this.optionsFactory=new fp,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const r=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(r)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:r}=t||{};return null==r||1==r}isTypeEditable(e){return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&["inRange","empty","blank","notBlank"].indexOf(e)<0}getAriaLabel(e){return`${this.columnNameService.getDisplayNameForColumn(e.column,"header",!0)} ${this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Bp=class extends U{constructor(e){super(),this.params=e,this.eFloatingFilterTextInput=de,this.valueChangedListener=()=>{}}setupGui(e){this.eFloatingFilterTextInput=this.createManagedBean(new bs(this.params?.config));const t=this.eFloatingFilterTextInput.getGui();e.appendChild(t);const r=i=>this.valueChangedListener(i);this.addManagedListeners(t,{input:r,keydown:r})}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},Np=class extends Op{constructor(){super(...arguments),this.eFloatingFilterInputContainer=de}postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" data-ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Ea(this.params.filterParams),!this.isReadOnly()){const r=td(this.params.filterParams,this.getDefaultDebounceMs()),i=Yt(this.syncUpWithParentFilter.bind(this),r);this.floatingFilterInputService.setValueChangedListener(i)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();Vt(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){if(this.applyActive&&e.key!==N.ENTER)return;let r=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(r=yp(r),this.floatingFilterInputService.setValue(r,!0)),this.params.parentFilterInstance(i=>{i&&i.onFloatingFilterChanged(this.getLastType()||null,r||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}},TT=class extends U{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new sd),this.eFloatingFilterTextInput=this.createManagedBean(new bs),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),r=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(r),this.setupListeners(t,i=>this.valueChangedListener(i)),this.setupListeners(r,i=>this.valueChangedListener(i))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}},dd={version:xe,moduleName:"@ag-grid-community/filter-core",beans:[class extends U{constructor(){super(...arguments),this.beanName="filterManager",this.advancedFilterModelUpdateQueue=[]}wireBeans(e){this.columnModel=e.columnModel,this.dataTypeService=e.dataTypeService,this.quickFilterService=e.quickFilterService,this.advancedFilterService=e.advancedFilterService,this.columnFilterService=e.columnFilterService}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvancedFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:r})=>this.onAdvancedFilterEnabledChanged(r),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",r=>this.setAdvancedFilterModel(r.currentValue)),this.quickFilterService&&this.addManagedListeners(this.quickFilterService,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return"function"==typeof e&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return"function"==typeof t&&t(e)}setFilterModel(e,t="api"){this.isAdvancedFilterEnabled()?this.warnAdvancedFilters():this.columnFilterService?.setFilterModel(e,t)}getFilterModel(){return this.columnFilterService?.getFilterModel()??{}}isColumnFilterPresent(){return!!this.columnFilterService?.isColumnFilterPresent()}isAggregateFilterPresent(){return!!this.columnFilterService?.isAggregateFilterPresent()}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){e?this.columnFilterService?.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilterService?.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){return!!this.advancedFilterService?.isEnabled()}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}resetQuickFilterCache(){this.quickFilterService?.resetQuickFilterCache()}refreshFiltersForAggregations(){pc(this.gos)&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:r,columns:i=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.columnFilterService?this.columnFilterService.updateBeforeFilterChanged(e):pr.resolve()).then(()=>{const s={source:t,type:"filterChanged",columns:i};r&&Qt(s,r),this.eventService.dispatchEvent(s),this.columnFilterService?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.columnFilterService?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilterService?.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!pc(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isAggregateFilterPresent()&&!this.columnFilterService.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode)||this.isColumnFilterPresent()&&!this.columnFilterService.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)||this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))}isFilterActive(e){return!!this.columnFilterService?.isFilterActive(e)}getOrCreateFilterWrapper(e){return this.columnFilterService?.getOrCreateFilterWrapper(e)??null}getDefaultFloatingFilter(e){return this.columnFilterService.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.columnFilterService.createFilterParams(e,t)}isFilterAllowed(e){return!this.isAdvancedFilterEnabled()&&!!this.columnFilterService?.isFilterAllowed(e)}getFloatingFilterCompDetails(e,t){return this.columnFilterService?.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){return this.columnFilterService?.getCurrentFloatingFilterParentModel(e)}destroyFilter(e,t="api"){this.columnFilterService?.destroyFilter(e,t)}areFilterCompsDifferent(e,t){return!!this.columnFilterService?.areFilterCompsDifferent(e,t)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){if(this.isAdvancedFilterEnabled()){if(this.dataTypeService?.isPendingInference())return void this.advancedFilterModelUpdateQueue.push(e);this.advancedFilterService.setModel(e??null),this.onFilterChanged({source:"advancedFilter"})}}toggleAdvancedFilterBuilder(e,t){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return!this.isAdvancedFilterEnabled()&&!!this.columnFilterService?.hasFloatingFilters()}getFilterInstance(e,t){if(!this.isAdvancedFilterEnabled())return this.columnFilterService?.getFilterInstance(e,t);this.warnAdvancedFilters()}getColumnFilterInstance(e){return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve(void 0)):this.columnFilterService?.getColumnFilterInstance(e)??Promise.resolve(void 0)}warnAdvancedFilters(){q("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){this.advancedFilterService?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advancedFilterModelUpdateQueue.forEach(e=>this.setAdvancedFilterModel(e)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){return this.columnFilterService?.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve()):this.columnFilterService?.setColumnFilterModel(e,t)??Promise.resolve()}setColDefPropertiesForDataType(e,t,r){this.columnFilterService?.setColDefPropertiesForDataType(e,t,r)}}]},_T={version:xe,moduleName:"@ag-grid-community/filter-api",apiFunctions:{isAnyFilterPresent:function bT(e){return!!e.filterManager?.isAnyFilterPresent()},onFilterChanged:function ET(e,t="api"){e.filterManager?.onFilterChanged({source:t})}},dependantModules:[dd]},ka={version:xe,moduleName:"@ag-grid-community/column-filter",beans:[class extends U{constructor(){super(...arguments),this.beanName="columnFilterService",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.userComponentFactory=e.userComponentFactory,this.rowRenderer=e.rowRenderer,this.dataTypeService=e.dataTypeService,this.filterManager=e.filterManager}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),rowDataUpdated:()=>this.onNewRowsLoaded("rowDataUpdated"),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...this.gos.get("initialState")?.filter?.filterModel??{}}}setFilterModel(e,t="api"){if(this.dataTypeService?.isPendingInference())return void this.filterModelUpdateQueue.push({model:e,source:t});const r=[],i=this.getFilterModel(!0);if(e){const s=new Set(Object.keys(e));this.allColumnFilters.forEach((n,o)=>{r.push(this.setModelOnFilterWrapper(n.filterPromise,e[o])),s.delete(o)}),s.forEach(n=>{const o=this.columnModel.getColDefCol(n)||this.columnModel.getCol(n);if(!o)return void q("setFilterModel() - no column found for colId: "+n);if(!o.isFilterAllowed())return void q("setFilterModel() - unable to fully apply model, filtering disabled for colId: "+n);const a=this.getOrCreateFilterWrapper(o);a?r.push(this.setModelOnFilterWrapper(a.filterPromise,e[n])):q("setFilterModel() - unable to fully apply model, unable to create filter for colId: "+n)})}else this.allColumnFilters.forEach(s=>{r.push(this.setModelOnFilterWrapper(s.filterPromise,null))});pr.all(r).then(()=>{const s=this.getFilterModel(!0),n=[];this.allColumnFilters.forEach((o,a)=>{Kn(i?i[a]:null,s?s[a]:null)||n.push(o.column)}),n.length>0&&this.filterManager?.onFilterChanged({columns:n,source:t})})}setModelOnFilterWrapper(e,t){return new pr(r=>{e.then(i=>{"function"!=typeof i.setModel&&(q("filter missing setModel method, which is needed for setFilterModel"),r()),(i.setModel(t)||pr.resolve()).then(()=>r())})})}getFilterModel(e){const t={},{allColumnFilters:r,initialFilterModel:i}=this;return r.forEach((s,n)=>{const o=this.getModelFromFilterWrapper(s);te(o)&&(t[n]=o)}),e||Object.entries(i).forEach(([s,n])=>{te(n)&&!r.has(s)&&this.columnModel.getCol(s)?.isFilterAllowed()&&(t[s]=n)}),t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?"function"!=typeof t.getModel?(q("filter API missing getModel method, which is needed for getFilterModel"),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){return!!this.allColumnFilters.size&&(this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"advancedFilterEnabled")),!0)}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const t=!!pc(this.gos),r=n=>{if(!n.isPrimary())return!0;const a=!this.columnModel.isPivotActive();return!(!n.isValueActive()||!a)&&(!!this.columnModel.isPivotMode()||t)},i=[],s=[];return this.forEachColumnFilter((n,o)=>{(n=>!!n&&(n.isFilterActive?n.isFilterActive():(q("Filter is missing isFilterActive() method"),!1)))(n)&&(r(o.column)?i.push(n):s.push(n))}).then(()=>{this.activeAggregateFilters=i,this.activeColumnFilters=s})}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter((r,i)=>i.column.setFilterActive(r.isFilterActive(),e,t))}forEachColumnFilter(e){return pr.all(Array.from(this.allColumnFilters.values()).map(t=>t.filterPromise.then(r=>e(r,t))))}doColumnFiltersPass(e,t,r){const{data:i,aggData:s}=e,n=r?this.activeAggregateFilters:this.activeColumnFilters,o=r?s:i;for(let a=0;a<n.length;a++){const l=n[a];if(null!=l&&l!==t){if("function"!=typeof l.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:e,data:o}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const t=()=>this.filterManager?.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}updateBeforeFilterChanged(e={}){const{filterInstance:t,additionalEventAttributes:r}=e;return this.updateDependentFilters(),this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",r).then(()=>{this.allColumnFilters.forEach(i=>{i.filterPromise&&i.filterPromise.then(s=>{s&&s!==t&&s.onAnyFilterChanged&&s.onAnyFilterChanged()})}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!this.gos.get("allowShowChangeAfterFilter")&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter(t=>{t.onNewRowsLoaded&&t.onNewRowsLoaded()}).then(()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0})).then(()=>this.updateActiveFilters())}createValueGetter(e){return({node:t})=>this.valueService.getValue(e,t,!0)}createGetValue(e){return(t,r)=>{const i=r?this.columnModel.getCol(r):e;return i?this.valueService.getValue(i,t,!0):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():null!=this.getModelFromInitialState(e)}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;if(xc(this.gos))t="agSetColumnFilter";else{const r=this.dataTypeService?.getBaseDataType(e);t="number"===r?"agNumberColumnFilter":"date"===r||"dateString"===r?"agDateColumnFilter":"agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;if(xc(this.gos))t="agSetColumnFloatingFilter";else{const r=this.dataTypeService?.getBaseDataType(e);t="number"===r?"agNumberColumnFloatingFilter":"date"===r||"dateString"===r?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const r=this.getDefaultFilter(e),i=e.getColDef();let s;const n={...this.createFilterParams(e,i),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(s,e)(),filterChangedCallback:a=>this.filterChangedCallbackFactory(s,e)(a),doesRowPassOtherFilter:a=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(s,a)},o=this.userComponentFactory.getFilterDetails(i,n,r);return o?{filterPromise:()=>{const a=o.newAgStackInstance();return a?.then(l=>{s=l,t&&(t.filter=l)}),a},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:Tf(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:r,compDetails:i}=this.createFilterInstance(e,t);return t.filterPromise=r?.()??null,t.compDetails=i,t}onColumnsChanged(){const e=[];this.allColumnFilters.forEach((r,i)=>{let s;s=r.column.isPrimary()?this.columnModel.getColDefCol(i):this.columnModel.getCol(i),(!s||s!==r.column)&&(e.push(r.column),this.disposeFilterWrapper(r,"columnChanged"),this.disposeColumnListener(i))});const t=e.every(r=>"agGroupColumnFilter"===r.getColDef().filter);e.length>0&&!t?this.filterManager?.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){this.columnModel.getAutoCols()?.forEach(t=>{"agGroupColumnFilter"===t.getColDef().filter&&this.getOrCreateFilterWrapper(t)})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:r}=this.allColumnFilters.get(e.getColId())??{};return!r||"function"!=typeof r?.isFilterAllowed||r.isFilterAllowed()}getFloatingFilterCompDetails(e,t){const r=l=>{const c=this.getOrCreateFilterWrapper(e)?.filterPromise;c?.then(d=>{l(ao(d))})},i=e.getColDef(),s={...this.createFilterParams(e,i),filterChangedCallback:()=>r(l=>this.filterChangedCallbackFactory(l,e)())},n=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(i,Jc,s);let o=function ST(e,t,r){if(null==t)return null;let i=null;const{compName:s,jsComp:n,fwComp:o}=lp.getCompKeys(e,t,Jc);return s?i={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[s]:null==n&&null==o&&!0===t.filter&&(i=r()),i}(this.frameworkOverrides,i,()=>this.getDefaultFloatingFilter(e));return null==o&&(o="agReadOnlyFloatingFilter"),this.userComponentFactory.getFloatingFilterCompDetails(i,{column:e,filterParams:n,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:r,showParentFilter:t,suppressFilterButton:!1},o)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e,t="api"){const r=e.getColId(),i=this.allColumnFilters.get(r);this.disposeColumnListener(r),delete this.initialFilterModel[r],i&&(this.disposeFilterWrapper(i,t),this.filterManager?.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then(r=>{this.destroyBean(r),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventService.dispatchEvent({type:"filterDestroyed",source:t,column:e.column})})}filterModifiedCallbackFactory(e,t){return()=>{this.eventService.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return r=>{this.callOnFilterChangedOutsideRenderCycle({filter:e,additionalEventAttributes:r,columns:[t],source:r?.source??"columnFilter"})}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const r=t.column,{compDetails:i}=r.isFilterAllowed()?this.createFilterInstance(r):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i))return void this.destroyFilter(r,"paramsUpdated");const s=r.getColDef().filterParams;t.filterPromise?t.filterPromise.then(n=>{!1===(!n?.refresh||n.refresh({...this.createFilterParams(r,r.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(n,r),filterChangedCallback:this.filterChangedCallbackFactory(n,r),doesRowPassOtherFilter:a=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(n,a),...s}))&&this.destroyFilter(r,"paramsUpdated")}):this.destroyFilter(r,"paramsUpdated")}setColumnFilterWrapper(e,t){const r=e.getColId();this.allColumnFilters.set(r,t),this.allColumnListeners.set(r,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(r)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:r}=e,{componentClass:i}=t;return!(r===i||r?.render&&i?.render&&r.render===i.render)}hasFloatingFilters(){return this.columnModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e,t){t&&this.getFilterInstanceImpl(e).then(r=>{const i=ao(r);t(i)})}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstanceImpl(e).then(r=>{t(ao(r))})})}getFilterInstanceImpl(e){const t=this.columnModel.getColDefCol(e);return t?this.getOrCreateFilterWrapper(t)?.filterPromise??pr.resolve(null):pr.resolve(void 0)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:e,source:t})=>this.setFilterModel(e,t)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:e,model:t,resolve:r})=>{this.setColumnFilterModel(e,t).then(()=>r())}),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){if(this.dataTypeService?.isPendingInference()){let n=()=>{};const o=new Promise(a=>{n=a});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:n}),o}const r=this.columnModel.getColDefCol(e),i=r?this.getOrCreateFilterWrapper(r):null;return i?(n=this.setModelOnFilterWrapper(i.filterPromise,t),new Promise(o=>{n.then(a=>o(a))})):Promise.resolve();var n}getFilterWrapper(e){const t=this.columnModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}setColDefPropertiesForDataType(e,t,r){const i=xc(this.gos),s=this.localeService.getLocaleTextFunc(),n=o=>{const{filterParams:a}=e;e.filterParams="object"==typeof a?{...a,...o}:o};switch(t.baseDataType){case"number":i&&n({comparator:(o,a)=>{const l=null==o?0:parseInt(o),c=null==a?0:parseInt(a);return l===c?0:l>c?1:-1}});break;case"boolean":n(i?{valueFormatter:o=>te(o.value)?s(String(o.value),o.value?"True":"False"):s("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(o,a)=>a,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(o,a)=>!1===a,numberOfInputs:0}]});break;case"date":i&&n({valueFormatter:o=>{const a=r(o);return te(a)?a:s("blanks","(Blanks)")},treeList:!0,treeListFormatter:(o,a)=>{if(1===a&&null!=o){const l=_p[Number(o)-1];return s(l,Lp[l])}return o??s("blanks","(Blanks)")}});break;case"dateString":{const o=t.dateParser;n(i?{valueFormatter:a=>{const l=r(a);return te(l)?l:s("blanks","(Blanks)")},treeList:!0,treeListPathGetter:a=>{const l=o(a??void 0);return l?[String(l.getFullYear()),String(l.getMonth()+1),String(l.getDate())]:null},treeListFormatter:(a,l)=>{if(1===l&&null!=a){const c=_p[Number(a)-1];return s(c,Lp[c])}return a??s("blanks","(Blanks)")}}:{comparator:(a,l)=>{const c=o(l);return null==l||c<a?-1:c>a?1:0}});break}case"object":i?n({valueFormatter:o=>{const a=r(o);return te(a)?a:s("blanks","(Blanks)")}}):e.filterValueGetter=o=>r({column:o.column,node:o.node,value:this.valueService.getValue(o.column,o.node)})}}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}}],dependantModules:[dd]},OT={version:xe,moduleName:"@ag-grid-community/column-filter-api",apiFunctions:{isColumnFilterPresent:function hT(e){return!!e.filterManager?.isColumnFilterPresent()||!!e.filterManager?.isAggregateFilterPresent()},getFilterInstance:function gT(e,t,r){return e.filterManager?.getFilterInstance(t,r)},getColumnFilterInstance:function fT(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)},destroyFilter:function pT(e,t){const r=e.columnModel.getColDefCol(t);if(r)return e.filterManager?.destroyFilter(r,"api")},setFilterModel:function mT(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))},getFilterModel:function vT(e){return e.filterManager?.getFilterModel()??{}},getColumnFilterModel:function CT(e,t){return e.filterManager?.getColumnFilterModel(t)??null},setColumnFilterModel:function wT(e,t,r){return e.filterManager?.setColumnFilterModel(t,r)??Promise.resolve()},showColumnFilter:function xT(e,t){const r=e.columnModel.getCol(t);r?e.menuService.showFilterMenu({column:r,containerType:"columnFilter",positionBy:"auto"}):Me(`column '${t}' not found`)}},dependantModules:[ka,_T]},ud={version:xe,moduleName:"@ag-grid-community/floating-filter-core",controllers:[{name:"headerFilterCell",classImp:class extends Ra{constructor(e,t,r){super(e,t,r),this.iconCreated=!1,this.column=e}setComp(e,t,r,i,s){this.comp=e,s=eo(this,this.beans.context,s),this.eButtonShowMainFilter=r,this.eFloatingFilterBody=i,this.setGui(t,s),this.setupActive(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s),s.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(s)}),s.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef();this.active=!!e.filter&&!!e.floatingFilter}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=fr("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new ys(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();en(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(Je(this.gos)===this.eGui)return;const i=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(i)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void i.focus();const s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleColsService;let r=this.column;do{if(r=e?t.getColBefore(r):t.getColAfter(r),!r)break}while(!r.getColDef().filter||!r.getColDef().floatingFilter);return r}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case N.UP:case N.DOWN:t||e.preventDefault();case N.LEFT:case N.RIGHT:if(t)return;e.stopPropagation();case N.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case N.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const r=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&tn(e.relatedTarget,"ag-floating-filter");if(r&&i&&e.target===this.eGui){const n=this.lastFocusEvent;n&&n&&n.key===N.TAB&&this.focusService.focusInto(this.eGui,n.shiftKey)}const s=this.getRowIndex();this.beans.focusService.setFocusedHeader(s,this.column)}setupHover(e){e.createManagedBean(new cd([this.column],this.eGui));const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const r=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",r)};e.addManagedEventListeners({columnHoverChanged:t}),t()}setupLeft(e){const t=new ld(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){this.menuService.showFilterMenu({column:this.column,buttonElement:this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,r=i=>{if("filterDestroyed"===i?.source&&!this.isAlive())return;const s=this.comp.getFloatingFilterComp();s&&s.then(n=>{if(n){const o=t?.getCurrentFloatingFilterParentModel(this.column),a=i?{...i,columns:i.columns??[],source:"api"===i.source?"api":"columnFilter"}:null;n.onParentModelChanged(o,a)}})};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:r}),t?.isFilterActive(this.column)&&r(null)}setupWidth(e){const t=()=>{const r=`${this.column.getActualWidth()}px`;this.comp.setWidth(r)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const r=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const i=this.active?this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,s=this.comp.getFloatingFilterComp();s&&i?s.then(n=>{!n||this.beans.filterManager?.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,r):this.updateFloatingFilterParams(i)}):this.updateCompDetails(e,i,r)}updateCompDetails(e,t,r){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),r&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){if(!e)return;const t=e.params;this.comp.getFloatingFilterComp()?.then(r=>{let i=!1;r?.refresh&&"function"==typeof r.refresh&&null!==r.refresh(t)&&(i=!0),!i&&r?.onParamsUpdated&&"function"==typeof r.onParamsUpdated&&null!==r.onParamsUpdated(t)&&q("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")})}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}}}],dependantModules:[ka]},BT={version:xe,moduleName:"@ag-grid-community/read-only-floating-filter",userComponents:[{name:"agReadOnlyFloatingFilter",classImp:class extends Ge{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eFloatingFilterText"></ag-input-text-field>\n            </div>',[Fa]),this.eFloatingFilterText=de}wireBeans(e){this.columnNameService=e.columnNameService}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),r=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${r("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){null!=e?this.params.parentFilterInstance(t=>{if(t.getModelAsString){const r=t.getModelAsString(e);this.eFloatingFilterText.setValue(r)}}):this.eFloatingFilterText.setValue("")}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}}}],dependantModules:[ud]},GT={version:xe,moduleName:"@ag-grid-community/simple-floating-filter",dependantModules:[{version:xe,moduleName:"@ag-grid-community/simple-filter",dependantModules:[ka],userComponents:[{name:"agTextColumnFilter",classImp:class extends pp{constructor(){super("textFilter"),this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>null==e?null:e.toString().toLowerCase(),this.defaultMatcher=({filterOption:e,value:t,filterText:r})=>{if(null==r)return!1;switch(e){case"contains":return t.indexOf(r)>=0;case"notContains":return t.indexOf(r)<0;case"equals":return t===r;case"notEqual":return t!=r;case"startsWith":return 0===t.indexOf(r);case"endsWith":{const i=t.lastIndexOf(r);return i>=0&&i===t.length-r.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[]}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new Sp(this.localeService,this.optionsFactory)}getTextMatcher(){const e=this.textFilterParams.textCustomComparator;return e?(q("textCustomComparator is deprecated, use textMatcher instead."),({filterOption:t,value:r,filterText:i})=>e(t,r,i)):this.textFilterParams.textMatcher||this.defaultMatcher}createCondition(e){const t=this.getConditionType(e),r={filterType:this.getFilterType(),type:t},i=this.getValuesWithSideEffects(e,!0);return i.length>0&&(r.filter=i[0]),i.length>1&&(r.filterTo=i[1]),r}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const r=[];return this.forEachPositionInput(e,(i,s,n,o)=>{if(s<o){let a=fi(i.getValue());t&&this.textFilterParams.trimInput&&(a=yp(a)??null,i.setValue(a,!0)),r.push(a)}}),r}getDefaultFilterOptions(){return xp}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),ir(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,r){const i=this.createManagedBean(new bs);i.addCssClass(`ag-filter-${r}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:r,type:i}=e||{};return[t||null,r||null].slice(0,this.getNumberOfInputs(i))}evaluateNullValue(e){return!!e&&["notEqual","notContains","blank"].indexOf(e)>=0}evaluateNonNullValue(e,t,r,i){const s=e.map(h=>this.formatter(h))||[],n=this.formatter(t),{api:o,colDef:a,column:l,context:c,textFormatter:d}=this.textFilterParams;if("blank"===r.type)return this.isBlank(t);if("notBlank"===r.type)return!this.isBlank(t);const u={api:o,colDef:a,column:l,context:c,node:i.node,data:i.data,filterOption:r.type,value:n,textFormatter:d};return s.some(h=>this.matcher({...u,filterText:h}))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}}},{name:"agNumberColumnFilter",classImp:class extends mp{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(e){return this.numberFilterParams.allowedCharPattern===e.allowedCharPattern&&super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:r,type:i}=e||{};return[this.processValue(t),this.processValue(r)].slice(0,this.getNumberOfInputs(i))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new wp(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return Cp}setElementValue(e,t,r){const i=!r&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(t??null):t;super.setElementValue(e,i)}createValueElement(){const e=od(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),ir(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,r,i){const s=this.createManagedBean(i?new bs({allowedCharPattern:i}):new sd);s.addCssClass(`ag-filter-${r}`),s.addCssClass("ag-filter-filter"),t.push(s),e.appendChild(s.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const t=[];return this.forEachPositionInput(e,(r,i,s,n)=>{i<n&&t.push(this.processValue(this.stringToFloat(r.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"==typeof e)return e;let t=fi(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),r={filterType:this.getFilterType(),type:t},i=this.getValues(e);return i.length>0&&(r.filter=i[0]),i.length>1&&(r.filterTo=i[1]),r}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}}},{name:"agDateColumnFilter",classImp:class extends mp{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=1/0,this.minValidDate=null,this.maxValidDate=null}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:r,type:i}=e||{};return[t&&sr(t)||null,r&&sr(r)||null].slice(0,this.getNumberOfInputs(i))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){return null==t||t<e?-1:t>e?1:0}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(r,i)=>{if(null!=e[r]){if(!isNaN(e[r]))return null==e[r]?i:Number(e[r]);q(`DateFilter ${r} is not a number`)}return i};this.minValidYear=t("minValidYear",1e3),this.maxValidYear=t("maxValidYear",1/0),this.minValidYear>this.maxValidYear&&q("DateFilter minValidYear should be <= maxValidYear"),this.minValidDate=e.minValidDate?e.minValidDate instanceof Date?e.minValidDate:sr(e.minValidDate):null,this.maxValidDate=e.maxValidDate?e.maxValidDate instanceof Date?e.maxValidDate:sr(e.maxValidDate):null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&q("DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new kp(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new Fp(this.context,this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc(()=>t.destroy()),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return Rp}createValueElement(){const t=gt(this.gos).createElement("div");return t.classList.add("ag-filter-body"),this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t}createFromToElement(e,t,r,i){const n=gt(this.gos).createElement("div");n.classList.add(`ag-filter-${i}`),n.classList.add(`ag-filter-date-${i}`),t.push(n),e.appendChild(n),r.push(this.createDateCompWrapper(n))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,r){this.removeItems(e,t,r).forEach(s=>s.destroy())}isValidDateValue(e){if(null===e)return!1;if(this.minValidDate){if(e<this.minValidDate)return!1}else if(e.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(e>this.maxValidDate)return!1}else if(e.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((r,i,s,n)=>{s!==e||!t||i>=n||(t=t&&this.isValidDateValue(r.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),r={},i=this.getValues(e);return i.length>0&&(r.dateFrom=Mr(i[0])),i.length>1&&(r.dateTo=Mr(i[1])),{dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t,...r}}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),r=e("ariaFilterValue","Filter Value");this.forEachInput(i=>{i.setInputPlaceholder(t),i.setInputAriaLabel(r)})}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,i,s,n)=>{i<n&&t.push(r.getDate())}),t}translate(e){return super.translate("lessThan"===e?"before":"greaterThan"===e?"after":e)}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}}},{name:"agDateInput",classImp:class extends Ge{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" data-ref="eDateInput"></ag-input-text-field>\n            </div>',[Fa]),this.eDateInput=de}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()},input:r=>{r.target===Je(this.gos)&&(this.eDateInput.isDisabled()||this.params.onDateChanged())}})}setParams(e){const t=this.eDateInput.getInputElement(),r=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=r&&ri(),t.type=r?"date":"text";const{minValidYear:i,maxValidYear:s,minValidDate:n,maxValidDate:o}=e.filterParams||{};if(n&&i&&q("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),o&&s&&q("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),n&&o){const[a,l]=[n,o].map(c=>c instanceof Date?c:sr(c));a&&l&&a.getTime()>l.getTime()&&q("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}n?t.min=n instanceof Date?uo(n):n:i&&(t.min=`${i}-01-01`),o?t.max=o instanceof Date?uo(o):o:s&&(t.max=`${s}-12-31`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return sr(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(Mr(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:Vc()||Wc()||ri()&&zf()>=14.1}}}]},ud],userComponents:[{name:"agTextColumnFloatingFilter",classImp:class extends Np{init(e){super.init(e),this.filterModelFormatter=new Sp(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return xp}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new Bp)}}},{name:"agNumberColumnFloatingFilter",classImp:class extends Np{init(e){super.init(e),this.filterModelFormatter=new wp(this.localeService,this.optionsFactory,e.filterParams?.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){od(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return Cp}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=od(e.filterParams),this.createManagedBean(this.allowedCharPattern?new Bp({config:{allowedCharPattern:this.allowedCharPattern}}):new TT)}}},{name:"agDateColumnFloatingFilter",classImp:class extends Op{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eReadOnlyText"></ag-input-text-field>\n                <div data-ref="eDateWrapper" style="display: flex;"></div>\n            </div>',[Fa]),this.eReadOnlyText=de,this.eDateWrapper=de}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}getDefaultFilterOptions(){return Rp}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new kp(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);this.setEditable(t),t?(this.dateComp.setDate(e?sr(e.dateFrom):null),this.eReadOnlyText.setValue("")):(this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null))}setEditable(e){et(this.eDateWrapper,e),et(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const t=Mr(this.dateComp.getDate());this.params.parentFilterInstance(r=>{if(r){const i=sr(t);r.onFloatingFilterChanged(this.getLastType()||null,i)}})}getDateComponentParams(){const e=td(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:Yt(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new Fp(this.context,this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}}}]},Gp={version:xe,moduleName:"@ag-grid-community/quick-filter-core",beans:[class extends U{constructor(){super(...arguments),this.beanName="quickFilterService",this.quickFilter=null,this.quickFilterParts=null}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.pivotResultColsService=e.pivotResultColsService}postConstruct(){const e=this.resetQuickFilterCache.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}}),this.addManagedPropertyListener("quickFilterText",t=>this.setQuickFilter(t.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}refreshQuickFilterCols(){const e=this.columnModel.isPivotMode(),t=this.columnModel.getAutoCols(),r=this.columnModel.getColDefCols();let i=(e&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.pivotResultColsService.getPivotResultCols()?.list:r)??[];t&&(i=i.concat(t)),this.colsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?i:i.filter(s=>s.isVisible()||s.isRowGroupActive())}isQuickFilterPresent(){return null!==this.quickFilter}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every(r=>t?this.doesRowPassQuickFilterCache(e,r):this.doesRowPassQuickFilterNoCache(e,r))}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;this.quickFilterParts=e?t?t(e):e.split(" "):null}parseQuickFilter(e){return te(e)?it(this.gos)?e.toUpperCase():(q("Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(null!=e&&"string"!=typeof e)return void q("Grid option quickFilterText only supports string inputs, received: "+typeof e);const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),r=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,r&&(this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onQuickFilterColumnConfigChanged(){this.refreshQuickFilterCols(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassQuickFilterNoCache(e,t){return this.colsForQuickFilter.some(r=>{const i=this.getQuickFilterTextForColumn(r,e);return te(i)&&i.indexOf(t)>=0})}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let r;e?(this.checkGenerateQuickFilterAggregateText(t),r=t.quickFilterAggregateText):r=this.getQuickFilterAggregateText(t);const{quickFilterParts:i,matcher:s}=this;return s(i,r)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let r=this.valueService.getValue(e,t,!0);const i=e.getColDef();if(i.getQuickFilterText){const s=this.gos.addGridCommonParams({value:r,node:t,data:t.data,column:e,colDef:i});r=i.getQuickFilterText(s)}return te(r)?r.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.colsForQuickFilter.forEach(r=>{const i=this.getQuickFilterTextForColumn(r,e);te(i)&&t.push(i)}),t.join("\n")}}],dependantModules:[dd]},VT={version:xe,moduleName:"@ag-grid-community/filter",dependantModules:[GT,BT,{version:xe,moduleName:"@ag-grid-community/quick-filter",dependantModules:[Gp,{version:xe,moduleName:"@ag-grid-community/quick-filter-api",apiFunctions:{isQuickFilterPresent:function PT(e){return!!e.filterManager?.isQuickFilterPresent()},getQuickFilter:function MT(e){return e.gos.get("quickFilterText")},resetQuickFilter:function IT(e){e.filterManager?.resetQuickFilterCache()}},dependantModules:[Gp]}]},OT]},hd=class extends Ge{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},WT=class extends hd{constructor(e){super('<div class="ag-header-cell ag-floating-filter" role="gridcell">\n            <div data-ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" data-ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" data-ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',e),this.eFloatingFilterBody=de,this.eButtonWrapper=de,this.eButtonShowMainFilter=de}postConstruct(){const e=this.getGui();this.ctrl.setComp({addOrRemoveCssClass:(r,i)=>this.addOrRemoveCssClass(r,i),addOrRemoveBodyCssClass:(r,i)=>this.eFloatingFilterBody.classList.toggle(r,i),setButtonWrapperDisplayed:r=>et(this.eButtonWrapper,r),setCompDetails:r=>this.setCompDetails(r),getFloatingFilterComp:()=>this.compPromise,setWidth:r=>e.style.width=r,setMenuIcon:r=>this.eButtonShowMainFilter.appendChild(r)},e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive())return void this.destroyBean(e);this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},UT=class extends hd{constructor(e){super('<div class="ag-header-cell" role="columnheader">\n            <div data-ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div data-ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',e),this.eResize=de,this.eHeaderCompWrapper=de,this.headerCompVersion=0,this.column=e.getColumnGroupChild(),this.pinned=e.getPinned()}postConstruct(){const e=this.getGui();var s,n;s="col-id",null!=(n=this.column.getColId())&&""!=n?e.setAttribute(s,n):e.removeAttribute(s);const r={setWidth:s=>e.style.width=s,addOrRemoveCssClass:(s,n)=>this.addOrRemoveCssClass(s,n),setAriaSort:s=>s?function yR(e,t){Ar(e,"sort",t)}(e,s):function bR(e){Pc(e,"sort")}(e),setUserCompDetails:s=>this.setUserCompDetails(s),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(r,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0);const i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(r=>this.afterCompCreated(t,r))}afterCompCreated(e,t){e==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(t)}},jT=class extends hd{constructor(e){super('<div class="ag-header-group-cell" role="columnheader">\n            <div data-ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n            <div data-ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',e),this.eResize=de,this.eHeaderCompWrapper=de}postConstruct(){const e=this.getGui();e.setAttribute("col-id",this.ctrl.getColId()),this.ctrl.setComp({addOrRemoveCssClass:(i,s)=>this.addOrRemoveCssClass(i,s),setResizableDisplayed:i=>et(this.eResize,i),setWidth:i=>e.style.width=i,setAriaExpanded:i=>((i,s)=>null!=s?e.setAttribute(i,s):e.removeAttribute(i))("aria-expanded",i),setUserCompDetails:i=>this.setUserCompDetails(i),getUserCompInstance:()=>this.headerGroupComp},e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive())return void t();const r=this.getGui(),i=e.getGui();this.eHeaderCompWrapper.appendChild(i),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(r)}},KT=class extends Ge{constructor(e){super(),this.headerComps={},this.ctrl=e,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}postConstruct(){Gf(this.getGui(),this.ctrl.getAriaRowIndex()),this.ctrl.setComp({setHeight:t=>this.getGui().style.height=t,setTop:t=>this.getGui().style.top=t,setHeaderCtrls:(t,r)=>this.setHeaderCtrls(t,r),setWidth:t=>this.getGui().style.width=t},void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;const r=this.headerComps;if(this.headerComps={},e.forEach(i=>{const s=i.instanceId;let n=r[s];delete r[s],null==n&&(n=this.createHeaderComp(i),this.getGui().appendChild(n.getGui())),this.headerComps[s]=n}),kr(r,(i,s)=>{this.getGui().removeChild(s.getGui()),this.destroyBean(s)}),t){const i=Hi(this.headerComps);i.sort((n,o)=>n.getCtrl().getColumnGroupChild().getLeft()-o.getCtrl().getColumnGroupChild().getLeft());const s=i.map(n=>n.getGui());Xf(this.getGui(),s)}}createHeaderComp(e){let t;switch(this.ctrl.getType()){case"group":t=new jT(e);break;case"filter":t=new WT(e);break;default:t=new UT(e)}return this.createBean(t),t.setParentComponent(this),t}},qT=class extends U{constructor(){super(...arguments),this.beanName="headerNavigationService",this.currentHeaderRowWithoutSpan=-1}wireBeans(e){this.focusService=e.focusService,this.headerPositionUtils=e.headerPositionUtils,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.visibleColService=e.visibleColsService}postConstruct(){this.ctrlsService.whenReady(this,t=>{this.gridBodyCon=t.gridBodyCtrl});const e=gt(this.gos);this.addManagedElementListeners(e,{mousedown:()=>this.setCurrentHeaderRowWithoutSpan(-1)})}getHeaderRowCount(){return this.ctrlsService.getHeaderRowContainerCtrl()?.getRowCount()??0}getHeaderPositionForColumn(e,t){let r;if("string"==typeof e?(r=this.columnModel.getCol(e),r||(r=this.visibleColService.getColumnGroup(e))):r=e,!r)return null;const s=this.ctrlsService.getHeaderRowContainerCtrl()?.getAllCtrls(),n="filter"===Le(s||[]).getType(),o=this.getHeaderRowCount()-1;let a=-1,l=r;for(;l;)a++,l=l.getParent();let c=a;return t&&n&&c===o-1&&c++,-1===c?null:{headerRowIndex:c,column:r}}navigateVertically(e,t,r){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:i}=t,s=t.column,n=this.getHeaderRowCount(),o=0===e;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:c}=o?this.headerPositionUtils.getColumnVisibleParent(s,i):this.headerPositionUtils.getColumnVisibleChild(s,i),d=!1;return a<0&&(a=0,l=s,d=!0),a>=n?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):void 0!==c&&(this.currentHeaderRowWithoutSpan=c),!(!d&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:r})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e,t=!1,r){const i=this.focusService.getFocusedHeader(),s=2===e,n=this.gos.get("enableRtl");let o,a;if(-1!==this.currentHeaderRowWithoutSpan?i.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=i.headerRowIndex,s!==n?(a="Before",o=this.headerPositionUtils.findHeader(i,a)):(a="After",o=this.headerPositionUtils.findHeader(i,a)),o||!t)return this.focusService.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r});if(t){const l=this.gos.getCallback("tabToNextHeader");if(l)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a})}return this.focusNextHeaderRow(i,a,r)}focusNextHeaderRow(e,t,r){const i=e.headerRowIndex;let n,s=null;if("Before"===t?i>0&&(n=i-1,this.currentHeaderRowWithoutSpan-=1,s=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"end")):(n=i+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),s=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"start")),!s)return!1;const{column:o,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(s.column,s?.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:a},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e,t="After"){if(e.getPinned())return;let r;if(ft(e)){const i=e.getDisplayedLeafColumns();r="Before"===t?Le(i):i[0]}else r=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(r)}},XT=class extends U{wireBeans(e){this.animationFrameService=e.animationFrameService,this.headerNavigationService=e.headerNavigationService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.menuService=e.menuService}setComp(e,t,r){this.comp=e,this.eGui=t,this.createManagedBean(new ys(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),this.onPivotModeChanged(),this.setupHeaderHeight();const i=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:i}),this.mockContextMenuForIPad(i),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>this.animationFrameService.requestAnimationFrame(()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t=0;const r=this.columnModel.getGroupRowsHeight().reduce((n,o)=>n+o,0),i=this.columnModel.getColumnHeaderRowHeight();this.filterManager?.hasFloatingFilters()&&(t+=e.getFloatingFiltersHeight()),t+=r,t+=i,this.headerHeight!==t&&(this.headerHeight=t,this.comp.setHeightAndMinHeight(`${t+1}px`),this.eventService.dispatchEvent({type:"headerHeightChanged"}))}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const t=this.visibleColsService.getAllCols().some(r=>r.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey;(this.headerNavigationService.navigateHorizontally(r!==t?2:3,!0,e)||!r&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(r))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case N.LEFT:t=2;case N.RIGHT:te(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e)&&e.preventDefault();break;case N.UP:t=0;case N.DOWN:te(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(Je(this.gos))||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,r){if(!e&&!r||!this.menuService.isHeaderContextMenuEnabled())return;const{target:i}=e??t;(i===this.eGui||i===this.ctrlsService.getHeaderRowContainerCtrl()?.getViewportElement())&&this.menuService.showHeaderContextMenu(void 0,e,r)}mockContextMenuForIPad(e){if(!Vi())return;const t=new Wi(this.eGui);this.addManagedListeners(t,{longTap:i=>{e(void 0,i.touchStart,i.touchEvent)}}),this.addDestroyFunc(()=>t.destroy())}},gd=class extends U{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}wireBeans(e){this.visibleColsService=e.visibleColsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=Pt(this.gos,"print"),t=this.visibleColsService.getBodyContainerWidth(),r=this.visibleColsService.getColsLeftWidth(),i=this.visibleColsService.getDisplayedColumnsRightWidth();let s;e?s=t+r+i:(s=t,this.addSpacer&&0===(this.gos.get("enableRtl")?r:i)&&this.scrollVisibleService.isVerticalScrollShowing()&&(s+=this.scrollVisibleService.getScrollbarWidth())),this.callback(s)}},QT=class extends U{constructor(e){super(),this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}wireBeans(e){this.funcColsService=e.funcColsService}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(r=>{r.isPrimary()&&(r.isAnyFunctionActive()||(r.isAllowValue()?this.columnsToAggregate.push(r):r.isAllowRowGroup()?this.columnsToGroup.push(r):r.isAllowPivot()&&this.columnsToPivot.push(r)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.funcColsService.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.funcColsService.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.funcColsService.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function Hp(e){const{isFromHeader:t,fromLeft:r,xPosition:i,fromEnter:s,fakeEvent:n,pinned:o,gos:a,columnModel:l,columnMoveService:c,visibleColsService:d}=e;let{allMovingColumns:u}=e;if(t){const M=[];u.forEach(O=>{let y=null,L=O.getParent();for(;null!=L&&1===L.getDisplayedLeafColumns().length;)y=L,L=L.getParent();null!=y?(y.getColGroupDef()?.marryChildren?y.getProvidedColumnGroup().getLeafColumns():y.getLeafColumns()).forEach(K=>{M.includes(K)||M.push(K)}):M.includes(O)||M.push(O)}),u=M}const h=u.slice();l.sortColsLikeCols(h);const g=function t6(e){const{movingCols:t,draggingRight:r,xPosition:i,pinned:s,gos:n,columnModel:o,visibleColsService:a}=e;if(n.get("suppressMovableColumns")||t.some(v=>v.getColDef().suppressMovable))return[];const c=function e6(e,t){switch(t){case"left":return e.getLeftCols();case"right":return e.getRightCols();default:return e.getCenterCols()}}(a,s),d=o.getCols(),u=c.filter(v=>vs(t,v)),h=c.filter(v=>!vs(t,v)),g=d.filter(v=>!vs(t,v));let m,p=0,f=i;if(r){let v=0;u.forEach(k=>v+=k.getActualWidth()),f-=v}if(f>0){for(let v=0;v<h.length&&(f-=h[v].getActualWidth(),!(f<0));v++)p++;r&&p++}p>0?m=g.indexOf(h[p-1])+1:(m=g.indexOf(h[0]),-1===m&&(m=0));const w=[m],C=(v,k)=>v-k;if(r){let v=m+1;const k=d.length-1;for(;v<=k;)w.push(v),v++;w.sort(C)}else{let v=m;const k=d.length-1;let M=d[v];for(;v<=k&&c.indexOf(M)<0;)v++,w.push(v),M=d[v];v=m-1;const O=0;for(;v>=O;)w.push(v),v--;w.sort(C).reverse()}return w}({movingCols:h,draggingRight:r,xPosition:i,pinned:o,gos:a,columnModel:l,visibleColsService:d}),p=function ZT(e,t){const r=t.getCols(),i=function DF(e){return e.sort((t,r)=>t-r)}(e.map(l=>r.indexOf(l))),s=i[0];return Le(i)-s!=i.length-1?null:s}(h,l);if(0===g.length)return;const f=g[0];let m=null!==p&&!s;if(t&&(m=null!==p),m&&!n&&(!r&&f>=p||r&&f<=p))return;const w=d.getAllCols(),C=[];let v=null;for(let M=0;M<g.length;M++){const O=g[M],y=c.getProposedColumnOrder(h,O);if(!c.doesOrderPassRules(y))continue;const L=y.filter(j=>w.includes(j));if(null===v)v=L;else if(!mi(L,v))break;const _=JT(y);C.push({move:O,fragCount:_})}if(0===C.length)return;C.sort((M,O)=>M.fragCount-O.fragCount);const k=C[0].move;return k>l.getCols().length-u.length?void 0:{columns:u,toIndex:k}}function fd(e){const{columns:t,toIndex:r}=Hp(e)||{},{finished:i,columnMoveService:s}=e;return t&&null!=r?(s.moveColumns(t,r,"uiColumnMoved",i),i?null:{columns:t,toIndex:r}):null}function JT(e){function t(i){const s=[];let n=i.getOriginalParent();for(;null!=n;)s.push(n),n=n.getOriginalParent();return s}let r=0;for(let i=0;i<e.length-1;i++){let s=t(e[i]),n=t(e[i+1]);[s,n]=s.length>n.length?[s,n]:[n,s],s.forEach(o=>{-1===n.indexOf(o)&&r++})}return r}function Ta(e){const{pinned:t,fromKeyboard:r,gos:i,ctrlsService:s,useHeaderRow:n,skipScrollPadding:o}=e;let a=s.getHeaderRowContainerCtrl(t)?.getViewportElement(),{x:l}=e;return a?(r&&(l-=a.getBoundingClientRect().left),i.get("enableRtl")&&(n&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),null==t&&!o&&(l+=s.get("center").getCenterViewportScrollLeft()),l):0}function on(e,t){for(const r of e)r.setMoving(t,"uiColumnMoved")}var s6=class extends U{constructor(e){super(),this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!te(e)}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnMoveService=e.columnMoveService,this.dragAndDropService=e.dragAndDropService,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const e=this.lastDraggingEvent?.dragItem.columns??[];for(const t of e){const r=t.getPinned();if(t.getColDef().lockPinned){if(r==this.pinned)return"move"}else{if(r===this.pinned||!this.pinned)return"move";if(!r&&this.pinned)return"pinned"}}return"notAllowed"}onDragEnter(e){const t=e.dragItem.columns;if(0===e.dragSource.type)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const i=e.dragItem.visibleState,s=(t||[]).filter(n=>i[n.getId()]);this.setColumnsVisible(s,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(t,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,r=!1,i=!1){const s=this.gos.get("suppressMoveWhenColumnDragging");if(i&&!s)return void this.finishColumnMoving();if(this.lastDraggingEvent=e,!e||!i&&Ie(e.hDirection))return;const{pinned:n,gos:o,ctrlsService:a}=this,l=Ta({x:e.x,pinned:n,gos:o,ctrlsService:a});t||this.checkCenterForScrolling(l),s?this.handleColumnDragWhileSuppressingMovement(e,t,r,l,i):this.handleColumnDragWhileAllowingMovement(e,t,r,l,i)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(!e)return;const i=e.filter(s=>!s.getColDef().lockVisible);this.columnModel.setColsVisible(i,t,r)}finishColumnMoving(){if(this.clearHighlighted(),!this.lastMovedInfo)return;const{columns:e,toIndex:t}=this.lastMovedInfo;this.columnMoveService.moveColumns(e,t,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,r,i,s){const n=this.getAllMovingColumns(e,!0);if(s){const o=this.isAttemptingToPin(n);o&&this.attemptToPinColumns(n,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(n,o)||{};if(null==a||null==l)return void this.finishColumnMoving();this.moveColumnsAfterHighlight({allMovingColumns:n,xPosition:l,fromEnter:t,fakeEvent:r,fromLeft:a})}else{if(!this.dragAndDropService.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(n,i)}}handleColumnDragWhileAllowingMovement(e,t,r,i,s){const n=this.getAllMovingColumns(e),o=1===this.normaliseDirection(e.hDirection),c=fd({...this.getMoveColumnParams({allMovingColumns:n,isFromHeader:1===e.dragSource.type,xPosition:i,fromLeft:o,fromEnter:t,fakeEvent:r}),finished:s});c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){const r=e.dragSource.getDragItem();let i=null;return t?(i=r.columnsInSplit,i||(i=r.columns)):i=r.columns,i?i.filter(n=>!n.getColDef().lockPinned||n.getPinned()==this.pinned):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:r,xPosition:i,fromLeft:s,fromEnter:n,fakeEvent:o}=e,{pinned:a,gos:l,columnModel:c,columnMoveService:d,visibleColsService:u}=this;return{allMovingColumns:t,isFromHeader:r,fromLeft:s,xPosition:i,pinned:a,fromEnter:n,fakeEvent:o,gos:l,columnModel:c,columnMoveService:d,visibleColsService:u}}findFirstAndLastMovingColumns(e){const t=e.length;let r,i;for(let s=0;s<=t;s++){if(!r){const n=e[s];null!=n.getLeft()&&(r=n)}if(!i){const n=e[t-1-s];null!=n.getLeft()&&(i=n)}if(r&&i)break}return{firstMovingCol:r,lastMovingCol:i}}highlightHoveredColumn(e,t){const{gos:r,columnModel:i}=this,s=r.get("enableRtl"),n=i.getCols().filter(d=>d.isVisible()&&d.getPinned()===this.pinned);let c,o=null,a=null,l=null;for(const d of n){if(a=d.getActualWidth(),o=this.getNormalisedColumnLeft(d,0,s),null!=o&&o<=t&&o+a>=t){l=d;break}o=null,a=null}if(l)-1!==e.indexOf(l)&&(l=null);else{for(let d=n.length-1;d>=0;d--){const u=n[d],h=n[d].getParent();if(!h){l=u;break}const g=h?.getDisplayedLeafColumns();if(g.length){l=Le(g);break}}if(!l)return;o=this.getNormalisedColumnLeft(l,0,s),a=l.getActualWidth()}this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),null!=l&&null!=o&&null!=a&&(c=t-o<a/2!==s?0:1,l.setHighlighted(c),this.lastHighlightedColumn={column:l,position:c})}getNormalisedXPositionInfo(e,t){const{gos:r,visibleColsService:i}=this,s=r.get("enableRtl"),{firstMovingCol:n,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,s);if(!n||!o||null==a)return;const l=i.getAllCols(),c=l.indexOf(n),d=l.indexOf(o),u=0===a!==s,h=c<d||c===d&&!u;let g=0;if(u?h&&(g-=1):h||(g+=1),d+g===c)return;const p=l[d+g];return p?{fromLeft:h,xPosition:this.getNormalisedColumnLeft(p,20,s)}:void 0}getColumnMoveAndTargetInfo(e,t,r){const i=this.lastHighlightedColumn||{},{firstMovingCol:s,lastMovingCol:n}=this.findFirstAndLastMovingColumns(e);if(!s||!n||i.column||!t)return{firstMovingCol:s,...i};const a="left"===this.getPinDirection();return{firstMovingCol:s,position:a?1:0,column:a!==r?s:n}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0}return e}getNormalisedColumnLeft(e,t,r){const{gos:i,ctrlsService:s}=this,n=e.getLeft();if(null==n)return null;const o=e.getActualWidth();return Ta({x:r?n+o-t:n+t,pinned:e.getPinned(),useHeaderRow:r,skipScrollPadding:!0,gos:i,ctrlsService:s})}isAttemptingToPin(e){return(this.needToMoveLeft||this.needToMoveRight)&&this.failedMoveAttempts>7||e.some(i=>i.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:r,fromEnter:i,fakeEvent:s,fromLeft:n}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:r,fromLeft:n,fromEnter:i,fakeEvent:s}),{columns:a,toIndex:l}=Hp(o)||{};a&&null!=l&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){this.lastHighlightedColumn&&(this.lastHighlightedColumn.column.setHighlighted(null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.ctrlsService.get("center"),r=t.getCenterViewportScrollLeft(),i=r+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<r+50,this.needToMoveLeft=e>i-50):(this.needToMoveLeft=e<r+50,this.needToMoveRight=e>i-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.dragAndDropService.getDragAndDropImageComponent()?.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.dragAndDropService.getDragAndDropImageComponent()?.setIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const r=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{if(this.failedMoveAttempts++,this.failedMoveAttempts<=8)return;if(this.dragAndDropService.getDragAndDropImageComponent()?.setIcon("pinned"),!this.gos.get("suppressMoveWhenColumnDragging")){const i=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(i,void 0,!0)}}}getPinDirection(){return this.needToMoveLeft||"left"===this.pinned?"left":this.needToMoveRight||"right"===this.pinned?"right":void 0}attemptToPinColumns(e,t,r=!1){const i=(e||[]).filter(s=>!s.getColDef().lockPinned);return i.length?(r&&(t=this.getPinDirection()),this.columnModel.setColsPinned(i,t,"uiColumnDragged"),r&&this.dragAndDropService.nudge(),i.length):0}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}},n6=class extends U{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(this,e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]]}}),this.moveColumnFeature=this.createManagedBean(new s6(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new QT(this.pinned)),this.dragAndDropService.addDropTarget(this),this.addDestroyFunc(()=>this.dragAndDropService.removeDropTarget(this))}isInterestedIn(e){return 1===e||0===e&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&0===e.dragSource.type}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},o6=class extends U{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.pinnedWidthService=e.pinnedWidthService,this.ctrlsService=e.ctrlsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,r,i,s){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=i,this.ctrl=s}postConstruct(){const e=[];let t,r;const i=()=>{if(et(this.eResize,t),!t)return;const o=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(o),r){const a=this.gos.get("skipHeaderOnAutoSize"),l=()=>{this.columnAutosizeService.autoSizeColumn(this.column,"uiColumnResized",a)};this.eResize.addEventListener("dblclick",l);const c=new Wi(this.eResize);c.addEventListener("doubleTap",l),e.push(()=>{this.eResize.removeEventListener("dblclick",l),c.removeEventListener("doubleTap",l),c.destroy()})}},s=()=>{e.forEach(o=>o()),e.length=0},n=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==r)&&(t=o,r=a,s(),i())};n(),this.addDestroyFunc(s),this.ctrl.setRefreshFunction("resize",n)}onResizing(e,t){const{column:r,lastResizeAmount:i,resizeStartWidth:s}=this,n=this.normaliseResizeAmount(t),a=[{key:r,newWidth:s+n}];this.column.getPinned()&&this.pinnedWidthService.getPinnedLeftWidth()+this.pinnedWidthService.getPinnedRightWidth()+(n-i)>io(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50||(this.lastResizeAmount=n,this.columnSizeService.setColumnWidths(a,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1))}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r="left"!==this.pinned,i="right"===this.pinned;return this.gos.get("enableRtl")?r&&(t*=-1):i&&(t*=-1),t}},a6=class extends U{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){const e=t=>{t&&"string"!=typeof t&&(this.selectionOptions=t)};e(this.gos.get("rowSelection")),this.addManagedPropertyListener("rowSelection",t=>e(t.currentValue))}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(Je(this.gos))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new ya),this.cbSelectAll.addCssClass("ag-header-select-all"),ir(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:this.onNewColumnsLoaded.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedListeners(this.cbSelectAll,{fieldValueChanged:this.onCbSelectAll.bind(this)}),Mc(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),r=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.headerCellCtrl.setAriaDescriptionProperty("selectAll",this.cbSelectAllVisible?`${i} (${r})`:null),this.cbSelectAll.setInputAriaLabel(`${i} (${r})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return!!Cc(this.gos)||(q(`${e} is only available if using 'multiRow' selection mode.`),!1)}checkRightRowModelType(e){return!(!it(this.gos)&&!pi(this.gos)&&(q(`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${this.rowModel.getType()}.`),1))}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),r=this.isCurrentPageOnly();let i="uiSelectAll";r?i="uiSelectAllCurrentPage":t&&(i="uiSelectAllFiltered");const s={source:i,justFiltered:t,justCurrentPage:r};e?this.selectionService.selectAllRowNodes(s):this.selectionService.deselectAllRowNodes(s)}isCheckboxSelection(){const e=this.selectionOptions,t=e&&la(e)&&Js(this.column),r=this.column.getColDef().headerCheckboxSelection;let i=!1;return i=!!t||("function"==typeof r?r(this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()})):!!r),i&&this.checkRightRowModelType(t?"headerCheckbox":"headerCheckboxSelection")&&this.checkSelectionType(t?"headerCheckbox":"headerCheckboxSelection")}isFilteredOnly(){const e=this.selectionOptions;return void 0!==e?"multiRow"===e.mode&&"filtered"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){const e=this.selectionOptions;return void 0!==e?"multiRow"===e.mode&&"currentPage"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}},l6=class extends Ra{constructor(e,t,r){super(e,t,r),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,r,i,s){this.comp=e,s=eo(this,this.beans.context,s),this.setGui(t,s),this.updateState(),this.setupWidth(s),this.setupMovingCss(s),this.setupMenuClass(s),this.setupSortableClass(s),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:i,checkMeasuringCallback:o=>this.setRefreshFunction("measuring",o),compBean:s}),this.addColumnHoverListener(s),this.setupFilterClass(s),this.setupClassesFromColDef(),this.setupTooltip(s),this.addActiveHeaderMouseListeners(s),this.setupSelectAll(s),this.setupUserComp(s),this.refreshAria(),this.resizeFeature=s.createManagedBean(new o6(this.getPinned(),this.column,r,e,this)),s.createManagedBean(new cd([this.column],t)),s.createManagedBean(new ld(this.column,t,this.beans)),s.createManagedBean(new ys(t,{shouldStopEventPropagation:o=>this.shouldStopEventPropagation(o),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(s),s.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],()=>this.refresh(s)),s.addManagedListeners(this.column,{colDefChanged:()=>this.refresh(s)}),s.addManagedListeners(this.column,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const n=()=>this.checkDisplayName(s);s.addManagedEventListeners({columnValueChanged:n,columnRowGroupChanged:n,columnPivotChanged:n,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),s.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){if(!this.column.isResizable())return;const r=this.column.getActualWidth(),i=this.column.getMinWidth(),s=this.column.getMaxWidth(),n=Math.min(Math.max(r+e,i),s);this.beans.columnSizeService.setColumnWidths([{key:this.column,newWidth:n}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,beans:r,column:i,ctrlsService:s}=this,{gos:n,columnModel:o,columnMoveService:a,visibleColsService:l}=r,c=this.getPinned(),d=t.getBoundingClientRect().left,u=i.getActualWidth(),p=Ta({x:0===e!==n.get("enableRtl")?d-20:d+u+20,pinned:c,fromKeyboard:!0,gos:n,ctrlsService:s}),f=this.focusService.getFocusedHeader();fd({allMovingColumns:[i],isFromHeader:!0,fromLeft:1===e,xPosition:p,pinned:c,fromEnter:!1,fakeEvent:!1,gos:n,columnModel:o,columnMoveService:a,visibleColsService:l,finished:!0}),s.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(i,"auto"),(!this.isAlive()||this.beans.gos.get("ensureDomOrder"))&&f&&this.restoreFocus(f)}restoreFocus(e){this.focusService.focusHeaderPosition({headerPosition:{...e,column:this.column}})}setupUserComp(e){const t=this.lookupUserCompDetails(e);this.setCompDetails(t)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(e){const t=this.createParams(e),r=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(r,t)}createParams(e){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:r=>{this.menuService.showColumnMenu({column:this.column,buttonElement:r,positionBy:"button"})},showColumnMenuAfterMouseClick:r=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:r,positionBy:"mouse"})},showFilter:r=>{this.menuService.showFilterMenu({column:this.column,buttonElement:r,containerType:"columnFilter",positionBy:"button"})},progressSort:r=>{this.beans.sortController.progressSort(this.column,!!r,"uiColumnSorted")},setSort:(r,i)=>{this.beans.sortController.setSortForColumn(this.column,r,!!i,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(r,i)=>{this.setupTooltip(e,r,i)}})}setupSelectAll(e){this.selectAllFeature=e.createManagedBean(new a6(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===N.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===N.ENTER&&this.onEnterKeyDown(e),e.key===N.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortController.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();!r||!(r instanceof Qc)||r.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const t=this.getRowIndex();this.focusService.setFocusedHeader(t,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t,r){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const i="whenTruncated"===this.gos.get("tooltipShowMode"),s=this.eGui,n=this.column.getColDef();!r&&i&&!n.headerComponent&&(r=()=>{const l=s.querySelector(".ag-header-cell-text");return!l||l.scrollWidth>l.clientWidth});const a=e.createManagedBean(new sn({getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>s,getLocation:()=>"header",getTooltipValue:()=>t??this.column.getColDef().headerTooltip,shouldDisplayTooltip:r}));this.setRefreshFunction("tooltip",()=>a.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const r=Ap(this.column.getColDef(),this.gos,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(r),r.forEach(s=>{i.has(s)?i.delete(s):this.comp.addOrRemoveCssClass(s,!0)}),i.forEach(s=>this.comp.addOrRemoveCssClass(s,!1))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:r,displayName:i,dragAndDropService:s,gos:n}=this,{columnModel:o}=r;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:()=>this.createDragItem(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),on([t],!0)},onDragStopped:()=>on([t],!1),onDragCancelled:()=>on([t],!1),onGridEnter:c=>{if(a){const d=c?.columns?.filter(u=>!u.getColDef().lockVisible)||[];o.setColsVisible(d,!0,"uiColumnMoved")}},onGridExit:c=>{if(a){const d=c?.columns?.filter(u=>!u.getColDef().lockVisible)||[];o.setColsVisible(d,!1,"uiColumnMoved")}}};s.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(e){this.updateState(),this.refreshHeaderComp(e),this.refreshAria(),Object.values(this.refreshFunctions).forEach(t=>t())}refreshHeaderComp(e){const t=this.lookupUserCompDetails(e);null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!(!t||!t.refresh)&&t.refresh(e)}calculateDisplayName(){return this.beans.columnNameService.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(e){this.displayName!==this.calculateDisplayName()&&this.refresh(e)}workOutDraggable(){const e=this.column.getColDef();return!(this.gos.get("suppressMovableColumns")||e.suppressMovable||e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const r=this.column.getActualWidth();this.comp.setWidth(`${r}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const r=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",r),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),r=1===e;this.comp.addOrRemoveCssClass("ag-header-highlight-before",0===e),this.comp.addOrRemoveCssClass("ag-header-highlight-after",r)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:r,beans:i}=this;if(!t.isSpanHeaderHeight())return e.style.removeProperty("top"),e.style.removeProperty("height"),r.addOrRemoveCssClass("ag-header-span-height",!1),void r.addOrRemoveCssClass("ag-header-span-total",!1);const{numberOfParents:s,isSpanningTotal:n}=this.column.getColumnGroupPaddingInfo();r.addOrRemoveCssClass("ag-header-span-height",s>0);const{columnModel:o}=i,a=o.getColumnHeaderRowHeight();if(0===s)return r.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height",`${a}px`);r.addOrRemoveCssClass("ag-header-span-total",n);const l=this.beans.columnModel.getGroupRowsHeight();let c=0;for(let d=0;d<s;d++)c+=l[l.length-1-d];e.style.setProperty("top",-c+"px"),e.style.setProperty("height",`${a+c}px`)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(function uR(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(Je(this.beans.gos)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,r)=>"filter"===t?-1:r.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnouncementService.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const r=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",r)};e.addManagedEventListeners({columnHoverChanged:t}),t()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(e){const t=s=>this.handleMouseOverChange("mouseenter"===s.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column),contextmenu:s=>this.handleContextMenuMouseEvent(s,void 0,this.column)})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof Qc?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy()}},c6=class extends U{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.autoWidthCalculator=e.autoWidthCalculator,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,r,i){super(),this.eResize=t,this.comp=e,this.pinned=r,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const t=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const r=[];this.columnGroup.getDisplayedLeafColumns().forEach(s=>{s.getColDef().suppressAutoSize||r.push(s.getColId())}),r.length>0&&this.columnAutosizeService.autoSizeCols({colKeys:r,skipHeader:t,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t,r="uiColumnResized"){const i=this.normaliseDragChange(t);this.resizeColumnsFromLocalValues(this.resizeStartWidth+i,r,e)}getInitialValues(e){const t=this.getColumnsToResize(),r=this.getInitialSizeOfColumns(t),s={columnsToResize:t,resizeStartWidth:r,resizeRatios:this.getSizeRatiosOfColumns(t,r)};let n=null;if(e&&(n=this.visibleColsService.getGroupAtDirection(this.columnGroup,"After")),n){const o=n.getDisplayedLeafColumns(),a=s.groupAfterColumns=o.filter(c=>c.isResizable()),l=s.groupAfterStartWidth=this.getInitialSizeOfColumns(a);s.groupAfterRatios=this.getSizeRatiosOfColumns(a,l)}else s.groupAfterColumns=void 0,s.groupAfterStartWidth=void 0,s.groupAfterRatios=void 0;return s}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:i,groupAfterColumns:s,groupAfterStartWidth:n,groupAfterRatios:o}=e;this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=i,this.resizeTakeFromCols=s,this.resizeTakeFromStartWidth=n,this.resizeTakeFromRatios=o}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t,r=!0){this.resizeCols&&this.resizeRatios&&this.resizeColumns({columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols??void 0,groupAfterStartWidth:this.resizeTakeFromStartWidth??void 0,groupAfterRatios:this.resizeTakeFromRatios??void 0},e,t,r)}resizeColumns(e,t,r,i=!0){const{columnsToResize:s,resizeStartWidth:n,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,d=[];d.push({columns:s,ratios:o,width:t}),a&&d.push({columns:a,ratios:c,width:l-(t-n)}),this.columnSizeService.resizeColumnSets({resizeSets:d,finished:i,source:r}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}getInitialSizeOfColumns(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}getSizeRatiosOfColumns(e,t){return e.map(r=>r.getActualWidth()/t)}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}},d6=class extends U{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}},u6=class extends Ra{constructor(e,t,r){super(e,t,r),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const i=this.getGui();this.setDragSource(i)}},this.column=e}setComp(e,t,r,i,s){this.comp=e,s=eo(this,this.beans.context,s),this.setGui(t,s),this.displayName=this.beans.columnNameService.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(s),this.setupExpandable(s),this.setupTooltip(s),this.setupAutoHeight({wrapperElement:i,compBean:s}),this.setupUserComp(s),this.addHeaderMouseListeners(s);const n=this.getParentRowCtrl().getPinned(),o=this.column.getProvidedColumnGroup().getLeafColumns();s.createManagedBean(new cd(o,t)),s.createManagedBean(new ld(this.column,t,this.beans)),s.createManagedBean(new d6(e,this.column)),this.resizeFeature=s.createManagedBean(new c6(e,r,n,this.column)),s.createManagedBean(new ys(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(s,o),s.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(s),s.addDestroyFunc(()=>this.clearComponent())}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const r of t)e.addManagedListeners(r,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,r)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),r=t[0]===e,i=Le(t)===e;if(!r&&!i)return;const s=e.getHighlighted();let o=!1,a=!1;if(this.getParentRowCtrl().findHeaderCellCtrl(l=>l.getColumnGroupChild().isMoving())){const l=this.beans.gos.get("enableRtl"),c=1===s,d=0===s;r&&(l?a=c:o=d),i&&(l?o=d:a=c)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",o),this.comp.addOrRemoveCssClass("ag-header-highlight-after",a)}getColumn(){return this.column}resizeHeader(e,t){if(!this.resizeFeature)return;const r=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(r,r.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:r,column:i,ctrlsService:s}=this,{gos:n,columnModel:o,columnMoveService:a,visibleColsService:l}=t,c=n.get("enableRtl"),d=0===e,u=this.getPinned(),h=r.getBoundingClientRect(),g=h.left,f=Ta({x:d!==c?g-20:g+h.width+20,pinned:u,fromKeyboard:!0,gos:n,ctrlsService:s}),m=i.getGroupId(),w=this.focusService.getFocusedHeader();fd({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,fromLeft:1===e,xPosition:f,pinned:u,fromEnter:!1,fakeEvent:!1,gos:n,columnModel:o,columnMoveService:a,visibleColsService:l,finished:!0});const C=i.getDisplayedLeafColumns(),v=d?C[0]:Le(C);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(v,"auto"),(!this.isAlive()||this.beans.gos.get("ensureDomOrder"))&&w&&this.restoreFocus(m,i,w)}restoreFocus(e,t,r){const i=t.getLeafColumns();if(!i.length)return;const s=i[0].getParent();if(!s)return;const n=this.findGroupWidthId(s,e);n&&this.focusService.focusHeaderPosition({headerPosition:{...r,column:n}})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(e){const t=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:i=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),i,"gridInitializing")},setTooltip:(i,s)=>{this.setupTooltip(e,i,s)}}),r=this.userComponentFactory.getHeaderGroupCompDetails(t);this.comp.setUserCompDetails(r)}addHeaderMouseListeners(e){const t=s=>this.handleMouseOverChange("mouseenter"===s.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),contextmenu:s=>this.handleContextMenuMouseEvent(s,void 0,this.column.getProvidedColumnGroup())})}handleMouseOverChange(e){this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t,r){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const i=this.column.getColGroupDef(),s="whenTruncated"===this.gos.get("tooltipShowMode"),n=this.eGui;!r&&s&&!i?.headerGroupComponent&&(r=()=>{const a=n.querySelector(".ag-header-group-text");return!a||a.scrollWidth>a.clientWidth});const o={getColumn:()=>this.column,getGui:()=>n,getLocation:()=>"headerGroup",getTooltipValue:()=>t??(i&&i.headerTooltip),shouldDisplayTooltip:r};i&&(o.getColDef=()=>i),e.createManagedBean(new sn(o))}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const r=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:r,expandableChanged:r})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.comp.setAriaExpanded(this.expandable?t?"true":"false":void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=Ap(e,this.gos,null,this.column);this.column.isPadding()?(t.push("ag-header-group-cell-no-group"),this.column.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&t.push("ag-header-span-height")):(t.push("ag-header-group-cell-with-group"),e?.wrapHeaderText&&t.push("ag-header-cell-wrap-text")),t.forEach(r=>this.comp.addOrRemoveCssClass(r,!0))}setupMovingCss(e){const r=this.column.getProvidedColumnGroup().getLeafColumns(),i=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());r.forEach(s=>{e.addManagedListeners(s,{movingChanged:i})}),i()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const t=this.getRowIndex();this.beans.focusService.setFocusedHeader(t,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===N.ENTER){const r=this.column,i=!r.isExpanded();this.beans.columnModel.setColumnGroupOpened(r.getProvidedColumnGroup(),i,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),!e))return;const{beans:t,column:r,displayName:i,gos:s,dragAndDropService:n}=this,{columnModel:o}=t,a=r.getProvidedColumnGroup().getLeafColumns();let l=!s.get("suppressDragLeaveHidesColumns");const c=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?"hide":"notAllowed",dragItemName:i,getDragItem:()=>this.getDragItemForGroup(r),onDragStarted:()=>{l=!s.get("suppressDragLeaveHidesColumns"),on(a,!0)},onDragStopped:()=>on(a,!1),onDragCancelled:()=>on(a,!1),onGridEnter:d=>{if(l){const{columns:u=[],visibleState:h}=d??{},g=u.filter(p=>!p.getColDef().lockVisible&&(!h||h[p.getColId()]));o.setColsVisible(g,!0,"uiColumnMoved")}},onGridExit:d=>{if(l){const u=d?.columns?.filter(h=>!h.getColDef().lockVisible)||[];o.setColsVisible(u,!1,"uiColumnMoved")}}};n.addDragSource(c,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),r={};t.forEach(o=>r[o.getId()]=o.isVisible());const i=[];this.beans.visibleColsService.getAllCols().forEach(o=>{t.indexOf(o)>=0&&(i.push(o),qt(t,o))}),t.forEach(o=>i.push(o));const s=[],n=e.getLeafColumns();for(const o of i)-1!==n.indexOf(o)&&s.push(o);return{columns:i,columnsInSplit:s,visibleState:r}}isSuppressMoving(){let e=!1;return this.column.getLeafColumns().forEach(r=>{(r.getColDef().suppressMovable||r.getColDef().lockPosition)&&(e=!0)}),e||this.gos.get("suppressMovableColumns")}destroy(){super.destroy()}},h6=0,md=class extends U{constructor(e,t,r){super(),this.instanceId=h6++,this.rowIndex=e,this.pinned=t,this.type=r,this.headerRowClass="ag-header-row "+("group"==r?"ag-header-row-column-group":"filter"==r?"ag-header-row-column-filter":"ag-header-row-column")}wireBeans(e){this.beans=e}postConstruct(){this.isPrintLayout=Pt(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return!!this.comp&&this.getHeaderCellCtrls().every(e=>null!=e.getGui())}setComp(e,t,r=!0){this.comp=e,t=eo(this,this.beans.context,t),r&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this);e.addManagedEventListeners({columnResized:this.onColumnResized.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:r=>this.onVirtualColumnsChanged(r.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),e.addManagedPropertyListener("ensureDomOrder",r=>this.isEnsureDomOrder=r.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}getHeaderCellCtrl(e){if(this.headerCellCtrls)return ia(this.headerCellCtrls).find(t=>t.getColumnGroupChild()===e)}onDisplayedColumnsChanged(){this.isPrintLayout=Pt(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleColsService:e}=this.beans;return this.isPrintLayout?null!=this.pinned?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans,r=[],i=e.getGroupRowsHeight(),s=e.getColumnHeaderRowHeight();r.push(...i),r.push(s),t?.hasFloatingFilters()&&r.push(e.getFloatingFiltersHeight());let n=0;for(let a=0;a<this.rowIndex;a++)n+=r[a];return{topOffset:n,rowHeight:r[this.rowIndex]}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(e=!1){const t=this.getHeaderCtrls();this.comp.setHeaderCtrls(t,this.isEnsureDomOrder||this.isPrintLayout,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const i of t)this.recycleAndCreateHeaderCtrls(i,e);const r=i=>{const{focusService:s,visibleColsService:n}=this.beans;return!!s.isHeaderWrapperFocused(i)&&n.isVisible(i.getColumnGroupChild())};if(e)for(const[i,s]of e)r(s)?this.headerCellCtrls.set(i,s):this.destroyBean(s);return this.getHeaderCellCtrls()}getHeaderCellCtrls(){return Array.from(this.headerCellCtrls?.values()??[])}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls||e.isEmptyGroup())return;const r=e.getUniqueId();let i;if(t&&(i=t.get(r),t.delete(r)),i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),null==i)switch(this.type){case"filter":i=this.createBean(this.beans.ctrlsFactory.getInstance("headerFilterCell",e,this.beans,this));break;case"group":i=this.createBean(new u6(e,this.beans,this));break;default:i=this.createBean(new l6(e,this.beans,this))}this.headerCellCtrls.set(r,i)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let e=[];const t=this.getActualDepth(),{columnViewportService:r}=this.beans;return["left",null,"right"].forEach(i=>{const s=r.getHeadersToRender(i,t);e=e.concat(s)}),e}getActualDepth(){return"filter"==this.type?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnViewportService.getHeadersToRender(this.pinned,this.getActualDepth())}findHeaderCellCtrl(e){if(!this.headerCellCtrls)return;let r;return r=this.getHeaderCellCtrls().find("function"==typeof e?e:i=>i.getColumnGroupChild()==e),r}focusHeader(e,t){const r=this.findHeaderCellCtrl(e);return!!r&&r.focus(t)}destroy(){this.headerCellCtrls?.forEach(e=>{this.destroyBean(e)}),this.headerCellCtrls=void 0,super.destroy()}},g6=class extends U{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}wireBeans(e){this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.focusService=e.focusService,this.filterManager=e.filterManager}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport);const r=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:r,advancedFilterEnabledChanged:r}),this.ctrlsService.register(`${"string"==typeof this.pinned?this.pinned:"center"}Header`,this),this.columnModel.isReady()&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const t=new rn,r=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const a=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let l=0;l<a;l++){const c=this.createBean(new md(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(c)}})(),(()=>{const a=t.next(),l=!(this.hidden||null!=this.columnsRowCtrl&&e&&this.columnsRowCtrl.getRowIndex()===a);(l||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),l&&(this.columnsRowCtrl=this.createBean(new md(a,this.pinned,"column")))})(),(()=>{this.includeFloatingFilter=!!this.filterManager?.hasFloatingFilters()&&!this.hidden;const a=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void a();const l=t.next();if(this.filtersRowCtrl){const c=this.filtersRowCtrl.getRowIndex()!==l;(!e||c)&&a()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new md(l,this.pinned,"filter")))})();const o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(r)}getHeaderCtrlForColumn(e){if(zi(e))return this.columnsRowCtrl?.getHeaderCellCtrl(e);if(0!==this.groupsRowCtrls.length)for(let t=0;t<this.groupsRowCtrls.length;t++){const r=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(r)return r}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const r=this.getAllCtrls()[e];return r?r.getType():void 0}focusHeader(e,t,r){const s=this.getAllCtrls()[e];return!!s&&s.focusHeader(t,r)}getViewportElement(){return this.eViewport}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}setupDragAndDrop(e){const t=new n6(this.pinned,e);this.createManagedBean(t)}restoreFocusOnHeader(e){if(!e)return;const{column:t}=e;t.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.filterManager?.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new gd(e=>this.comp.setCenterWidth(`${e}px`),!0))}setupPinnedWidth(){if(null==this.pinned)return;const e="left"===this.pinned,t="right"===this.pinned;this.hidden=!0;const r=()=>{const i=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==i)return;const s=0==i,n=this.hidden!==s,o=this.gos.get("enableRtl"),a=this.scrollVisibleService.getScrollbarWidth(),c=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&e||!o&&t)?i+a:i;this.comp.setPinnedContainerWidth(`${c}px`),this.comp.setDisplayed(!s),n&&(this.hidden=s,this.refresh())};this.addManagedEventListeners({leftPinnedWidthChanged:r,rightPinnedWidthChanged:r,scrollVisibilityChanged:r,scrollbarWidthChanged:r})}},vd=class extends Ge{constructor(e){super(),this.eCenterContainer=de,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();const e={setDisplayed:r=>this.setDisplayed(r),setCtrls:r=>this.setCtrls(r),setCenterWidth:r=>this.eCenterContainer.style.width=r,setViewportScrollLeft:r=>this.getGui().scrollLeft=r,setPinnedContainerWidth:r=>{const i=this.getGui();i.style.width=r,i.style.maxWidth=r,i.style.minWidth=r}};this.createManagedBean(new g6(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){this.setTemplate("left"==this.pinned?'<div class="ag-pinned-left-header" role="rowgroup"></div>':"right"==this.pinned?'<div class="ag-pinned-right-header" role="rowgroup"></div>':'<div class="ag-header-viewport" role="presentation">\n        <div class="ag-header-container" data-ref="eCenterContainer" role="rowgroup"></div>\n    </div>'),this.eRowContainer=this.eCenterContainer!==de?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const t=this.headerRowComps;let r;this.headerRowComps={},this.rowCompsList=[];const i=s=>{const n=s.getGui();n.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(n),r&&qf(this.eRowContainer,n,r),r=n};e.forEach(s=>{const n=s.instanceId,o=t[n];delete t[n];const a=o||this.createBean(new KT(s));this.headerRowComps[n]=a,this.rowCompsList.push(a),i(a)}),Hi(t).forEach(s=>this.destroyRowComp(s))}},C6={selector:"AG-HEADER-ROOT",component:class extends Ge{constructor(){super('<div class="ag-header" role="presentation"/>')}postConstruct(){const e={addOrRemoveCssClass:(i,s)=>this.addOrRemoveCssClass(i,s),setHeightAndMinHeight:i=>{this.getGui().style.height=i,this.getGui().style.minHeight=i}};this.createManagedBean(new XT).setComp(e,this.getGui(),this.getFocusableElement());const r=i=>{this.createManagedBean(i),this.appendChild(i)};r(new vd("left")),r(new vd(null)),r(new vd("right"))}}},Cd=class extends U{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e};this.view.updateLayoutClasses(t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal",t)}getDomLayout(){const e=this.gos.get("domLayout")??"normal";return-1===["normal","print","autoHeight"].indexOf(e)?(q(`${e} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):e}},S6={selector:"AG-OVERLAY-WRAPPER",component:class extends Ge{constructor(){super('\n            <div class="ag-overlay" role="presentation">\n                <div class="ag-overlay-panel" role="presentation">\n                    <div class="ag-overlay-wrapper" data-ref="eOverlayWrapper" role="presentation"></div>\n                </div>\n            </div>'),this.eOverlayWrapper=de,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeOverlayWrapperCssClass=null,this.elToFocusAfter=null}wireBeans(e){this.overlayService=e.overlayService,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}handleKeyDown(e){if(e.key!==N.TAB||e.defaultPrevented||vi(e)||this.focusService.findNextFocusableElement(this.eOverlayWrapper,!1,e.shiftKey))return;let r=!1;r=e.shiftKey?this.focusService.focusGridView(Le(this.visibleColsService.getAllCols()),!0,!1):this.focusService.focusNextGridCoreContainer(!1),r&&e.preventDefault()}updateLayoutClasses(e,t){const r=this.eOverlayWrapper.classList;r.toggle("ag-layout-auto-height",t.autoHeight),r.toggle("ag-layout-normal",t.normal),r.toggle("ag-layout-print",t.print)}postConstruct(){this.createManagedBean(new Cd(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&t.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r,i){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),r&&this.focusService.isGridFocused()){const s=Je(this.gos);s&&!mf(this.gos)&&(this.elToFocusAfter=s)}e.then(s=>{if(this.activePromise!==e)return void(this.activeOverlay!==s&&(this.destroyBean(s),s=null));if(this.activePromise=null,!s)return;if(this.activeOverlay!==s&&(this.eOverlayWrapper.appendChild(s.getGui()),this.activeOverlay=s,i)){const o=s;this.updateListenerDestroyFunc=this.addManagedPropertyListener(i,({currentValue:a})=>{o.refresh?.(this.gos.addGridCommonParams({...a??{}}))})}const n=this.focusService;r&&n.isGridFocused()&&n.focusInto(this.eOverlayWrapper)})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.focusService.isGridFocused()&&(t=null);const r=this.updateListenerDestroyFunc;r&&(r(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Vt(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.overlayService.setOverlayWrapperComp(void 0),super.destroy()}}},Vp=class extends Ge{constructor(e,t){super(),this.direction=t,this.eViewport=de,this.eContainer=de,this.hideTimeout=null,this.setTemplate(e)}wireBeans(e){this.animationFrameService=e.animationFrameService}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Vf()||Vi())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=Uf(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),r=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)}})}attemptSettingScrollPosition(e){const t=this.getViewportElement();!function vF(e,t,r=100,i){const s=(new Date).getTime();let n=null,o=!1;const a=()=>{const l=(new Date).getTime()-s>r;(e()||l)&&(t(),o=!0,null!=n&&(window.clearInterval(n),n=null),l&&i&&q(i))};a(),o||(n=window.setInterval(a,10))}(()=>zr(t),()=>this.setScrollPosition(e),100)}getViewportElement(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}},b6={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:class extends Vp{constructor(){super('<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" data-ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" data-ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" data-ref="eRightSpacer"></div>\n        </div>',"horizontal"),this.eLeftSpacer=de,this.eRightSpacer=de}wireBeans(e){super.wireBeans(e),this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new gd(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.visibleColsService.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,i=this.scrollVisibleService.getScrollbarWidth();r&&(t+=i),Vr(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=i);let s=this.visibleColsService.getColsLeftWidth();this.enableRtl&&e&&(s+=i),Vr(this.eLeftSpacer,s),this.eLeftSpacer.classList.toggle("ag-scroller-corner",s<=i)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),i=e&&this.scrollVisibleService.getScrollbarWidth()||0,n=r?0:0===i&&t?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),no(this.getGui(),n),no(this.eViewport,n),no(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return wa(this.getViewportElement(),this.enableRtl)}setScrollPosition(e){zr(this.getViewportElement())||this.attemptSettingScrollPosition(e),xa(this.getViewportElement(),e,this.enableRtl)}}},Wp=class extends U{wireBeans(e){this.maxDivHeightScaler=e.rowContainerHeightService}constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this)})}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?`${e}px`:"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}},F6={selector:"AG-FAKE-VERTICAL-SCROLL",component:class extends Vp{wireBeans(e){super.wireBeans(e),this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}constructor(){super('<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" data-ref="eContainer"></div>\n            </div>\n        </div>',"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new Wp(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this)})}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,r=e&&this.scrollVisibleService.getScrollbarWidth()||0,i=0===r&&t?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),Vr(this.getGui(),i),Vr(this.eViewport,i),Vr(this.eContainer,i),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:e}=this,r=e.getGridBodyCtrl().getBodyViewportElement(),i=this.getScrollPosition(),s=r.scrollTop;i!=s&&this.setScrollPosition(s,!0)}getScrollPosition(){return this.getViewportElement().scrollTop}setScrollPosition(e,t){!t&&!zr(this.getViewportElement())&&this.attemptSettingScrollPosition(e),this.getViewportElement().scrollTop=e}}},wd=(e=>(e.FakeHScrollbar="fakeHScrollComp",e.Header="centerHeader",e.PinnedTop="topCenter",e.PinnedBottom="bottomCenter",e.StickyTop="stickyTopCenter",e.StickyBottom="stickyBottomCenter",e))(wd||{}),R6=class extends U{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=Yt(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=Yt(()=>this.lastScrollSource[0]=null,500)}wireBeans(e){this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.rowModel=e.rowModel,this.heightScaler=e.rowContainerHeightService,this.rowRenderer=e.rowRenderer,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)}),this.ctrlsService.whenReady(this,e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.getViewportElement(),{scroll:this.onHScroll.bind(this,"Viewport")});for(const e of Object.values(wd)){const t=this.ctrlsService.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsService.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),r=t?Yt(this.onVScroll.bind(this,"Viewport"),100):this.onVScroll.bind(this,"Viewport"),i=t?Yt(this.onVScroll.bind(this,"fakeVScrollComp"),100):this.onVScroll.bind(this,"fakeVScrollComp");this.addManagedElementListeners(this.eBodyViewport,{scroll:r}),this.registerScrollPartner(e,i)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){null!=this.centerRowsCtrl&&(void 0===e&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...Object.values(wd),"Viewport"])this.lastScrollSource[1]!==t&&xa(this.getViewportForSource(t),e,this.enableRtl)}getViewportForSource(e){return"Viewport"===e?this.centerRowsCtrl.getViewportElement():this.ctrlsService.get(e).getViewportElement()}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(0===t?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;const i=wa(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(Math.round(i)),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;t="Viewport"===e?this.eBodyViewport.scrollTop:this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),!this.shouldBlockScrollUpdate(0,t,!0)&&(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,"Viewport"===e?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:1===e?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{this.eventService.dispatchEvent({...t,type:"bodyScrollEnd"})},100)}shouldBlockScrollUpdate(e,t,r=!1){return!(r&&!Vi())&&(0===e?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=Kc(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&Ca()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll("Viewport")}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(e=this.enableRtl&&Ca()?e>0?0:i:Math.min(Math.max(e,0),i)),xa(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){return this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight,{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const r=this.rowModel.getRowCount();let i=-1;for(let s=0;s<r;s++){const n=this.rowModel.getRow(s);if("function"==typeof e){if(n&&e(n)){i=s;break}}else if(e===n||e===n.data){i=s;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t){if(Pt(this.gos,"print"))return;const r=this.rowModel.getRowCount();if("number"!=typeof e||e<0||e>=r)return void q("Invalid row index for ensureIndexVisible: "+e);const s=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{s||this.paginationService?.goToPageWithIndex(e);const n=this.ctrlsService.getGridBodyCtrl(),o=n.getStickyTopHeight(),a=n.getStickyBottomHeight(),l=this.rowModel.getRow(e);let c;do{const d=l.rowTop,u=l.rowHeight,h=this.pageBoundsService.getPixelOffset(),g=l.rowTop-h,p=g+l.rowHeight,f=this.getVScrollPosition(),m=this.heightScaler.getDivStretchOffset(),w=f.top+m,C=f.bottom+m,v=C-w,k=this.heightScaler.getScrollPositionForPixel(g),M=this.heightScaler.getScrollPositionForPixel(p-v),O=Math.min((k+M)/2,g);let _=null;"top"===t?_=k:"bottom"===t?_=M:"middle"===t?_=O:w+o>g?_=k-o:C-a<p&&(_=M+a),null!==_&&(this.setVerticalScrollPosition(_),this.rowRenderer.redraw({afterScroll:!0})),c=d!==l.rowTop||u!==l.rowHeight}while(c);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(e,t="auto"){const r=this.columnModel.getCol(e);if(!r||r.isPinned()||!this.visibleColsService.isColDisplayed(r))return;const i=this.getPositionedHorizontalScroll(r,t);this.getFrameworkOverrides().wrapIncoming(()=>{null!==i&&this.centerRowsCtrl.setCenterViewportScrollLeft(i),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:i}=this.isColumnOutsideViewport(e),s=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),n=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:i)||s,l=o?i:r;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:d,colMiddle:u,colRight:h}=this.getColumnBounds(e);return c?u-n/2:a?o?h:d:o?d-n:h-n}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:i,colRight:s}=this.getColumnBounds(e),n=this.enableRtl;return{columnBeforeStart:n?t>s:r<s,columnAfterEnd:n?r<i:t>i}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleColsService.getBodyContainerWidth(),i=e.getActualWidth(),s=e.getLeft(),n=t?-1:1,o=t?r-s:s;return{colLeft:o,colMiddle:o+i/2*n,colRight:o+i*n}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}},k6=class extends U{wireBeans(e){this.ctrlsService=e.ctrlsService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.columnViewportService=e.columnViewportService}constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const e=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleService.onCentreViewportResized(),this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnSizeService.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const t=io(this.gridBodyCtrl.getBodyViewportElement());if(t<=50)return;let r=this.getPinnedColumnsOverflowingViewport(t-50);const i=this.gos.getCallback("processUnpinnedColumns");r.length&&(i&&(r=i({columns:r,viewportWidth:t})),this.columnModel.setColsPinned(r,null,"viewportSizeFeature"))}getPinnedColumnsOverflowingViewport(e){const i=this.pinnedWidthService.getPinnedRightWidth()+this.pinnedWidthService.getPinnedLeftWidth();if(i<e)return[];const s=[...this.visibleColsService.getLeftCols()],n=[...this.visibleColsService.getRightCols()];let o=0,a=0;const c=[];let d=i-0-e;for(;(a<s.length||o<n.length)&&d>0;){if(o<n.length){const u=n[o++];d-=u.getActualWidth(),c.push(u)}if(a<s.length&&d>0){const u=s[a++];d-=u.getActualWidth(),c.push(u)}}return c}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const t=Kc(this.gridBodyCtrl.getBodyViewportElement());this.bodyHeight!==t&&(this.bodyHeight=t,this.eventService.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnViewportService.setScrollPosition(e,t)}},T6=class extends U{wireBeans(e){this.dragService=e.dragService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){this.rangeService&&(this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ei(this.gos)?this.enableFeature():this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature()),ei(this.gos)&&this.enableFeature())}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}},D6=class extends Ge{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[Zc]),this.eCheckbox=de}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),r=Ic(e,t),[i,s]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],n=e(i,s);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${n} (${r})`)}onClicked(e,t,r){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:r.shiftKey,groupSelectsFiltered:t,event:r,source:"checkboxSelected"})}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:i=>Zs(i),click:i=>{Zs(i);const s="filteredDescendants"===wc(this.gos),n=this.eCheckbox.getValue();this.shouldHandleIndeterminateState(n,s)?0===this.onClicked(!0,s,i||{})&&this.onClicked(!1,s,i):n?this.onClicked(!1,s,i):this.onClicked(!0,s,i||{})}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),vc(this.gos)||"function"==typeof this.getIsVisible()){const i=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i}),this.addManagedListeners(this.rowNode,{dataChanged:i,cellChanged:i}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&it(this.gos)}showOrHideSelect(){let e=this.rowNode.selectable;const t=this.getIsVisible();if(e)if("function"==typeof t){const s=this.overrides?.callbackParams;if(this.column){const n=this.column.createColumnFunctionCallbackParams(this.rowNode);e=t({...s,...n})}else e=t({...s,node:this.rowNode,data:this.rowNode.data})}else e=t??!1;const r=this.gos.get("rowSelection");if(r&&"string"!=typeof r?!function yF(e){return e?.hideDisabledCheckboxes??!1}(r):this.column?.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!e),this.setVisible(!0),void this.setDisplayed(!0);this.overrides?.removeHidden?this.setDisplayed(e):this.setVisible(e)}getIsVisible(){if(this.overrides)return this.overrides.isVisible;const e=this.gos.get("rowSelection");return e&&"string"!=typeof e?Qs(e):this.column?.getColDef()?.checkboxSelection}},A6=class extends Ge{constructor(e,t,r){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=r}postConstruct(){this.getGui().appendChild(fr("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0),t?t(this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e})):(()=>{try{const i=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",i),e.dataTransfer.setData("text/plain",i)}catch{}})()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}},P6=class extends U{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,r=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,r,i=>this.cellComp.addOrRemoveCssClass(i,!0),i=>this.cellComp.addOrRemoveCssClass(i,!1)),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if("function"==typeof e.cellStyle){const r=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});t=(0,e.cellStyle)(r)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(r=>this.cellComp.addOrRemoveCssClass(r,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(r=>this.cellComp.addOrRemoveCssClass(r,!0))}destroy(){super.destroy()}},M6=class extends U{constructor(e,t,r,i,s){super(),this.cellCtrl=e,this.beans=t,this.rowNode=i,this.rowCtrl=s}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case N.ENTER:this.onEnterKeyDown(e);break;case N.F2:this.onF2KeyDown(e);break;case N.ESCAPE:this.onEscapeKeyDown(e);break;case N.TAB:this.onTabKeyDown(e);break;case N.BACKSPACE:case N.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case N.DOWN:case N.UP:case N.RIGHT:case N.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:r,beans:i,rowNode:s}=this,{gos:n,rangeService:o,eventService:a}=i;if(!r.isEditing()){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),function tT(e,t=!1){return e===N.DELETE||!t&&e===N.BACKSPACE&&Vf()}(e,n.get("enableCellEditingOnBackspace"))){if(o&&ei(n))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const l=r.getColumn(),c=this.beans.valueService.getDeleteValue(l,s);s.setDataValue(l,c,"cellClear")}}else r.startRowOrCellEdit(e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){this.cellCtrl.isEditing()||this.rowCtrl.isEditing()?this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey):this.beans.gos.get("enterNavigatesVertically")?this.beans.navigationService.navigateToNextCell(null,e.shiftKey?N.UP:N.DOWN,this.cellCtrl.getCellPosition(),!1):(this.cellCtrl.startRowOrCellEdit(N.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault())}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(N.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const i=e.key;" "===i?this.onSpaceKeyDown(e):this.cellCtrl.startRowOrCellEdit(i,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&sa(t)){const r=this.rowNode.isSelected(),i=!r,s="filteredDescendants"===wc(t),n=this.rowNode.setSelectedParams({newValue:i,rangeSelect:e.shiftKey,groupSelectsFiltered:s,event:e,source:"spaceKey"});void 0===r&&0===n&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:s,event:e,source:"spaceKey"})}e.preventDefault()}destroy(){super.destroy()}},I6=class extends U{constructor(e,t,r){super(),this.cellCtrl=e,this.beans=t,this.column=r}onMouseEvent(e,t){if(!vi(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();const{eventService:t,rangeService:r,gos:i}=this.beans;r&&(e.ctrlKey||e.metaKey)&&r.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&r.intersectLastRange(!0);const n=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(n);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{o.onCellClicked(n)})},0),(i.get("singleClickEdit")||o.singleClickEdit)&&!i.get("suppressClickEdit")&&(!e.shiftKey||0==r?.getCellRanges().length)&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!Vi()||Rf("dblclick"))return!1;const e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const{column:t,beans:r,cellCtrl:i}=this,{eventService:s,frameworkOverrides:n,gos:o}=r,a=t.getColDef(),l=i.createEvent(e,"cellDoubleClicked");s.dispatchEvent(l),"function"==typeof a.onCellDoubleClicked&&window.setTimeout(()=>{n.wrapOutgoing(()=>{a.onCellDoubleClicked(l)})},0),!o.get("singleClickEdit")&&!o.get("suppressClickEdit")&&i.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:r,shiftKey:i}=e,s=e.target,{cellCtrl:n,beans:o}=this,{eventService:a,rangeService:l,focusService:c,gos:d}=o;if(this.isRightClickInExistingRange(e))return;const u=l&&0!=l.getCellRanges().length;if(!i||!u){const g=d.get("enableCellTextSelection")&&e.defaultPrevented,p=(ri()||g)&&!n.isEditing()&&!$c(s);n.focusCell(p)}if(i&&u&&!c.isCellFocused(n.getCellPosition())){e.preventDefault();const h=c.getFocusedCell();if(h){const{column:g,rowIndex:p,rowPinned:f}=h,w=o.rowRenderer.getRowByPosition({rowIndex:p,rowPinned:f})?.getCellCtrl(g);w?.isEditing()&&w.stopEditing(),c.setFocusedCell({column:g,rowIndex:p,rowPinned:f,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(s)){if(l){const h=this.cellCtrl.getCellPosition();i?l.extendLatestRangeToCell(h):l.setRangeToCell(h,t||r)}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),i=2===e.button||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(r&&i)return!0}return!1}containsWidget(e){return tn(e,"ag-selection-checkbox",3)}onMouseOut(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),this.beans.columnHoverService.clearMouseOver())}onMouseOver(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),this.beans.columnHoverService.setMouseOver([this.column]))}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),r=t.contains(e.target),i=t.contains(e.relatedTarget);return r&&i}destroy(){super.destroy()}},L6=class extends U{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();mi(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else{let r=this.column;const i=this.column.getPinned();for(let s=0;r&&s<e&&(t.push(r),r=this.beans.visibleColsService.getColAfter(r),r&&!Ie(r)&&i===r.getPinned());s++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gos.get("enableRtl")&&this.colsSpanning?Le(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;const t=this.beans.visibleColsService.getColsLeftWidth();return"right"===this.column.getPinned()?t+this.beans.visibleColsService.getBodyContainerWidth()+(e||0):t+(e||0)}applyRowSpan(e){if(1===this.rowSpan&&!e)return;const r=fs(this.beans.gos)*this.rowSpan;this.eGui.style.height=`${r}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},ho="ag-cell-range-selected",tD=0,Up=class _d extends U{constructor(t,r,i,s){super(),this.column=t,this.rowNode=r,this.beans=i,this.rowCtrl=s,this.cellRangeFeature=void 0,this.cellPositionFeature=void 0,this.cellCustomStyleFeature=void 0,this.tooltipFeature=void 0,this.cellMouseListenerFeature=void 0,this.cellKeyboardListenerFeature=void 0,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],this.instanceId=t.getId()+"-"+tD++,this.colIdSanitised=ti(this.column.getId()),this.createCellPosition(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}onFocusOut(){this.beans.focusService.clearRestoreFocus()}addFeatures(){this.cellPositionFeature=new L6(this,this.beans),this.cellCustomStyleFeature=new P6(this,this.beans),this.cellMouseListenerFeature=new I6(this,this.beans,this.column),this.cellKeyboardListenerFeature=new M6(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature(),this.beans.rangeService&&ei(this.beans.gos)&&(this.cellRangeFeature=new class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onCellSelectionChanged()}onCellSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(ho,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(`${ho}-1`,1===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${ho}-2`,2===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${ho}-3`,3===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${ho}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),fa(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),i=!t&&e.right,s=!t&&e.bottom,n=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",!t&&e.top),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",s),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",n)}isSingleCell(){const{rangeService:e}=this.beans;return 1===this.rangeCount&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(r=>vs([1,0],r.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,r=!1,i=!1,s=!1;const n=this.cellCtrl.getCellPosition().column,o=this.beans.visibleColsService;let a,l;e?(a=o.getColAfter(n),l=o.getColBefore(n)):(a=o.getColBefore(n),l=o.getColAfter(n));const c=this.rangeService.getCellRanges().filter(d=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),d));a||(s=!0),l||(r=!0);for(let d=0;d<c.length&&!(t&&r&&i&&s);d++){const u=c[d],h=this.rangeService.getRangeStartRow(u),g=this.rangeService.getRangeEndRow(u);!t&&this.beans.rowPositionUtils.sameRow(h,this.cellCtrl.getCellPosition())&&(t=!0),!i&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(i=!0),!s&&a&&u.columns.indexOf(a)<0&&(s=!0),!r&&l&&u.columns.indexOf(l)<0&&(r=!0)}return{top:t,right:r,bottom:i,left:s}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),r=t.length;if(this.rangeCount<1||r<1)return!1;const i=Le(t),s=this.cellCtrl.getCellPosition(),n=xf(e)&&!this.cellCtrl.isSuppressFillHandle(),o=function RF(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!=typeof t&&"range"===t.handle?.mode:e.get("enableRangeHandle")}(e);let a=1===r&&!this.cellCtrl.isEditing()&&(n||o);if(this.hasChartRange){const c=1===t[0].type&&this.rangeService.isCellInSpecificRange(s,t[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",c),a=0===i.type}return a&&null!=i.endRow&&this.rangeService.isContiguousRange(i)&&this.rangeService.isBottomRightCell(i,s)}addSelectionHandle(){const e=Le(this.rangeService.getCellRanges()).type,r=xf(this.beans.gos)&&Ie(e)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==r&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(r)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}}(this.beans,this))}removeFeatures(){const t=this.beans.context;this.cellPositionFeature=t.destroyBean(this.cellPositionFeature),this.cellCustomStyleFeature=t.destroyBean(this.cellCustomStyleFeature),this.cellMouseListenerFeature=t.destroyBean(this.cellMouseListenerFeature),this.cellKeyboardListenerFeature=t.destroyBean(this.cellKeyboardListenerFeature),this.cellRangeFeature=t.destroyBean(this.cellRangeFeature),this.disableTooltipFeature()}enableTooltipFeature(t,r){const s="whenTruncated"===this.beans.gos.get("tooltipShowMode");!r&&s&&!this.isCellRenderer()&&(r=()=>{const o=this.getGui(),a=0===o.children.length?o:o.querySelector(".ag-cell-value");return!a||a.scrollWidth>a.clientWidth}),this.tooltipFeature=new sn({getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:null!=t?()=>t:()=>{const o=this.column.getColDef(),a=this.rowNode.data;if(o.tooltipField&&te(a))return Qn(a,o.tooltipField,this.column.isTooltipFieldContainsDots());const l=o.tooltipValueGetter;return l?l(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:r},this.beans)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(t,r,i,s,n,o){this.cellComp=t,this.eGui=r,this.printLayout=s,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.cellPositionFeature?.setComp(r),this.cellCustomStyleFeature?.setComp(t),this.tooltipFeature?.refreshToolTip(),this.cellKeyboardListenerFeature?.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t,r),n&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(a=>a()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(t,r){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!t)return;const i=t.parentElement,s=Ni(this.beans.gos,this.rowNode).height,n=l=>{if(this.editing||!this.isAlive()||!r.isAlive())return;const{paddingTop:c,paddingBottom:d,borderBottomWidth:u,borderTopWidth:h}=xs(i),f=t.offsetHeight+(c+d+u+h);if(l<5){const w=gt(this.beans.gos);if(!w||!w.contains(t)||0==f)return void window.setTimeout(()=>n(l+1),0)}const m=Math.max(f,s);this.rowNode.setRowAutoHeight(m,this.column)},o=()=>n(0);o();const a=this.beans.resizeObserverService.observeResize(t,o);r.addDestroyFunc(()=>{a(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const t=this.column.getColDef();return null!=t.cellRenderer||null!=t.cellRendererSelector}getValueToDisplay(){return this.valueFormatted??this.value}showValue(t=!1){const r=this.getValueToDisplay();let i;if(this.rowNode.stub&&null==this.rowNode.groupData?.[this.column.getId()]){const n=this.createCellRendererParams();i=this.beans.userComponentFactory.getLoadingCellRendererDetails(this.column.getColDef(),n)}else if(this.isCellRenderer()){const n=this.createCellRendererParams();i=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),n)}this.cellComp.setRenderDetails(i,r,t),this.cellRangeFeature?.refreshHandle()}setupControlComps(){const t=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(t)),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(t){return null==this.rowNode.rowPinned&&("function"==typeof t||!0===t)}isCheckboxSelection(t){const{rowSelection:r}=this.beans.gridOptions;return t.checkboxSelection||Js(this.column)&&r&&"string"!=typeof r&&Qs(r)}refreshShouldDestroy(){const t=this.column.getColDef(),r=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(t)),i=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),s=this.includeDndSource!=this.isIncludeControl(t.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return r||i||s||n}startEditing(t=null,r=!1,i=null){const{editService:s}=this.beans;return!(this.isCellEditable()&&!this.editing&&s)||(this.cellComp?s.startEditing(this,t,r,i):(this.onCellCompAttachedFuncs.push(()=>{this.startEditing(t,r,i)}),!0))}setEditing(t,r){this.editCompDetails=r,this.editing!==t&&(this.editing=t,this.cellRangeFeature?.refreshHandle())}stopRowOrCellEdit(t=!1){"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.stopEditing(t):this.stopEditing(t)}onPopupEditorClosed(){this.editing&&this.stopEditingAndFocus()}stopEditing(t=!1){this.onCellEditorAttachedFuncs=[];const{editService:r}=this.beans;return!(!this.editing||!r)&&r.stopEditing(this,t)}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.beans.valueService.getValueForDisplay(this.column,this.rowNode),setValue:r=>this.beans.valueService.setValue(this.rowNode,this.column,r),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(r,i,s,n)=>this.registerRowDragger(r,i,n),setTooltip:(r,i)=>{this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(r,i),this.tooltipFeature?.refreshToolTip()}})}setFocusOutOnEditor(){this.editing&&this.beans.editService?.setFocusOutOnEditor(this)}setFocusInOnEditor(){this.editing&&this.beans.editService?.setFocusInOnEditor(this)}onCellChanged(t){t.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(t){this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(t)}refreshCell(t){if(this.suppressRefreshCell||this.editing)return;const r=this.column.getColDef(),i=null!=t&&!!t.newData,s=null!=t&&!!t.suppressFlash||!!r.suppressCellFlash,o=t&&t.forceRefresh||null==r.field&&null==r.valueGetter&&null==r.showRowGroup||i,a=!!this.cellComp,l=this.updateAndFormatValue(a);if(a){if(o||l){this.showValue(i);const d=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!s&&!d&&(this.beans.gos.get("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),this.cellCustomStyleFeature?.applyUserStyles(),this.cellCustomStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshToolTip(),this.cellCustomStyleFeature?.applyCellClassRules()}}stopEditingAndFocus(t=!1,r=!1){this.beans.editService?.stopEditingAndFocus(this,t,r)}flashCell(t){this.animateCell("data-changed",t?.flashDuration??t?.flashDelay,t?.fadeDuration??t?.fadeDelay)}animateCell(t,r,i){if(!this.cellComp)return;const{gos:s}=this.beans;if(r||(r=s.get("cellFlashDuration")),0===r)return;te(i)||(i=s.get("cellFadeDuration"));const n=`ag-cell-${t}`,o=`ag-cell-${t}-animation`;this.cellComp.addOrRemoveCssClass(n,!0),this.cellComp.addOrRemoveCssClass(o,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(n,!1),this.cellComp.addOrRemoveCssClass(o,!0),this.eGui.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(o,!1),this.eGui.style.transition="")},i))},r)})}onFlashCells(t){if(!this.cellComp)return;const r=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[r]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(t){return this.callValueFormatter(t)??t}callValueFormatter(t){return this.beans.valueService.formatValue(this.column,this.rowNode,t)}updateAndFormatValue(t){const r=this.value,i=this.valueFormatted;return this.value=this.beans.valueService.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),!t||!this.valuesAreEqual(r,this.value)||this.valueFormatted!=i}valuesAreEqual(t,r){const i=this.column.getColDef();return i.equals?i.equals(t,r):t===r}getComp(){return this.cellComp}getValue(){return this.value}addDomData(t){const r=this.getGui();ps(this.beans.gos,r,_d.DOM_DATA_KEY_CELL_CTRL,this),t.addDestroyFunc(()=>ps(this.beans.gos,r,_d.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(t,r){return this.beans.gos.addGridCommonParams({type:r,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex})}processCharacter(t){this.cellKeyboardListenerFeature?.processCharacter(t)}onKeyDown(t){this.cellKeyboardListenerFeature?.onKeyDown(t)}onMouseEvent(t,r){this.cellMouseListenerFeature?.onMouseEvent(t,r)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){this.cellComp&&this.cellPositionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:t,column:r,beans:i}=this;Pp(t,r,i.visibleColsService)}refreshAriaColIndex(){const t=this.beans.visibleColsService.getAriaColIndex(this.column);Hf(this.getGui(),t)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){return this.cellPositionFeature?.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(t,r=null){return this.cellComp?"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.startRowEditing(t,this):this.startEditing(t,!0,r):(this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(t,r)}),!0)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(t=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:t})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}onSuppressCellFocusChanged(t){this.eGui&&Pr(this.eGui,"tabindex",t?void 0:-1)}onFirstRightPinnedChanged(){if(!this.cellComp)return;const t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",t)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",t)}onCellFocused(t){if(this.beans.focusService.isCellFocusSuppressed())return;const r=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp)return void(r&&t?.forceBrowserFocus&&(this.focusEventToRestore=t));if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",r),r&&t&&t.forceBrowserFocus){let s=this.cellComp.getFocusableElement();if(this.editing){const n=this.beans.focusService.findFocusableElements(s,null,!0);n.length&&(s=n[0])}s.focus({preventScroll:!!t.preventScrollOnBrowserFocus})}const i="fullRow"===this.beans.gos.get("editType");!r&&!i&&this.editing&&this.stopRowOrCellEdit(),r&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:fi(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const t=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",t),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!t)}onColumnHover(){if(!this.cellComp||!this.beans.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",t)}onColDefChanged(){this.cellComp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?this.beans.editService?.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0}))}setWrapText(){const t=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",t)}dispatchCellContextMenuEvent(t){const r=this.column.getColDef(),i=this.createEvent(t,"cellContextMenu");this.beans.eventService.dispatchEvent(i),r.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{r.onCellContextMenu(i)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const t=new D6;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t}createDndSource(){const t=new A6(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(t),t}registerRowDragger(t,r,i){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(t,r);const s=this.createRowDragComp(t,r,i);s&&(this.customRowDragComp=s,this.addDestroyFunc(()=>{this.beans.context.destroyBean(s),this.customRowDragComp=null}))}createRowDragComp(t,r,i){const s=this.beans.gos.get("pagination"),n=this.beans.gos.get("rowDragManaged"),o=it(this.beans.gos);if(n){if(!o)return void q("managed row dragging is only allowed in the Client Side Row Model");if(s)return void q("managed row dragging is not possible when doing pagination")}const a=new ed(()=>this.value,this.rowNode,this.column,t,r,i);return this.beans.context.createBean(a),a}setSuppressRefreshCell(t){this.suppressRefreshCell=t}getEditCompDetails(){return this.editCompDetails}onCellEditorAttached(t){this.onCellEditorAttachedFuncs.push(t)}cellEditorAttached(){this.onCellEditorAttachedFuncs.forEach(t=>t()),this.onCellEditorAttachedFuncs=[]}};Up.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var Es=Up,rD=0,jp=class Od extends U{constructor(t,r,i,s,n){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=r,this.gos=r.gos,this.rowNode=t,this.paginationPage=r.paginationService?.getCurrentPage()??0,this.useAnimationFrameForCreate=s,this.printLayout=n,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=t.id+"-"+rD++,this.rowId=ti(t.id),this.initRowBusinessKey(),this.rowFocused=r.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=r.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!=typeof this.businessKeyForNodeFunc)return;const t=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=ti(t)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}isSticky(){return this.rowNode.sticky}updateGui(t,r){"left"===t?this.leftGui=r:"right"===t?this.rightGui=r:"fullWidth"===t?this.fullWidthGui=r:this.centerGui=r}setComp(t,r,i,s){const n={rowComp:t,element:r,containerType:i,compBean:s=eo(this,this.beans.context,s)};this.allRowGuis.push(n),this.updateGui(i,n),this.initialiseRowComp(n),"FullWidthLoading"!==this.rowType&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(t){this.allRowGuis=this.allRowGuis.filter(r=>r.containerType!==t),this.updateGui(t,void 0)}isCacheable(){return"FullWidthDetail"===this.rowType&&this.gos.get("keepDetailRows")}setCached(t){const r=t?"none":"";this.allRowGuis.forEach(i=>i.element.style.display=r)}initialiseRowComp(t){const r=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),sa(r)&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=t.rowComp;this.getInitialRowClasses(t.containerType).forEach(n=>i.addOrRemoveCssClass(n,!0)),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&ga(t.element,1==this.rowNode.expanded),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),ps(r,t.element,Od.DOM_DATA_KEY_ROW_CTRL,this),t.compBean.addDestroyFunc(()=>ps(r,t.element,Od.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t),this.isFullWidth()&&this.setupFullWidth(t),r.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(t){null!=this.businessKeySanitised&&t.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(t){this.rowId=ti(this.rowNode.id),null!=this.rowId&&t.setRowId(this.rowId)}executeSlideAndFadeAnimations(t){const{containerType:r}=t;this.slideInAnimation[r]&&(uf(()=>{this.onTopChanged()}),this.slideInAnimation[r]=!1),this.fadeInAnimation[r]&&(uf(()=>{t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[r]=!1)}addRowDraggerToRow(t){if(ei(this.gos))return void q("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `cellSelection: true`");const r=this.beans.localeService.getLocaleTextFunc(),i=new ed(()=>`1 ${r("rowDragRow","row")}`,this.rowNode,void 0,t.element,void 0,!0),s=this.createBean(i,this.beans.context);this.rowDragComps.push(s),t.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==s),this.destroyBean(s,this.beans.context)})}setupFullWidth(t){const r=this.getPinnedForContainer(t.containerType);if("FullWidthDetail"==this.rowType&&!this.gos.assertModuleRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)"))return;const i=this.createFullWidthCompDetails(t.element,r);t.rowComp.showFullWidth(i)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(t=>t?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}getCellElement(t){const r=this.getCellCtrl(t);return r?r.getGui():null}executeProcessRowPostCreateFunc(){const t=this.gos.getCallback("processRowPostCreate");t&&this.areAllContainersReady()&&t({eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const t=!!this.leftGui||!this.beans.visibleColsService.isPinningLeft(),r=!!this.centerGui,i=!!this.rightGui||!this.beans.visibleColsService.isPinningRight();return t&&r&&i}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const t=this.beans.gos.getCallback("isFullWidthRow");return!!t&&t({rowNode:this.rowNode})}setRowType(){const t=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),r=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,s=this.beans.columnModel.isPivotMode(),o=!!this.rowNode.group&&!this.rowNode.footer&&aa(this.gos,s);this.rowType=t?"FullWidthLoading":i?"FullWidthDetail":r?"FullWidth":o?"FullWidthGroup":"Normal"}updateColumnLists(t=!1,r=!1){this.isFullWidth()||(t||this.gos.get("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(r):this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0))}createCellCtrls(t,r,i=null){const s={list:[],map:{}},n=(o,a)=>{s.list.push(a),s.map[o]=a};return r.forEach(o=>{const a=o.getInstanceId();let l=t.map[a];l||(l=new Es(o,this.rowNode,this.beans,this)),n(a,l)}),t.list.forEach(o=>{const a=o.getColumn().getInstanceId();null==s.map[a]&&(this.isCellEligibleToBeRemoved(o,i)?o.destroy():n(a,o))}),s}updateColumnListsImpl(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)}setCellCtrls(t){this.allRowGuis.forEach(r=>{const i=this.getCellCtrlsForContainer(r.containerType);r.rowComp.setCellCtrls(i,t)})}getCellCtrlsForContainer(t){switch(t){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const t=this.beans.columnViewportService,r=this.beans.visibleColsService;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r.getAllCols()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=t.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const s=r.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,s,"left");const n=r.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,n,"right")}}isCellEligibleToBeRemoved(t,r){if(t.getColumn().getPinned()!=r)return!0;const o=t.isEditing(),a=this.beans.focusService.isCellFocused(t.getCellPosition());if(o||a){const c=t.getColumn();return!(this.beans.visibleColsService.getAllCols().indexOf(c)>=0)}return!0}getDomOrder(){return this.gos.get("ensureDomOrder")||Pt(this.gos,"print")}listenOnDomOrder(t){t.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],()=>{t.rowComp.setDomOrder(this.getDomOrder())})}setAnimateFlags(t){if(this.isSticky()||!t)return;const r=te(this.rowNode.oldRowTop),i=this.beans.visibleColsService.isPinningLeft(),s=this.beans.visibleColsService.isPinningRight();if(r){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.slideInAnimation.fullWidth=!0);this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=s}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.fadeInAnimation.fullWidth=!0);this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=s}}isEditing(){return this.editingRow}isFullWidth(){return"Normal"!==this.rowType}refreshFullWidth(){const t=(a,l)=>!a||a.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(a.element,l).params),r=t(this.fullWidthGui,null),i=t(this.centerGui,null),s=t(this.leftGui,"left"),n=t(this.rightGui,"right");return r&&i&&s&&n}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),expandedChanged:this.updateExpandedCss.bind(this),hasChildrenChanged:this.updateExpandedCss.bind(this)}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventService,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{this.gos.get("rowDragEntireRow")?this.allRowGuis.forEach(r=>{this.addRowDraggerToRow(r)}):this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach(t=>t.onRowIndexChanged())},cellChanged:t=>{this.getAllCellCtrls().forEach(r=>r.onCellChanged(t))}})}onRowNodeDataChanged(t){this.isFullWidth()===!!this.isNodeFullWidthCell()?this.isFullWidth()?this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode):(this.getAllCellCtrls().forEach(i=>i.refreshCell({suppressFlash:!t.update,newData:!t.update})),this.allRowGuis.forEach(i=>{this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp)}),this.onRowSelected(),this.postProcessCss()):this.beans.rowRenderer.redrawRow(this.rowNode)}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const t=this.rowNode.highlighted;this.allRowGuis.forEach(r=>{const s=1===t;r.rowComp.addOrRemoveCssClass("ag-row-highlight-above",0===t),r.rowComp.addOrRemoveCssClass("ag-row-highlight-below",s)})}postProcessRowDragging(){const t=this.rowNode.dragging;this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-row-dragging",t))}updateExpandedCss(){const t=this.rowNode.isExpandable(),r=1==this.rowNode.expanded;this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass("ag-row-group",t),i.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&r),i.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!r),ga(i.element,t&&r)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:fi(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}findFullWidthRowGui(t){return this.allRowGuis.find(r=>r.element.contains(t))}onKeyboardNavigate(t){const r=this.findFullWidthRowGui(t.target);if((r?r.element:null)!==t.target)return;const n=this.rowNode,o=this.beans.focusService.getFocusedCell(),a={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:o?.column??this.getColumnForFullWidth(r)};this.beans.navigationService.navigateToNextCell(t,t.key,a,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||vi(t))return;const r=this.allRowGuis.find(l=>l.element.contains(t.target)),i=r?r.element:null,s=i===t.target,n=Je(this.gos);let o=!1;i&&n&&(o=i.contains(n)&&n.classList.contains("ag-cell"));let a=null;!s&&!o&&(a=this.beans.focusService.findNextFocusableElement(i,!1,t.shiftKey)),(this.isFullWidth()&&s||!a)&&this.beans.navigationService.onTabKeyDown(this,t)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const t=this.allRowGuis.find(r=>zr(r.element))?.element;return t?t.getBoundingClientRect().top:0}onSuppressCellFocusChanged(t){const r=this.isFullWidth()&&t?void 0:-1;this.allRowGuis.forEach(i=>{Pr(i.element,"tabindex",r)})}onFullWidthRowFocused(t){const r=this.rowNode,i=!!t&&this.isFullWidth()&&t.rowIndex===r.rowIndex&&t.rowPinned==r.rowPinned,s=this.fullWidthGui?this.fullWidthGui.element:this.centerGui?.element;s&&(s.classList.toggle("ag-full-width-focus",i),i&&t?.forceBrowserFocus&&s.focus({preventScroll:!0}))}recreateCell(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),t.destroy(),this.updateColumnLists()}removeCellCtrl(t,r){const i={list:[],map:{}};return t.list.forEach(s=>{s!==r&&(i.list.push(s),i.map[s.getColumn().getInstanceId()]=s)}),i}onMouseEvent(t,r){switch(t){case"dblclick":this.onRowDblClick(r);break;case"click":this.onRowClick(r);break;case"touchstart":case"mousedown":this.onRowMouseDown(r)}}createRowEvent(t,r){return this.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:r})}createRowEventWithSource(t,r){const i=this.createRowEvent(t,r);return i.source=this,i}onRowDblClick(t){vi(t)||this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",t))}getColumnForFullWidth(t){const{visibleColsService:r}=this.beans;switch(t?.containerType){case"center":return r.getCenterCols()[0];case"left":return r.getLeftCols()[0];case"right":return r.getRightCols()[0];default:return r.getAllCols()[0]}}onRowMouseDown(t){if(this.lastMouseDownOnDragger=tn(t.target,"ag-row-drag",3),!this.isFullWidth())return;const r=this.rowNode;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges();const i=this.findFullWidthRowGui(t.target),s=i?.element,n=t.target;let o=!0;s&&s.contains(n)&&$c(n)&&(o=!1),this.beans.focusService.setFocusedCell({rowIndex:r.rowIndex,column:this.getColumnForFullWidth(i),rowPinned:r.rowPinned,forceBrowserFocus:o})}onRowClick(t){if(vi(t)||this.lastMouseDownOnDragger)return;const{gos:i}=this;this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowClicked",t));const s=t.ctrlKey||t.metaKey,n=t.shiftKey,o=this.rowNode.isSelected();if(ms(i)&&this.rowNode.group||this.isRowSelectionBlocked()||!function kF(e){const t=Sf(e);return!0===t||"enableSelection"===t}(i)&&!o||!mc(i)&&o)return;const l=function TF(e){const t=e.get("rowSelection");return"string"==typeof t?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}(i),c=mc(i),d="rowClicked";o?l?this.rowNode.setSelectedParams({newValue:!1,event:t,source:d}):s?c&&this.rowNode.setSelectedParams({newValue:!1,event:t,source:d}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:t,source:d}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!l&&!s,rangeSelect:n,event:t,source:d})}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!sa(this.gos)}setupDetailRowAutoHeight(t){if("FullWidthDetail"!==this.rowType||!this.gos.get("detailRowAutoHeight"))return;const r=()=>{const s=t.clientHeight;null!=s&&s>0&&window.setTimeout(()=>{this.rowNode.setRowHeight(s),(it(this.gos)||pi(this.gos))&&this.beans.rowModel.onRowHeightChanged()},0)},i=this.beans.resizeObserverService.observeResize(t,r);this.addDestroyFunc(i),r()}createFullWidthCompDetails(t,r){const{gos:i,rowNode:s}=this,n=i.addGridCommonParams({fullWidth:!0,data:s.data,node:s,value:s.key,valueFormatted:s.key,eGridCell:t,eParentOfValue:t,pinned:r,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(a,l,c,d)=>this.addFullWidthRowDragging(a,l,c,d),setTooltip:(a,l)=>this.refreshRowTooltip(a,l)}),o=this.beans.userComponentFactory;switch(this.rowType){case"FullWidthDetail":return o.getFullWidthDetailCellRendererDetails(n);case"FullWidthGroup":return o.getFullWidthGroupCellRendererDetails(n);case"FullWidthLoading":return o.getFullWidthLoadingCellRendererDetails(n);default:return o.getFullWidthCellRendererDetails(n)}}refreshRowTooltip(t,r){if(!this.fullWidthGui)return;const i={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>t,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:r};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new sn(i,this.beans))}addFullWidthRowDragging(t,r,i="",s){if(!this.isFullWidth())return;const n=new ed(()=>i,this.rowNode,void 0,t,r,s);this.createBean(n,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(n,this.beans.context)})}onUiLevelChanged(){const t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){const r="ag-row-level-"+t,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(s=>{s.rowComp.addOrRemoveCssClass(r,!0),s.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=t}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getLastRow()}refreshFirstAndLastRowStyles(){const t=this.isFirstRowOnPage(),r=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-first",t))),this.lastRowOnPage!==r&&(this.lastRowOnPage=r,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-last",r)))}stopEditing(t=!1){this.stoppingRowEdit||this.beans.rowEditService?.stopEditing(this,t)}setInlineEditingCss(){const t=this.editingRow||this.getAllCellCtrls().some(r=>r.isEditing());this.allRowGuis.forEach(r=>{r.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),r.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}setEditingRow(t){this.editingRow=t}startRowEditing(t=null,r=null,i=null){return!!this.editingRow||(this.beans.rowEditService?.startEditing(this,t,r,i)??!0)}getAllCellCtrls(){return 0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const t=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!t||!t.length||t.forEach(r=>{this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass(r,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,t=>{this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass(t,!0))},t=>{this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass(t,!1))})}setStylesFromGridOptions(t,r){t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(r,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(t){return"left"===t||"right"===t?t:null}getInitialRowClasses(t){const r=this.getPinnedForContainer(t),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[t],rowIsEven:this.rowNode.rowIndex%2==0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:r};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const t=this.gos.get("rowStyle");if(t&&"function"==typeof t)return void q("rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const r=this.gos.getCallback("getRowStyle");let i;return r&&(i=r({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})),i||t?Object.assign({},t,i):this.emptyStyle}onRowSelected(t){const r=!!this.rowNode.isSelected();this.forEachGui(t,i=>{i.rowComp.addOrRemoveCssClass("ag-row-selected",r),fa(i.element,r),i.element.contains(Je(this.gos))&&(i===this.centerGui||i===this.fullWidthGui)&&this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const t=this.rowNode.isSelected();if(t&&!mc(this.gos))return;const i=this.beans.localeService.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(i,"rowSelection")}addHoverFunctionality(t){if(!this.active)return;const{element:r,compBean:i}=t,{rowNode:s,beans:n,gos:o}=this;i.addManagedListeners(r,{mouseenter:()=>s.onMouseEnter(),mouseleave:()=>s.onMouseLeave()}),i.addManagedListeners(s,{mouseEnter:()=>{!n.dragService.isDragging()&&!o.get("suppressRowHoverHighlight")&&(r.classList.add("ag-row-hover"),s.setHovered(!0))},mouseLeave:()=>{r.classList.remove("ag-row-hover"),s.setHovered(!1)}})}roundRowTopToBounds(t){const r=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(r.top,!0)-100,s=this.applyPaginationOffset(r.bottom,!0)+100;return Math.min(Math.max(i,t),s)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(t,r){t?r(t):this.allRowGuis.forEach(r)}onRowHeightChanged(t){if(null==this.rowNode.rowHeight)return;const r=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=ff(this.gos)?Ni(this.gos,this.rowNode).height:void 0,o=n?Math.min(i,n)-2+"px":void 0;this.forEachGui(t,a=>{a.element.style.height=`${r}px`,o&&a.element.style.setProperty("--ag-line-height",o)})}addEventListener(t,r){super.addEventListener(t,r)}removeEventListener(t,r){super.removeEventListener(t,r)}destroyFirstPass(t=!1){if(this.active=!1,!t&&qs(this.gos)&&!this.isSticky())if(null!=this.rowNode.rowTop){const s=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(s)}else this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.rowNode.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventService.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const t=r=>(r.list.forEach(i=>i.destroy()),{list:[],map:{}});this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)}setFocusedClasses(t){this.forEachGui(t,r=>{r.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),r.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const t=this.beans.paginationService?.getCurrentPage()??0;this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(t,r=!1){return this.rowNode.isRowPinned()||this.rowNode.sticky?t:t+this.beans.pageBoundsService.getPixelOffset()*(r?1:-1)}setRowTop(t){if(!this.printLayout&&te(t)){const r=this.applyPaginationOffset(t),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}px`;this.setRowTopStyle(n)}}getInitialRowTop(t){return this.suppressRowTransform?this.getInitialRowTopShared(t):void 0}getInitialTransform(t){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(t)})`}getInitialRowTopShared(t){if(this.printLayout)return"";const r=this.rowNode;let i;if(this.isSticky())i=r.stickyRowTop;else{const s=this.slideInAnimation[t]?this.roundRowTopToBounds(r.oldRowTop):r.rowTop,n=this.applyPaginationOffset(s);i=r.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n)}return i+"px"}setRowTopStyle(t){this.allRowGuis.forEach(r=>this.suppressRowTransform?r.rowComp.setTop(t):r.rowComp.setTransform(`translateY(${t})`))}getRowNode(){return this.rowNode}getCellCtrl(t){let r=null;return this.getAllCellCtrls().forEach(i=>{i.getColumn()==t&&(r=i)}),null!=r||this.getAllCellCtrls().forEach(i=>{i.getColSpanningList().indexOf(t)>=0&&(r=i)}),r}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(t){const r=this.rowNode.getRowIndexString();if(null===r)return;const i=this.beans.headerNavigationService.getHeaderRowCount()+(this.beans.filterManager?.getHeaderRowCount()??0),s=this.rowNode.rowIndex%2==0,n=i+this.rowNode.rowIndex+1;this.forEachGui(t,o=>{o.rowComp.setRowIndex(r),o.rowComp.addOrRemoveCssClass("ag-row-even",s),o.rowComp.addOrRemoveCssClass("ag-row-odd",!s),Gf(o.element,n)})}setStoppingRowEdit(t){this.stoppingRowEdit=t}};jp.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Fs=jp,iD=class extends U{wireBeans(e){this.mouseEventService=e.mouseEventService,this.valueService=e.valueService,this.menuService=e.menuService,this.ctrlsService=e.ctrlsService,this.navigationService=e.navigationService,this.focusService=e.focusService,this.undoRedoService=e.undoRedoService,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.rangeService=e.rangeService,this.clipboardService=e.clipboardService}constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Rf("touchstart")?"touchstart":"mousedown"].forEach(r=>{const i=this.processMouseEvent.bind(this,r);this.addManagedElementListeners(this.element,{[r]:i})})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||vi(t))return;const r=this.getRowForEvent(t),i=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,void 0,r,i):(i&&i.onMouseEvent(e,t),r&&r.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!Vi())return;const e=new Wi(this.element);this.addManagedListeners(e,{longTap:r=>{const i=this.getRowForEvent(r.touchEvent),s=this.mouseEventService.getRenderedCellForEvent(r.touchEvent);this.handleContextMenuMouseEvent(void 0,r.touchEvent,i,s)}}),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const r=Yn(this.gos,t,Fs.DOM_DATA_KEY_ROW_CTRL);if(r)return r;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,r,i){const s=r?r.getRowNode():null,n=i?i.getColumn():null;let o=null;n&&(i.dispatchCellContextMenuEvent((e||t)??null),o=this.valueService.getValue(n,s));const a=this.ctrlsService.getGridBodyCtrl(),l=i?i.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:s,column:n,value:o,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:yc(this.gos,e,Es.DOM_DATA_KEY_CELL_CTRL),rowCtrl:yc(this.gos,e,Fs.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,r){const i=e.getRowNode(),s=e.getColumn(),n=e.isEditing();!id(this.gos,r,i,s,n)&&"keydown"===t&&(!n&&this.navigationService.handlePageScrollingKey(r)||e.onKeyDown(r),this.doGridOperations(r,e.isEditing()),vp(r)&&e.processCharacter(r)),"keydown"===t&&this.eventService.dispatchEvent(e.createEvent(r,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,r){const i=e.getRowNode(),s=this.focusService.getFocusedCell();if(!id(this.gos,r,i,s&&s.column,!1)&&"keydown"===t)switch(r.key){case N.PAGE_HOME:case N.PAGE_END:case N.PAGE_UP:case N.PAGE_DOWN:this.navigationService.handlePageScrollingKey(r,!0);break;case N.UP:case N.DOWN:e.onKeyboardNavigate(r);break;case N.TAB:e.onTabKeyDown(r)}"keydown"===t&&this.eventService.dispatchEvent(e.createRowEvent("cellKeyDown",r))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!this.mouseEventService.isEventFromThisGrid(e))return;const r=function eT(e){const{keyCode:t}=e;let r;switch(t){case 65:r=N.A;break;case 67:r=N.C;break;case 86:r=N.V;break;case 68:r=N.D;break;case 90:r=N.Z;break;case 89:r=N.Y;break;default:r=e.code}return r}(e);return r===N.A?this.onCtrlAndA(e):r===N.C?this.onCtrlAndC(e):r===N.D?this.onCtrlAndD(e):r===N.V?this.onCtrlAndV(e):r===N.X?this.onCtrlAndX(e):r===N.Y?this.onCtrlAndY():r===N.Z?this.onCtrlAndZ(e):void 0}onCtrlAndA(e){const{pinnedRowModel:t,rowModel:r,rangeService:i}=this;if(i&&r.isRowsToRender()){const[s,n]=[t.isEmpty("top"),t.isEmpty("bottom")],o=s?null:"top";let a,l;n?(a=null,l=r.getRowCount()-1):(a="bottom",l=t.getPinnedBottomRowCount()-1);const c=this.visibleColsService.getAllCols();if(rr(c))return;i.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:l,rowEndPinned:a,columnStart:c[0],columnEnd:Le(c)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:r}=this.getControlsForEventTarget(e.target);t?.isEditing()||r?.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:r}=this.getControlsForEventTarget(e.target);t?.isEditing()||r?.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:r}=this.getControlsForEventTarget(e.target);t?.isEditing()||r?.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){!this.gos.get("undoRedoCellEditing")||!this.undoRedoService||(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService?.redo("ui")}},sD=class extends U{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({leftPinnedWidthChanged:this.onPinnedLeftWidthChanged.bind(this)})}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth();et(this.element,e>0),Vr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}},nD=class extends U{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({rightPinnedWidthChanged:this.onPinnedRightWidthChanged.bind(this)})}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth();et(this.element,e>0),Vr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}},Aa=e=>e.getTopRowCtrls(),Pa=e=>e.getStickyTopRowCtrls(),Ma=e=>e.getStickyBottomRowCtrls(),Ia=e=>e.getBottomRowCtrls(),La=e=>e.getCentreRowCtrls(),oD={center:{type:"center",container:"ag-center-cols-container",viewport:"ag-center-cols-viewport",getRowCtrls:La},left:{type:"left",container:"ag-pinned-left-cols-container",pinnedType:"left",getRowCtrls:La},right:{type:"right",container:"ag-pinned-right-cols-container",pinnedType:"right",getRowCtrls:La},fullWidth:{type:"fullWidth",container:"ag-full-width-container",fullWidth:!0,getRowCtrls:La},topCenter:{type:"center",container:"ag-floating-top-container",viewport:"ag-floating-top-viewport",getRowCtrls:Aa},topLeft:{type:"left",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Aa},topRight:{type:"right",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Aa},topFullWidth:{type:"fullWidth",container:"ag-floating-top-full-width-container",fullWidth:!0,getRowCtrls:Aa},stickyTopCenter:{type:"center",container:"ag-sticky-top-container",viewport:"ag-sticky-top-viewport",getRowCtrls:Pa},stickyTopLeft:{type:"left",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Pa},stickyTopRight:{type:"right",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Pa},stickyTopFullWidth:{type:"fullWidth",container:"ag-sticky-top-full-width-container",fullWidth:!0,getRowCtrls:Pa},stickyBottomCenter:{type:"center",container:"ag-sticky-bottom-container",viewport:"ag-sticky-bottom-viewport",getRowCtrls:Ma},stickyBottomLeft:{type:"left",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Ma},stickyBottomRight:{type:"right",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Ma},stickyBottomFullWidth:{type:"fullWidth",container:"ag-sticky-bottom-full-width-container",fullWidth:!0,getRowCtrls:Ma},bottomCenter:{type:"center",container:"ag-floating-bottom-container",viewport:"ag-floating-bottom-viewport",getRowCtrls:Ia},bottomLeft:{type:"left",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Ia},bottomRight:{type:"right",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Ia},bottomFullWidth:{type:"fullWidth",container:"ag-floating-bottom-full-width-container",fullWidth:!0,getRowCtrls:Ia}};function an(e){return oD[e]}var dD=["center","left","right","fullWidth"],uD=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],hD=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],gD=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],$p=["stickyTopCenter","stickyTopLeft","stickyTopRight"],Kp=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],fD=[...$p,"stickyTopFullWidth",...Kp,"stickyBottomFullWidth"],pD=["topCenter","topLeft","topRight","bottomCenter","bottomLeft","bottomRight","center","left","right",...$p,...Kp],mD=class extends U{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.options=an(e)}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService,this.columnViewportService=e.columnViewportService,this.resizeObserverService=e.resizeObserverService,this.rowRenderer=e.rowRenderer}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new k6(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.ctrlsService.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,r){this.comp=e,this.eContainer=t,this.eViewport=r,this.createManagedBean(new iD(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const i=()=>this.onPinnedWidthChanged();this.forContainers(hD,()=>{this.pinnedWidthFeature=this.createManagedBean(new sD(this.eContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:i})}),this.forContainers(gD,()=>{this.pinnedWidthFeature=this.createManagedBean(new nD(this.eContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:i})}),this.forContainers(dD,()=>this.createManagedBean(new Wp(this.eContainer,"center"===this.name?r:void 0))),this.forContainers(pD,()=>this.createManagedBean(new T6(this.eContainer))),this.forContainers(uD,()=>this.createManagedBean(new gd(s=>this.comp.setContainerWidth(`${s}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}addListeners(){this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),displayedRowsChanged:e=>this.onDisplayedRowsChanged(e.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(fD.indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const t=()=>{const r=this.gos.get("ensureDomOrder"),i=Pt(this.gos,"print");this.comp.setDomOrder(r||i)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const e=t=>{this.dragService.isDragging()&&t.cancelable&&t.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.columnViewportService.setScrollPosition(t,r,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return io(this.eViewport)}getCenterViewportScrollLeft(){return wa(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return Yf(this.eViewport)}getViewportScrollLeft(){return wa(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||function MR(e){return e.clientWidth<e.scrollWidth}(this.eViewport)}getViewportElement(){return this.eViewport}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){xa(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(null!=this.options.pinnedType)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.rowRenderer);if(!this.visible||0===t.length)return void this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});const r=Pt(this.gos,"print"),s=this.gos.get("embedFullWidthRows")||r,n=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!s&&a:s||!a});this.comp.setRowCtrls({rowCtrls:n,useFlushSync:e})}},Yp="ag-force-vertical-scroll",wD=class extends U{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.menuService=e.menuService,this.headerNavigationService=e.headerNavigationService,this.dragAndDropService=e.dragAndDropService,this.pinnedRowModel=e.pinnedRowModel,this.rowRenderer=e.rowRenderer,this.popupService=e.popupService,this.mouseEventService=e.mouseEventService,this.rowModel=e.rowModel,this.filterManager=e.filterManager,this.environment=e.environment}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,r,i,s,n,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=i,this.eBottom=s,this.eStickyTop=n,this.eStickyBottom=o,this.eCenterColsViewport=r.querySelector(`.${an("center").viewport}`),this.eFullWidthContainer=r.querySelector(`.${an("fullWidth").container}`),this.eStickyTopFullWidthContainer=n.querySelector(`.${an("stickyTopFullWidth").container}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${an("stickyBottomFullWidth").container}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new Cd(this.comp)),this.bodyScrollFeature=this.createManagedBean(new R6(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,r,s,n,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvancedFilterHeaderComp(i),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){const e=this.setFloatingHeights.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.onScrollGapChanged.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.onHeaderHeightChanged.bind(this)})}addFocusListeners(e){e.forEach(t=>{this.addManagedElementListeners(t,{focusin:r=>{const{target:i}=r,s=tn(i,"ag-root",t);t.classList.toggle("ag-has-focus",!s)},focusout:r=>{const{target:i,relatedTarget:s}=r,n=t.contains(s),o=tn(s,"ag-root",t);tn(i,"ag-root",t)||(!n||o)&&t.classList.remove("ag-has-focus")}})})}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss("ag-selectable",e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const i=`calc(100% + ${(e&&this.scrollVisibleService.getScrollbarWidth()||0)+(Uf()?16:0)}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(i)),this.updateScrollingClasses()}onScrollGapChanged(){this.updateScrollingClasses()}updateScrollingClasses(){this.eGridBody.classList.toggle("ag-body-vertical-content-no-gap",!this.scrollVisibleService.hasVerticalScrollGap()),this.eGridBody.classList.toggle("ag-body-horizontal-content-no-gap",!this.scrollVisibleService.hasHorizontalScrollGap())}onGridColumnsChanged(){const e=this.columnModel.getCols();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=r=>{const i=r.relatedTarget;if(null===jc(i))return void this.rowRenderer.stopEditing();let s=t.some(n=>n.contains(i))&&this.mouseEventService.isElementInThisGrid(i);if(!s){const n=this.popupService;s=n.getActivePopups().some(o=>o.contains(i))||n.isElementWithinCustomPopup(i)}s||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach(r=>this.addManagedElementListeners(r,{focusout:e}))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount()+(this.filterManager?.getHeaderRowCount()??0),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1;this.comp.setRowCount(-1===t?-1:e+t)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){this.comp.setPinnedTopBottomOverflowY(e?"scroll":"hidden")}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?Yp:null,r=Pt(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&function IR(e){return e.clientHeight<e.scrollHeight}(this.eBodyViewport)}setupRowAnimationCssClass(){let e=this.environment.hasMeasuredSizes();const t=()=>{const r=e&&qs(this.gos)&&!this.rowContainerHeightService.isStretching();this.comp.setRowAnimationCssOnBodyViewport(r?"ag-row-animation":"ag-row-no-animation",r)};t(),this.addManagedEventListeners({heightScaleChanged:t}),this.addManagedPropertyListener("animateRows",t),this.addManagedEventListeners({gridStylesChanged:()=>{!e&&this.environment.hasMeasuredSizes()&&(e=!0,t())}})}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:e}),this.mockContextMenuForIPad(e),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:r,shiftKey:i}=e;(i||Math.abs(t)>Math.abs(r))&&this.mouseEventService.isEventFromThisGrid(e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:r,shiftKey:i}=e,s=i||Math.abs(t)>Math.abs(r),n=e.target;s?(this.eStickyTopFullWidthContainer.contains(n)||this.eStickyBottomFullWidthContainer.contains(n))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(r))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:r}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||r})}onBodyViewportContextMenu(e,t,r){if(!e&&!r)return;this.gos.get("preventDefaultOnContextMenu")&&(e||r).preventDefault();const{target:i}=e||t;(i===this.eBodyViewport||i===this.ctrlsService.get("center").getViewportElement())&&this.menuService.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!Vi())return;const t=new Wi(this.eBodyViewport);this.addManagedListeners(t,{longTap:i=>{e(void 0,i.touchStart,i.touchEvent)}}),this.addDestroyFunc(()=>t.destroy())}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new Ik(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature),this.addDestroyFunc(()=>this.dragAndDropService.removeDropTarget(this.rowDragFeature))}getRowDragFeature(){return this.rowDragFeature}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e.getPinnedTopTotalHeight(),r=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(r),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(r?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(e){const t=this.scrollVisibleService.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}else this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const t=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+(this.filterManager?.getHeaderHeight()??0),r=this.pinnedRowModel.getPinnedTopTotalHeight();let i=0;t>0&&(i+=t),r>0&&(i+=r),i>0&&(i+=1),this.comp.setStickyTopTop(`${i}px`)}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight(),r=this.scrollVisibleService.isHorizontalScrollShowing()&&this.scrollVisibleService.getScrollbarWidth()||0;this.comp.setStickyBottomBottom(`${e+r}px`)}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.scrollVisibleService.getScrollbarWidth():0,n=io(this.eGridBody)-i;n>0?this.columnSizeService.sizeColumnsToFit(n,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):100===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):500===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):q("tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}},xD=class extends Ge{constructor(e,t,r,i,s){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.column=t.getColumn(),this.rowNode=t.getRowNode(),this.rowCtrl=t.getRowCtrl(),this.eRow=i,this.cellCtrl=t;const n=document.createElement("div");n.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(n);const o=this.getGui();this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1),ir(o,t.getCellAriaRole()),o.setAttribute("col-id",t.colIdSanitised),t.setComp({addOrRemoveCssClass:(l,c)=>this.addOrRemoveCssClass(l,c),setUserStyles:l=>Qf(o,l),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,c,d)=>this.setRenderDetails(l,c,d),setEditDetails:(l,c,d)=>this.setEditDetails(l,c,d),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()},this.getGui(),this.eCellWrapper,r,s,void 0)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(e,t,r){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=null==this.firstRender;const s=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!r&&!s&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t))}setEditDetails(e,t,r){e?this.createCellEditorInstance(e,t,r):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,r=t||this.forceWrapper,i=r&&null==this.eCellWrapper;if(i){const c=document.createElement("div");c.setAttribute("role","presentation"),c.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=c,this.getGui().appendChild(this.eCellWrapper)}const s=!r&&null!=this.eCellWrapper;s&&(Hr(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!r);const n=!e&&r,o=n&&null==this.eCellValue;if(o){const c=document.createElement("span");c.setAttribute("role","presentation"),c.setAttribute("class","ag-cell-value"),this.eCellValue=c,this.eCellWrapper.appendChild(this.eCellValue)}const a=!n&&null!=this.eCellValue;a&&(Hr(this.eCellValue),this.eCellValue=void 0);const l=i||s||o||a;return l&&this.removeControls(),e||t&&this.addControls(),l}addControls(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(e,t,r){const i=this.editorVersion,s=e.newAgStackInstance();if(null==s)return;const{params:n}=e;s.then(a=>this.afterCellEditorCreated(i,a,n,t,r)),Ie(this.cellEditor)&&n.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Vt(t);const r=null!=e?ti(e,!0):null;null!=r&&(t.textContent=r)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),Hr(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:e}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),Hr(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(null==this.cellRenderer||null==this.cellRenderer.refresh||this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return!0===t||void 0===t}createCellRendererInstance(e){const r=!this.beans.gos.get("suppressAnimationFrame"),i=this.rendererVersion,{componentClass:s}=e,n=()=>{if(this.rendererVersion!==i||!this.isAlive())return;const a=e.newAgStackInstance(),l=this.afterCellRendererCreated.bind(this,i,s);a&&a.then(l)};r&&this.firstRender?this.beans.animationFrameService.createTask(n,this.rowNode.rowIndex,"createTasksP2"):n()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(e,t,r){if(this.isAlive()&&e===this.rendererVersion){if(this.cellRenderer=r,this.cellRendererClass=t,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){const s=this.getParentOfValue();Vt(s),s.appendChild(this.cellRendererGui)}}else this.beans.context.destroyBean(r)}afterCellEditorCreated(e,t,r,i,s){if(e!==this.editorVersion)return void this.beans.context.destroyBean(t);if(t.isCancelBeforeStart&&t.isCancelBeforeStart())return this.beans.context.destroyBean(t),void this.cellCtrl.stopEditing(!0);if(!t.getGui)return q(`cellEditor for column ${this.column.getId()} is missing getGui() method`),void this.beans.context.destroyBean(t);this.cellEditor=t,this.cellEditorGui=t.getGui();const a=i||void 0!==t.isPopup&&t.isPopup();a?this.addPopupCellEditor(r,s):this.addInCellEditor(),this.refreshEditStyles(!0,a),t.afterGuiAttached&&t.afterGuiAttached(),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),this.rowCtrl?.setInlineEditingCss()}addInCellEditor(){const e=this.getGui();e.contains(Je(this.beans.gos))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){"fullRow"===this.beans.gos.get("editType")&&q("popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const r=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(this.beans.editService.createPopupEditorWrapper(e));const i=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&i.appendChild(this.cellEditorGui);const s=this.beans.popupService,n=this.beans.gos.get("stopEditingWhenCellsLoseFocus"),o=t??r.getPopupPosition?.()??"over",a=this.beans.gos.get("enableRtl"),l={ePopup:i,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:o,alignSide:a?"right":"left",keepWithinBounds:!0},c=s.positionPopupByComponent.bind(s,l),d=this.beans.localeService.getLocaleTextFunc(),u=s.addPopup({modal:n,eChild:i,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:d("ariaLabelCellEditor","Cell Editor")});u&&(this.hideEditorPopup=u.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const e=this.getGui();e.contains(Je(this.beans.gos))&&Uc()&&e.focus({preventScroll:!0}),Vt(this.getParentOfValue())}},SD=class extends Ge{constructor(e,t,r){super(),this.cellComps={},this.beans=t,this.rowCtrl=e;const i=document.createElement("div");i.setAttribute("comp-id",`${this.getCompId()}`),i.setAttribute("style",this.getInitialStyle(r)),this.setTemplateFromElement(i);const s=this.getGui(),n=s.style;this.domOrder=this.rowCtrl.getDomOrder(),ir(s,"row"),e.setComp({setDomOrder:a=>this.domOrder=a,setCellCtrls:a=>this.setCellCtrls(a),showFullWidth:a=>this.showFullWidth(a),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,addOrRemoveCssClass:(a,l)=>this.addOrRemoveCssClass(a,l),setUserStyles:a=>Qf(s,a),setTop:a=>n.top=a,setTransform:a=>n.transform=a,setRowIndex:a=>s.setAttribute("row-index",a),setRowId:a=>s.setAttribute("row-id",a),setRowBusinessKey:a=>s.setAttribute("row-business-key",a),refreshFullWidth:a=>this.fullWidthCellRenderer?.refresh?.(a())??!1},this.getGui(),r,void 0),this.addDestroyFunc(()=>{e.unsetComp(r)})}getInitialStyle(e){const t=this.rowCtrl.getInitialTransform(e);return t?`transform: ${t}`:`top: ${this.rowCtrl.getInitialRowTop(e)}`}showFullWidth(e){const r=e.newAgStackInstance();r?.then(i=>{if(this.isAlive()){const s=i.getGui();this.getGui().appendChild(s),this.rowCtrl.setupDetailRowAutoHeight(s),this.setFullWidthRowComp(i)}else this.beans.context.destroyBean(i)})}setCellCtrls(e){const t=Object.assign({},this.cellComps);e.forEach(i=>{const s=i.instanceId;null==this.cellComps[s]?this.newCellComp(i):t[s]=null});const r=Hi(t).filter(i=>null!=i);this.destroyCells(r),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const t=[];e.forEach(r=>{const i=this.cellComps[r.instanceId];i&&t.push(i.getGui())}),Xf(this.getGui(),t)}newCellComp(e){const t=new xD(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.instanceId]=t,this.getGui().appendChild(t.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const e=Hi(this.cellComps).filter(t=>null!=t);this.destroyCells(e)}setFullWidthRowComp(e){this.fullWidthCellRenderer&&Me("should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}destroyCells(e){e.forEach(t=>{if(!t)return;const r=t.getCtrl().instanceId;this.cellComps[r]===t&&(t.detach(),t.destroy(),this.cellComps[r]=null)})}},ED={selector:"AG-ROW-CONTAINER",component:class extends Ge{constructor(){super(),this.eViewport=de,this.eContainer=de,this.rowComps={},this.name=Ge.elementGettingCreated.getAttribute("name"),this.options=an(this.name),this.setTemplate(function yD(e){let t;return t="center"===e.type?`<div class="${e.viewport}" data-ref="eViewport" role="presentation">\n                <div class="${e.container}" data-ref="eContainer"></div>\n            </div>`:`<div class="${e.container}" data-ref="eContainer"></div>`,t}(this.options))}wireBeans(e){this.beans=e}postConstruct(){const e={setHorizontalScroll:r=>this.eViewport.scrollLeft=r,setViewportHeight:r=>this.eViewport.style.height=r,setRowCtrls:({rowCtrls:r})=>this.setRowCtrls(r),setDomOrder:r=>{this.domOrder=r},setContainerWidth:r=>this.eContainer.style.width=r,setOffsetTop:r=>this.eContainer.style.transform=`translateY(${r})`};this.createManagedBean(new mD(this.name)).setComp(e,this.eContainer,this.eViewport)}destroy(){this.setRowCtrls([]),super.destroy()}setRowCtrls(e){const t={...this.rowComps};this.rowComps={},this.lastPlacedElement=null,e.forEach(i=>{const s=i.instanceId,n=t[s];if(n)this.rowComps[s]=n,delete t[s],this.ensureDomOrder(n.getGui());else{if(!i.getRowNode().displayed)return;const o=new SD(i,this.beans,this.options.type);this.rowComps[s]=o,this.appendRow(o.getGui())}}),Hi(t).forEach(i=>{this.eContainer.removeChild(i.getGui()),i.destroy()}),ir(this.eContainer,"rowgroup")}appendRow(e){this.domOrder?function PR(e,t,r){r?r.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e}ensureDomOrder(e){this.domOrder&&(qf(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)}}};function go(e){return e.map(t=>`<ag-row-container name="${t}"></ag-row-container>`).join("")}var FD=`<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root></ag-header-root>\n        <div class="ag-floating-top" data-ref="eTop" role="presentation">\n            ${go(["topLeft","topCenter","topRight","topFullWidth"])}\n        </div>\n        <div class="ag-body" data-ref="eBody" role="presentation">\n            <div class="ag-body-viewport" data-ref="eBodyViewport" role="presentation">\n            ${go(["left","center","right","fullWidth"])}\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" data-ref="eStickyTop" role="presentation">\n            ${go(["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])}\n        </div>\n        <div class="ag-sticky-bottom" data-ref="eStickyBottom" role="presentation">\n            ${go(["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])}\n        </div>\n        <div class="ag-floating-bottom" data-ref="eBottom" role="presentation">\n            ${go(["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])}\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>`,kD={selector:"AG-GRID-BODY",component:class extends Ge{constructor(){super(FD,[S6,b6,F6,C6,ED]),this.eBodyViewport=de,this.eStickyTop=de,this.eStickyBottom=de,this.eTop=de,this.eBottom=de,this.eBody=de}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.rangeService=e.rangeService}postConstruct(){const e=(r,i)=>{const s=`${r}px`;i.style.minHeight=s,i.style.height=s},t={setRowAnimationCssOnBodyViewport:(r,i)=>this.setRowAnimationCssOnBodyViewport(r,i),setColumnCount:r=>function xR(e,t){Ar(e,"colcount",t)}(this.getGui(),r),setRowCount:r=>function wR(e,t){Ar(e,"rowcount",t)}(this.getGui(),r),setTopHeight:r=>e(r,this.eTop),setBottomHeight:r=>e(r,this.eBottom),setTopDisplay:r=>this.eTop.style.display=r,setBottomDisplay:r=>this.eBottom.style.display=r,setStickyTopHeight:r=>this.eStickyTop.style.height=r,setStickyTopTop:r=>this.eStickyTop.style.top=r,setStickyTopWidth:r=>this.eStickyTop.style.width=r,setStickyBottomHeight:r=>{this.eStickyBottom.style.height=r,this.eStickyBottom.classList.toggle("ag-hidden","0px"===r)},setStickyBottomBottom:r=>this.eStickyBottom.style.bottom=r,setStickyBottomWidth:r=>this.eStickyBottom.style.width=r,setColumnMovingCss:(r,i)=>this.addOrRemoveCssClass(r,i),updateLayoutClasses:(r,i)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(n=>{n.toggle("ag-layout-auto-height",i.autoHeight),n.toggle("ag-layout-normal",i.normal),n.toggle("ag-layout-print",i.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",i.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",i.normal),this.addOrRemoveCssClass("ag-layout-print",i.print)},setAlwaysVerticalScrollClass:(r,i)=>this.eBodyViewport.classList.toggle(Yp,i),registerBodyViewportResizeListener:r=>{const i=this.resizeObserverService.observeResize(this.eBodyViewport,r);this.addDestroyFunc(()=>i())},setPinnedTopBottomOverflowY:r=>this.eTop.style.overflowY=this.eBottom.style.overflowY=r,setCellSelectableCss:(r,i)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(s=>s.classList.toggle(r,i))},setBodyViewportWidth:r=>this.eBodyViewport.style.width=r};this.ctrl=this.createManagedBean(new wD),this.ctrl.setComp(t,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(this.rangeService&&ei(this.gos)||Cc(this.gos))&&function CR(e,t){Ar(e,"multiselectable",t)}(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const r=this.eBodyViewport.classList;r.toggle("ag-row-animation",t),r.toggle("ag-row-no-animation",!t)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}}},TD=class extends U{constructor(){super(...arguments),this.beanName="scrollVisibleService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnAnimationService=e.columnAnimationService}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)})}onDisplayedColumnsChanged(){this.updateScrollVisible()}onDisplayedColumnsWidthChanged(){this.updateScrollVisible()}onCentreViewportResized(){this.updateScrollGap()}updateScrollVisible(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsService.get("center"),t=e.hasHorizontalScrollGap(),r=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==r)&&(this.horizontalScrollGap=t,this.verticalScrollGap=r,this.eventService.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventService.dispatchEvent({type:"scrollVisibilityChanged"}))}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}hasHorizontalScrollGap(){return this.horizontalScrollGap}hasVerticalScrollGap(){return this.verticalScrollGap}getScrollbarWidth(){if(null==this.scrollbarWidth){const e=this.gos.get("scrollbarWidth"),r="number"==typeof e&&e>=0?e:function TR(){return null==Hc&&Wf(),Hc}();null!=r&&(this.scrollbarWidth=r,this.eventService.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},qp="__ag_grid_instance",Xp=class lm extends U{constructor(){super(...arguments),this.beanName="mouseEventService",this.gridInstanceId=lm.gridInstanceSequence.next()}wireBeans(t){this.ctrlsService=t.ctrlsService}stampTopLevelGridCompWithGridInstance(t){t[qp]=this.gridInstanceId}getRenderedCellForEvent(t){return yc(this.gos,t.target,Es.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(t){return this.isElementInThisGrid(t.target)}isElementInThisGrid(t){let r=t;for(;r;){const i=r[qp];if(te(i))return i===this.gridInstanceId;r=r.parentElement}return!1}getCellPositionForEvent(t){const r=this.getRenderedCellForEvent(t);return r?r.getCellPosition():null}getNormalisedPosition(t){const r=Pt(this.gos,"normal");let s,n;if(null!=t.clientX||null!=t.clientY?(s=t.clientX,n=t.clientY):(s=t.x,n=t.y),r){const o=this.ctrlsService.getGridBodyCtrl(),a=o.getScrollFeature().getVScrollPosition();s+=o.getScrollFeature().getHScrollPosition().left,n+=a.top}return{x:s,y:n}}};Xp.gridInstanceSequence=new rn;var DD=Xp,AD=class extends U{constructor(){super(),this.beanName="navigationService",this.onPageDown=hf(this.onPageDown,100),this.onPageUp=hf(this.onPageUp,100)}wireBeans(e){this.mouseEventService=e.mouseEventService,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.ctrlsService=e.ctrlsService,this.rowRenderer=e.rowRenderer,this.headerNavigationService=e.headerNavigationService,this.rowPositionUtils=e.rowPositionUtils,this.cellNavigationService=e.cellNavigationService,this.pinnedRowModel=e.pinnedRowModel,this.scrollVisibleService=e.scrollVisibleService,this.rangeService=e.rangeService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const r=e.key,i=e.altKey,s=e.ctrlKey||e.metaKey,n=!!this.rangeService&&e.shiftKey,o=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(r){case N.PAGE_HOME:case N.PAGE_END:!s&&!i&&(this.onHomeOrEndKey(r),a=!0);break;case N.LEFT:case N.RIGHT:case N.UP:case N.DOWN:if(!o)return!1;s&&!i&&!n&&(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case N.PAGE_DOWN:case N.PAGE_UP:!s&&!i&&(a=this.handlePageUpDown(r,o,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.focusService.getFocusedCell()),!!t&&(e===N.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){const{scrollIndex:t,scrollType:r,scrollColumn:i,focusIndex:s,focusColumn:n}=e;te(i)&&!i.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(i),te(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,r),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(s),this.focusService.setFocusedCell({rowIndex:s,column:n,rowPinned:null,forceBrowserFocus:!0}),this.rangeService?.setRangeToCell({rowIndex:s,rowPinned:null,column:n})}onPageDown(e){const r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),s=this.pageBoundsService.getPixelOffset(),o=this.rowModel.getRowIndexAtPixel(r.top+i+s);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.pageBoundsService.getPixelOffset(),n=this.rowModel.getRowIndexAtPixel(r.top+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,n,!0):this.navigateToNextPage(e,n,!0)}navigateToNextPage(e,t,r=!1){const i=this.getViewportHeight(),s=this.pageBoundsService.getFirstRow(),n=this.pageBoundsService.getLastRow(),o=this.pageBoundsService.getPixelOffset(),a=this.rowModel.getRow(e.rowIndex),l=r?a?.rowHeight-i-o:i-o;let u,d=this.rowModel.getRowIndexAtPixel(a?.rowTop+l+o);d===e.rowIndex&&(t=d=e.rowIndex+(r?-1:1)),r?(u="bottom",d<s&&(d=s),t<s&&(t=s)):(u="top",d>n&&(d=n),t>n&&(t=n)),this.isRowTallerThanView(d)&&(t=d,u="top"),this.navigateTo({scrollIndex:t,scrollType:u,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,r=!1){this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const i=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const r=t?-1:1,i=this.getViewportHeight(),s=this.pageBoundsService.getLastRow();let n=0,o=e.rowIndex;for(;o>=0&&o<=s;){const a=this.rowModel.getRow(o);if(a){const l=a.rowHeight??0;if(n+l>i)break;n+=l}o+=r}return Math.max(0,Math.min(o,s))}getViewportHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.scrollVisibleService.getScrollbarWidth();let r=e.bottom-e.top;return this.ctrlsService.get("center").isHorizontalScrollShowing()&&(r-=t),r}isRowTallerThanView(e){const t=this.rowModel.getRow(e);if(!t)return!1;const r=t.rowHeight;return"number"==typeof r&&r>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:i}=r,s=r.column;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:s,focusIndex:i,focusColumn:s})}onHomeOrEndKey(e){const t=e===N.PAGE_HOME,r=this.visibleColsService.getAllCols(),i=t?r[0]:Le(r),s=t?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow();this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:i,focusIndex:s,focusColumn:i})}onTabKeyDown(e,t){const r=t.shiftKey,i=this.tabToNextCellCommon(e,r,t);if(!1===i)if(r){const{rowIndex:s,rowPinned:n}=e.getRowPosition();(n?0===s:s===this.pageBoundsService.getFirstRow())&&(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof Es&&e.focusCell(!0),(!r&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(r))&&t.preventDefault();else i?t.preventDefault():null===i&&this.focusService.allowFocusForNextGridCoreContainer(r)}tabToNextCell(e,t){const r=this.focusService.getFocusedCell();if(!r)return!1;let i=this.getCellByPosition(r);return!!(i||(i=this.rowRenderer.getRowByPosition(r),i&&i.isFullWidth()))&&!!this.tabToNextCellCommon(i,e,t)}tabToNextCellCommon(e,t,r){let s,i=e.isEditing();if(!i&&e instanceof Es){const o=e.getRowCtrl();o&&(i=o.isEditing())}return s=i?"fullRow"===this.gos.get("editType")?this.moveToNextEditingRow(e,t,r):this.moveToNextEditingCell(e,t,r):this.moveToNextCellNotEditing(e,t),null===s?s:s||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t,r=null){const i=e.getCellPosition();e.getGui().focus(),e.stopEditing();const s=this.findNextCellToFocusOn(i,t,!0);return!1===s?null:null!=s&&(s.startEditing(null,!0,r),s.focusCell(!1),!0)}moveToNextEditingRow(e,t,r=null){const i=e.getCellPosition(),s=this.findNextCellToFocusOn(i,t,!0);if(!1===s)return null;if(null==s)return!1;const n=s.getCellPosition(),o=this.isCellEditable(i),a=this.isCellEditable(n),l=n&&i.rowIndex===n.rowIndex&&i.rowPinned===n.rowPinned;return o&&e.setFocusOutOnEditor(),l||(e.getRowCtrl().stopEditing(),s.getRowCtrl().startRowEditing(void 0,void 0,r)),a?(s.setFocusInOnEditor(),s.focusCell()):s.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const r=this.visibleColsService.getAllCols();let i;i=e instanceof Fs?{...e.getRowPosition(),column:t?r[0]:Le(r)}:e.getCellPosition();const s=this.findNextCellToFocusOn(i,t,!1);if(!1===s)return null;if(s instanceof Es)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s.getRowPosition(),t);return te(s)}findNextCellToFocusOn(e,t,r){let i=e;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=this.cellNavigationService.getNextTabbedCell(i,t);const s=this.gos.getCallback("tabToNextCell");if(te(s)){const l=s({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:i||null});if(!0===l||null===l)null===l&&q("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),i=e;else{if(!1===l)return!1;i={rowIndex:l.rowIndex,column:l.column,rowPinned:l.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const a=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+i.rowIndex,column:i.column},fromCell:!0}),null}const n="fullRow"===this.gos.get("editType");if(r&&!n&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const o=this.getCellByPosition(i);if(!o){const a=this.rowRenderer.getRowByPosition(i);if(!a||!a.isFullWidth()||r)continue;return a}if(!o.isSuppressNavigable())return this.rangeService?.setRangeToCell(i),o}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.rowModel.getRow(e.rowIndex)}navigateToNextCell(e,t,r,i){let s=r,n=!1;for(;s&&(s===r||!this.isValidNavigateCell(s));)this.gos.get("enableRtl")?t===N.LEFT&&(s=this.getLastCellOfColSpan(s)):t===N.RIGHT&&(s=this.getLastCellOfColSpan(s)),s=this.cellNavigationService.getNextCellToFocus(t,s),n=Ie(s);if(n&&e&&e.key===N.UP&&(s={rowIndex:-1,rowPinned:null,column:r.column}),i){const a=this.gos.getCallback("navigateToNextCell");if(te(a)){const c=a({key:t,previousCellPosition:r,nextCellPosition:s||null,event:e});s=te(c)?{rowPinned:c.rowPinned,rowIndex:c.rowIndex,column:c.column}:null}}if(!s)return;if(s.rowIndex<0){const a=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+s.rowIndex,column:r.column},event:e||void 0,fromCell:!0})}const o=this.getNormalisedPosition(s);o?this.focusPosition(o):this.tryToFocusFullWidthRow(s)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const r=this.visibleColsService.getAllCols(),i=this.rowRenderer.getRowByPosition(e);if(!i||!i.isFullWidth())return!1;const s=this.focusService.getFocusedCell(),n={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Le(r):r[0])};this.focusPosition(n);const o=t??(null!=s&&this.rowPositionUtils.before(n,s));return this.eventService.dispatchEvent({type:"fullWidthRowFocused",rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:n.column,isFullWidthCell:!0,fromBelow:o}),!0}focusPosition(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService?.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const r=t.getColSpanningList();return 1===r.length?e:{rowIndex:e.rowIndex,column:Le(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=oa(this.gos),r=this.rowModel.getRow(e.rowIndex);!(t&&r?.sticky)&&Ie(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}},PD=class extends U{constructor(){super(...arguments),this.beanName="horizontalResizeService"}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};return this.dragService.addDragSource(t),()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(r)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},MD=class extends U{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.menuService=e.menuService}hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,r){this.showPopup(e,i=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:r,mouseEvent:t,ePopup:i})},r,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,r){let i=-1,s="left";const n=this.menuService.isLegacyMenuEnabled();!n&&this.gos.get("enableRtl")&&(i=1,s="right");const o=n?void 0:4*i,a=n?void 0:4;this.showPopup(e,l=>{this.popupService.positionPopupByComponent({type:r,eventSource:t,ePopup:l,nudgeX:o,nudgeY:a,alignSide:s,keepWithinBounds:!0,position:"under",column:e})},r,t,n)}showPopup(e,t,r,i,s){const n=e?this.createBean(new Gk(e,"COLUMN_MENU")):void 0;if(this.activeMenu=n,!n?.hasFilter()||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");let a;ir(o,"presentation"),o.classList.add("ag-menu"),s||o.classList.add("ag-filter-menu"),[this.tabListener]=this.addManagedElementListeners(o,{keydown:p=>this.trapFocusWithin(p,o)}),o.appendChild(n?.getGui());const c=this.menuService.isColumnMenuAnchoringEnabled()?i??this.ctrlsService.getGridBodyCtrl().getGui():void 0,u=this.localeService.getLocaleTextFunc(),h=s&&"columnFilter"!==r?u("ariaLabelColumnMenu","Column Menu"):u("ariaLabelColumnFilter","Column Filter"),g=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:p=>{e.setMenuVisible(!1,"contextMenu");const f=p instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),f&&i&&zr(i)){const m=this.focusService.findTabbableParent(i);m&&m.focus()}n?.afterGuiDetached(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,r,e)},positionCallback:()=>t(o),anchorToElement:c,ariaLabel:h});g&&(this.hidePopup=a=g.hideFunc),n.afterInit().then(()=>{t(o),n.afterGuiAttached({container:r,hidePopup:a})}),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,r,e)}trapFocusWithin(e,t){e.key!==N.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,r){this.eventService.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:r??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},ID=class extends U{constructor(){super(...arguments),this.beanName="resizeObserverService"}observeResize(e,t){const i=pf(this.gos).ResizeObserver,s=i?new i(t):null;return s?.observe(e),()=>s?.disconnect()}},LD=class extends U{constructor(){super(...arguments),this.beanName="animationFrameService",this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}setScrollTop(e){const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){const r=this.paginationService?.getCurrentPage()??0;r!==this.lastPage&&(this.lastPage=r,this.scrollGoingDown=!0)}this.lastScrollTop=e}postConstruct(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){!1===this.useAnimationFrame&&q(`AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,r){this.verifyAnimationFrameOn(r);const i={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[r],i),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((r,i)=>r.index!==i.index?t*(i.index-r.index):i.createOrder-r.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,r=t.list,i=this.createTasksP2,s=i.list,n=this.destroyTasks,o=(new Date).getTime();let a=(new Date).getTime()-o;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let u;if(r.length)this.sortTaskList(t),u=r.pop().task;else if(s.length)this.sortTaskList(i),u=s.pop().task;else{if(!n.length){this.cancelledTasks.clear();break}u=n.pop()}this.cancelledTasks.has(u)||u()}a=(new Date).getTime()-o}r.length||s.length||n.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=pf(this.gos);t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{this.isOn()?t||(t=!0,this.addDestroyTask(()=>{t=!1,e()})):window.setTimeout(e,0)}}},OD=class extends U{constructor(){super(...arguments),this.beanName="expansionService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.isClientSideRowModel=it(this.gos)}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode(r=>{r.id&&t.has(r.id)&&(r.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode(({expanded:t,id:r})=>{t&&r&&e.push(r)}),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,r,i){e&&(r&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,r,i),e.setExpanded(t,void 0,i))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}},BD=class extends U{constructor(){super(...arguments),this.beanName="menuService"}wireBeans(e){this.valueService=e.valueService,this.filterMenuFactory=e.filterMenuFactory,this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.filterManager=e.filterManager,this.rowRenderer=e.rowRenderer,this.columnChooserFactory=e.columnChooserFactory,this.contextMenuFactory=e.contextMenuFactory,this.enterpriseMenuFactory=e.enterpriseMenuFactory}postConstruct(){this.activeMenuFactory=this.enterpriseMenuFactory??this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,r){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,r)}getContextMenuPosition(e,t){const r=this.getRowCtrl(e),i=this.getCellGui(r,t);if(!i)return r?{x:0,y:r.getRowYPosition()}:{x:0,y:0};const s=i.getBoundingClientRect();return{x:s.x+s.width/2,y:s.y+s.height/2}}showContextMenu(e){const{rowNode:t}=e,r=e.column;let{anchorToElement:i,value:s}=e;t&&r&&null==s&&(s=this.valueService.getValueForDisplay(r,t)),null==i&&(i=this.getContextMenuAnchorElement(t,r)),this.contextMenuFactory?.onContextMenu(e.mouseEvent??null,e.touchEvent??null,t??null,r??null,s,i)}showColumnChooser(e){this.columnChooserFactory?.showColumnChooser(e)}hidePopupMenu(){this.contextMenuFactory?.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){this.columnChooserFactory?.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:r}=e.getColDef();return!(r??t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&zi(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&"new"===this.getColumnMenuType()}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Vi()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!(!this.filterManager?.isFilterAllowed(e)||this.isLegacyMenuEnabled()||this.isFilterMenuInHeaderEnabled(e)||this.isFloatingFilterButtonDisplayed(e))}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return"new"===this.getColumnMenuType()}isLegacyMenuEnabled(){return"legacy"===this.getColumnMenuType()}isFloatingFilterButtonEnabled(e){const t=e.getColDef(),r=t.floatingFilterComponentParams?.suppressFilterButton;return null!=r&&q("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),null==t.suppressFloatingFilterButton?!r:!t.suppressFloatingFilterButton}getColumnMenuType(){return this.gos.get("columnMenu")}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()?!!this.gos.exists("suppressMenuHide")&&e:e}showColumnMenuCommon(e,t,r,i){const{positionBy:s}=t,n=t.column;if("button"===s){const{buttonElement:o}=t;e.showMenuAfterButtonClick(n,o,r,i)}else if("mouse"===s){const{mouseEvent:o}=t;e.showMenuAfterMouseEvent(n,o,r,i)}else n&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(n,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const o=this.ctrlsService.getHeaderRowContainerCtrl(n.getPinned())?.getHeaderCtrlForColumn(n);o&&e.showMenuAfterButtonClick(n,o.getAnchorElementForMenu(i),r,!0)}))}getRowCtrl(e){const{rowIndex:t,rowPinned:r}=e||{};if(null!=t)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r})||void 0}getCellGui(e,t){return e&&t&&e.getCellCtrl(t)?.getGui()||void 0}getContextMenuAnchorElement(e,t){const r=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),i=this.getRowCtrl(e);return i?this.getCellGui(i,t)||(i.isFullWidth()?i.getFullWidthElement():r):r}},GD={selector:"AG-INPUT-TEXT-AREA",component:class extends Ss{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const r=super.setValue(e,t);return this.eInput.value=e,r}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}}},zD=class extends nn{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){ps(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedElementListeners(e,{keydown:i=>{id(this.gos,i,t.node,t.column,!0)||t.onKeyDown(i)}})}},_a=class extends nn{constructor(e){super(`\n            <div class="ag-cell-edit-wrapper">\n                ${e.getTemplate()}\n            </div>`,e.getAgComponents()),this.cellEditorInput=e,this.eInput=de}init(e){this.params=e;const{cellStartedEdit:t,eventKey:r,suppressPreventDefault:i}=e,s=this.eInput;this.cellEditorInput.init(s,e);let n,o=!0;t?(this.focusAfterAttached=!0,r===N.BACKSPACE||r===N.DELETE?n="":r&&1===r.length?i?o=!1:n=r:(n=this.cellEditorInput.getStartValue(),r!==N.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,n=this.cellEditorInput.getStartValue()),o&&null!=n&&s.setStartValue(n),this.addManagedElementListeners(s.getGui(),{keydown:a=>{const{key:l}=a;(l===N.PAGE_UP||l===N.PAGE_DOWN)&&a.preventDefault()}})}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;ri()||t.getFocusableElement().focus();const r=t.getInputElement();this.highlightAllOnFocus?r.select():this.cellEditorInput.setCaret?.()}focusIn(){const e=this.eInput,t=e.getFocusableElement(),r=e.getInputElement();t.focus(),r.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},Qp=class extends _a{constructor(){super(new class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" data-ref="eInput"></ag-input-text-field>'}getAgComponents(){return[Fa]}init(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return te(e)||te(this.params.value)?this.params.parseValue(e):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=te(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}})}},Zp={selector:"AG-INPUT-DATE-FIELD",component:class extends bs{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=ri();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){Je(this.gos)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?Mr(e??null,!1)??void 0:e;return this.min===t||(this.min=t,Pr(this.eInput,"min",t)),this}setMax(e){const t=e instanceof Date?Mr(e??null,!1)??void 0:e;return this.max===t||(this.max=t,Pr(this.eInput,"max",t)),this}setStep(e){return this.step===e||(this.step=e,Pr(this.eInput,"step",e)),this}getDate(){if(this.eInput.validity.valid)return sr(this.getValue())??void 0}setDate(e,t){this.setValue(Mr(e??null,!1),t)}}},fo=class{constructor(e){this.cellValueChanges=e}},xd=class extends fo{constructor(e,t,r,i){super(e),this.initialRange=t,this.finalRange=r,this.ranges=i}},Jp=class{constructor(e){this.actionStack=[],this.maxStackSize=e||10,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};function e0(e,t,r="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(t,r),"ensureVisible")}function t0(e,t,r){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureIndexVisible(t,r),"ensureVisible")}var Rs={version:xe,moduleName:"@ag-grid-community/edit-core",beans:[class extends U{constructor(){super(...arguments),this.beanName="editService"}wireBeans(e){this.navigationService=e.navigationService,this.userComponentFactory=e.userComponentFactory,this.valueService=e.valueService}startEditing(e,t=null,r=!1,i=null){const s=this.createCellEditorParams(e,t,r),n=e.getColumn().getColDef(),o=this.userComponentFactory.getCellEditorDetails(n,s),a=null!=o?.popupFromSelector?o.popupFromSelector:!!n.cellEditorPopup,l=null!=o?.popupPositionFromSelector?o.popupPositionFromSelector:n.cellEditorPopupPosition;return e.setEditing(!0,o),e.getComp().setEditDetails(o,a,l,this.gos.get("reactiveCustomComponents")),this.eventService.dispatchEvent(e.createEvent(i,"cellEditingStarted")),!o?.params?.suppressPreventDefault}stopEditing(e,t){const r=e.getComp(),{newValue:i,newValueExists:s}=this.takeValueFromCellEditor(t,r),n=e.getRowNode(),o=e.getColumn(),a=this.valueService.getValueForDisplay(o,n);let l=!1;return s&&(l=this.saveNewValue(e,a,i,n,o)),e.setEditing(!1,void 0),r.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventService.dispatchEvent({...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:i,valueChanged:l}),l}handleColDefChanged(e){const t=e.getCellEditor();if(t?.refresh){const{eventKey:r,cellStartedEdit:i}=e.getEditCompDetails().params,s=this.createCellEditorParams(e,r,i),n=e.getColumn().getColDef(),o=this.userComponentFactory.getCellEditorDetails(n,s);t.refresh(o.params)}}setFocusOutOnEditor(e){const t=e.getComp().getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){const t=e.getComp(),r=t.getCellEditor();r?.focusIn?r.focusIn():(e.focusCell(!0),e.onCellEditorAttached(()=>t.getCellEditor()?.focusIn?.()))}stopEditingAndFocus(e,t=!1,r=!1){e.stopRowOrCellEdit(),e.focusCell(!0),t||this.navigateAfterEdit(r,e.getCellPosition())}createPopupEditorWrapper(e){return new zD(e)}takeValueFromCellEditor(e,t){const r={newValueExists:!1};if(e)return r;const i=t.getCellEditor();return!i||i.isCancelAfterEnd&&i.isCancelAfterEnd()?r:{newValue:i.getValue(),newValueExists:!0}}saveNewValue(e,t,r,i,s){if(r===t)return!1;e.setSuppressRefreshCell(!0);const n=i.setDataValue(s,r,"edit");return e.setSuppressRefreshCell(!1),n}createCellEditorParams(e,t,r){const i=e.getColumn(),s=e.getRowNode();return this.gos.addGridCommonParams({value:this.valueService.getValueForDisplay(i,s),eventKey:t,column:i,colDef:i.getColDef(),rowIndex:e.getCellPosition().rowIndex,node:s,data:s.data,cellStartedEdit:r,onKeyDown:e.onKeyDown.bind(e),stopEditing:e.stopEditingAndFocus.bind(e),eGridCell:e.getGui(),parseValue:n=>this.valueService.parseValue(i,s,n,e.getValue()),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){this.gos.get("enterNavigatesVerticallyAfterEdit")&&this.navigationService.navigateToNextCell(null,e?N.UP:N.DOWN,t,!1)}}]},g4={version:xe,moduleName:"@ag-grid-community/edit-api",apiFunctions:{undoCellEditing:function i4(e){e.undoRedoService?.undo("api")},redoCellEditing:function s4(e){e.undoRedoService?.redo("api")},getCellEditorInstances:function n4(e,t={}){return e.rowRenderer.getCellEditorInstances(t).map(ao)},getEditingCells:function o4(e){return e.rowRenderer.getEditingCells()},stopEditing:function a4(e,t=!1){e.rowRenderer.stopEditing(t)},startEditingCell:function l4(e,t){const r=e.columnModel.getCol(t.colKey);if(!r)return void q(`no column found for ${t.colKey}`);const i={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:r};null==t.rowPinned&&t0(e,t.rowIndex),e0(e,t.colKey);const n=e.navigationService.getCellByPosition(i);if(!n)return;const{focusService:o,gos:a}=e,c=a.get("stopEditingWhenCellsLoseFocus")&&(()=>{const d=Je(a),u=n.getGui();return d!==u&&u.contains(d)})();(c||!o.isCellFocused(i))&&o.setFocusedCell({...i,forceBrowserFocus:c,preventScrollOnBrowserFocus:!0}),n.startRowOrCellEdit(t.key)},getCurrentUndoSize:function c4(e){return e.undoRedoService?.getCurrentUndoStackSize()??0},getCurrentRedoSize:function d4(e){return e.undoRedoService?.getCurrentRedoStackSize()??0}},dependantModules:[Rs]},r0={version:xe,moduleName:"@ag-grid-community/default-editor",userComponents:[{name:"agCellEditor",classImp:Qp}],dependantModules:[Rs]},x4={version:xe,moduleName:"@ag-grid-community/editing",dependantModules:[Rs,{version:xe,moduleName:"@ag-grid-community/undo-redo-edit",beans:[class extends U{constructor(){super(...arguments),this.beanName="undoRedoService",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},r=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,t),i=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(r||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:a,oldValue:l,value:c}=e,d={rowPinned:n,rowIndex:o,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(d)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}wireBeans(e){this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.cellPositionUtils=e.cellPositionUtils,this.rowPositionUtils=e.rowPositionUtils,this.columnModel=e.columnModel,this.rangeService=e.rangeService}postConstruct(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");if(e<=0)return;this.undoStack=new Jp(e),this.redoStack=new Jp(e),this.addListeners();const t=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:r=>{r.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:t,newColumnsLoaded:t,columnGroupOpened:t,columnRowGroupChanged:t,columnMoved:t,columnPinned:t,columnVisible:t,rowDragEnd:t}),this.ctrlsService.whenReady(this,r=>{this.gridBodyCtrl=r.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){this.eventService.dispatchEvent({type:"undoStarted",source:e});const t=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo");this.eventService.dispatchEvent({type:"undoEnded",source:e,operationPerformed:t})}redo(e){this.eventService.dispatchEvent({type:"redoStarted",source:e});const t=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo");this.eventService.dispatchEvent({type:"redoEnded",source:e,operationPerformed:t})}undoRedo(e,t,r,i,s){if(!e)return!1;const n=e.pop();return!(!n||!n.cellValueChanges||(this.processAction(n,o=>o[i],s),n instanceof xd?this.processRange(this.rangeService,n.ranges||[n[r]]):this.processCell(n.cellValueChanges),t.push(n),0))}processAction(e,t,r){e.cellValueChanges.forEach(i=>{const{rowIndex:s,rowPinned:n,columnId:o}=i,l=this.rowPositionUtils.getRowNode({rowIndex:s,rowPinned:n});l.displayed&&l.setDataValue(o,t(i),r)})}processRange(e,t){let r;e.removeAllCellRanges(!0),t.forEach((i,s)=>{if(!i)return;const n=i.startRow,o=i.endRow;s===t.length-1&&(r={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(r)),e.addCellRange({rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns})})}processCell(e){const t=e[0],{rowIndex:r,rowPinned:i}=t,n=this.rowPositionUtils.getRowNode({rowIndex:r,rowPinned:i});this.setLastFocusedCell({rowPinned:t.rowPinned,rowIndex:n.rowIndex,columnId:t.columnId},this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:r,columnId:i,rowPinned:s}=e,n=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getCol(i);if(!o)return;n.ensureIndexVisible(r),n.ensureColumnVisible(o);const a={rowIndex:r,column:o,rowPinned:s};this.focusService.setFocusedCell({...a,forceBrowserFocus:!0}),t?.setRangeToCell(a)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new fo(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const r=new fo(this.cellValueChanges);this.pushActionsToUndoStack(r)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new fo(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new xd(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;e=this.rangeService&&ei(this.gos)?new xd(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new fo(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}}],dependantModules:[Rs]},{version:xe,moduleName:"@ag-grid-community/full-row-edit",beans:[class extends U{constructor(){super(...arguments),this.beanName="rowEditService"}startEditing(e,t=null,r=null,i=null){let s=!0;return e.getAllCellCtrls().reduce((o,a)=>{const l=a===r;return l?s=a.startEditing(t,l,i):a.startEditing(null,l,i),!!o||a.isEditing()},!1)&&this.setEditing(e,!0),s}stopEditing(e,t=!1){const r=e.getAllCellCtrls(),i=e.isEditing();e.setStoppingRowEdit(!0);let s=!1;for(const n of r){const o=n.stopEditing(t);i&&!t&&!s&&o&&(s=!0)}s&&this.eventService.dispatchEvent(e.createRowEvent("rowValueChanged")),i&&this.setEditing(e,!1),e.setStoppingRowEdit(!1)}setEditing(e,t){e.setEditingRow(t),e.forEachGui(void 0,i=>i.rowComp.addOrRemoveCssClass("ag-row-editing",t));const r=e.createRowEvent(t?"rowEditingStarted":"rowEditingStopped");this.eventService.dispatchEvent(r)}}],dependantModules:[Rs]},{version:xe,moduleName:"@ag-grid-community/all-editors",dependantModules:[r0,{version:xe,moduleName:"@ag-grid-community/data-type-editors",userComponents:[{name:"agTextCellEditor",classImp:Qp},{name:"agNumberCellEditor",classImp:class extends _a{constructor(){super(new class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" data-ref="eInput"></ag-input-number-field>'}getAgComponents(){return[rT]}init(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step);const r=e.getInputElement();t.preventStepping?e.addManagedElementListeners(r,{keydown:this.preventStepping}):t.showStepperButtons&&r.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===N.UP||e.key===N.DOWN)&&e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!te(e)&&!te(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(null==t)return t;if("string"==typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}setCaret(){ri()&&this.eInput.getInputElement().focus({preventScroll:!0})}})}},params:{suppressPreventDefault:!0}},{name:"agDateCellEditor",classImp:class extends _a{constructor(){super(new class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[Zp]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return te(e)||te(this.params.value)?e??null:this.params.value}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return Mr(e,!1)}})}}},{name:"agDateStringCellEditor",classImp:class extends _a{wireBeans(e){this.dataTypeService=e.dataTypeService}constructor(){super(new class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[Zp]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return te(e)||te(this.params.value)?this.params.parseValue(e??""):this.params.value}getStartValue(){return Mr(this.parseDate(this.params.value??void 0)??null,!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):sr(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Mr(e??null,!1)??void 0}}(()=>this.dataTypeService))}}},{name:"agCheckboxCellEditor",classImp:class extends nn{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[Zc]),this.eCheckbox=de}init(e){this.params=e;const t=e.value??void 0;this.eCheckbox.setValue(t),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(this.eCheckbox,{fieldValueChanged:i=>this.setAriaLabel(i.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),r=Ic(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${r})`)}}}],dependantModules:[r0]},{version:xe,moduleName:"@ag-grid-community/select-editor",userComponents:[{name:"agSelectCellEditor",classImp:class extends nn{constructor(){super('<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" data-ref="eSelect"></ag-select>\n            </div>',[$k]),this.eSelect=de,this.startedByEnter=!1}wireBeans(e){this.valueService=e.valueService}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:r,gos:i}=this,{values:s,value:n,eventKey:o}=e;if(Ie(s))return void q("no values found for select cellEditor");this.startedByEnter=null!=o&&o===N.ENTER;let a=!1;s.forEach(u=>{const h={value:u},g=r.formatValue(e.column,null,u);h.text=null!=g?g:u,t.addOption(h),a=a||n===u}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:d}=e;null!=l&&t.setPickerGap(l),null!=d&&t.setPickerMaxHeight(d),null!=c&&t.setPickerMaxWidth(c),"fullRow"!==i.get("editType")&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}}],dependantModules:[Rs]},{version:xe,moduleName:"@ag-grid-community/large-text-editor",userComponents:[{name:"agLargeTextCellEditor",classImp:class extends nn{constructor(){super('<div class="ag-large-text">\n        <ag-input-text-area data-ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',[GD]),this.eTextArea=de}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),te(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===N.LEFT||t===N.UP||t===N.RIGHT||t===N.DOWN||e.shiftKey&&t===N.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return te(e)||te(this.params.value)?this.params.parseValue(e):this.params.value}}}],dependantModules:[Rs]}]},g4]},S4=class extends U{constructor(){super(...arguments),this.beanName="autoWidthCalculator"}wireBeans(e){this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const i=this.rowRenderer.getAllCellsForColumn(e);return t||i.push(r),this.addElementsToContainerAndGetWidth(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const r=this.centerRowContainerCtrl.getContainerElement();e.forEach(n=>this.cloneItemIntoDummy(n,t)),r.appendChild(t);const i=t.offsetWidth;return r.removeChild(t),i+this.getAutoSizePadding()}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(r=>{const i=r.getHtmlElementForColumnHeader(e);null!=i&&(t=i)}),t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const i=document.createElement("div"),s=i.classList;["ag-header-cell","ag-header-group-cell"].some(a=>r.classList.contains(a))?(s.add("ag-header","ag-header-row"),i.style.position="static"):s.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const c=o.classList[l];"ag-row-position-absolute"!=c&&s.add(c)}break}o=o.parentElement}i.appendChild(r),t.appendChild(i)}},y4=class extends U{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.extraTopHeight=0,this.extraBottomHeight=0}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.isClientSide=it(this.gos),this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl}),this.resetStickyContainers()}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}setOffsetTop(e){this.extraTopHeight!==e&&(this.extraTopHeight=e,this.eventService.dispatchEvent({type:"stickyTopOffsetChanged",offset:e}))}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getExtraTopHeight(){return this.extraTopHeight}getExtraBottomHeight(){return this.extraBottomHeight}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let r=e.childStore?.getStoreBounds();return e.footer&&(r=e.sibling.childStore?.getStoreBounds()),(r?.heightPx??0)+(r?.topPx??0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){if(e.footer&&0===e.rowIndex)return Number.MAX_SAFE_INTEGER;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let i=e.footer?e.sibling:e;for(;i.isExpandable()&&i.expanded;)if(i.master)i=i.detailNode;else if(i.childrenAfterSort){if(0===i.childrenAfterSort.length)break;i=Le(i.childrenAfterSort)}return i.rowTop+i.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t="top"===e;let r=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,r);const i=t?this.rowRenderer.getFirstVisibleVerticalPixel()-this.extraTopHeight:this.rowRenderer.getLastVisibleVerticalPixel()-this.extraTopHeight,s=new Set,n=c=>{if(s.add(c),t){const d=this.getLastPixelOfGroup(c),u=i+r+c.rowHeight;c.stickyRowTop=d<u?r+(d-u):r}else{const d=this.getFirstPixelOfGroup(c),u=i-(r+c.rowHeight);c.stickyRowTop=d>u?r-(d-u):r}r=0,s.forEach(d=>{const u=d.stickyRowTop+d.rowHeight;r<u&&(r=u)})},o=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=c=>!!c.displayed&&(c.footer?!(!0===o||"grand"===o&&-1===c.level||"group"===o&&c.level>-1)&&!("bottom"===e&&c.sibling.rowIndex&&c.sibling.rowIndex+1===c.rowIndex||s.has(c)):!!c.isExpandable()&&!0!==a&&"bottom"!==e&&!s.has(c)&&c.expanded);for(let c=0;c<100;c++){let d=i+r;t||(d=i-r);const u=this.rowModel.getRowIndexAtPixel(d),h=this.rowModel.getRow(u);if(null==h)break;const p=this.getStickyAncestors(h).find(m=>(t?m.rowIndex<u:m.rowIndex>u)&&l(m));if(p)n(p);else{if(!(t?h.rowTop<d:h.rowTop+h.rowHeight>d)||!l(h))break;n(h)}}return t||s.forEach(c=>{c.stickyRowTop=r-(c.stickyRowTop+c.rowHeight)}),this.refreshNodesAndContainerHeight(e,s,r)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(!0===e)return!0;const t=!!this.gos.get("groupIncludeFooter")||"group"===e,r=!!this.gos.get("groupIncludeTotalFooter")||"grand"===e;return!(!t||!r)||(r?"grand":!!t&&"group")}canRowsBeSticky(){const e=oa(this.gos),t=this.areFooterRowsStickySuppressed(),r=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!r)}getStickyAncestors(e){const t=[];let r=e.footer?e.sibling:e.parent;for(;r;)r.sibling&&t.push(r.sibling),t.push(r),r=r.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.resetStickyContainers()}resetStickyContainers(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some(r=>r.getRowNode()===e)){for(let r=0;r<this.stickyTopRowCtrls.length;r++){const i=this.stickyTopRowCtrls[r].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows()}else{for(let r=0;r<this.stickyBottomRowCtrls.length;r++){const i=this.stickyBottomRowCtrls[r].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}}refreshNodesAndContainerHeight(e,t,r){const i="top"===e,s=i?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,n={},o=[];for(let h=0;h<s.length;h++){const g=s[h].getRowNode();t.has(g)?o.push(s[h]):(n[g.id]=s[h],g.sticky=!1)}const a=new Set;for(let h=0;h<o.length;h++)a.add(o[h].getRowNode());const l=[];t.forEach(h=>{a.has(h)||(h.sticky=!0,l.push(this.createRowCon(h,!1,!1)))});let c=!!l.length||o.length!==s.length;i?this.topContainerHeight!==r&&(this.topContainerHeight=r,this.gridBodyCtrl.setStickyTopHeight(r),c=!0):this.bottomContainerHeight!==r&&(this.bottomContainerHeight=r,this.gridBodyCtrl.setStickyBottomHeight(r),c=!0),this.destroyRowCtrls(n,!1);const d=[...o,...l];d.sort((h,g)=>g.getRowNode().rowIndex-h.getRowNode().rowIndex),i||d.reverse(),d.forEach(h=>h.setRowTop(h.getRowNode().stickyRowTop));let u=0;return i?(t.forEach(h=>{h.rowIndex<this.pageBoundsService.getFirstRow()&&(u+=h.rowHeight)}),u>this.topContainerHeight&&(u=this.topContainerHeight),this.setOffsetTop(u)):(t.forEach(h=>{h.rowIndex>this.pageBoundsService.getLastRow()&&(u+=h.rowHeight)}),u>this.bottomContainerHeight&&(u=this.bottomContainerHeight),this.setOffsetBottom(u)),!!c&&(i?this.stickyTopRowCtrls=d:this.stickyBottomRowCtrls=d,!0)}ensureRowHeightsValid(){let e=!1;const t=r=>{const i=r.getRowNode();if(i.rowHeightEstimated){const s=Ni(this.gos,i);i.setRowHeight(s.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}},b4=class extends U{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(n=>n.onCellSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(n=>n.updateRangeBordersIfRangeCount())},r=()=>{this.eventService.addEventListener("cellSelectionChanged",e),this.eventService.addEventListener("columnMoved",t),this.eventService.addEventListener("columnPinned",t),this.eventService.addEventListener("columnVisible",t)},i=()=>{this.eventService.removeEventListener("cellSelectionChanged",e),this.eventService.removeEventListener("columnMoved",t),this.eventService.removeEventListener("columnPinned",t),this.eventService.removeEventListener("columnVisible",t)};this.addDestroyFunc(()=>i()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ei(this.gos)?r():i()}),ei(this.gos)&&r()}}wireBeans(e){this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusService=e.focusService,this.beans=e,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",e=>this.onSuppressCellFocusChanged(e.currentValue)),this.addManagedPropertyListeners(["getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection","rowSelection"],()=>this.redrawRows()),oa(this.gos)&&(it(this.gos)||pi(this.gos))&&(this.stickyRowFeature=this.createManagedBean(new y4(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this)))),this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=Pt(this.gos,"print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount();this.cachedRowCtrls=new E4(e??3)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=Hi(this.rowCtrlsByRowIndex),t=Hi(this.zombieRowCtrls),r=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=t.length>0||r.length>0?[...e,...t,...r]:e}onCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onSuppressCellFocusChanged(e)),this.getFullWidthRowCtrls().forEach(t=>t.onSuppressCellFocusChanged(e))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>{this.onCellFocusChanged(e)},cellFocusCleared:()=>this.onCellFocusChanged(),flashCells:e=>{this.getAllCellCtrls().forEach(t=>t.onFlashCells(e))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.columnModel.getCols().forEach(t=>{const r=l=>{this.getAllCellCtrls().forEach(c=>{c.getColumn()===t&&l(c)})},i=()=>{r(l=>l.onLeftChanged())},s=()=>{r(l=>l.onWidthChanged())},n=()=>{r(l=>l.onFirstRightPinnedChanged())},o=()=>{r(l=>l.onLastLeftPinnedChanged())},a=()=>{r(l=>l.onColDefChanged())};t.addEventListener("leftChanged",i),t.addEventListener("widthChanged",s),t.addEventListener("firstRightPinnedChanged",n),t.addEventListener("lastLeftPinnedChanged",o),t.addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.removeEventListener("leftChanged",i),t.removeEventListener("widthChanged",s),t.removeEventListener("firstRightPinnedChanged",n),t.removeEventListener("lastLeftPinnedChanged",o),t.removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const e=Pt(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){this.redrawAfterModelUpdate({recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0})}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach(r=>{const i=r.getCellElement(e);i&&t.push(i)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){const{pinnedRowModel:r,beans:i,printLayout:s}=this,n=Object.fromEntries(e.map(a=>[a.getRowNode().id,a]));r.forEachPinnedRow(t,(a,l)=>{const c=e[l];c&&void 0===r.getPinnedRowById(c.getRowNode().id,t)&&(c.destroyFirstPass(),c.destroySecondPass()),a.id in n?(e[l]=n[a.id],delete n[a.id]):e[l]=new Fs(a,i,!1,!1,s)});const o="top"===t?r.getPinnedTopRowCount():r.getPinnedBottomRowCount();e.length=o}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else{if(this.cachedRowCtrls?.has(e))return void this.cachedRowCtrls.removeRow(e);{const r=i=>{const s=i[e.rowIndex];s&&s.getRowNode()===e&&(s.destroyFirstPass(),s.destroySecondPass(),i[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":r(this.topRowCtrls);break;case"bottom":r(this.bottomRowCtrls);break;default:r(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(null!=e)return e?.forEach(r=>this.redrawRow(r,!0)),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=e?.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;const r=Je(this.gos),i=Yn(this.gos,r,Es.DOM_DATA_KEY_CELL_CTRL),s=Yn(this.gos,r,Fs.DOM_DATA_KEY_ROW_CTRL);return i||s?t:null}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&qs(this.gos),s=r?this.getRowsToRecycle():null;if(r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature){this.stickyRowFeature.checkStickyRows();const n=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();n&&this.updateContainerHeights(n)}this.recycleRows(s,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.getScrollFeature().scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let t=this.pageBoundsService.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0,this.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&this.focusService.restoreFocusedCell(e,()=>{this.onCellFocusChanged(this.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))})}stopEditing(e=!1){this.getAllRowCtrls().forEach(t=>{t.stopEditing(e)})}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let i=0;i<r;i++){const s=t[i].getAllCellCtrls(),n=s.length;for(let o=0;o<n;o++)e.push(s[o])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],r=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const i in this.rowCtrlsByRowIndex)r.push(this.rowCtrlsByRowIndex[i]);return r}addRenderedRowListener(e,t,r){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,r)}flashCells(e={}){this.getCellCtrls(e.rowNodes,e.columns).forEach(t=>t.flashCell(e))}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const r of this.getCellCtrls(e.rowNodes,e.columns))r.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=null;this.stickyRowFeature&&Uc()&&(t=this.getCellToRestoreFocusToAfterRefresh()||null);for(const r of this.getRowCtrls(e))r.isFullWidth()&&(r.refreshFullWidth()||this.redrawRow(r.getRowNode(),!0));this.dispatchDisplayedRowsChanged(!1),t&&this.restoreFocusedCell(t)}getCellRendererInstances(e){const t=this.getCellCtrls(e.rowNodes,e.columns).map(s=>s.getCellRenderer()).filter(s=>null!=s);if(e.columns?.length)return t;const r=[],i=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(s=>{if(i&&!this.isRowInMap(s.getRowNode(),i)||!s.isFullWidth())return;const n=s.getFullWidthCellRenderers();for(let o=0;o<n.length;o++){const a=n[o];null!=a&&r.push(a)}}),[...r,...t]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(r=>{const i=r.getCellEditor();i&&t.push(i)}),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const r=t.getCellPosition();e.push(r)}}),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(r=>{const i=r.id;switch(r.rowPinned){case"top":t.top[i]=r;break;case"bottom":t.bottom[i]=r;break;default:t.normal[i]=r}}),t}isRowInMap(e,t){const r=e.id;switch(e.rowPinned){case"top":return null!=t.top[r];case"bottom":return null!=t.bottom[r];default:return null!=t.normal[r]}}getRowCtrls(e){const t=this.mapRowNodes(e),r=this.getAllRowCtrls();return e&&t?r.filter(i=>{const s=i.getRowNode();return this.isRowInMap(s,t)}):r}getCellCtrls(e,t){let r;te(t)&&(r={},t.forEach(s=>{const n=this.columnModel.getCol(s);te(n)&&(r[n.getId()]=!0)}));const i=[];return this.getRowCtrls(e).forEach(s=>{s.getAllCellCtrls().forEach(n=>{const o=n.getColumn().getId();r&&!r[o]||i.push(n)})}),i}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];kr(this.rowCtrlsByRowIndex,(r,i)=>{null==i.getRowNode().id&&e.push(r)}),this.removeRowCtrls(e);const t={};return kr(this.rowCtrlsByRowIndex,(r,i)=>{const s=i.getRowNode();t[s.id]=i}),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(r=>{const i=this.rowCtrlsByRowIndex[r];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[r]})}onBodyScroll(e){"vertical"===e.direction&&this.redraw({afterScroll:!0})}redraw(e={}){const{afterScroll:t}=e;let r;this.stickyRowFeature&&Uc()&&(r=this.getCellToRestoreFocusToAfterRefresh()||void 0);const i=this.firstRenderedRow,s=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let n=!1;if(this.stickyRowFeature){n=this.stickyRowFeature.checkStickyRows();const a=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();a&&this.updateContainerHeights(a)}if((!t||n||this.firstRenderedRow!==i||this.lastRenderedRow!==s)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!n),null!=r)){const a=this.getCellToRestoreFocusToAfterRefresh();null!=r&&null==a&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(r))}}removeRowCompsNotToDraw(e,t){const r={};e.forEach(n=>r[n]=!0);const s=Object.keys(this.rowCtrlsByRowIndex).filter(n=>!r[n]);this.removeRowCtrls(s,t)}calculateIndexesToDraw(e){const t=function nT(e,t){const r=[];for(let i=e;i<=t;i++)r.push(i);return r}(this.firstRenderedRow,this.lastRenderedRow),r=(s,n)=>{const o=n.getRowNode().rowIndex;null!=o&&(o<this.firstRenderedRow||o>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&t.push(o)};kr(this.rowCtrlsByRowIndex,r),kr(e,r),t.sort((s,n)=>s-n);const i=[];for(let s=0;s<t.length;s++){const n=t[s],o=this.rowModel.getRow(n);o&&!o.sticky&&i.push(n)}return i}recycleRows(e,t=!1,r=!1){const i=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(i,!t);const s=[];i.forEach(n=>{const o=this.createOrUpdateRowCtrl(n,e,t,r);te(o)&&s.push(o)}),e&&(!r||this.gos.get("suppressAnimationFrame")||this.printLayout?this.destroyRowCtrls(e,t):this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})),this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventService.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const e=this.visibleColsService.isPinningLeft(),t=this.visibleColsService.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const r=t.getRowNode().rowIndex;e.push(r.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter(r=>{if(!r.isFullWidth())return!1;const i=r.getRowNode();return!(null!=t&&!this.isRowInMap(i,t))})}createOrUpdateRowCtrl(e,t,r,i){let s,n=this.rowCtrlsByRowIndex[e];if(n||(s=this.rowModel.getRow(e),te(s)&&te(t)&&t[s.id]&&s.alreadyRendered&&(n=t[s.id],t[s.id]=null)),!n){if(s||(s=this.rowModel.getRow(e)),!te(s))return;n=this.createRowCon(s,r,i)}return s&&(s.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=n,n}destroyRowCtrls(e,t){const r=[];kr(e,(i,s)=>{if(s){if(this.cachedRowCtrls&&s.isCacheable())return void this.cachedRowCtrls.addRow(s);if(s.destroyFirstPass(!t),t){const n=s.instanceId;this.zombieRowCtrls[n]=s,r.push(()=>{s.destroySecondPass(),delete this.zombieRowCtrls[n]})}else s.destroySecondPass()}}),t&&(r.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),function pF(e){!function mF(e,t=0){e.length>0&&window.setTimeout(()=>e.forEach(r=>r()),t)}(e,400)}(r))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){return this.getRowBuffer()*fs(this.gos)}workOutFirstAndLastRowsToRender(){let e,t;if(this.rowContainerHeightService.updateOffset(),this.rowModel.isRowsToRender())if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.pageBoundsService.getFirstRow(),t=this.pageBoundsService.getLastRow();else{const a=this.getRowBufferInPixels(),l=this.ctrlsService.getGridBodyCtrl(),c=this.gos.get("suppressRowVirtualisation");let u,h,d=!1;do{const w=this.pageBoundsService.getPixelOffset(),{pageFirstPixel:C,pageLastPixel:v}=this.pageBoundsService.getCurrentPagePixelRange(),k=this.rowContainerHeightService.getDivStretchOffset(),M=l.getScrollFeature().getVScrollPosition(),O=M.top,y=M.bottom;c?(u=C+k,h=v+k):(u=Math.max(O+w-a,C)+k,h=Math.min(y+w+a,v)+k),this.firstVisibleVPixel=Math.max(O+w,C)+k,this.lastVisibleVPixel=Math.min(y+w,v)+k,d=this.ensureAllRowsInRangeHaveHeightsCalculated(u,h)}while(d);let g=this.rowModel.getRowIndexAtPixel(u),p=this.rowModel.getRowIndexAtPixel(h);const f=this.pageBoundsService.getFirstRow(),m=this.pageBoundsService.getLastRow();g<f&&(g=f),p>m&&(p=m),e=g,t=p}else e=0,t=-1;const r=Pt(this.gos,"normal"),i=this.gos.get("suppressMaxRenderedRowRestriction"),s=Math.max(this.getRowBuffer(),500);r&&!i&&t-e>s&&(t=e+s),(e!==this.firstRenderedRow||t!==this.lastRenderedRow)&&(this.firstRenderedRow=e,this.lastRenderedRow=t,this.eventService.dispatchEvent({type:"viewportChanged",firstRow:e,lastRow:t}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const r=this.pinnedRowModel?.ensureRowHeightsValid(),i=this.stickyRowFeature?.ensureRowHeightsValid(),s=this.rowModel.ensureRowHeightsValid(e,t,this.pageBoundsService.getFirstRow(),this.pageBoundsService.getLastRow());return(s||i)&&this.eventService.dispatchEvent({type:"recalculateRowBounds"}),!!(i||s||r)&&(this.updateContainerHeights(),!0)}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const i=e.getRowNode(),s=this.focusService.isRowNodeFocused(i),n=e.isEditing();return!!(s||n||i.detail)&&!!this.isRowPresent(i)}isRowPresent(e){return!!this.rowModel.isRowPresent(e)&&(!this.paginationService||this.paginationService.isRowPresent(e))}createRowCon(e,t,r){const i=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(i)return i;const s=this.gos.get("suppressAnimationFrame");return new Fs(e,this.beans,t,r&&!s&&!this.printLayout,this.printLayout)}getRenderedNodes(){return Object.values(this.rowCtrlsByRowIndex).map(t=>t.getRowNode())}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find(i=>i.getRowNode().rowIndex===r)||null,t||(t=this.getStickyBottomRowCtrls().find(i=>i.getRowNode().rowIndex===r)||null))}return t}isRangeInRenderedViewport(e,t){return null!=e&&null!=t&&!(t<this.firstRenderedRow||e>this.lastRenderedRow)}},E4=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=e?null:t):null}has(e){return null!=this.entriesMap[e.id]}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],qt(this.entriesList,r)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],qt(this.entriesList,e)}getEntries(){return this.entriesList}},F4=class extends U{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0,this.pinnedTopRows=new i0,this.pinnedBottomRows=new i0}wireBeans(e){this.beans=e}postConstruct(){this.setPinnedRowData(this.gos.get("pinnedTopRowData"),"top"),this.setPinnedRowData(this.gos.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",e=>this.setPinnedRowData(e.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",e=>this.setPinnedRowData(e.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){return("top"===e?this.pinnedTopRows:this.pinnedBottomRows).isEmpty()}isRowsToRender(e){return!this.isEmpty(e)}onGridStylesChanges(e){if(e.rowHeightChanged){const t=r=>{r.setRowHeight(r.rowHeight,!0)};this.pinnedBottomRows.forEach(t),this.pinnedTopRows.forEach(t)}}ensureRowHeightsValid(){let e=!1,t=0;const r=i=>{if(i.rowHeightEstimated){const s=Ni(this.gos,i);i.setRowTop(t),i.setRowHeight(s.height),t+=s.height,e=!0}};return this.pinnedBottomRows?.forEach(r),t=0,this.pinnedTopRows?.forEach(r),this.eventService.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventService.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const r="top"===t?this.pinnedTopRows:this.pinnedBottomRows;if(void 0===e)return void r.clear();const i=Xs(this.gos),s="top"===t?Si.ID_PREFIX_TOP_PINNED:Si.ID_PREFIX_BOTTOM_PINNED,n=r.getIds(),o=[],a=new Set;let l=0,c=-1;for(const d of e){const u=i?.({data:d,level:0,rowPinned:t})??s+this.nextId++;if(a.has(u)){q("Duplicate ID",u,"found for pinned row with data",d,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter.");continue}c++,a.add(u),o.push(u);const h=r.getById(u);if(void 0!==h)h.data!==d&&h.setData(d),l+=this.setRowTopAndRowIndex(h,l,c),n.delete(u);else{const g=new Si(this.beans);g.id=u,g.data=d,g.rowPinned=t,l+=this.setRowTopAndRowIndex(g,l,c),r.push(g)}}n.forEach(d=>{r.getById(d)?.clearRowTopAndRowIndex()}),r.removeAllById(n),r.setOrder(o)}setRowTopAndRowIndex(e,t,r){return e.setRowTop(t),e.setRowHeight(Ni(this.gos,e).height),e.setRowIndex(r),e.rowHeight}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getPinnedTopRowCount(){return this.pinnedTopRows.getSize()}getPinnedBottomRowCount(){return this.pinnedBottomRows.getSize()}getPinnedTopRow(e){return this.pinnedTopRows.getByIndex(e)}getPinnedBottomRow(e){return this.pinnedBottomRows.getByIndex(e)}getPinnedRowById(e,t){return"top"===t?this.pinnedTopRows.getById(e):this.pinnedBottomRows.getById(e)}forEachPinnedRow(e,t){return"top"===e?this.pinnedTopRows.forEach(t):this.pinnedBottomRows.forEach(t)}getTotalHeight(e){const t=e.getSize();if(0===t)return 0;const r=e.getByIndex(t-1);return void 0===r?0:r.rowTop+r.rowHeight}},i0=class{constructor(){this.cache={},this.ordering=[]}getById(e){return this.cache[e]}getByIndex(e){return this.cache[this.ordering[e]]}push(e){this.cache[e.id]=e,this.ordering.push(e.id)}removeAllById(e){for(const t of e)delete this.cache[t];this.ordering=this.ordering.filter(t=>!e.has(t))}setOrder(e){this.ordering=e}forEach(e){this.ordering.forEach((t,r)=>{const i=this.cache[t];i&&e(i,r)})}clear(){this.ordering.length=0,this.cache={}}isEmpty(){return 0===this.ordering.length}getSize(){return this.ordering.length}getIds(){return new Set(this.ordering)}},k4=class extends U{constructor(e){super(),this.state="needsLoading",this.version=0,this.id=e}getId(){return this.id}load(){this.state="loading",this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed",this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,r){this.successCommon(e,{rowData:t,rowCount:r})}isRequestMostRecentAndLive(e){const t=e===this.version,r=this.isAlive();return t&&r}successCommon(e,t){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}dispatchLoadCompleted(e=!0){this.dispatchLocalEvent({type:"loadComplete",success:e,block:this})}},D4={version:xe,moduleName:"@ag-grid-community/row-node-block",beans:[class extends U{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Yt(this.performCheckBlocksToLoad.bind(this),e))}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){qt(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchLocalEvent({type:"blockLoaded"}),0==this.activeBlockLoadsCount&&this.dispatchLocalEvent({type:"blockLoaderFinished"})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void(this.gos.get("debug")&&Rr("RowNodeBlockLoader - checkBlockToLoad: max loads exceeded"));const e=this.getAvailableLoadingCount(),t=this.blocks.filter(r=>"needsLoading"===r.getState()).slice(0,e);this.registerLoads(t.length),t.forEach(r=>r.load()),this.printCacheStatus()}getBlockState(){if(pi(this.gos))return this.rowModel.getBlockStates();const e={};return this.blocks.forEach(t=>{const{id:r,state:i}=t.getBlockStateJson();e[r]=i}),e}printCacheStatus(){this.gos.get("debug")&&Rr(`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}}]},P4=class extends U{constructor(){super(...arguments),this.beanName="stylingService"}wireBeans(e){this.expressionService=e.expressionService}processAllCellClasses(e,t,r,i){this.processClassRules(void 0,e.cellClassRules,t,r,i),this.processStaticCellClasses(e,t,r)}processClassRules(e,t,r,i,s){if(null==t&&null==e)return;const n={},o={},a=(l,c)=>{l.split(" ").forEach(d=>{""!=d.trim()&&c(d)})};if(t){const l=Object.keys(t);for(let c=0;c<l.length;c++){const d=l[c],u=t[d];let h;"string"==typeof u?h=this.expressionService.evaluate(u,r):"function"==typeof u&&(h=u(r)),a(d,g=>{h?n[g]=!0:o[g]=!0})}}e&&s&&Object.keys(e).forEach(l=>a(l,c=>{n[c]||(o[c]=!0)})),s&&Object.keys(o).forEach(s),Object.keys(n).forEach(i)}getStaticCellClasses(e,t){const{cellClass:r}=e;if(!r)return[];let i;return i="function"==typeof r?r(t):r,"string"==typeof i&&(i=[i]),i||[]}processStaticCellClasses(e,t,r){this.getStaticCellClasses(e,t).forEach(s=>{r(s)})}},L4=class extends U{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:r,eBottomGuard:i,focusTrapActive:s,forceFocusOutWhenTabGuardsAreEmpty:n,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:d,onTabKeyDown:u,handleKeyDown:h,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=r,this.eBottomGuard=i,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!s,this.forceFocusOutWhenTabGuardsAreEmpty=!!n,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=d,this.providedOnTabKeyDown=u,this.providedHandleKeyDown=h}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.createManagedBean(new ys(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)}))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);if(this.forceFocusOutWhenTabGuardsAreEmpty&&0===this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){const t=gt(this.gos),r=this.focusService.findFocusableElements(t.body,null,!0),i=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(-1===i)return;let s,n;e?(s=0,n=i):(s=i+1,n=r.length);const o=r.slice(s,n),a=this.gos.get("tabIndex");o.sort((l,c)=>{const d=parseInt(l.getAttribute("tabindex")||"0"),u=parseInt(c.getAttribute("tabindex")||"0");return u===a?1:d===a?-1:0===d?1:0===u?-1:d-u}),o[e?o.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},_4=class extends U{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:r,eFocusableElement:i}=this,s=[t,r],n={setTabIndex:f=>{s.forEach(m=>null!=f?m.setAttribute("tabindex",f):m.removeAttribute("tabindex"))}};this.addTabGuards(t,r);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:u,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:p}=e;this.tabGuardCtrl=this.createManagedBean(new L4({comp:n,focusTrapActive:o,eTopGuard:t,eBottomGuard:r,eFocusableElement:i,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:d,onTabKeyDown:u,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:p}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=gt(this.gos).createElement("div");return t.classList.add("ag-tab-guard","top"===e?"ag-tab-guard-top":"ag-tab-guard-bottom"),ir(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Vt(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,r){qc(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):e(t,r)}},s0=class extends Ge{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new _4(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},O4=0,N4=class extends U{constructor(){super(...arguments),this.beanName="popupService",this.popupList=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.resizeObserverService=e.resizeObserverService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){return this.gos.get("popupParent")||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:r}=e,i=this.getPopupIndex(r);-1!==i&&(this.popupList[i].alignedToElement=t);const s=t.getBoundingClientRect(),n=this.getParentRect(),o=this.keepXYWithinBounds(r,s.top-n.top,0),a=r.clientWidth>0?r.clientWidth:200;r.style.minWidth=`${a}px`;const c=n.right-n.left-a;let d;function u(){return s.right-n.left-2}function h(){return s.left-n.left-a}this.gos.get("enableRtl")?(d=h(),d<0&&(d=u(),this.setAlignedStyles(r,"left")),d>c&&(d=0,this.setAlignedStyles(r,"right"))):(d=u(),d>c&&(d=h(),this.setAlignedStyles(r,"right")),d<0&&(d=0,this.setAlignedStyles(r,"left"))),r.style.left=`${d}px`,r.style.top=`${o}px`}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:r,nudgeY:i,skipObserver:s}=e;this.positionPopup({ePopup:t,nudgeX:r,nudgeY:i,keepWithinBounds:!0,skipObserver:s,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:r,nudgeY:i,keepWithinBounds:s,eventSource:n,alignSide:o="left",position:a="over",column:l,rowNode:c,type:d}=e,u=n.getBoundingClientRect(),h=this.getParentRect(),g=this.getPopupIndex(t);-1!==g&&(this.popupList[g].alignedToElement=n),this.positionPopup({ePopup:t,nudgeX:r,nudgeY:i,keepWithinBounds:s,updatePosition:()=>{let m,f=u.left-h.left;return"right"===o&&(f-=t.offsetWidth-u.width),"over"===a?(m=u.top-h.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),m="under"===this.shouldRenderUnderOrAbove(t,u,h,e.nudgeY||0)?u.top-h.top+u.height:u.top-t.offsetHeight-2*(i||0)-h.top),{x:f,y:m}},postProcessCallback:()=>this.callPostProcessPopup(d,t,n,null,l,c)})}shouldRenderUnderOrAbove(e,t,r,i){const s=r.bottom-t.bottom,n=t.top-r.top,o=e.offsetHeight+i;return s>o?"under":n>o||n>s?"above":"under"}setAlignedStyles(e,t){const r=this.getPopupIndex(e);if(-1===r)return;const i=this.popupList[r],{alignedToElement:s}=i;!s||(["right","left","over","above","under"].forEach(o=>{s.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`)}),!t)||(s.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}callPostProcessPopup(e,t,r,i,s,n){const o=this.gos.getCallback("postProcessPopup");o&&o({column:s,rowNode:n,ePopup:t,type:e,eventSource:r,mouseEvent:i})}positionPopup(e){const{ePopup:t,keepWithinBounds:r,nudgeX:i,nudgeY:s,skipObserver:n,updatePosition:o}=e,a={width:0,height:0},l=(c=!1)=>{let{x:d,y:u}=o();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,i&&(d+=i),s&&(u+=s),r&&(d=this.keepXYWithinBounds(t,d,1),u=this.keepXYWithinBounds(t,u,0)),t.style.left=`${d}px`,t.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!n){const c=this.resizeObserverService.observeResize(t,()=>l(!0));setTimeout(()=>c(),200)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=gt(this.gos);let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),Kf(t)}keepXYWithinBounds(e,t,r){const i=0===r,s=i?"clientHeight":"clientWidth",n=i?"top":"left",o=i?"height":"width",a=i?"scrollTop":"scrollLeft",l=gt(this.gos),c=l.documentElement,d=this.getPopupParent(),u=e.getBoundingClientRect(),h=d.getBoundingClientRect(),g=l.documentElement.getBoundingClientRect(),p=d===l.body,f=Math.ceil(u[o]);let w=p?(i?$f:va)(c)+c[a]:d[s];p&&(w-=Math.abs(g[n]-h[n]));const C=w-f;return Math.min(Math.max(t,0),Math.abs(C))}addPopup(e){const t=gt(this.gos),{eChild:r,ariaLabel:i,alwaysOnTop:s,positionCallback:n,anchorToElement:o}=e;if(!t)return q("could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(r);if(-1!==a)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(r);const l=this.createPopupWrapper(r,i,!!s),c=this.addEventListenersToPopup({...e,wrapperEl:l});return n&&n(),this.addPopupToPopupList(r,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const r=this.getPopupParent().getBoundingClientRect();te(e.style.top)||(e.style.top=-1*r.top+"px"),te(e.style.left)||(e.style.left=-1*r.left+"px")}createPopupWrapper(e,t,r){const i=this.getPopupParent(),s=document.createElement("div");return this.environment.applyThemeClasses(s),s.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||ir(e,"dialog"),en(e,t),s.appendChild(e),i.appendChild(s),r?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),s}handleThemeChange(e){if(e.themeChanged)for(const t of this.popupList)this.environment.applyThemeClasses(t.wrapper)}addEventListenersToPopup(e){const t=gt(this.gos),r=this.getPopupParent(),{wrapperEl:i,eChild:s,closedCallback:n,afterGuiAttached:o,closeOnEsc:a,modal:l}=e;let c=!1;const d=p=>{i.contains(Je(this.gos))&&p.key===N.ESCAPE&&!vi(p)&&g({keyboardEvent:p})},u=p=>g({mouseEvent:p}),h=p=>g({touchEvent:p}),g=(p={})=>{const{mouseEvent:f,touchEvent:m,keyboardEvent:w,forceHide:C}=p;!C&&(this.isEventFromCurrentPopup({mouseEvent:f,touchEvent:m},s)||c)||(c=!0,r.removeChild(i),t.removeEventListener("keydown",d),t.removeEventListener("mousedown",u),t.removeEventListener("touchstart",h),t.removeEventListener("contextmenu",u),this.eventService.removeEventListener("dragStarted",u),n&&n(f||m||w),this.removePopupFromPopupList(s))};return o&&o({hidePopup:g}),window.setTimeout(()=>{a&&t.addEventListener("keydown",d),l&&(t.addEventListener("mousedown",u),this.eventService.addEventListener("dragStarted",u),t.addEventListener("touchstart",h),t.addEventListener("contextmenu",u))},0),g}addPopupToPopupList(e,t,r,i){this.popupList.push({element:e,wrapper:t,hideFunc:r,instanceId:O4++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const r=this.getPopupIndex(e);if(-1===r)return;const i=this.popupList[r];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(n=>n&&n()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const s=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=s,i.isAnchored=!0,s}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),r=t.getBoundingClientRect(),{element:i,ePopup:s}=e,n=i.getBoundingClientRect(),o=u=>parseInt(u.substring(0,u.length-1),10),a=(u,h)=>{const g=r[u]-n[u],p=o(s.style[u]);return{initialDiff:g,lastDiff:g,initial:p,last:p,direction:h}},l=a("top",0),c=a("left",1),d=this.getFrameworkOverrides();return new pr(u=>{d.wrapIncoming(()=>{d.setInterval(()=>{const h=t.getBoundingClientRect(),g=i.getBoundingClientRect();if(0==g.top&&0==g.left&&0==g.height&&0==g.width)return void e.hidePopup();const f=(m,w)=>{const C=o(s.style[w]);m.last!==C&&(m.initial=C,m.last=C);const v=h[w]-g[w];if(v!=m.lastDiff){const k=this.keepXYWithinBounds(s,m.initial+m.initialDiff-v,m.direction);s.style[w]=`${k}px`,m.last=k}m.lastDiff=v};f(l,"top"),f(c,"left")},200).then(h=>{u(()=>{null!=h&&window.clearInterval(h)})})},"popupPositioning")})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:r,touchEvent:i}=e,s=r||i;if(!s)return!1;const n=this.getPopupIndex(t);if(-1===n)return!1;for(let o=n;o<this.popupList.length;o++)if(LF(this.popupList[o].element,s))return!0;return this.isElementWithinCustomPopup(s.target)}isElementWithinCustomPopup(e){const t=gt(this.gos);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const r=this.getWrapper(e);r&&(r.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(r))}bringPopupToFront(e){const t=this.getPopupParent(),r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=r.length,s=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),n=s.length,o=this.getWrapper(e);if(!o||i<=1||!t.contains(e))return!1;const a=r.indexOf(o),l=o.querySelectorAll("div"),c=[];l.forEach(u=>{0!==u.scrollTop&&c.push([u,u.scrollTop])});let d=!1;for(n?o.classList.contains("ag-always-on-top")?a!==i-1&&(Le(s).insertAdjacentElement("afterend",o),d=!0):a!==i-n-1&&(s[0].insertAdjacentElement("beforebegin",o),d=!0):a!==i-1&&(Le(r).insertAdjacentElement("afterend",o),d=!0);c.length;){const u=c.pop();u[0].scrollTop=u[1]}return d}},G4=["touchstart","touchend","touchmove","touchcancel"],n0=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t()}setInterval(e,t){return new pr(r=>{r(window.setInterval(e,t))})}addEventListener(e,t,r,i){const s=vs(G4,t);e.addEventListener(t,r,{capture:!!i,passive:s})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`https://www.ag-grid.com/${"solid"===this.frameworkName?"react":this.frameworkName}-data-grid${e?`/${e}`:""}`}},H4=class extends U{constructor(){super(...arguments),this.beanName="cellNavigationService"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.pinnedRowModel=e.pinnedRowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}getNextCellToFocus(e,t,r=!1){return r?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===N.UP,s=e===N.LEFT;let n,o;if(r||e===N.DOWN)o=r?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow(),n=t.column;else{const a=this.visibleColsService.getAllCols(),l=this.gos.get("enableRtl");o=t.rowIndex,n=s!==l?a[0]:Le(a)}return{rowIndex:o,rowPinned:null,column:n}}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,i=!1;for(;!i;){switch(e){case N.UP:r=this.getCellAbove(r);break;case N.DOWN:r=this.getCellBelow(r);break;case N.RIGHT:r=this.gos.get("enableRtl")?this.getCellToLeft(r):this.getCellToRight(r);break;case N.LEFT:r=this.gos.get("enableRtl")?this.getCellToRight(r):this.getCellToLeft(r);break;default:r=null,q("unknown key for navigation ",e)}i=!r||this.isCellGoodToFocusOn(r)}return r}isCellGoodToFocusOn(e){const t=e.column;let r;switch(e.rowPinned){case"top":r=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":r=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:r=this.rowModel.getRow(e.rowIndex)}return!!r&&!t.isSuppressNavigable(r)}getCellToLeft(e){if(!e)return null;const t=this.visibleColsService.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.visibleColsService.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,r=e.rowPinned;let i=!1;if(this.isLastRowInContainer(e))switch(r){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.pageBoundsService.getFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}else r&&(i=!0);const s=this.rowModel.getRow(e.rowIndex);return(i?void 0:this.getNextStickyPosition(s))||{rowIndex:t+1,rowPinned:r}}getNextStickyPosition(e,t){if(!oa(this.gos)||!e||!e.sticky)return;let i=[];i=this.rowRenderer.getStickyTopRowCtrls().some(a=>a.getRowNode().rowIndex===e.rowIndex)?[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,l)=>a.getRowNode().rowIndex-l.getRowNode().rowIndex):[...this.rowRenderer.getStickyBottomRowCtrls()].sort((a,l)=>l.getRowNode().rowIndex-a.getRowNode().rowIndex);const s=t?-1:1,n=i.findIndex(a=>a.getRowNode().rowIndex===e.rowIndex),o=i[n+s];return o?{rowIndex:o.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,r=e.rowIndex;return"top"===t?this.pinnedRowModel.getPinnedTopRowCount()-1<=r:"bottom"===t?this.pinnedRowModel.getPinnedBottomRowCount()-1<=r:this.pageBoundsService.getLastRow()<=r}getRowAbove(e){const t=e.rowIndex,r=e.rowPinned;let s=!1;if(r?0===t:t===this.pageBoundsService.getFirstRow())return"top"===r?null:r&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;r&&(s=!0);const n=this.rowModel.getRow(e.rowIndex);return(s?void 0:this.getNextStickyPosition(n,!0))||{rowIndex:t-1,rowPinned:r}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.pageBoundsService.getLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowCount()-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const t=this.visibleColsService.getAllCols();let r=e.rowIndex,i=e.rowPinned,s=this.visibleColsService.getColAfter(e.column);if(!s){s=t[0];const n=this.getRowBelow(e);if(Ie(n)||!n.rowPinned&&!(this.paginationService?.isRowInPage(n)??1))return null;r=n?n.rowIndex:null,i=n?n.rowPinned:null}return{rowIndex:r,column:s,rowPinned:i}}getNextTabbedCellBackwards(e){const t=this.visibleColsService.getAllCols();let r=e.rowIndex,i=e.rowPinned,s=this.visibleColsService.getColBefore(e.column);if(!s){s=Le(t);const n=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(Ie(n)||!n.rowPinned&&!(this.paginationService?.isRowInPage(n)??1))return null;r=n?n.rowIndex:null,i=n?n.rowPinned:null}return{rowIndex:r,column:s,rowPinned:i}}},Zt=(e,t)=>{for(const r in t)t[r]=e;return t},o0={...Zt("@ag-grid-community/core",{dispatchEvent:0,destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,getState:0,setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0,redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRow:0,getFirstDisplayedRowIndex:0,getLastDisplayedRow:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0,getModel:0,getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0,getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0,addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0,expireValueCache:0,getValue:0,getCellValue:0,showColumnMenuAfterButtonClick:0,showColumnMenuAfterMouseClick:0,showColumnMenu:0,hidePopupMenu:0,onSortChanged:0,getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0,setGridAriaProperty:0,refreshCells:0,flashCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0,addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getColumnDef:0,getColumnDefs:0,sizeColumnsToFit:0,setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumn:0,getDisplayNameForColumnGroup:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnVisible:0,setColumnsVisible:0,setColumnPinned:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0,moveColumn:0,moveColumnByIndex:0,moveColumns:0,setColumnWidth:0,setColumnWidths:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0,autoSizeColumn:0,autoSizeColumns:0,autoSizeAllColumns:0,undoCellEditing:0,redoCellEditing:0,getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0,getCurrentUndoSize:0,getCurrentRedoSize:0,isAnyFilterPresent:0,onFilterChanged:0,isColumnFilterPresent:0,getFilterInstance:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0,paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0,expandAll:0,collapseAll:0,onRowHeightChanged:0,setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...Zt("@ag-grid-community/client-side-row-model",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0}),...Zt("@ag-grid-community/csv-export",{getDataAsCsv:0,exportDataAsCsv:0}),...Zt("@ag-grid-community/infinite-row-model",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...Zt("@ag-grid-enterprise/advanced-filter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...Zt("@ag-grid-enterprise/charts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...Zt("@ag-grid-enterprise/clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...Zt("@ag-grid-enterprise/excel-export",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...Zt("@ag-grid-enterprise/master-detail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...Zt("@ag-grid-enterprise/menu",{showContextMenu:0,showColumnChooser:0,hideColumnChooser:0}),...Zt("@ag-grid-enterprise/range-selection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...Zt("@ag-grid-enterprise/row-grouping",{addAggFunc:0,addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0,isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumn:0,removeValueColumns:0,addValueColumn:0,addValueColumns:0,setRowGroupColumns:0,removeRowGroupColumn:0,removeRowGroupColumns:0,addRowGroupColumn:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0,setPivotColumns:0,removePivotColumn:0,removePivotColumns:0,addPivotColumn:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...Zt("@ag-grid-enterprise/server-side-row-model",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0}),...Zt("@ag-grid-enterprise/side-bar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...Zt("@ag-grid-enterprise/status-bar",{getStatusPanel:0})},Sd={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},z4=(e,t)=>e.eventService.dispatchEvent(t),a0=class{};Reflect.defineProperty(a0,"name",{value:"GridApi"});var V4=class extends U{constructor(){super(),this.beanName="apiFunctionService",this.api=new a0,this.fns={...Sd,dispatchEvent:z4},this.beans=null,this.preDestroyLink="";const{api:e}=this;for(const t in o0)e[t]=this.makeApi(t)[t]}wireBeans(e){this.beans=e}postConstruct(){this.preDestroyLink=this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:r,beans:i}=this;r!==Sd&&(r[e]=i?.validationService?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{const{beans:r,fns:{[e]:i}}=this;return i?i(r,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:r,preDestroyLink:i}=this;if(t){const s=o0[e];r.assertModuleRegistered(s,`api.${e}`)&&q(`API function '${e}' not registered to module '${s}'`)}else q(`Grid API function ${e}() cannot be called as the grid has been destroyed.\nEither clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.\nTo run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${i}`)}destroy(){super.destroy(),this.fns=Sd,this.beans=null}};function W4(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionService").api}}var U4=class extends U{constructor(){super(...arguments),this.beanName="columnDefFactory"}buildColumnDefs(e,t,r){const i=[],s={};return e.forEach(n=>{let a=!0,l=this.createDefFromColumn(n,t,r),c=n.getOriginalParent(),d=null;for(;c;){let u=null;if(c.isPadding()){c=c.getOriginalParent();continue}const h=s[c.getGroupId()];if(h){h.children.push(l),a=!1;break}if(u=this.createDefFromGroup(c),u&&(u.children=[l],s[u.groupId]=u,l=u,c=c.getOriginalParent()),null!=c&&d===c){a=!1;break}d=c}a&&i.push(l)}),i}createDefFromGroup(e){const t=kc(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,r){const i=kc(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?r.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=!e.isVisible()||void 0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,i}},j4=class extends U{constructor(){super(...arguments),this.beanName="columnEventDispatcher"}visibleCols(e){this.eventService.dispatchEvent({type:"displayedColumnsChanged",source:e})}gridColumns(){this.eventService.dispatchEvent({type:"gridColumnsChanged"})}headerHeight(e){this.eventService.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"})}groupHeaderHeight(e){this.eventService.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}groupOpened(e){this.eventService.dispatchEvent({type:"columnGroupOpened",columnGroup:1===e.length?e[0]:void 0,columnGroups:e})}rowGroupChanged(e,t){this.eventService.dispatchEvent({type:"columnRowGroupChanged",columns:e,column:1===e.length?e[0]:null,source:t})}genericColumnEvent(e,t,r){this.eventService.dispatchEvent({type:e,columns:t,column:1===t.length?t[0]:null,source:r})}pivotModeChanged(){this.eventService.dispatchEvent({type:"columnPivotModeChanged"})}virtualColumnsChanged(e){this.eventService.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}newColumnsLoaded(e){this.eventService.dispatchEvent({type:"newColumnsLoaded",source:e})}everythingChanged(e){this.eventService.dispatchEvent({type:"columnEverythingChanged",source:e})}columnMoved(e){const{movedColumns:t,source:r,toIndex:i,finished:s}=e;this.eventService.dispatchEvent({type:"columnMoved",columns:t,column:t&&1===t.length?t[0]:null,toIndex:i,finished:s,source:r})}columnPinned(e,t){if(!e.length)return;const r=1===e.length?e[0]:null,i=this.getCommonValue(e,s=>s.getPinned());this.eventService.dispatchEvent({type:"columnPinned",pinned:i??null,columns:e,column:r,source:t})}columnVisible(e,t){if(!e.length)return;const r=1===e.length?e[0]:null,i=this.getCommonValue(e,s=>s.isVisible());this.eventService.dispatchEvent({type:"columnVisible",visible:i,columns:e,column:r,source:t})}getCommonValue(e,t){if(!e||0==e.length)return;const r=t(e[0]);for(let i=1;i<e.length;i++)if(r!==t(e[i]))return;return r}columnChanged(e,t,r){this.eventService.dispatchEvent({type:e,columns:t,column:t&&1==t.length?t[0]:null,source:r})}columnResized(e,t,r,i=null){e&&e.length&&this.eventService.dispatchEvent({type:"columnResized",columns:e,column:1===e.length?e[0]:null,flexColumns:i,finished:t,source:r})}},$4=class extends U{constructor(){super(...arguments),this.beanName="columnGetStateService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}getColumnState(){if(Ie(this.columnModel.getColDefCols())||!this.columnModel.isAlive())return[];const r=this.columnModel.getAllCols().map(i=>this.createStateItemFromColumn(i));return this.orderColumnStateList(r),r}createStateItemFromColumn(e){const t=this.funcColsService.getRowGroupColumns(),r=this.funcColsService.getPivotColumns(),i=e.isRowGroupActive()?t.indexOf(e):null,s=e.isPivotActive()?r.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,o=null!=e.getSort()?e.getSort():null,a=null!=e.getSortIndex()?e.getSortIndex():null,l=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:o,sortIndex:a,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:i,pivot:e.isPivotActive(),pivotIndex:s,flex:l}}orderColumnStateList(e){const t=this.columnModel.getCols(),r=new Map(t.map((i,s)=>[i.getColId(),s]));e.sort((i,s)=>(r.has(i.colId)?r.get(i.colId):-1)-(r.has(s.colId)?r.get(s.colId):-1))}},K4=class extends U{constructor(){super(...arguments),this.beanName="columnGroupStateService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService}getColumnGroupState(){const e=[];return wi(null,this.columnModel.getColTree(),r=>{Xt(r)&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e}resetColumnGroupState(e){const t=this.columnModel.getColDefColTree();if(!t)return;const r=[];wi(null,t,i=>{if(Xt(i)){const s=i.getColGroupDef(),n={groupId:i.getGroupId(),open:s?s.openByDefault:void 0};r.push(n)}}),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){if(!this.columnModel.getColTree())return;this.columnAnimationService.start();const i=[];e.forEach(s=>{const o=s.open,a=this.columnModel.getProvidedColGroup(s.groupId);a&&a.isExpanded()!==o&&(a.setExpanded(o),i.push(a))}),this.visibleColsService.refresh(t,!0),i.length&&this.eventDispatcher.groupOpened(i),this.columnAnimationService.finish()}},Y4=class extends U{constructor(){super(...arguments),this.beanName="columnViewportService",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,r=!1){const i=this.visibleColsService.isBodyWidthDirty();if(e!==this.scrollWidth||t!==this.scrollPosition||i){if(this.scrollWidth=e,this.scrollPosition=t,this.visibleColsService.setBodyWidthDirty(),this.gos.get("enableRtl")){const n=this.visibleColsService.getBodyContainerWidth();this.viewportLeft=n-this.scrollPosition-this.scrollWidth,this.viewportRight=n-this.scrollPosition}else this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition;this.columnModel.isReady()&&this.checkViewportColumns(r)}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t]}return r||[]}extractViewportColumns(){const e=this.visibleColsService.getCenterCols();this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||0===this.viewportRight}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return!(!e.isAutoHeaderHeight()&&!this.isAnyParentAutoHeaderHeight(e))||this.isColumnInRowViewport(e)}isAnyParentAutoHeaderHeight(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),i=this.viewportLeft-200,s=this.viewportRight+200;return!(t<i&&r<i||t>s&&r>s)}getViewportColumns(){const e=this.visibleColsService.getLeftCols(),t=this.visibleColsService.getRightCols();return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.columnModel.isColSpanActive())return this.colsWithinViewport;const r=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),i=this.visibleColsService.getColsCenter();return this.visibleColsService.getColsForRow(e,i,r,s=>{const n=s.getLeft();return te(n)&&n>this.viewportLeft})}checkViewportColumns(e=!1){this.extractViewport()&&this.eventDispatcher.virtualColumnsChanged(e)}calculateHeaderRows(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={};const e={},t=this.visibleColsService.getLeftCols(),r=this.visibleColsService.getRightCols();this.headerColsWithinViewport.concat(t).concat(r).forEach(n=>e[n.getId()]=!0);const s=(n,o,a)=>{let l=!1;for(let c=0;c<n.length;c++){const d=n[c];let u=!1;if(zi(d))u=!0===e[d.getId()];else{const g=d.getDisplayedChildren();g&&(u=s(g,o,a+1))}u&&(l=!0,o[a]||(o[a]=[]),o[a].push(d))}return l};s(this.visibleColsService.getTreeLeft(),this.rowsOfHeadersToRenderLeft,0),s(this.visibleColsService.getTreeRight(),this.rowsOfHeadersToRenderRight,0),s(this.visibleColsService.getTreeCenter(),this.rowsOfHeadersToRenderCenter,0)}extractViewport(){this.extractViewportColumns();const t=this.getViewportColumns().map(i=>`${i.getId()}-${i.getPinned()||"normal"}`).join("#"),r=this.colsWithinViewportHash!==t;return r&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),r}},q4=class extends U{constructor(){super(...arguments),this.beanName="agComponentUtils"}wireBeans(e){this.componentMetadataProvider=e.componentMetadataProvider}adaptFunction(e,t){const r=this.componentMetadataProvider.retrieve(e);return r&&r.functionAdapter?r.functionAdapter(t):null}adaptCellRendererFunction(e){return class t{refresh(){return!1}getGui(){return this.eGui}init(i){const s=e(i),n=typeof s;this.eGui="string"!==n&&"number"!==n&&"boolean"!==n?null!=s?s:so("<span></span>"):so("<span>"+s+"</span>")}}}doesImplementIComponent(e){return!!e&&e.prototype&&"getGui"in e.prototype}},X4=class extends U{constructor(){super(...arguments),this.beanName="componentMetadataProvider"}wireBeans(e){this.agComponentUtils=e.agComponentUtils}postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},dragAndDropImageComponent:{mandatoryMethodList:["setIcon","setLabel"],optionalMethodList:[]},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}},l0=Object.fromEntries(["rowPositionUtils","cellPositionUtils","headerPositionUtils","paginationAutoPageSizeService","apiFunctionService","gridApi","userComponentRegistry","agComponentUtils","componentMetadataProvider","resizeObserverService","userComponentFactory","rowContainerHeightService","horizontalResizeService","localeService","validationService","pinnedRowModel","dragService","visibleColsService","eventService","gos","popupService","selectionService","columnFilterService","quickFilterService","filterManager","columnModel","headerNavigationService","pageBoundsService","paginationService","pageBoundsListener","rowRenderer","expressionService","columnFactory","alignedGridsService","navigationService","valueCache","valueService","loggerFactory","autoWidthCalculator","filterMenuFactory","dragAndDropService","focusService","mouseEventService","environment","cellNavigationService","stylingService","scrollVisibleService","sortController","columnHoverService","columnAnimationService","selectableService","autoColService","controlsColService","changeDetectionService","animationFrameService","undoRedoService","columnDefFactory","rowCssClassCalculator","rowNodeBlockLoader","rowNodeSorter","ctrlsService","pinnedWidthService","rowNodeEventThrottle","ctrlsFactory","dataTypeService","syncService","overlayService","stateService","expansionService","apiEventService","ariaAnnouncementService","menuService","columnApplyStateService","columnEventDispatcher","columnMoveService","columnAutosizeService","columnGetStateService","columnGroupStateService","columnSizeService","funcColsService","columnNameService","columnViewportService","pivotResultColsService","showRowGroupColsService"].map((e,t)=>[e,t]));function Z4(e,t){return((e.beanName?l0[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER)-((t.beanName?l0[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER)}function J4(e,t){return"gridDestroyService"===e?.beanName?-1:0}var eA=class extends U{constructor(){super(...arguments),this.beanName="ctrlsFactory",this.registry={}}register(e){this.registry[e.name]=e.classImp}getInstance(e,...t){const r=this.registry[e];if(null!=r)return new r(...t)}},tA=class extends U{constructor(){super(...arguments),this.beanName="ctrlsService",this.params={gridCtrl:void 0,gridBodyCtrl:void 0,center:void 0,left:void 0,right:void 0,bottomCenter:void 0,bottomLeft:void 0,bottomRight:void 0,topCenter:void 0,topLeft:void 0,topRight:void 0,stickyTopCenter:void 0,stickyTopLeft:void 0,stickyTopRight:void 0,stickyBottomCenter:void 0,stickyBottomLeft:void 0,stickyBottomRight:void 0,fakeHScrollComp:void 0,fakeVScrollComp:void 0,gridHeaderCtrl:void 0,centerHeader:void 0,leftHeader:void 0,rightHeader:void 0},this.ready=!1,this.readyCallbacks=[],this.runReadyCallbacksAsync=!1}wireBeans(e){this.runReadyCallbacksAsync=e.frameworkOverrides.runWhenReadyAsync?.()??!1}postConstruct(){this.addEventListener("ready",()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach(e=>e(this.params)),this.readyCallbacks.length=0)},this.runReadyCallbacksAsync)}updateReady(){this.ready=Object.values(this.params).every(e=>e?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const r=this.readyCallbacks.indexOf(t);r>=0&&this.readyCallbacks.splice(r,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}},rA=class extends U{constructor(){super(...arguments),this.beanName="cellPositionUtils"}createId(e){const{rowIndex:t,rowPinned:r,column:i}=e;return this.createIdFromValues({rowIndex:t,column:i,rowPinned:r})}createIdFromValues(e){const{rowIndex:t,rowPinned:r,column:i}=e;return`${t}.${r??"null"}.${i.getId()}`}equals(e,t){return e.column===t.column&&e.rowPinned===t.rowPinned&&e.rowIndex===t.rowIndex}},iA=class extends U{constructor(){super(...arguments),this.beanName="rowNodeEventThrottle",this.events=[]}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowModel=e.rowModel}postConstruct(){it(this.gos)&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(e);this.events.push(e);const r=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(i=>this.eventService.dispatchEvent(i)),this.events=[]};t?r():(null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(r)),this.dispatchExpandedDebounced())}},sA=class extends U{constructor(){super(...arguments),this.beanName="rowPositionUtils"}wireBeans(e){this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.pageBoundsService=e.pageBoundsService}getFirstRow(){let t,e=0;return this.pinnedRowModel.getPinnedTopRowCount()?t="top":this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(t="bottom"),void 0===t?null:{rowIndex:e,rowPinned:t}}getLastRow(){let e,t=null;const r=this.pinnedRowModel.getPinnedBottomRowCount(),i=this.pinnedRowModel.getPinnedTopRowCount();return r?(t="bottom",e=r-1):this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getLastRow()):i&&(t="top",e=i-1),void 0===e?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRow(e.rowIndex);case"bottom":return this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t||!(e&&!t||!e&&t)&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}before(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(te(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}},c0={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},d0={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},u0={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},nA=class extends U{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.ancestorThemeClasses=[],this.sizesMeasured=!1,this.gridTheme=null}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.eGridDiv=e.eGridDiv}postConstruct(){this.addManagedPropertyListener("theme",()=>this.handleThemeGridOptionChange()),this.handleThemeGridOptionChange(),this.addDestroyFunc(()=>this.stopUsingTheme()),this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.ancestorThemeClasses=this.readAncestorThemeClasses(),this.setUpThemeClassObservers(),this.getSizeEl(c0),this.getSizeEl(d0),this.getSizeEl(u0)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(c0)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(d0)}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(u0)}hasMeasuredSizes(){return this.sizesMeasured}getGridThemeClass(){return this.gridTheme?.getCssClass()||null}getThemeClasses(){return this.gridTheme?[this.gridTheme.getCssClass()]:this.ancestorThemeClasses}applyThemeClasses(e){const t=this.getThemeClasses();for(const r of Array.from(e.classList))r.startsWith("ag-theme-")&&!t.includes(r)&&e.classList.remove(r);e.classList.add(...t)}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(null==t||isNaN(t)||!isFinite(t))return null!==e&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const r=`${t}px`;return e!=r?(this.eGridDiv.style.setProperty("--ag-line-height",r),t):""!=e?parseFloat(e):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(null!=t)return t;const r=this.measureSizeEl(e);return"detached"===r||"no-styles"===r?e.defaultValue:(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(null==t.offsetParent)return"detached";const r=t.offsetWidth;return r===h0?"no-styles":(this.sizesMeasured=!0,r)}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let r=this.eMeasurementContainer;r||(r=this.eMeasurementContainer=document.createElement("div"),r.className="ag-measurement-container",this.gos.get("theme")&&this.applyThemeClasses(r),this.eGridDiv.appendChild(r)),t=document.createElement("div"),t.style.width=`var(${e.cssName}, ${h0}px)`,r.appendChild(t),this.sizeEls.set(e,t);let i=this.measureSizeEl(e);"no-styles"===i&&q(`no value for ${e.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e.defaultValue} will be used and updated when styles load.`);const s=this.resizeObserverService.observeResize(t,()=>{const n=this.measureSizeEl(e);"detached"===n||"no-styles"===n||(this.lastKnownValues.set(e,n),n!==i&&(i=n,this.fireGridStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>s()),t}fireGridStylesChangedEvent(e){this.eventService.dispatchEvent({type:"gridStylesChanged",[e]:!0})}setUpThemeClassObservers(){const e=new MutationObserver(()=>{const r=this.readAncestorThemeClasses();oA(r,this.ancestorThemeClasses)||(this.ancestorThemeClasses=r,this.fireGridStylesChangedEvent("themeChanged"))});let t=this.eGridDiv;for(;t;)e.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement;this.addDestroyFunc(()=>e.disconnect())}readAncestorThemeClasses(){let e=this.eGridDiv;const t=[];for(;e;){const r=Array.from(e.classList).filter(i=>i.startsWith("ag-theme-"));for(const i of r)t.includes(i)||t.unshift(i);e=e.parentElement}return Object.freeze(t)}handleThemeGridOptionChange(){const{gos:e,eMeasurementContainer:t,gridTheme:r}=this,i=e.get("theme")||null;i!==r&&(r?.stopUse(),this.gridTheme=i,i?.startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),container:this.eGridDiv}),t&&this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged"))}stopUsingTheme(){this.gridTheme?.stopUse(),this.gridTheme=null}},oA=(e,t)=>e.length===t.length&&-1===e.findIndex((r,i)=>e[i]!==t[i]),h0=15538,aA=class extends U{constructor(){super(...arguments),this.beanName="eventService",this.globalEventService=new Ys}wireBeans(e){this.globalEventListener=e.globalEventListener,this.globalSyncEventListener=e.globalSyncEventListener}postConstruct(){if(this.globalEventListener){const e=na(this.gos);this.addGlobalListener(this.globalEventListener,e)}this.globalSyncEventListener&&this.addGlobalListener(this.globalSyncEventListener,!1)}addEventListener(e,t,r){this.globalEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.globalEventService.removeEventListener(e,t,r)}addGlobalListener(e,t=!1){this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(this.gos.addGridCommonParams(e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(this.gos.addGridCommonParams(e))}},yd=class _r extends U{constructor(){super(...arguments),this.beanName="focusService"}wireBeans(t){this.eGridDiv=t.eGridDiv,this.columnModel=t.columnModel,this.visibleColsService=t.visibleColsService,this.headerNavigationService=t.headerNavigationService,this.headerPositionUtils=t.headerPositionUtils,this.rowRenderer=t.rowRenderer,this.rowPositionUtils=t.rowPositionUtils,this.cellPositionUtils=t.cellPositionUtils,this.navigationService=t.navigationService,this.ctrlsService=t.ctrlsService,this.filterManager=t.filterManager,this.rangeService=t.rangeService,this.advancedFilterService=t.advancedFilterService,this.overlayService=t.overlayService}static addKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",_r.toggleKeyboardMode),t.addEventListener("mousedown",_r.toggleKeyboardMode))}static removeKeyboardModeEvents(t){this.instanceCount>0||(t.removeEventListener("keydown",_r.toggleKeyboardMode),t.removeEventListener("mousedown",_r.toggleKeyboardMode))}static toggleKeyboardMode(t){const i="keydown"===t.type;i&&(t.ctrlKey||t.metaKey||t.altKey)||_r.keyboardModeActive!==i&&(_r.keyboardModeActive=i)}postConstruct(){const t=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:t,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:t,columnRowGroupChanged:t}),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(this,r=>{this.gridCtrl=r.gridCtrl})}registerKeyboardFocusEvents(){const t=gt(this.gos);_r.addKeyboardModeEvents(t),_r.instanceCount++,this.addDestroyFunc(()=>{_r.instanceCount--,_r.removeKeyboardModeEvents(t)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const t=this.focusedCellPosition.column,r=this.columnModel.getCol(t.getId());t!==r&&this.clearFocusedCell()}isKeyboardMode(){return _r.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(Je(this.gos),Fs.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(Je(this.gos),Ra.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(t,r){let i=t;for(;i;){if(Yn(this.gos,i,r))return!1;i=i.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(t){return!!this.isCellRestoreFocused(t)&&(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0)}clearRestoreFocus(){this.restoredFocusedCellPosition=null,this.awaitRestoreFocusedCell=!1}restoreFocusedCell(t,r){this.awaitRestoreFocusedCell=!0,setTimeout(()=>{this.awaitRestoreFocusedCell&&(this.setRestoreFocusedCell(t),r())})}isCellRestoreFocused(t){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(t,this.restoredFocusedCellPosition)}setRestoreFocusedCell(t){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=t)}getFocusEventParams(t){const{rowIndex:r,rowPinned:i,column:s}=t,n={rowIndex:r,rowPinned:i,column:s,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:r,rowPinned:i});return o&&(n.isFullWidthCell=o.isFullWidth()),n}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const t=this.getFocusEventParams(this.focusedCellPosition);this.focusedCellPosition=null,this.eventService.dispatchEvent({type:"cellFocusCleared",...t})}setFocusedCell(t){const{column:r,rowIndex:i,rowPinned:s,forceBrowserFocus:n=!1,preventScrollOnBrowserFocus:o=!1}=t,a=this.columnModel.getCol(r);a?(this.focusedCellPosition={rowIndex:i,rowPinned:fi(s),column:a},this.eventService.dispatchEvent({type:"cellFocused",...this.getFocusEventParams(this.focusedCellPosition),forceBrowserFocus:n,preventScrollOnBrowserFocus:o})):this.focusedCellPosition=null}isCellFocused(t){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(t,this.focusedCellPosition)}isRowNodeFocused(t){return this.isRowFocused(t.rowIndex,t.rowPinned)}isHeaderWrapperFocused(t){if(null==this.focusedHeaderPosition)return!1;const r=t.getColumnGroupChild(),i=t.getRowIndex(),s=t.getPinned(),{column:n,headerRowIndex:o}=this.focusedHeaderPosition;return r===n&&i===o&&s==n.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(t,r){this.focusedHeaderPosition={headerRowIndex:t,column:r}}isHeaderFocusSuppressed(){return this.gos.get("suppressHeaderFocus")||this.overlayService.isExclusive()}isCellFocusSuppressed(){return this.gos.get("suppressCellFocus")||this.overlayService.isExclusive()}focusHeaderPosition(t){if(this.isHeaderFocusSuppressed())return!1;const{direction:r,fromTab:i,allowUserOverride:s,event:n,fromCell:o,rowWithoutSpanValue:a}=t;let{headerPosition:l}=t;if(o&&this.filterManager?.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(l);if(s){const c=this.getFocusedHeader(),d=this.headerNavigationService.getHeaderRowCount();if(i){const u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:r,currentPosition:c,headerPosition:l,headerRowCount:d}))}else{const u=this.gos.getCallback("navigateToNextHeader");u&&n&&(l=u({key:n.key,previousHeaderPosition:c,nextHeaderPosition:l,headerRowCount:d,event:n}))}}return!!l&&this.focusProvidedHeaderPosition({headerPosition:l,direction:r,event:n,fromCell:o,rowWithoutSpanValue:a})}focusHeaderPositionFromUserFunc(t){if(this.isHeaderFocusSuppressed())return!1;const{userFunc:r,headerPosition:i,direction:s,event:n}=t,o=this.getFocusedHeader(),a=this.headerNavigationService.getHeaderRowCount(),l=this.getHeaderPositionFromUserFunc({userFunc:r,direction:s,currentPosition:o,headerPosition:i,headerRowCount:a});return!!l&&this.focusProvidedHeaderPosition({headerPosition:l,direction:s,event:n})}getHeaderPositionFromUserFunc(t){const{userFunc:r,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o}=t,l=r({backwards:"Before"===i,previousHeaderPosition:s,nextHeaderPosition:n,headerRowCount:o});return!0===l||null===l?(null===l&&q("Since v31.3 Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),s):!1===l?null:l}focusProvidedHeaderPosition(t){const{headerPosition:r,direction:i,fromCell:s,rowWithoutSpanValue:n,event:o}=t,{column:a,headerRowIndex:l}=r;if(-1===l)return this.filterManager?.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(r):this.focusGridView(a);this.headerNavigationService.scrollToColumn(a,i);const d=this.ctrlsService.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(r.headerRowIndex,a,o)||!1;return d&&(null!=n||s)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(n??-1),d}focusFirstHeader(){if(this.overlayService.isExclusive()&&this.focusOverlay())return!0;let t=this.visibleColsService.getAllCols()[0];if(!t)return!1;t.getParent()&&(t=this.visibleColsService.getColGroupAtLevel(t,0));const r=this.headerPositionUtils.getHeaderIndexToFocus(t,0);return this.focusHeaderPosition({headerPosition:r,rowWithoutSpanValue:0})}focusLastHeader(t){if(this.overlayService.isExclusive()&&this.focusOverlay(!0))return!0;const r=this.headerNavigationService.getHeaderRowCount()-1,i=Le(this.visibleColsService.getAllCols());return this.focusHeaderPosition({headerPosition:{headerRowIndex:r,column:i},rowWithoutSpanValue:-1,event:t})}focusPreviousFromFirstCell(t){return this.filterManager?.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(t)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(t,r){return null!=this.focusedCellPosition&&this.focusedCellPosition.rowIndex===t&&this.focusedCellPosition.rowPinned===fi(r)}findFocusableElements(t,r,i=!1){let n=jf;r&&(n+=", "+r),i&&(n+=', [tabindex="-1"]');const o=Array.prototype.slice.apply(t.querySelectorAll("[tabindex], input, select, button, textarea, [href]")).filter(c=>zr(c)),a=Array.prototype.slice.apply(t.querySelectorAll(n));return a.length?(d=a,o.filter(u=>-1===d.indexOf(u))):o;var d}focusInto(t,r=!1,i=!1){const s=this.findFocusableElements(t,null,i),n=r?Le(s):s[0];return!!n&&(n.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(t,r){if(!r)return null;const i=this.findFocusableElements(t),s=i.indexOf(r);if(-1===s)return null;let n=-1;for(let o=s-1;o>=0;o--)if(i[o].classList.contains("ag-tab-guard-top")){n=o;break}return n<=0?null:i[n-1]}findNextFocusableElement(t=this.eGridDiv,r,i){const s=this.findFocusableElements(t,r?':not([tabindex="-1"])':null),n=Je(this.gos);let o;o=r?s.findIndex(l=>l.contains(n)):s.indexOf(n);const a=o+(i?-1:1);return a<0||a>=s.length?null:s[a]}isTargetUnderManagedComponent(t,r){if(!r)return!1;const i=t.querySelectorAll(`.${ys.FOCUS_MANAGED_CLASS}`);if(!i.length)return!1;for(let s=0;s<i.length;s++)if(i[s].contains(r))return!0;return!1}findTabbableParent(t,r=5){let i=0;for(;t&&null===jc(t)&&++i<=r;)t=t.parentElement;return null===jc(t)?null:t}focusOverlay(t){const r=this.overlayService.isVisible()&&this.overlayService.getOverlayWrapper()?.getGui();return!!r&&this.focusInto(r,t)}focusGridViewFailed(t,r){return r&&this.focusOverlay(t)||t&&this.focusLastHeader()}focusGridView(t,r=!1,i=!0){if(this.overlayService.isExclusive())return i&&this.focusOverlay(r);if(this.isCellFocusSuppressed())return r&&!this.isHeaderFocusSuppressed()?this.focusLastHeader():!(!i||!this.focusOverlay(r))||this.focusNextGridCoreContainer(!1);const s=r?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(s){const{rowIndex:n,rowPinned:o}=s;if(t??(t=this.getFocusedHeader()?.column),t&&null!=n)return this.navigationService.ensureCellVisible({rowIndex:n,column:t,rowPinned:o}),r&&this.rowRenderer.getRowByPosition(s)?.isFullWidth()&&this.navigationService.tryToFocusFullWidthRow(s,r)||(this.setFocusedCell({rowIndex:n,column:t,rowPinned:fi(o),forceBrowserFocus:!0}),this.rangeService?.setRangeToCell({rowIndex:n,rowPinned:o,column:t})),!0}return!!(i&&this.focusOverlay(r)||r&&this.focusLastHeader())}isGridFocused(){const t=Je(this.gos);return!!t&&this.eGridDiv.contains(t)}focusNextGridCoreContainer(t,r=!1){return!(r||!this.gridCtrl.focusNextInnerContainer(t))||((r||!t&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(t),!1)}focusAdvancedFilter(t){return this.advancedFilterFocusColumn=t?.column,this.advancedFilterService?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(t,r){const i=(r?void 0:this.advancedFilterFocusColumn)??this.visibleColsService.getAllCols()?.[0];return t?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(i)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}addFocusableContainer(t){this.gridCtrl.addFocusableContainer(t)}removeFocusableContainer(t){this.gridCtrl.removeFocusableContainer(t)}focusGridInnerElement(t){return this.gridCtrl.focusInnerElement(t)}allowFocusForNextGridCoreContainer(t){this.gridCtrl.allowFocusForNextCoreContainer(t)}};yd.keyboardModeActive=!1,yd.instanceCount=0;var lA=yd,cA=class extends U{constructor(){super(...arguments),this.beanName="pinnedWidthService"}wireBeans(e){this.visibleColsService=e.visibleColsService}postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=Pt(this.gos,"print"),t=e?0:this.visibleColsService.getColsLeftWidth(),r=e?0:this.visibleColsService.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:"leftPinnedWidthChanged"})),r!=this.rightWidth&&(this.rightWidth=r,this.eventService.dispatchEvent({type:"rightPinnedWidthChanged"}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}},dA=class extends U{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}wireBeans(e){this.beans=e,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDropService:i,mouseEventService:s,ctrlsService:n,resizeObserverService:o}=this.beans,a={getContainer:()=>this.eGui,isInterestedIn:c=>1===c||0===c,getIconName:()=>"notAllowed"};i.addDropTarget(a),this.addDestroyFunc(()=>i.removeDropTarget(a)),s.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new Cd(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr"),this.updateGridThemeClass(),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)});const l=o.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>l()),n.register("gridCtrl",this)}isDetailGrid(){return this.focusService.findTabbableParent(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.paginationService?.getPaginationSelector(),gridHeaderDropZonesSelector:e.columnDropZonesService?.getDropZoneSelector(),sideBarSelector:e.sideBarService?.getSideBarSelector(),statusBarSelector:e.statusBarService?.getStatusPanelSelector(),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventService.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:r,nextIndex:i}=this.getNextFocusableIndex(t,e);if(i<0||i>=t.length)return!1;if(0===i){if(r>0){const n=Le(this.visibleColsService.getAllCols());if(this.focusService.focusGridView(n,!0))return!0}return!1}return this.focusContainer(t[i],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const r=this.getFocusableContainers(),i=this.visibleColsService.getAllCols();if(e){if(r.length>1)return this.focusContainer(Le(r),!0);const s=Le(i);if(this.focusService.focusGridView(s,!0))return!0}if(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()){if(this.focusService.focusGridView(i[0]))return!0;for(let s=1;s<r.length;s++)if(this.focusService.focusInto(r[s].getGui()))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:r,indexWithFocus:i}=this.getNextFocusableIndex(t,e);if(-1===i||r<0||r>=t.length)return;const s=t[r];s.setAllowFocus?.(!0),setTimeout(()=>{s.setAllowFocus?.(!1)})}getNextFocusableIndex(e,t){const r=Je(this.gos),i=e.findIndex(n=>n.getGui().contains(r));return{indexWithFocus:i,nextIndex:i+(t?-1:1)}}focusContainer(e,t){e.setAllowFocus?.(!0);const r=this.focusService.focusInto(e.getGui(),t);return e.setAllowFocus?.(!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}updateGridThemeClass(){const e=this.beans.environment.getGridThemeClass();e&&this.view.setGridThemeClass(e)}handleThemeChange(e){e.themeChanged&&this.updateGridThemeClass()}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},g0=class extends s0{constructor(e){super(),this.gridBody=de,this.sideBar=de,this.pagination=de,this.rootWrapperBody=de,this.eGridDiv=e}postConstruct(){const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:n=>this.addCssClass(n),setGridThemeClass:n=>this.addCssClass(n),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:n=>{this.getGui().style.userSelect=n??"",this.getGui().style.webkitUserSelect=n??""},setCursor:n=>{this.getGui().style.cursor=n??""}},t=this.createManagedBean(new dA),r=t.getOptionalSelectors(),i=this.createTemplate(r),s=[kD,...Object.values(r).filter(n=>!!n)];this.setTemplate(i,s),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:n=>t.focusInnerElement(n),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),this.gos.get("debug")&&Rr("Grid removed from DOM")})}updateLayoutClasses(e,t){const r=this.rootWrapperBody.classList;r.toggle("ag-layout-auto-height",t.autoHeight),r.toggle("ag-layout-normal",t.normal),r.toggle("ag-layout-print",t.print),this.addOrRemoveCssClass("ag-layout-auto-height",t.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",t.normal),this.addOrRemoveCssClass("ag-layout-print",t.print)}createTemplate(e){return`<div class="ag-root-wrapper" role="presentation">\n                ${e.gridHeaderDropZonesSelector?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":""}\n                <div class="ag-root-wrapper-body" data-ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body data-ref="gridBody"></ag-grid-body>\n                    ${e.sideBarSelector?'<ag-side-bar data-ref="sideBar"></ag-side-bar>':""}\n                </div>\n                ${e.statusBarSelector?"<ag-status-bar></ag-status-bar>":""}\n                ${e.paginationSelector?'<ag-pagination data-ref="pagination"></ag-pagination>':""}\n                ${e.watermarkSelector?"<ag-watermark></ag-watermark>":""}\n            </div>`}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){e||!this.pagination?.isDisplayed()?super.forceFocusOutOfContainer(e):this.pagination.forceFocusOutOfContainer(e)}getFocusableContainers(){const e=[this.gridBody];return[this.sideBar,this.pagination].forEach(t=>{t&&e.push(t)}),e.filter(t=>zr(t.getGui()))}},hA={version:xe,moduleName:"@ag-grid-community/aligned-grid",beans:[class extends U{constructor(){super(...arguments),this.beanName="alignedGridsService",this.consuming=!1}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.ctrlsService=e.ctrlsService,this.columnApplyStateService=e.columnApplyStateService}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t="function"==typeof e;"function"==typeof e&&(e=e());const r=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return e.map(s=>{if(!s)return Me("alignedGrids contains an undefined option."),t||Me('You may want to configure via a callback to avoid setup race conditions:\n                     "alignedGrids: () => [linkedGrid]"'),void Me(r());if(this.isGridApi(s))return s;const n=s;return"current"in n?n.current?.api:(n.api||Me(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${r()}`),n.api)}).filter(s=>!!s&&!s.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{t.isDestroyed()||t.dispatchEvent(e)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){"horizontal"===e.direction&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const r=[];return e.columns?e.columns.forEach(i=>{r.push(t(i))}):e.column&&r.push(t(e.column)),r}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":this.processColumnEvent(e);break;case"columnGroupOpened":this.processGroupOpenedEvent(e);break;case"columnPivotChanged":q("pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})}processGroupOpenedEvent(e){const{columnModel:t}=this;e.columnGroups.forEach(r=>{let i=null;r&&(i=t.getProvidedColGroup(r.getGroupId())),(!r||i)&&t.setColumnGroupOpened(i,r.isExpanded(),"alignedGridChanged")})}processColumnEvent(e){const t=e.column;let r=null;if(t&&(r=this.columnModel.getColDefCol(t.getColId())),t&&!r)return;const i=this.getMasterColumns(e),{columnApplyStateService:s,columnSizeService:n,ctrlsService:o}=this;switch(e.type){case"columnMoved":{const d=e.api.getColumnState().map(u=>({colId:u.colId}));s.applyColumnState({state:d,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const d=e.api.getColumnState().map(u=>({colId:u.colId,hide:u.hide}));s.applyColumnState({state:d},"alignedGridChanged")}break;case"columnPinned":{const d=e.api.getColumnState().map(u=>({colId:u.colId,pinned:u.pinned}));s.applyColumnState({state:d},"alignedGridChanged")}break;case"columnResized":{const c=e,d={};i.forEach(u=>{d[u.getId()]={key:u.getColId(),newWidth:u.getActualWidth()}}),c.flexColumns?.forEach(u=>{d[u.getId()]&&delete d[u.getId()]}),n.setColumnWidths(Object.values(d),!1,c.finished,"alignedGridChanged");break}}const l=o.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(c=>{c.setGridOption("alwaysShowVerticalScroll",l)})}}]},iP={version:xe,moduleName:"@ag-grid-community/data-type",beans:[class extends U{constructor(){super(...arguments),this.beanName="dataTypeService",this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.columnApplyStateService=e.columnApplyStateService,this.filterManager=e.filterManager}postConstruct(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(Cs(e.source))})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes();this.dataTypeDefinitions={},this.formatValueFuncs={};const t=i=>s=>{const{column:n,node:o,value:a}=s;let l=n.getColDef().valueFormatter;return l===i.groupSafeValueFormatter&&(l=i.valueFormatter),this.valueService.formatValue(n,o,a,l)};Object.entries(e).forEach(([i,s])=>{const n={...s,groupSafeValueFormatter:this.createGroupSafeValueFormatter(s)};this.dataTypeDefinitions[i]=n,this.formatValueFuncs[i]=t(n)});const r=this.gos.get("dataTypeDefinitions")??{};this.dataTypeMatchers={},Object.entries(r).forEach(([i,s])=>{const n=this.processDataTypeDefinition(s,r,[i],e);n&&(this.dataTypeDefinitions[i]=n,s.dataTypeMatcher&&(this.dataTypeMatchers[i]=s.dataTypeMatcher),this.formatValueFuncs[i]=t(n))}),this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach(i=>{const s=this.dataTypeMatchers[i];s&&delete this.dataTypeMatchers[i],this.dataTypeMatchers[i]=s??e[i].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...ha(e.columnTypes),...ha(t.columnTypes)]),r}processDataTypeDefinition(e,t,r,i){let s;const n=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=i[n];const a=t[n];if(o&&a&&(o=a),!this.validateDataTypeDefinition(e,o,n))return;s=this.mergeDataTypeDefinitions(o,e)}else{if(r.includes(n))return void q('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');const o=t[n];if(!this.validateDataTypeDefinition(e,o,n))return;const a=this.processDataTypeDefinition(o,t,[...r,n],i);if(!a)return;s=this.mergeDataTypeDefinitions(a,e)}return{...s,groupSafeValueFormatter:this.createGroupSafeValueFormatter(s)}}validateDataTypeDefinition(e,t,r){return t?t.baseDataType===e.baseDataType||(q('The "baseDataType" property of a data type definition must match that of its parent.'),!1):(q(`The data type definition ${r} does not exist.`),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{if(t.node?.group){const r=(t.colDef.pivotValueColumn??t.column).getAggFunc();if(r){if("first"===r||"last"===r)return e.valueFormatter(t);if("number"===e.baseDataType&&"count"!==r){if("number"==typeof t.value)return e.valueFormatter(t);if("object"==typeof t.value){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter({...t,value:t.value.toNumber()});if("value"in t.value)return e.valueFormatter({...t,value:t.value.value})}}return}if((this.gos.get("suppressGroupMaintainValueType")||"groupRows"===this.gos.get("groupDisplayType"))&&!this.gos.get("treeData"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()&&"string"==typeof t.value&&!e.dataTypeMatcher?.(t.value))return;return e.valueFormatter(t)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:i}=t;const{field:s}=t;if(void 0===i&&(i=e.cellDataType),(null==i||!0===i)&&(i=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(s,r)),!i)return void(e.cellDataType=!1);const n=this.dataTypeDefinitions[i];if(n)return e.cellDataType=i,n.groupSafeValueFormatter&&(e.valueFormatter=n.groupSafeValueFormatter),n.valueParser&&(e.valueParser=n.valueParser),n.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,i,n,r),n.columnTypes;q(`Missing data type definition - "${i}"`)}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=i=>{t.add(i.key)};e.addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener("columnStateUpdated",r))}canInferCellDataType(e,t){if(!it(this.gos))return!1;const r={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,r))return!1;const i=null===t.type?e.type:t.type;if(i){const s=this.gos.get("columnTypes")??{};if(ha(i).some(o=>{const a=s[o.trim()];return a&&this.doColDefPropsPreventInference(a,r)}))return!1}return!this.doColDefPropsPreventInference(e,r)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([r,i])=>this.doesColDefPropPreventInference(e,t,r,i))}doesColDefPropPreventInference(e,t,r,i){if(!t[r])return!1;const s=e[r];return null===s?(t[r]=!1,!1):void 0===i?!!s:s===i}inferCellDataType(e,t){if(!e)return;let r;const i=this.getInitialData();if(i){const n=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");r=Qn(i,e,n)}else this.initWaitForRowData(t);if(null==r)return;const[s]=Object.entries(this.dataTypeMatchers).find(([n,o])=>o(r))??["object"];return s}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const t=this.rowModel.getRootNode().allLeafChildren;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const[r]=this.addManagedEventListeners({rowDataUpdateStarted:i=>{const{firstRowData:s}=i;s&&(r?.(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(s,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations(),this.eventService.dispatchEvent({type:"dataTypesInferred"}))}})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const i={},s={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([n,o])=>{const a=this.columnModel.getCol(n);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const d=this.getUpdatedColumnState(a,o);d.rowGroup&&null==d.rowGroupIndex&&(i[n]=d),d.pivot&&null==d.pivotIndex&&(s[n]=d),r.push(d)}}),t&&r.push(...this.funcColsService.generateColumnStateForRowGroupAndPivotIndexes(i,s)),r.length&&this.columnApplyStateService.applyColumnState({state:r},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const r=this.columnApplyStateService.getColumnStateFromColDef(e);return t.forEach(i=>{delete r[i],"rowGroup"===i?delete r.rowGroupIndex:"pivot"===i&&delete r.pivotIndex}),r}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,r=e.object;this.hasObjectValueParser=t.valueParser!==r.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==r.valueFormatter}getDateStringTypeDefinition(e){return e?this.getDataTypeDefinition(e)??this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(null==t)return!0;const r=this.getDataTypeDefinition(e)?.dataTypeMatcher;return!r||r(t)}validateColDef(e){const t=r=>q(`Cell data type is "object" but no Value ${r} has been provided. Please either provide an object data type definition with a Value ${r}, or set "colDef.value${r}"`);"object"===e.cellDataType&&(e.valueFormatter===this.dataTypeDefinitions.object.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&t("Parser"))}getFormatValue(e){return this.formatValueFuncs[e]}setColDefPropertiesForBaseDataType(e,t,r,i){const s=this.formatValueFuncs[t];switch(r.baseDataType){case"number":e.cellEditor="agNumberCellEditor";break;case"boolean":e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=n=>!!n.colDef.editable&&n.event.key===N.SPACE;break;case"date":e.cellEditor="agDateCellEditor",e.keyCreator=s;break;case"dateString":e.cellEditor="agDateStringCellEditor",e.keyCreator=s;break;case"object":e.cellEditorParams={useFormatter:!0},e.comparator=(n,o)=>{const a=this.columnModel.getColDefCol(i),l=a?.getColDef();if(!a||!l)return 0;const c=null==n?"":s({column:a,node:null,value:n}),d=null==o?"":s({column:a,node:null,value:o});return c===d?0:c>d?1:-1},e.keyCreator=s}this.filterManager?.setColDefPropertiesForDataType(e,r,s)}getDefaultDataTypes(){const e=r=>!!r.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:r=>""===r.newValue?.trim?.()?null:Number(r.newValue),valueFormatter:r=>null==r.value?"":"number"!=typeof r.value||isNaN(r.value)?t("invalidNumber","Invalid Number"):String(r.value),dataTypeMatcher:r=>"number"==typeof r},text:{baseDataType:"text",valueParser:r=>""===r.newValue?null:uc(r.newValue),dataTypeMatcher:r=>"string"==typeof r},boolean:{baseDataType:"boolean",valueParser:r=>null==r.newValue?r.newValue:""===r.newValue?.trim?.()?null:"true"===String(r.newValue).toLowerCase(),valueFormatter:r=>null==r.value?"":String(r.value),dataTypeMatcher:r=>"boolean"==typeof r},date:{baseDataType:"date",valueParser:r=>sr(null==r.newValue?null:String(r.newValue)),valueFormatter:r=>null==r.value?"":r.value instanceof Date&&!isNaN(r.value.getTime())?Mr(r.value,!1)??"":t("invalidDate","Invalid Date"),dataTypeMatcher:r=>r instanceof Date},dateString:{baseDataType:"dateString",dateParser:r=>sr(r)??void 0,dateFormatter:r=>Mr(r??null,!1)??void 0,valueParser:r=>e(String(r.newValue))?r.newValue:null,valueFormatter:r=>e(String(r.value))?r.value:"",dataTypeMatcher:r=>"string"==typeof r&&e(r)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:r=>uc(r.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}}]};function f0(e,t){const{colKey:r,rowNode:i,useFormatter:s}=t,n=e.columnModel.getColDefCol(r)??e.columnModel.getCol(r);if(Ie(n))return null;const o=e.valueService.getValueForDisplay(n,i);return s?e.valueService.formatValue(n,i,o)??ti(o,!0):o}function p0(e,t){e.gos.updateGridOptions({options:t})}function m0(e){return e.rowRenderer.getFirstVirtualRenderedRow()}function v0(e){return e.rowRenderer.getLastVirtualRenderedRow()}var EM={version:xe,moduleName:"@ag-grid-community/api",dependantModules:[{version:xe,moduleName:"@ag-grid-community/core-api",apiFunctions:{getGridId:function DP(e){return e.context.getGridId()},destroy:function AP(e){e.gridDestroyService.destroy()},isDestroyed:function PP(e){return e.gridDestroyService.isDestroyCalled()},getGridOption:function MP(e,t){return e.gos.get(t)},setGridOption:function IP(e,t,r){p0(e,{[t]:r})},updateGridOptions:p0}},{version:xe,moduleName:"@ag-grid-community/pinned-row-api",apiFunctions:{getPinnedTopRowCount:function cP(e){return e.pinnedRowModel.getPinnedTopRowCount()},getPinnedBottomRowCount:function dP(e){return e.pinnedRowModel.getPinnedBottomRowCount()},getPinnedTopRow:function uP(e,t){return e.pinnedRowModel.getPinnedTopRow(t)},getPinnedBottomRow:function hP(e,t){return e.pinnedRowModel.getPinnedBottomRow(t)}}},{version:xe,moduleName:"@ag-grid-community/row-selection-api",apiFunctions:{setNodesSelected:function nM(e,t){if(!t.nodes.every(a=>a.rowPinned?(q("cannot select pinned rows"),!1):void 0!==a.id||(q("cannot select node until id for node is known"),!1)))return;const{nodes:i,source:s,newValue:n}=t;e.selectionService.setNodesSelected({nodes:i,source:s??"api",newValue:n})},selectAll:function oM(e,t="apiSelectAll"){e.selectionService.selectAllRowNodes({source:t})},deselectAll:function aM(e,t="apiSelectAll"){e.selectionService.deselectAllRowNodes({source:t})},selectAllFiltered:function lM(e,t="apiSelectAllFiltered"){e.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},deselectAllFiltered:function cM(e,t="apiSelectAllFiltered"){e.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},selectAllOnCurrentPage:function dM(e,t="apiSelectAllCurrentPage"){e.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},deselectAllOnCurrentPage:function uM(e,t="apiSelectAllCurrentPage"){e.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},getSelectedNodes:function hM(e){return e.selectionService.getSelectedNodes()},getSelectedRows:function gM(e){return e.selectionService.getSelectedRows()}}},{version:xe,moduleName:"@ag-grid-community/column-api",apiFunctions:{getColumnDef:function gA(e,t){const r=e.columnModel.getColDefCol(t);return r?r.getColDef():null},getColumnDefs:function fA(e){return e.columnModel.getColumnDefs()},sizeColumnsToFit:function pA(e,t){"number"==typeof t?e.columnSizeService.sizeColumnsToFit(t,"api"):e.ctrlsService.getGridBodyCtrl().sizeColumnsToFit(t)},setColumnGroupOpened:function mA(e,t,r){e.columnModel.setColumnGroupOpened(t,r,"api")},getColumnGroup:function vA(e,t,r){return e.visibleColsService.getColumnGroup(t,r)},getProvidedColumnGroup:function CA(e,t){return e.columnModel.getProvidedColGroup(t)},getDisplayNameForColumn:function wA(e,t,r){return e.columnNameService.getDisplayNameForColumn(t,r)||""},getDisplayNameForColumnGroup:function xA(e,t,r){return e.columnNameService.getDisplayNameForColumnGroup(t,r)||""},getColumn:function SA(e,t){return e.columnModel.getColDefCol(t)},getColumns:function yA(e){return e.columnModel.getColDefCols()},applyColumnState:function bA(e,t){return e.columnApplyStateService.applyColumnState(t,"api")},getColumnState:function EA(e){return e.columnGetStateService.getColumnState()},resetColumnState:function FA(e){e.columnApplyStateService.resetColumnState("api")},getColumnGroupState:function RA(e){return e.columnGroupStateService.getColumnGroupState()},setColumnGroupState:function kA(e,t){e.columnGroupStateService.setColumnGroupState(t,"api")},resetColumnGroupState:function TA(e){e.columnGroupStateService.resetColumnGroupState("api")},isPinning:function DA(e){return e.visibleColsService.isPinningLeft()||e.visibleColsService.isPinningRight()},isPinningLeft:function AA(e){return e.visibleColsService.isPinningLeft()},isPinningRight:function PA(e){return e.visibleColsService.isPinningRight()},getDisplayedColAfter:function MA(e,t){return e.visibleColsService.getColAfter(t)},getDisplayedColBefore:function IA(e,t){return e.visibleColsService.getColBefore(t)},setColumnVisible:function LA(e,t,r){e.columnModel.setColsVisible([t],r,"api")},setColumnsVisible:function _A(e,t,r){e.columnModel.setColsVisible(t,r,"api")},setColumnPinned:function OA(e,t,r){e.columnModel.setColsPinned([t],r,"api")},setColumnsPinned:function BA(e,t,r){e.columnModel.setColsPinned(t,r,"api")},getAllGridColumns:function NA(e){return e.columnModel.getCols()},getDisplayedLeftColumns:function GA(e){return e.visibleColsService.getLeftCols()},getDisplayedCenterColumns:function HA(e){return e.visibleColsService.getCenterCols()},getDisplayedRightColumns:function zA(e){return e.visibleColsService.getRightCols()},getAllDisplayedColumns:function VA(e){return e.visibleColsService.getAllCols()},getAllDisplayedVirtualColumns:function WA(e){return e.columnViewportService.getViewportColumns()},moveColumn:function UA(e,t,r){e.columnMoveService.moveColumns([t],r,"api")},moveColumnByIndex:function jA(e,t,r){e.columnMoveService.moveColumnByIndex(t,r,"api")},moveColumns:function $A(e,t,r){e.columnMoveService.moveColumns(t,r,"api")},setColumnWidth:function KA(e,t,r,i=!0,s="api"){e.columnSizeService.setColumnWidths([{key:t,newWidth:r}],!1,i,s)},setColumnWidths:function YA(e,t,r=!0,i="api"){e.columnSizeService.setColumnWidths(t,!1,r,i)},getLeftDisplayedColumnGroups:function qA(e){return e.visibleColsService.getTreeLeft()},getCenterDisplayedColumnGroups:function XA(e){return e.visibleColsService.getTreeCenter()},getRightDisplayedColumnGroups:function QA(e){return e.visibleColsService.getTreeRight()},getAllDisplayedColumnGroups:function ZA(e){return e.visibleColsService.getAllTrees()},autoSizeColumn:function JA(e,t,r){return e.columnAutosizeService.autoSizeCols({colKeys:[t],skipHeader:r,source:"api"})},autoSizeColumns:function eP(e,t,r){e.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:r,source:"api"})},autoSizeAllColumns:function tP(e,t){e.columnAutosizeService.autoSizeAllColumns("api",t)}}},{version:xe,moduleName:"@ag-grid-community/row-api",apiFunctions:{redrawRows:function YP(e,t={}){const r=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(r))},setRowNodeExpanded:function qP(e,t,r,i,s){e.expansionService.setRowNodeExpanded(t,r,i,s)},getRowNode:function XP(e,t){return e.rowModel.getRowNode(t)},addRenderedRowListener:function QP(e,t,r,i){e.rowRenderer.addRenderedRowListener(t,r,i)},getRenderedNodes:function ZP(e){return e.rowRenderer.getRenderedNodes()},forEachNode:function JP(e,t,r){e.rowModel.forEachNode(t,r)},getFirstDisplayedRow:function eM(e){return m0(e)},getFirstDisplayedRowIndex:m0,getLastDisplayedRow:function tM(e){return v0(e)},getLastDisplayedRowIndex:v0,getDisplayedRowAtIndex:function rM(e,t){return e.rowModel.getRow(t)},getDisplayedRowCount:function iM(e){return e.rowModel.getRowCount()},getModel:function sM(e){return e.rowModel}}},{version:xe,moduleName:"@ag-grid-community/drag-api",apiFunctions:{addRowDropZone:function nP(e,t){e.ctrlsService.getGridBodyCtrl().getRowDragFeature().addRowDropZone(t)},removeRowDropZone:function oP(e,t){const r=e.dragAndDropService.findExternalZone(t);r&&e.dragAndDropService.removeDropTarget(r)},getRowDropZoneParams:function aP(e,t){return e.ctrlsService.getGridBodyCtrl().getRowDragFeature().getRowDropZone(t)}}},{version:xe,moduleName:"@ag-grid-community/scroll-api",apiFunctions:{getVerticalPixelRange:function e4(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition()},getHorizontalPixelRange:function t4(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getHScrollPosition()},ensureColumnVisible:e0,ensureIndexVisible:t0,ensureNodeVisible:function r4(e,t,r=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureNodeVisible(t,r),"ensureVisible")}}},{version:xe,moduleName:"@ag-grid-community/overlay-api",apiFunctions:{showLoadingOverlay:function fP(e){e.overlayService.showLoadingOverlay()},showNoRowsOverlay:function pP(e){e.overlayService.showNoRowsOverlay()},hideOverlay:function mP(e){e.overlayService.hideOverlay()}}},{version:xe,moduleName:"@ag-grid-community/keyboard-navigation-api",apiFunctions:{getFocusedCell:function NP(e){return e.focusService.getFocusedCell()},clearFocusedCell:function GP(e){return e.focusService.clearFocusedCell()},setFocusedCell:function HP(e,t,r,i){e.focusService.setFocusedCell({rowIndex:t,column:r,rowPinned:i,forceBrowserFocus:!0})},setFocusedHeader:function WP(e,t,r=!1){const i=e.headerNavigationService.getHeaderPositionForColumn(t,r);i&&e.focusService.focusHeaderPosition({headerPosition:i})},tabToNextCell:function zP(e,t){return e.navigationService.tabToNextCell(!1,t)},tabToPreviousCell:function VP(e,t){return e.navigationService.tabToNextCell(!0,t)}}},{version:xe,moduleName:"@ag-grid-community/event-api",apiFunctions:{addEventListener:function LP(e,t,r){e.apiEventService.addEventListener(t,r)},addGlobalListener:function OP(e,t){e.apiEventService.addGlobalListener(t)},removeEventListener:function _P(e,t,r){e.apiEventService.removeEventListener(t,r)},removeGlobalListener:function BP(e,t){e.apiEventService.removeGlobalListener(t)}}},{version:xe,moduleName:"@ag-grid-community/render-api",apiFunctions:{setGridAriaProperty:function CP(e,t,r){if(!t)return;const i=e.ctrlsService.getGridBodyCtrl().getGui(),s=`aria-${t}`;null===r?i.removeAttribute(s):i.setAttribute(s,r)},refreshCells:function wP(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))},flashCells:function xP(e,t={}){const r=i=>q(`Since v31.1 api.flashCells parameter '${i}Delay' is deprecated. Please use '${i}Duration' instead.`);te(t.fadeDelay)&&r("fade"),te(t.flashDelay)&&r("flash"),e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.flashCells(t))},refreshHeader:function SP(e){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))},isAnimationFrameQueueEmpty:function yP(e){return e.animationFrameService.isQueueEmpty()},flushAllAnimationFrames:function bP(e){e.animationFrameService.flushAllFrames()},getSizesForCurrentTheme:function EP(e){return{rowHeight:fs(e.gos),headerHeight:e.columnModel.getHeaderHeight()}},getCellRendererInstances:function FP(e,t={}){return e.rowRenderer.getCellRendererInstances(t).map(ao)}}},{version:xe,moduleName:"@ag-grid-community/cell-api",apiFunctions:{expireValueCache:function kP(e){e.valueCache.expire()},getValue:function TP(e,t,r){return f0(e,{colKey:t,rowNode:r})},getCellValue:f0}},{version:xe,moduleName:"@ag-grid-community/menu-api",apiFunctions:{showColumnMenuAfterButtonClick:function UP(e,t,r){const i=e.columnModel.getCol(t);e.menuService.showColumnMenu({column:i,buttonElement:r,positionBy:"button"})},showColumnMenuAfterMouseClick:function jP(e,t,r){let i=e.columnModel.getCol(t);i||(i=e.columnModel.getColDefCol(t)),i?e.menuService.showColumnMenu({column:i,mouseEvent:r,positionBy:"mouse"}):Me(`column '${t}' not found`)},showColumnMenu:function $P(e,t){const r=e.columnModel.getCol(t);r?e.menuService.showColumnMenu({column:r,positionBy:"auto"}):Me(`column '${t}' not found`)},hidePopupMenu:function KP(e){e.menuService.hidePopupMenu()}}},{version:xe,moduleName:"@ag-grid-community/sort-api",apiFunctions:{onSortChanged:function fM(e){e.sortController.onSortChanged("api")}}}]};var C0={version:xe,moduleName:"@ag-grid-community/state-core",beans:[class extends U{constructor(){super(...arguments),this.beanName="stateService",this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Yt(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=Yt(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=Yt(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}wireBeans(e){this.filterManager=e.filterManager,this.ctrlsService=e.ctrlsService,this.pivotResultColsService=e.pivotResultColsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnGroupStateService=e.columnGroupStateService,this.columnGetStateService=e.columnGetStateService,this.paginationService=e.paginationService,this.selectionService=e.selectionService,this.expansionService=e.expansionService,this.columnAnimationService=e.columnAnimationService,this.columnApplyStateService=e.columnApplyStateService,this.sideBarService=e.sideBarService,this.rangeService=e.rangeService}postConstruct(){this.isClientSideRowModel=it(this.gos),this.cachedState=this.getInitialState(),this.ctrlsService.whenReady(this,()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const[e,t,r]=this.addManagedEventListeners({newColumnsLoaded:({source:i})=>{"gridInitializing"===i&&(e(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))},rowCountReady:()=>{t?.(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())},firstDataRendered:()=>{r?.(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())}})}getInitialState(){return function RM(e){return"32.1.0"===(e.version||(e.version="32.1.0"),e.version)&&(e=function kM(e){return e.cellSelection=function TM(e,t){if(e&&"object"==typeof e)return e[t]}(e,"rangeSelection"),e}(e)),e}(this.gos.get("initialState")??{})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState());const e=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.getInitialState();this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState());const t=r=>()=>this.updateColumnState([r]);this.addManagedEventListeners({columnValueChanged:t("aggregation"),columnMoved:t("columnOrder"),columnPinned:t("columnPinning"),columnResized:t("columnSizing"),columnVisible:t("columnVisibility"),columnPivotChanged:t("pivot"),columnPivotModeChanged:t("pivot"),columnRowGroupChanged:t("rowGroup"),sortChanged:t("sort"),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:r,pagination:i}=this.getInitialState(),s=this.gos.get("advancedFilterModel");(e||s)&&this.setFilterState(e,s),t&&this.setRowGroupExpansionState(t),r&&this.setRowSelectionState(r),i&&this.setPaginationState(i),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState());const n=()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState());this.addManagedEventListeners({filterChanged:()=>this.updateCachedState("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:n,columnRowGroupChanged:n,rowDataUpdated:()=>{0!==this.gos.get("groupDefaultExpanded")&&setTimeout(()=>{n()})},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:o=>{(o.newPage||o.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,cellSelection:t,focusedCell:r,columnOrder:i}=this.getInitialState();r&&this.setFocusedCellState(r),t&&this.setCellSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!!i?.orderedColIds),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState());const s=this.getRangeSelectionState();this.updateCachedState("rangeSelection",s),this.updateCachedState("cellSelection",s),this.updateCachedState("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>this.updateCachedState("focusedCell",this.getFocusedCellState()),cellSelectionChanged:n=>{if(n.finished){const o=this.getRangeSelectionState();this.updateCachedState("rangeSelection",o),this.updateCachedState("cellSelection",o)}},bodyScrollEnd:()=>this.updateCachedState("scroll",this.getScrollState())})}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],r=[],i=[],s=[],n=[],o=[],a=[],l=[],c=[];let d=0;const u=this.columnGetStateService.getColumnState();for(let h=0;h<u.length;h++){const{colId:g,sort:p,sortIndex:f,rowGroup:m,rowGroupIndex:w,aggFunc:C,pivot:v,pivotIndex:k,pinned:M,hide:O,width:y,flex:L}=u[h];c.push(g),p&&(t[f??d++]={colId:g,sort:p}),m&&(r[w??0]=g),"string"==typeof C&&i.push({colId:g,aggFunc:C}),v&&(s[k??0]=g),M&&("right"===M?o:n).push(g),O&&a.push(g),(L||y)&&l.push({colId:g,flex:L??void 0,width:y})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:r.length?{groupColIds:r}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:s.length||e?{pivotMode:e,pivotColIds:s}:void 0,columnPinning:n.length||o.length?{leftColIds:n,rightColIds:o}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:r,aggregation:i,pivot:s,columnPinning:n,columnVisibility:o,columnSizing:a,columnOrder:l,partialColumnState:c}=e,d={},u=m=>{let w=d[m];return w||(w={colId:m},d[m]=w,w)},h=c?{}:{sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};t&&(t.sortModel.forEach(({colId:m,sort:w},C)=>{const v=u(m);v.sort=w,v.sortIndex=C}),h.sort=null,h.sortIndex=null),r&&(r.groupColIds.forEach((m,w)=>{const C=u(m);C.rowGroup=!0,C.rowGroupIndex=w}),h.rowGroup=null,h.rowGroupIndex=null),i&&(i.aggregationModel.forEach(({colId:m,aggFunc:w})=>{u(m).aggFunc=w}),h.aggFunc=null),s&&(s.pivotColIds.forEach((m,w)=>{const C=u(m);C.pivot=!0,C.pivotIndex=w}),this.gos.updateGridOptions({options:{pivotMode:s.pivotMode},source:"gridInitializing"}),h.pivot=null,h.pivotIndex=null),n&&(n.leftColIds.forEach(m=>{u(m).pinned="left"}),n.rightColIds.forEach(m=>{u(m).pinned="right"}),h.pinned=null),o&&(o.hiddenColIds.forEach(m=>{u(m).hide=!0}),h.hide=null),a&&(a.columnSizingModel.forEach(({colId:m,flex:w,width:C})=>{const v=u(m);v.flex=w??null,v.width=C}),h.flex=null);const g=l?.orderedColIds,p=!!g?.length,f=p?g.map(m=>u(m)):Object.values(d);f.length&&(this.columnStates=f,this.columnApplyStateService.applyColumnState({state:f,applyOrder:p,defaultState:h},"gridInitializing"))}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const r=this.columnGroupStates;if(this.columnGroupStates=void 0,this.pivotResultColsService.isPivotResultColsPresent()){if(t){const i=[];for(const s of t)this.pivotResultColsService.getPivotResultCol(s.colId)&&i.push(s);this.columnApplyStateService.applyColumnState({state:i,applyOrder:e},"gridInitializing")}r&&this.columnGroupStateService.setColumnGroupState(r,"gridInitializing")}}getColumnGroupState(){const e=this.columnGroupStateService.getColumnGroupState(),t=[];return e.forEach(({groupId:r,open:i})=>{i&&t.push(r)}),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){if(!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const t=new Set(e.columnGroup?.openColumnGroupIds),i=this.columnGroupStateService.getColumnGroupState().map(({groupId:s})=>{const n=t.has(s);return n&&t.delete(s),{groupId:s,open:n}});t.forEach(s=>{i.push({groupId:s,open:!0})}),i.length&&(this.columnGroupStates=i),this.columnGroupStateService.setColumnGroupState(i,"gridInitializing")}getFilterState(){let e=this.filterManager?.getFilterModel();e&&0===Object.keys(e).length&&(e=void 0);const t=this.filterManager?.getAdvancedFilterModel()??void 0;return e||t?{filterModel:e,advancedFilterModel:t}:void 0}setFilterState(e,t){const{filterModel:r,advancedFilterModel:i}=e??{advancedFilterModel:t};r&&this.filterManager?.setFilterModel(r,"columnFilter"),i&&this.filterManager?.setAdvancedFilterModel(i)}getRangeSelectionState(){const e=this.rangeService?.getCellRanges().map(t=>{const{id:r,type:i,startRow:s,endRow:n,columns:o,startColumn:a}=t;return{id:r,type:i,startRow:s,endRow:n,colIds:o.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeService:r,columnModel:i,visibleColsService:s}=this;if(!ei(t)||!r)return;const n=[];if(e.cellRanges.forEach(o=>{const a=[];if(o.colIds.forEach(c=>{const d=i.getCol(c);d&&a.push(d)}),!a.length)return;let l=i.getCol(o.startColId);if(!l){const c=s.getAllCols(),d=new Set(a);l=c.find(u=>d.has(u))}n.push({...o,columns:a,startColumn:l})}),function EF(e){return void 0!==e.get("cellSelection")}(t)&&function FF(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!=typeof t&&(t?.suppressMultiRanges??!1):e.get("suppressMultiRangeSelection")}(t)&&n.length>1)return q("cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`");r.setCellRanges(n)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.ctrlsService.getGridBodyCtrl()?.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:r}=e?.getVScrollPosition()??{top:0};return r||t?{top:r,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:r}=e;this.ctrlsService.getGridBodyCtrl()?.getScrollFeature().setScrollPosition(t,r)}getSideBarState(){return this.sideBarService?.getSideBarComp()?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:r,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:r,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:r,rowPinned:i}=e;this.focusService.setFocusedCell({column:this.columnModel.getCol(t),rowIndex:r,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){if(!this.paginationService)return;const e=this.paginationService.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationService.getPageSize();return e||t?{page:e,pageSize:t}:void 0}setPaginationState(e){this.paginationService&&(e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationService.setPageSize(e.pageSize,"initialState"),"number"==typeof e.page&&this.paginationService.setPage(e.page))}getRowSelectionState(){const e=this.selectionService.getSelectionState();return e&&(Array.isArray(e)||!1!==e.selectAll&&!1!==e.selectAllChildren||e?.toggledNodes?.length)?e:void 0}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let r=!1;Object.entries(t).forEach(([i,s])=>{Kn(s,this.cachedState[i])||(r=!0)}),this.cachedState={...this.cachedState,...t},r&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const r=this.cachedState[e];this.setCachedStateValue(e,t),Kn(t,r)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){this.staleStateKeys.forEach(e=>{"rowSelection"===e&&this.setCachedStateValue(e,this.getRowSelectionState())}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear(),this.eventService.dispatchEvent({type:"stateUpdated",sources:e,state:this.cachedState})}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}}]},PM={version:xe,moduleName:"@ag-grid-community/state",dependantModules:[C0,{version:xe,moduleName:"@ag-grid-community/state-api",apiFunctions:{getState:function FM(e){return e.stateService?.getState()??{}}},dependantModules:[C0]}]},po="paginationPageSizeSelector",jM={selector:"AG-PAGE-SIZE-SELECTOR",component:class extends Ge{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationService.getPageSize()||(this.paginationService.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.paginationService=e.paginationService}postConstruct(){this.addManagedPropertyListener(po,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.paginationService.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&this.reloadPageSizesSelector()}reset(){Vt(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&!1!==this.gos.get(po)}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationService.getPageSize(),r=!t||!e.includes(t);if(r){const s=this.gos.exists("paginationPageSize"),n=!0!==this.gos.get(po);q(`'paginationPageSize=${t}'${s?"":" (default value)"}, but ${t} is not included in${n?"":" the default"} paginationPageSizeSelector=[${e.join(", ")}].`),n||q(`Either set '${po}' to an array that includes ${t} or to 'false' to disable the page size selector.`),e.unshift("")}const i=String(r?"":t);this.selectPageSizeComp?(mi(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(i,!0)):this.createPageSizeSelectorComp(e,i),this.hasEmptyOption=r}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const r=this.localeService.getLocaleTextFunc(),i=r("pageSizeSelectorLabel","Page Size:"),s=r("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new rd).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(s).setLabel(i).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const t=this.gos.get(po);return!Array.isArray(t)||rr(t)?[20,50,100]:[...t].sort((r,i)=>r-i)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}}},KM={selector:"AG-PAGINATION",component:class extends s0{constructor(){super(),this.btFirst=de,this.btPrevious=de,this.btNext=de,this.btLast=de,this.lbRecordCount=de,this.lbFirstRowOnPage=de,this.lbLastRowOnPage=de,this.lbCurrent=de,this.lbTotal=de,this.pageSizeComp=de,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.focusService=e.focusService,this.ariaAnnouncementService=e.ariaAnnouncementService}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[jM]);const{btFirst:t,btPrevious:r,btNext:i,btLast:s}=this;this.activateTabIndex([t,r,i,s]),t.insertAdjacentElement("afterbegin",fr(e?"last":"first",this.gos)),r.insertAdjacentElement("afterbegin",fr(e?"next":"previous",this.gos)),i.insertAdjacentElement("afterbegin",fr(e?"previous":"next",this.gos)),s.insertAdjacentElement("afterbegin",fr(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:n=>{this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(n):this.focusService.focusGridInnerElement(n)},forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:r}=e;this.addManagedListeners(t,{click:r,keydown:i=>{(i.key===N.ENTER||i.key===N.SPACE)&&(i.preventDefault(),r())}})}),function WM(e,t,r){e.addManagedElementListeners(t,{keydown:i=>{if(!i.defaultPrevented&&i.key===N.TAB){const s=i.shiftKey;r.findNextFocusableElement(t,!1,s)||r.focusNextGridCoreContainer(s)&&i.preventDefault()}}})}(this,this.getGui(),this.focusService),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationService.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t)return t({value:e});const r=this.localeService.getLocaleTextFunc();return function Ep(e,t,r){return"number"!=typeof e?"":e.toString().replace(".",r).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${t}`)}(e,r("thousandSeparator",","),r("decimalSeparator","."))}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),r=e("to","to"),i=e("of","of"),s=e("firstPage","First Page"),n=e("previousPage","Previous Page"),o=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">\n                <ag-page-size-selector data-ref="pageSizeComp"></ag-page-size-selector>\n                <span class="ag-paging-row-summary-panel">\n                    <span id="ag-${l}-first-row" data-ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-to">${r}</span>\n                    <span id="ag-${l}-last-row" data-ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-of">${i}</span>\n                    <span id="ag-${l}-row-count" data-ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div data-ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${s}"></div>\n                    <div data-ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${n}"></div>\n                    <span class="ag-paging-description">\n                        <span id="ag-${l}-start-page">${t}</span>\n                        <span id="ag-${l}-start-page-number" data-ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-${l}-of-page">${i}</span>\n                        <span id="ag-${l}-of-page-number" data-ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div data-ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>\n                    <div data-ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>\n                </span>\n            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationService.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationService.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationService.goToLastPage()}enableOrDisableButtons(){const e=this.paginationService.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),r=this.paginationService.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay();this.nextButtonDisabled=e===r-1||i,this.lastButtonDisabled=!t||i||e===r-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){(function pR(e,t){Dr(e,"disabled",t)})(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages();return e&&0===t}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages(),r=this.paginationService.getMasterRowCount(),i=e?r:null;if(1===i){const C=this.rowModel.getRow(0);if(C&&C.group&&!C.groupData&&!C.aggData)return void this.setTotalLabelsToZero()}const s=this.paginationService.getCurrentPage(),n=this.paginationService.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=n*s+1,a=o+n-1,e&&a>i&&(a=i));const c=!e&&r<o+n-1,d=this.formatNumber(o);let u;this.lbFirstRowOnPage.textContent=d;const h=this.localeService.getLocaleTextFunc();u=c?h("pageLastRowUnknown","?"):this.formatNumber(a),this.lbLastRowOnPage.textContent=u;const f=this.formatNumber(t>0?s+1:0);let m,w;if(this.lbCurrent.textContent=f,e)m=this.formatNumber(t),w=this.formatNumber(i);else{const C=h("more","more");m=C,w=C}this.lbTotal.textContent=m,this.lbRecordCount.textContent=w,this.announceAriaStatus(d,u,w,f,m)}announceAriaStatus(e,t,r,i,s){const n=this.localeService.getLocaleTextFunc(),o=n("page","Page"),a=n("to","to"),l=n("of","of"),c=`${e} ${a} ${t} ${l} ${r}`,d=`${o} ${i} ${l} ${s}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnouncementService.announceValue(c,"paginationRow")),d!==this.ariaPageStatus&&(this.ariaPageStatus=d,this.ariaAnnouncementService.announceValue(d,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}}},w0={version:xe,moduleName:"@ag-grid-community/pagination-core",beans:[class extends U{constructor(){super(...arguments),this.beanName="paginationService",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return KM}isPaginateChildRows(){return!(!this.gos.get("groupRemoveSingleChildren")&&!this.gos.get("groupRemoveLowestSingleChildren"))||this.gos.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){!this.active||this.currentPage===e||"number"!=typeof this.currentPage||(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}isRowPresent(e){return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){return!this.active||this.getPageForIndex(e.rowIndex)===this.currentPage}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return te(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:te(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:te(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:te(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.pageBoundsService.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(void 0===this.pageSizeAutoCalculated)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const r=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,0!==this.currentPage&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,0!==this.currentPage&&this.goToFirstPage()}r!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();let r=this.pageSize*(this.currentPage+1)-1;if(r>e&&(r=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(this.pageSize*this.currentPage),r===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const i=this.rowModel.getTopLevelRowDisplayedIndex(r+1);this.bottomDisplayedRowIndex=i-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:r=!1,newPageSize:i=!1}=e;this.eventService.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:r,newPageSize:i,keepRenderedRows:t})}},class extends U{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||null==this.centerRowsCtrl}onPaginationAutoSizeChanged(){this.notActive()?this.paginationService.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const r=Math.max(fs(this.gos),1),i=Math.floor(e/r);this.paginationService.setPageSize(i,"autoCalculated")};this.isBodyRendered?Yt(()=>t(),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}}]},XM={version:xe,moduleName:"@ag-grid-community/pagination",dependantModules:[w0,{version:xe,moduleName:"@ag-grid-community/pagination-api",dependantModules:[w0],apiFunctions:{paginationIsLastPageFound:function MM(e){return e.rowModel.isLastRowIndexKnown()},paginationGetPageSize:function IM(e){return e.paginationService?.getPageSize()??100},paginationGetCurrentPage:function LM(e){return e.paginationService?.getCurrentPage()??0},paginationGetTotalPages:function _M(e){return e.paginationService?.getTotalPages()??1},paginationGetRowCount:function OM(e){return e.paginationService?e.paginationService.getMasterRowCount():e.rowModel.getRowCount()},paginationGoToNextPage:function BM(e){e.paginationService?.goToNextPage()},paginationGoToPreviousPage:function NM(e){e.paginationService?.goToPreviousPage()},paginationGoToFirstPage:function GM(e){e.paginationService?.goToFirstPage()},paginationGoToLastPage:function HM(e){e.paginationService?.goToLastPage()},paginationGoToPage:function zM(e,t){e.paginationService?.goToPage(t)}}}]},nr="clientSide",Jt="serverSide",ln="infinite",QM={onGroupExpandedOrCollapsed:[nr],refreshClientSideRowModel:[nr],isRowDataEmpty:[nr],forEachLeafNode:[nr],forEachNodeAfterFilter:[nr],forEachNodeAfterFilterAndSort:[nr],resetRowHeights:[nr],applyTransaction:[nr],applyTransactionAsync:[nr],flushAsyncTransactions:[nr],getBestCostNodeSelection:[nr],getServerSideSelectionState:[Jt],setServerSideSelectionState:[Jt],applyServerSideTransaction:[Jt],applyServerSideTransactionAsync:[Jt],applyServerSideRowData:[Jt],retryServerSideLoads:[Jt],flushServerSideAsyncTransactions:[Jt],refreshServerSide:[Jt],getServerSideGroupLevelState:[Jt],refreshInfiniteCache:[ln],purgeInfiniteCache:[ln],getInfiniteRowCount:[ln],isLastRowIndexKnown:[ln,Jt],expandAll:[nr,Jt],collapseAll:[nr,Jt],onRowHeightChanged:[nr,Jt],setRowCount:[ln,Jt],getCacheBlockState:[ln,Jt]},ZM={getValue:{version:"v31.3",new:"getCellValue"},getFirstDisplayedRow:{version:"v31.1",new:"getFirstDisplayedRowIndex"},getLastDisplayedRow:{version:"v31.1",new:"getLastDisplayedRowIndex"},getModel:{version:"v31.1",message:"Please use the appropriate grid API methods instead."},setColumnVisible:{version:"v31.1",old:"setColumnVisible(key,visible)",new:"setColumnsVisible([key],visible)"},setColumnPinned:{version:"v31.1",old:"setColumnPinned(key,pinned)",new:"setColumnsPinned([key],pinned)"},moveColumn:{version:"v31.1",old:"moveColumn(key, toIndex)",new:"moveColumns([key], toIndex)"},setColumnWidth:{version:"v31.1",old:"setColumnWidth(col, width)",new:"setColumnWidths([{key: col, newWidth: width}])"},autoSizeColumn:{version:"v31.1",old:"autoSizeColumn(key, skipHeader)",new:"autoSizeColumns([key], skipHeader)"},addAggFunc:{version:"v31.1",old:"addAggFunc(key, func)",new:"addAggFuncs({ key: func })"},removeValueColumn:{version:"v31.1",old:"removeValueColumn(colKey)",new:"removeValueColumns([colKey])"},addValueColumn:{version:"v31.1",old:"addValueColumn(colKey)",new:"addValueColumns([colKey])"},removeRowGroupColumn:{version:"v31.1",old:"removeRowGroupColumn(colKey)",new:"removeRowGroupColumns([colKey])"},addRowGroupColumn:{version:"v31.1",old:"addRowGroupColumn(colKey)",new:"addRowGroupColumns([colKey])"},removePivotColumn:{version:"v31.1",old:"removePivotColumn(colKey)",new:"removePivotColumns([colKey])"},addPivotColumn:{version:"v31.1",old:"addPivotColumn(colKey)",new:"addPivotColumns([colKey])"},showColumnMenuAfterButtonClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere."},showColumnMenuAfterMouseClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere."},getFilterInstance:{version:"v31.1",message:"'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."},showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"}},ji=(e,t)=>"clientSide"===(t.rowModelType??"clientSide")?{module:"@ag-grid-enterprise/row-grouping"}:null,tI={enableRowGroup:ji,rowGroup:ji,rowGroupIndex:ji,enablePivot:ji,enableValue:ji,pivot:ji,pivotIndex:ji,aggFunc:ji,cellEditor:e=>"agRichSelect"===e.cellEditor||"agRichSelectCellEditor"===e.cellEditor?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(r=>t.includes(r))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,{rowSelection:t})=>"multiple"===t?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:t})=>"multiple"===t?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,{rowSelection:t})=>"multiple"===t?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>cn},cn={objectName:"colDef",allProperties:Object.keys({headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0}),docsUrl:"column-properties/",deprecations:{columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}},validations:tI},nI={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"\t",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1},x0={version:xe,moduleName:"@ag-grid-community/core-community-features",dependantModules:[{version:xe,moduleName:"@ag-grid-community/core"},{version:xe,moduleName:"@ag-grid-community/core-validations",beans:[class extends U{constructor(){super(...arguments),this.beanName="validationService"}wireBeans(e){this.beans=e,this.gridOptions=e.gridOptions}postConstruct(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,{objectName:"gridOptions",allProperties:[...Zn.ALL_PROPERTIES,...Jn.EVENT_CALLBACKS],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:{advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."},suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."}},validations:{sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",validate:e=>{const t=e.rowModelType??"clientSide";switch(t){case"clientSide":return e.getDataPath?null:`treeData requires 'getDataPath' in the ${t} row model.`;case"serverSide":return e.isServerSideGroup&&e.getServerSideGroupKey?null:`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${t} row model.`}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],validate:e=>{switch(e.rowModelType??"clientSide"){case"clientSide":return null;case"serverSide":return e.suppressServerSideInfiniteScroll?"groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll":null}return null}},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:[void 0,"bottom"]}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},paginationPageSizeSelector:{validate:e=>{const t=e.paginationPageSizeSelector;return"boolean"==typeof t||null==t||t.length?null:"'paginationPageSizeSelector' cannot be an empty array.\n                    If you want to hide the page size selector, set paginationPageSizeSelector to false."}},rowSelection:{validate:({rowSelection:e})=>e&&"string"==typeof e?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':null},cellSelection:{module:"@ag-grid-enterprise/range-selection"},columnDefs:()=>cn,defaultColDef:()=>cn,defaultColGroupDef:()=>cn,autoGroupColumnDef:()=>cn,selectionColumnDef:()=>cn}})}validateApiFunction(e,t){return function JM(e,t,r){const i=ZM[e];if(i){const{version:n,new:o,old:a,message:l}=i,c=a??e;return(...d)=>(q(`Since ${n} api.${c} is deprecated. ${o?`Please use ${o} instead. `:""}${l??""}`),t.apply(t,d))}const s=QM[e];return s?(...n)=>{const o=r.rowModel.getType();if(s.includes(o))return t.apply(t,n);Me(`api.${e} can only be called when gridOptions.rowModelType is ${s.join(" or ")}`)}:t}(e,t,this.beans)}processOptions(e,t){const{validations:r,deprecations:i,allProperties:s,propertyExceptions:n,objectName:o,docsUrl:a}=t;s&&!0!==this.gridOptions.suppressPropertyNamesCheck&&this.checkProperties(e,[...n??[],...Object.keys(i)],s,o,a);const l=new Set;Object.keys(e).forEach(d=>{const u=i[d];if(u)if("renamed"in u){const{renamed:v,version:k}=u;l.add(`As of v${k}, ${String(d)} is deprecated. Please use ${String(v)} instead.`),e[v]=e[d]}else{const{message:v,version:k}=u;l.add(`As of v${k}, ${String(d)} is deprecated. ${v??""}`)}const h=e[d];if(null==h||!1===h)return;const g=r[d];let p;if(!g)return;if("function"==typeof g){const v=g(e,this.gridOptions);if(!v)return;if("objectName"in v){const k=e[d];return Array.isArray(k)?void k.forEach(M=>{this.processOptions(M,v)}):void this.processOptions(e[d],v)}p=v}else p=g;const{module:f,dependencies:m,validate:w,supportedRowModels:C}=p;if(C){const v=this.gridOptions.rowModelType??"clientSide";if(!C.includes(v))return void l.add(`${String(d)} is not supported with the '${v}' row model.`)}if(f){const v=Array.isArray(f)?f:[f];let k=!0;if(v.forEach(M=>{this.gos.assertModuleRegistered(M,String(d))||(k=!1,l.add(`${String(d)} is only available when ${M} is loaded.`))}),!k)return}if(m){const v=this.checkForRequiredDependencies(d,m,e);if(v)return void l.add(v)}if(w){const v=w(e,this.gridOptions);if(v)return void l.add(v)}}),l.size>0&&l.forEach(d=>{q(d)})}checkForRequiredDependencies(e,t,r){const s=Object.entries(t).find(([a,l])=>!l.includes(r[a]));if(!s)return null;const[n,o]=s;return o.length>1?`'${String(e)}' requires '${n}' to be one of [${o.join(", ")}].`:`'${String(e)}' requires '${n}' to be ${o[0]}.`}checkProperties(e,t,r,i,s){const o=function sk(e,t,r){const i={},s=e.filter(n=>!t.some(o=>o===n));return s.length>0&&s.forEach(n=>i[n]=np(n,r).values),i}(Object.getOwnPropertyNames(e),["__ob__","__v_skip","__metadata__",...t,...r],r);if(kr(o,(a,l)=>{let c=`invalid ${i} property '${a}' did you mean any of these: ${l.slice(0,8).join(", ")}.`;r.includes("context")&&(c+=`\nIf you are trying to annotate ${i} with application data, use the '${i}.context' property instead.`),q(c)}),Object.keys(o).length>0&&s){const a=this.getFrameworkOverrides().getDocLink(s);q(`to see all the valid ${i} properties please check: ${a}`)}}}]},x4,VT,PM,iP,hA,XM,EM]},uI=class extends U{constructor(){super(...arguments),this.beanName="gridDestroyService",this.destroyCalled=!1}wireBeans(e){this.beans=e}destroy(){this.destroyCalled||(this.eventService.dispatchEvent({type:"gridPreDestroyed",state:this.beans.stateService?.getState()??{}}),this.destroyCalled=!0,this.beans.ctrlsService.get("gridCtrl")?.destroyGridUi(),this.beans.context.destroy(),super.destroy())}isDestroyCalled(){return this.destroyCalled}},Oa=new Set(["gridPreDestroyed","fillStart","pasteStart"]),gI=new Map([...Zn.BOOLEAN_PROPERTIES.map(e=>[e,gc]),...Zn.NUMBER_PROPERTIES.map(e=>[e,bp]),["groupAggFiltering",e=>"function"==typeof e?e:gc(e)],["pageSize",ii(1)],["autoSizePadding",ii(0)],["keepDetailRowsCount",ii(1)],["rowBuffer",ii(0)],["infiniteInitialRowCount",ii(1)],["cacheOverflowSize",ii(1)],["cacheBlockSize",ii(1)],["serverSideInitialRowCount",ii(1)],["viewportRowModelPageSize",ii(1)],["viewportRowModelBufferSize",ii(0)]]);function S0(e,t){const r=gI.get(e);return r?r(t):t}var y0=class cm extends U{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new Ys,this.globalEventHandlerFactory=t=>(r,i)=>{if(!this.isAlive())return;const s=Oa.has(r);if(s&&!t||!s&&t)return;const n=Jn.getCallbackForEvent(r),o=this.gridOptions[n];"function"==typeof o&&this.frameworkOverrides.wrapOutgoing(()=>{o(i)})}}wireBeans(t){this.gridOptions=t.gridOptions,this.eGridDiv=t.eGridDiv,this.validationService=t.validationService,this.environment=t.environment,this.api=t.gridApi,this.gridId=t.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){const t=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),t),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:r})=>{this.updateGridOptions({options:r,force:!0,source:"gridOptionsUpdated"})}})}get(t){return this.gridOptions[t]??nI[t]}getCallback(t){return this.mergeGridCommonParams(this.gridOptions[t])}exists(t){return te(this.gridOptions[t])}mergeGridCommonParams(t){return t&&(i=>{const s=i;return s.api=this.api,s.context=this.gridOptionsContext,t(s)})}updateGridOptions({options:t,force:r,source:i="api"}){const s={id:cm.changeSetId++,properties:[]},n=[];Object.entries(t).forEach(([o,a])=>{"api"===i&&aR[o]&&q(`${o} is an initial property and cannot be updated.`);const l=S0(o,a),d=this.gridOptions[o];(r||"object"==typeof l&&"api"===i||d!==l)&&(this.gridOptions[o]=l,n.push({type:o,currentValue:l,previousValue:d,changeSet:s,source:i}))}),this.validationService?.processGridOptions(this.gridOptions),s.properties=n.map(o=>o.type),n.forEach(o=>{this.gridOptions.debug&&Rr(`Updated property ${o.type} from`,o.previousValue," to ",o.currentValue),this.propertyEventService.dispatchEvent(o)})}addPropertyEventListener(t,r){this.propertyEventService.addEventListener(t,r)}removePropertyEventListener(t,r){this.propertyEventService.removeEventListener(t,r)}getDomDataKey(){return this.domDataKey}getGridCommonParams(){return{api:this.api,context:this.gridOptionsContext}}addGridCommonParams(t){const r=t;return r.api=this.api,r.context=this.gridOptionsContext,r}assertModuleRegistered(t,r){return xi.__assertRegistered(t,r,this.gridId)}isModuleRegistered(t){return xi.__isRegistered(t,this.gridId)}};y0.changeSetId=0;var pI=y0,mI=class extends U{constructor(){super(...arguments),this.beanName="headerPositionUtils"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}findHeader(e,t){let r,i;if(ft(e.column)?r=this.visibleColsService.getGroupAtDirection(e.column,t):(i=`getCol${t}`,r=this.visibleColsService[i](e.column)),!r)return;const{headerRowIndex:s}=e;if("filter"!==this.getHeaderRowType(s)){const a=[r];for(;r.getParent();)r=r.getParent(),a.push(r);r=a[a.length-1-s]}const{column:n,headerRowIndex:o}=this.getHeaderIndexToFocus(r,s);return{column:n,headerRowIndex:o}}getHeaderIndexToFocus(e,t){let r;if(ft(e)&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const i=e;r=i.getLeafColumns()[0];let s=r;for(;s!==i;)t++,s=s.getParent()}return{column:r||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return!!e&&e.getLeafColumns().some(t=>t.isSpanHeaderHeight())}getColumnVisibleParent(e,t){const r=this.getHeaderRowType(t),s="column"===r;let n="filter"===r?e:e.getParent(),o=t-1,a=o;if(s&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;n&&n.isPadding();)n=n.getParent(),o--;a=o,o<0&&(n=e,o=t,a=void 0)}return{column:n,headerRowIndex:o,headerRowIndexWithoutSpan:a}}getColumnVisibleChild(e,t,r="After"){let s=e,n=t+1;const o=n;if("group"===this.getHeaderRowType(t)){const a=e.getDisplayedLeafColumns(),l="After"===r?a[0]:Le(a),c=[];let d=l;for(;d.getParent()!==e;)d=d.getParent(),c.push(d);if(s=l,l.isSpanHeaderHeight())for(let u=c.length-1;u>=0;u--){const h=c[u];if(!h.isPadding()){s=h;break}n++}else s=Le(c),s||(s=l)}return{column:s,headerRowIndex:n,headerRowIndexWithoutSpan:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const r=this.visibleColsService.getAllCols(),i=r["start"===t?0:r.length-1];if(!i)return;const n=this.ctrlsService.getHeaderRowContainerCtrl(i.getPinned())?.getRowType(e);return"group"==n?{headerRowIndex:e,column:this.visibleColsService.getColGroupAtLevel(i,e)}:{headerRowIndex:null==n?-1:e,column:i}}},vI=class extends U{constructor(){super(...arguments),this.beanName="localeService"}getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(r,i,s)=>e({key:r,defaultValue:i,variableValues:s});const t=this.gos.get("localeText");return(r,i,s)=>{let n=t&&t[r];if(n&&s&&s.length){let o=0;for(;!(o>=s.length||-1===n.indexOf("${variable}"));)n=n.replace("${variable}",s[o++])}return n??i}}},CI=class extends U{constructor(){super(...arguments),this.beanName="apiEventService",this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new Fc(this.getFrameworkOverrides())}addEventListener(e,t){const r=this.frameworkEventWrappingService.wrap(t),i=na(this.gos)&&!Oa.has(e),s=i?this.asyncEventListeners:this.syncEventListeners;s.has(e)||s.set(e,new Set),s.get(e).add(r),this.eventService.addEventListener(e,r,i)}removeEventListener(e,t){const r=this.frameworkEventWrappingService.unwrap(t),s=!!this.asyncEventListeners.get(e)?.delete(r);s||this.syncEventListeners.get(e)?.delete(r),this.eventService.removeEventListener(e,r,s)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(na(this.gos)){const i=(n,o)=>{Oa.has(n)&&t(n,o)},s=(n,o)=>{Oa.has(n)||t(n,o)};this.globalEventListenerPairs.set(e,{syncListener:i,asyncListener:s}),this.eventService.addGlobalListener(i,!1),this.eventService.addGlobalListener(s,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:i,asyncListener:s}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(i,!1),this.eventService.removeGlobalListener(s,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach((r,i)=>{r.forEach(s=>this.eventService.removeEventListener(i,s,t)),r.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(r=>this.eventService.removeGlobalListener(r,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener:e,asyncListener:t})=>{this.eventService.removeGlobalListener(e,!1),this.eventService.removeGlobalListener(t,!0)}),this.globalEventListenerPairs.clear()}},wI=class extends U{constructor(){super(...arguments),this.beanName="pageBoundsListener"}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventService.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){this.paginationService?this.paginationService.calculatePages():this.pageBoundsService.calculateBounds(0,this.rowModel.getRowCount()-1)}},xI=class extends U{constructor(){super(...arguments),this.beanName="pageBoundsService",this.pixelOffset=0}wireBeans(e){this.rowModel=e.rowModel}getFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getCurrentPageHeight(){return Ie(this.topRowBounds)||Ie(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}calculateBounds(e,t){this.topRowBounds=this.rowModel.getRowBounds(e),this.topRowBounds&&(this.topRowBounds.rowIndex=e),this.bottomRowBounds=this.rowModel.getRowBounds(t),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=t),this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=te(this.topRowBounds)?this.topRowBounds.rowTop:0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},SI=class extends U{constructor(){super(),this.beanName="ariaAnnouncementService",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.updateAnnouncement=Yt(this.updateAnnouncement.bind(this),200)}wireBeans(e){this.eGridDiv=e.eGridDiv}postConstruct(){const e=gt(this.gos),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),Nf(t,"polite"),function fR(e,t){Dr(e,"relevant",t)}(t,"additions text"),function gR(e,t){Dr(e,"atomic",t)}(t,!0),this.eGridDiv.appendChild(t)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)},50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Vt(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null,this.pendingAnnouncements.clear()}},yI=class extends U{constructor(){super(...arguments),this.beanName="columnAnimationService",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(e,t){if(0===this.executeNextFuncs.length&&0===this.executeLaterFuncs.length)return e(),void t();const r=i=>{for(;i.length;){const s=i.pop();s&&s()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e(),r(this.executeNextFuncs)},0),window.setTimeout(()=>{t(),r(this.executeLaterFuncs)},200)})}},bI=class extends U{constructor(){super(...arguments),this.beanName="columnHoverService"}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}updateState(e){this.selectedColumns=e,this.eventService.dispatchEvent({type:"columnHoverChanged"})}},EI=class extends U{constructor(){super(...arguments),this.beanName="overlayService",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}wireBeans(e){this.userComponentFactory=e.userComponentFactory,this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}postConstruct(){this.isClientSide=it(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.onGridSizeChanged.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.overlayWrapperComp=e,this.updateOverlayVisibility()}isVisible(){return 0!==this.state&&!!this.overlayWrapperComp}isExclusive(){return 1===this.state&&!!this.overlayWrapperComp}getOverlayWrapper(){return this.overlayWrapperComp}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos.get("loading");!e&&(void 0!==e||this.gos.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1,!this.gos.get("loading")&&!this.gos.get("suppressNoRowsOverlay")&&this.doShowNoRowsOverlay()}hideOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")?q("Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead."):this.doHideOverlay()}updateOverlayVisibility(){if(!this.overlayWrapperComp)return void(this.state=0);let e=this.gos.get("loading");this.showInitialOverlay&&void 0===e&&!this.gos.get("suppressLoadingOverlay")&&(e=!this.gos.get("columnDefs")||!this.columnModel.isReady()||!this.gos.get("rowData")&&this.isClientSide),e?1!==this.state&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,this.rowModel.isEmpty()&&!this.gos.get("suppressNoRowsOverlay")&&this.isClientSide?2!==this.state&&this.doShowNoRowsOverlay():0!==this.state&&this.doHideOverlay())}doShowLoadingOverlay(){this.overlayWrapperComp&&(this.state=1,this.showOverlay(this.userComponentFactory.getLoadingOverlayCompDetails({}),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.overlayWrapperComp&&(this.state=2,this.showOverlay(this.userComponentFactory.getNoRowsOverlayCompDetails({}),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.overlayWrapperComp&&(this.state=0,this.overlayWrapperComp.hideOverlay(),this.updateExclusive())}showOverlay(e,t,r){const i=e.newAgStackInstance();this.overlayWrapperComp?.showOverlay(i,t,this.isExclusive(),r),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventService.dispatchEvent({type:"overlayExclusiveChanged"})}onGridSizeChanged(){this.refreshWrapperPadding()}refreshWrapperPadding(){if(!this.overlayWrapperComp)return;let e=0;2===this.state?e=this.ctrlsService.get("gridHeaderCtrl")?.getHeaderHeight()||0:0!==this.wrapperPadding&&(e=0),this.wrapperPadding!==e&&(this.wrapperPadding=e,this.overlayWrapperComp.updateOverlayWrapperPaddingTop(e))}},FI=class extends U{constructor(){super(...arguments),this.beanName="rowCssClassCalculator"}wireBeans(e){this.stylingService=e.stylingService}getInitialRowClasses(e){const t=[];return te(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),Ef(t,this.processClassesFromGridOptions(e.rowNode)),Ef(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],r=n=>{"string"==typeof n?t.push(n):Array.isArray(n)&&n.forEach(o=>t.push(o))},i=this.gos.get("rowClass");if(i){if("function"==typeof i)return q("rowClass should not be a function, please use getRowClass instead"),[];r(i)}const s=this.gos.getCallback("getRowClass");return s&&r(s({data:e.data,node:e,rowIndex:e.rowIndex})),t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,r=>{t.push(r)},()=>{}),t}processRowClassRules(e,t,r){const i=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),i,t,r)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}},RI=class extends U{constructor(){super(...arguments),this.beanName="rowContainerHeightService",this.scrollY=0,this.uiBodyHeight=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=function FR(){if(void 0!==zc)return zc;if(!document.body)return-1;let e=1e6;const t=Wc()?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const i=2*e;if(r.style.height=i+"px",i>t||r.clientHeight!==i)break;e=i}return document.body.removeChild(r),zc=e,e}(),this.gos.get("debug")&&Rr("RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,r=this.getUiBodyHeight();(t!==this.scrollY||r!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=r,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.gos.get("debug")&&Rr(`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"==typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return t.bottom-t.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight();return this.maxScrollY*(e/t)}},kI=class extends U{constructor(){super(...arguments),this.beanName="rowNodeSorter"}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.showRowGroupColsService=e.showRowGroupColsService}postConstruct(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=Jr(this.gos),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=Jr(this.gos))}doFullSort(e,t){const i=e.map((s,n)=>({currentPos:n,rowNode:s}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(s=>s.rowNode)}compareRowNodes(e,t,r){const i=t.rowNode,s=r.rowNode;for(let n=0,o=e.length;n<o;n++){const a=e[n],l="desc"===a.sort,c=this.getValue(i,a.column),d=this.getValue(s,a.column);let u;const h=this.getComparator(a,i);if(u=h?h(c,d,i,s,l):wF(c,d,this.isAccentedSort),!isNaN(u)&&0!==u)return"asc"===a.sort?u:-1*u}return t.currentPos-r.currentPos}getComparator(e,t){const r=e.column,i=r.getColDef().comparator;if(null!=i)return i;if(!r.getColDef().showRowGroup)return;const s=!t.group&&r.getColDef().field;if(!s)return;const n=this.columnModel.getColDefCol(s);return n?n.getColDef().comparator:void 0}getValue(e,t){if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(aa(this.gos,this.columnModel.isPivotActive())){const n=e.allLeafChildren?.[0];return n?this.valueService.getValue(t,n,!1,!1):void 0}const s=this.showRowGroupColsService?.getShowRowGroupCol(t.getId());return s?e.groupData?.[s.getId()]:void 0}return e.group&&t.getColDef().showRowGroup?void 0:this.valueService.getValue(t,e,!1,!1)}},Ba=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let r=0;r<e.children.length;r++)this.depthFirstSearchChangedPath(e.children[r],t);t(e.rowNode)}depthFirstSearchEverything(e,t,r){if(e.childrenAfterGroup)for(let i=0;i<e.childrenAfterGroup.length;i++){const s=e.childrenAfterGroup[i];s.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[i],t,r):r&&t(s)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,r=!1){this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];)this.mapToItems[t.id]={rowNode:t,children:null},r++,t=t.parent;return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;)this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={}),t.forEach(i=>this.nodeIdsToColumns[r.id][i.getId()]=!0),r=r.parent}linkPathItems(e,t){let r=e;for(let i=0;i<t;i++){const s=this.mapToItems[r.id],n=this.mapToItems[r.parent.id];n.children||(n.children=[]),n.children.push(s),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter(s=>r[s.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter(s=>!r[s.getId()])}},b0=class extends U{constructor(){super(...arguments),this.beanName="selectionService",this.selectedNodes=new Map,this.selectionCtx=new class{constructor(){this.root=null,this.end=null,this.cachedRange=[]}init(e){this.rowModel=e}reset(){this.root=null,this.end=null,this.cachedRange.length=0}setRoot(e){this.root=e,this.end=null,this.cachedRange.length=0}setEndRange(e){this.end=e,this.cachedRange.length=0}getRange(){if(0===this.cachedRange.length){const e=this.getRoot(),t=this.getEnd();if(null==e||null==t)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)}return this.cachedRange}isInRange(e){return null!==this.root&&this.getRange().some(t=>t.id===e.id)}getRoot(){return this.root&&null===this.root?.key&&(this.root=this.rowModel.getRowNode(this.root.id)??null),this.root}getEnd(){return this.end&&null===this.end?.key&&(this.end=this.rowModel.getRowNode(this.end.id)??null),this.end}truncate(e){const t=this.getRange();if(0===t.length)return{keep:[],discard:[]};const r=t[0].id===this.root.id,i=t.findIndex(s=>s.id===e.id);if(i>-1){const s=t.slice(0,i),n=t.slice(i+1);return this.setEndRange(e),r?{keep:s,discard:n}:{keep:n,discard:s}}return{keep:t,discard:[]}}extend(e,t=!1){const r=this.getRoot();if(null==r){const s=this.getRange().slice();return t&&e.depthFirstSearch(n=>!n.group&&s.push(n)),s.push(e),this.setRoot(e),{keep:s,discard:[]}}if(this.rowModel.getNodesInRangeForSelection(r,e).find(s=>s.id===this.end?.id))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const s=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:s}}}},this.rowSelectionMode=void 0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){const{gos:e,rowModel:t,onRowSelected:r}=this;this.selectionCtx.init(t),this.rowSelectionMode=ca(e),this.groupSelectsChildren=ms(e),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{const i=ms(e),s=ca(e);(i!==this.groupSelectsChildren||s!==this.rowSelectionMode)&&(this.groupSelectsChildren=i,this.rowSelectionMode=s,this.deselectAllRowNodes({source:"api"}))}),this.addManagedEventListeners({rowSelected:r.bind(this)})}destroy(){super.destroy(),this.resetNodes(),this.selectionCtx.reset()}isMultiSelect(){return"multiRow"===this.rowSelectionMode}overrideSelectionValue(e,t){if(!(e=>"checkboxSelected"===e||"rowClicked"===e||"spaceKey"===e||"uiSelectAll"===e||"uiSelectAllCurrentPage"===e||"uiSelectAllFiltered"===e)(t))return e;const r=this.selectionCtx.getRoot();return!r||(r.isSelected()??!1)}setNodesSelected(e){const{newValue:t,clearSelection:r,suppressFinishActions:i,rangeSelect:s,nodes:n,event:o,source:a}=e;if(0===n.length)return 0;if(n.length>1&&!this.isMultiSelect())return q("cannot multi select unless selection mode is 'multiRow'"),0;const l=this.groupSelectsChildren&&!0===e.groupSelectsFiltered,c=n.map(u=>u.footer?u.sibling:u);if(s){if(c.length>1)return q("cannot range select while selecting multiple rows"),0;const u=c[0],h=this.overrideSelectionValue(t,a);if(this.isMultiSelect()){if(this.selectionCtx.isInRange(u)){const g=this.selectionCtx.truncate(u);return h&&this.selectRange(g.discard,!1,a),this.selectRange(g.keep,h,a)}if(this.selectionCtx.getRoot()!==u){const f=this.selectionCtx.extend(u,this.groupSelectsChildren);return h&&this.selectRange(f.discard,!1,a),this.selectRange(f.keep,h,a)}}}i||this.selectionCtx.setRoot(c[0]);let d=0;for(let u=0;u<c.length;u++){const h=c[u];l&&h.group||h.selectThisNode(t,o,a)&&d++,this.groupSelectsChildren&&h.childrenAfterGroup?.length&&(d+=this.selectChildren(h,t,l,a))}return i||(t&&(r||!this.isMultiSelect())&&(d+=this.clearOtherNodes(c[0],a)),d>0&&(this.updateGroupsFromChildrenSelections(a),this.dispatchSelectionChanged(a))),d}selectRange(e,t,r){let i=0;return e.forEach(s=>{s.group&&this.groupSelectsChildren||s.selectThisNode(t,void 0,r)&&i++}),i>0&&(this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)),i}selectChildren(e,t,r,i){const s=r?e.childrenAfterAggFilter:e.childrenAfterGroup;return Ie(s)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:r,source:i,nodes:s})}getSelectedNodes(){const e=[];return this.selectedNodes.forEach(t=>{t&&e.push(t)}),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>{t&&t.data&&e.push(t.data)}),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((r,i)=>{r&&e(r)&&t.set(i,r)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren||!it(this.gos))return!1;const i=this.rowModel.getRootNode();t||(t=new Ba(!0,i)).setInactive();let s=!1;return t.forEachChangedNodeDepthFirst(n=>{if(n!==i){const o=n.calculateSelectedFromChildren();s=n.selectThisNode(null!==o&&o,void 0,e)||s}}),s}clearOtherNodes(e,t){const r=new Map;let i=0;return this.selectedNodes.forEach(s=>{if(s&&s.id!==e.id){const n=this.selectedNodes.get(s.id);i+=n.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&s.parent&&r.set(s.parent.id,s.parent)}}),r.forEach(s=>{const n=s.calculateSelectedFromChildren();s.selectThisNode(null!==n&&n,void 0,t)}),i}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){te(t)&&e.id!==t.id&&t&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes?.clear()}getBestCostNodeSelection(){if(!it(this.gos))return;const t=this.rowModel.getTopLevelNodes();if(null===t)return;const r=[];return function i(s){for(let n=0,o=s.length;n<o;n++){const a=s[n];a.isSelected()?r.push(a):a.group&&a.children&&i(a.children)}}(t),r}isEmpty(){let e=0;return this.selectedNodes.forEach(t=>{t&&e++}),0===e}deselectAllRowNodes(e){const t=o=>o.selectThisNode(!1,void 0,i),r=it(this.gos),{source:i,justFiltered:s,justCurrentPage:n}=e;if(n||s){if(!r)return void Me("selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(s,n).forEach(t)}else this.selectedNodes.forEach(o=>{o&&t(o)}),this.reset(i);this.selectionCtx.reset(),r&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)}getSelectedCounts(e,t){let r=0,i=0;return this.getNodesToSelect(e,t).forEach(n=>{this.groupSelectsChildren&&n.group||(n.isSelected()?r++:n.selectable&&i++)}),{selectedCount:r,notSelectedCount:i}}getSelectAllState(e,t){const{selectedCount:r,notSelectedCount:i}=this.getSelectedCounts(e,t);return(0!==r||0!==i)&&(r>0&&i>0?null:r>0)}hasNodesToSelect(e=!1,t=!1){return this.getNodesToSelect(e,t).filter(r=>r.selectable).length>0}getNodesToSelect(e=!1,t=!1){this.validateSelectAllType();const r=[];if(t)return this.forEachNodeOnPage(s=>{if(s.group)if(s.expanded)this.groupSelectsChildren||r.push(s);else{const n=o=>{r.push(o),o.childrenAfterFilter?.length&&o.childrenAfterFilter.forEach(n)};n(s)}else r.push(s)}),r;const i=this.rowModel;return e?(i.forEachNodeAfterFilter(s=>{r.push(s)}),r):(i.forEachNode(s=>{r.push(s)}),r)}forEachNodeOnPage(e){const t=this.pageBoundsService.getFirstRow(),r=this.pageBoundsService.getLastRow();for(let i=t;i<=r;i++){const s=this.rowModel.getRow(i);s&&e(s)}}selectAllRowNodes(e){if(function bF(e){return"string"!=typeof e.get("rowSelection")}(this.gos)&&!Cc(this.gos))return q("cannot multi select unless selection mode is 'multiRow'");this.validateSelectAllType();const{source:t,justFiltered:r,justCurrentPage:i}=e,s=this.getNodesToSelect(r,i);s.forEach(n=>n.selectThisNode(!0,void 0,t)),this.selectionCtx.setRoot(s[0]??null),this.selectionCtx.setEndRange(Le(s)??null),it(this.gos)&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t),this.dispatchSelectionChanged(t)}getSelectionState(){const e=[];return this.selectedNodes.forEach(t=>{t?.id&&e.push(t.id)}),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return Me("Invalid selection state. When using client-side row model, the state must conform to `string[]`.");const r=new Set(e),i=[];this.rowModel.forEachNode(s=>{r.has(s.id)&&i.push(s)}),this.setNodesSelected({newValue:!0,nodes:i,source:t})}dispatchSelectionChanged(e){this.eventService.dispatchEvent({type:"selectionChanged",source:e})}validateSelectAllType(){if(!it(this.gos))throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`)}},TI=class extends U{constructor(){super(...arguments),this.beanName="selectableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(e=!1){const{gos:t}=this,r=sa(t),i=vc(t);if(!r||!i)return;const s=ms(t),n=it(t)&&s,o=[],a=l=>{if(e&&!l.group)return;if(n&&l.group){const d=l.childrenAfterGroup.some(u=>!0===u.selectable);return void l.setRowSelectable(d,!0)}const c=i?.(l)??!0;l.setRowSelectable(c,!0),!c&&l.isSelected()&&o.push(l)};n?new Ba(!1,this.rowModel.getRootNode()).forEachChangedNodeDepthFirst(a,!0,!0):this.rowModel.forEachNode(a),o.length&&this.selectionService.setNodesSelected({nodes:o,newValue:!1,source:"selectableChanged"}),n&&this.selectionService instanceof b0&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}},E0=["asc","desc",null],DI=class extends U{constructor(){super(...arguments),this.beanName="sortController"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.showRowGroupColsService=e.showRowGroupColsService}progressSort(e,t,r){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,r)}setSortForColumn(e,t,r,i){"asc"!==t&&"desc"!==t&&(t=null);let n=[e];if(Jr(this.gos)&&e.getColDef().showRowGroup){const c=this.funcColsService.getSourceColumnsForGroupColumn(e)?.filter(d=>d.isSortable());c&&(n=[e,...c])}n.forEach(l=>l.setSort(t,i));const a=[];if(!r&&!this.gos.get("alwaysMultiSort")||this.gos.get("suppressMultiSort")){const l=this.clearSortBarTheseColumns(n,i);a.push(...l)}this.updateSortIndex(e),a.push(...n),this.dispatchSortChangedEvents(i,a)}updateSortIndex(e){const t=Jr(this.gos),r=this.showRowGroupColsService?.getShowRowGroupCol(e.getId()),i=t&&r||e,s=this.getColumnsWithSortingOrdered();this.columnModel.getAllCols().forEach(a=>a.setSortIndex(null));const n=s.filter(a=>!(t&&a.getColDef().showRowGroup||a===i));(i.getSort()?[...n,i]:n).forEach((a,l)=>{a.setSortIndex(l)})}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const t=this.columnModel.getAllCols().filter(r=>!!r.getSort());return t&&t.length>0}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventService.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.columnModel.getAllCols().forEach(i=>{e.includes(i)||(i.getSort()&&r.push(i),i.setSort(void 0,t))}),r}getNextSortDirection(e){let t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gos.get("sortingOrder")?this.gos.get("sortingOrder"):E0,!Array.isArray(t)||t.length<=0)return q(`sortingOrder must be an array with at least one element, currently it's ${t}`),null;const r=t.indexOf(e.getSort());let n;return n=r<0||r==t.length-1?t[0]:t[r+1],E0.indexOf(n)<0?(q("invalid sort type ",n),null):n}getIndexedSortMap(){let e=this.columnModel.getAllCols().filter(n=>!!n.getSort());if(this.columnModel.isPivotMode()){const n=Jr(this.gos);e=e.filter(o=>{const a=!!o.getAggFunc(),l=!o.isPrimary(),c=n?this.showRowGroupColsService?.getShowRowGroupCol(o.getId()):o.getColDef().showRowGroup;return a||l||c})}const t=this.funcColsService.getRowGroupColumns().filter(n=>!!n.getSort()),r={};e.forEach((n,o)=>r[n.getId()]=o),e.sort((n,o)=>{const a=n.getSortIndex(),l=o.getSortIndex();return null!=a&&null!=l?a-l:null==a&&null==l?r[n.getId()]>r[o.getId()]?1:-1:null==l?-1:1});const i=Jr(this.gos)&&!!t.length;i&&(e=[...new Set(e.map(n=>this.showRowGroupColsService?.getShowRowGroupCol(n.getId())??n))]);const s=new Map;return e.forEach((n,o)=>s.set(n,o)),i&&t.forEach(n=>{const o=this.showRowGroupColsService.getShowRowGroupCol(n.getId());s.set(n,s.get(o))}),s}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([e,t],[r,i])=>t-i).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=Jr(this.gos),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){const t=this.funcColsService.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const i=null!=e.getColDef().field||e.getColDef().valueGetter?[e,...t]:t,s=i[0].getSort();return i.every(o=>o.getSort()==s)?s:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}},AI=class extends U{constructor(){super(...arguments),this.beanName="syncService",this.waitingForColumns=!1}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.rowModel=e.rowModel}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.ctrlsService.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){this.columnModel.setColumnDefs(e??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.eventService.dispatchEvent({type:"gridReady"});const e=this.gos.isModuleRegistered("@ag-grid-enterprise/core");this.gos.get("debug")&&Rr(`initialised successfully, enterprise = ${e}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns)return this.waitingForColumns=!1,void this.setColumnsAndData(t);this.columnModel.setColumnDefs(t,Cs(e.source))}}},MI=class extends U{constructor(){super(...arguments),this.beanName="changeDetectionService"}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer}postConstruct(){it(this.gos)&&(this.clientSideRowModel=this.rowModel),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const r=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const i=this.gos.get("aggregateOnlyChangedColumns"),s=new Ba(i,this.clientSideRowModel.getRootNode());s.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(s),s.forEachChangedNodeDepthFirst(n=>{r.push(n)})}this.rowRenderer.refreshCells({rowNodes:r})}},II=class extends U{constructor(){super(...arguments),this.beanName="expressionService",this.expressionToFunctionCache={}}evaluate(e,t){if("string"==typeof e)return this.evaluateExpression(e,t);Me("value should be either a string or a function",e)}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return Rr("Processing of the expression failed"),Rr("Expression = ",e),Rr("Params = ",t),Rr("Exception = ",r),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),r=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=r,r}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},LI=class extends U{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,r){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=r)}getValue(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}},_I=class extends U{constructor(){super(...arguments),this.beanName="valueService",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionService=e.expressionService,this.columnModel=e.columnModel,this.valueCache=e.valueCache,this.dataTypeService=e.dataTypeService}postConstruct(){this.initialised||this.init()}init(){this.isSsrm=pi(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=r=>this.callColumnCellValueChangedHandler(r),t=na(this.gos);this.eventService.addEventListener("cellValueChanged",e,t),this.addDestroyFunc(()=>this.eventService.removeEventListener("cellValueChanged",e,t)),this.addManagedPropertyListener("treeData",r=>this.isTreeData=r.currentValue)}getValueForDisplay(e,t){const r=t.leafGroup&&this.columnModel.isPivotMode(),i=t.group&&t.expanded&&!t.footer&&!r,s=this.gos.get("groupSuppressBlankHeader");if(!i||s)return this.getValue(e,t);let n=!1;const o=this.gos.get("groupTotalRow")??this.gos.get("groupIncludeFooter");return n="function"!=typeof o?!!o:!!(this.gos.getCallback("groupTotalRow")??this.gos.getCallback("groupIncludeFooter"))({node:this}),this.getValue(e,t,!1,i&&n)}getValue(e,t,r=!1,i=!1){if(this.initialised||this.init(),!t)return;const s=e.getColDef(),n=s.field,o=e.getColId(),a=t.data;let l;const c=t.groupData&&void 0!==t.groupData[o],d=!i&&t.aggData&&void 0!==t.aggData[o],u=this.isSsrm&&i&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(r&&s.filterValueGetter?l=this.executeFilterValueGetter(s.filterValueGetter,a,e,t):this.isTreeData&&d?l=t.aggData[o]:this.isTreeData&&s.valueGetter?l=this.executeValueGetter(s.valueGetter,a,e,t):this.isTreeData&&n&&a?l=Qn(a,n,e.isFieldContainsDots()):c?l=t.groupData[o]:d?l=t.aggData[o]:s.valueGetter?l=this.executeValueGetter(s.valueGetter,a,e,t):h?l=Qn(a,t.field,e.isFieldContainsDots()):n&&a&&!u&&(l=Qn(a,n,e.isFieldContainsDots())),this.cellExpressions&&"string"==typeof l&&0===l.indexOf("=")){const g=l.substring(1);l=this.executeValueGetter(g,a,e,t)}if(null==l){const g=this.getOpenedGroup(t,e);if(null!=g)return g}return l}parseValue(e,t,r,i){const s=e.getColDef(),n=s.valueParser;if(te(n)){const o=this.gos.addGridCommonParams({node:t,data:t?.data,oldValue:i,newValue:r,colDef:s,column:e});return"function"==typeof n?n(o):this.expressionService.evaluate(n,o)}return r}getDeleteValue(e,t){return te(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t))??null:null}formatValue(e,t,r,i,s=!0){let o,n=null;const a=e.getColDef();if(i?o=i:s&&(o=a.valueFormatter),o){const l=this.gos.addGridCommonParams({value:r,node:t,data:t?t.data:null,colDef:a,column:e});n="function"==typeof o?o(l):this.expressionService.evaluate(o,l)}else if(a.refData)return a.refData[r]||"";return null==n&&Array.isArray(r)&&(n=r.join(", ")),n}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup")||!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let s=e.parent;for(;null!=s;){if(s.rowGroupColumn&&(!0===i||i===s.rowGroupColumn.getColId()))return s.key;s=s.parent}}setValue(e,t,r,i){const s=this.columnModel.getColDefCol(t);if(!e||!s)return!1;Ie(e.data)&&(e.data={});const{field:n,valueSetter:o}=s.getColDef();if(Ie(n)&&Ie(o))return q("you need either field or valueSetter set on colDef for editing to work"),!1;if(this.dataTypeService&&!this.dataTypeService.checkType(s,r))return q("Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(s,e),newValue:r,colDef:s.getColDef(),column:s});let l;if(a.newValue=r,l=te(o)?"function"==typeof o?o(a):this.expressionService.evaluate(o,a):this.setValueUsingField(e.data,n,r,s.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged();const c=this.getValue(s,e);return this.eventService.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:c,value:c,source:i}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"==typeof t&&this.getFrameworkOverrides().wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,r,i){if(!t)return!1;let s=!1;if(i){const n=t.split(".");let o=e;for(;n.length>0&&o;){const a=n.shift();0===n.length?(s=o[a]===r,s||(o[a]=r)):o=o[a]}}else s=e[t]===r,s||(e[t]=r);return!s}executeFilterValueGetter(e,t,r,i){const s=this.gos.addGridCommonParams({data:t,node:i,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,i)});return"function"==typeof e?e(s):this.expressionService.evaluate(e,s)}executeValueGetter(e,t,r,i){const s=r.getColId(),n=this.valueCache.getValue(i,s);if(void 0!==n)return n;const o=this.gos.addGridCommonParams({data:t,node:i,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,i)});let a;return a="function"==typeof e?e(o):this.expressionService.evaluate(e,o),this.valueCache.setValue(i,s,a),a}getValueCallback(e,t){const r=this.columnModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),i=e.getColDef().keyCreator;let s=r;return i&&(s=i(this.gos.addGridCommonParams({value:r,colDef:e.getColDef(),column:e,node:t,data:t.data}))),"string"==typeof s||null==s||(s=String(s),"[object Object]"===s&&q("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),s}},bd=class As{static applyGlobalGridOptions(t){if(!As.gridOptions)return t;let r={};return Qt(r,As.gridOptions,!0,!0),"deep"===As.mergeStrategy?Qt(r,t,!0,!0):r={...r,...t},As.gridOptions.context&&(r.context=As.gridOptions.context),t.context&&("deep"===As.mergeStrategy&&r.context&&Qt(t.context,r.context,!0,!0),r.context=t.context),r}};bd.gridOptions=void 0,bd.mergeStrategy="shallow";var Na=bd,BI=1,R0=class extends U{constructor(){super(...arguments),this.beanName="rowModelHelperService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){const e=this.rowModel;switch(e.getType()){case"clientSide":this.clientSideRowModel=e;break;case"infinite":this.infiniteRowModel=e;break;case"serverSide":this.serverSideRowModel=e}}getClientSideRowModel(){return this.clientSideRowModel}getInfiniteRowModel(){return this.infiniteRowModel}getServerSideRowModel(){return this.serverSideRowModel}},UI={version:xe,moduleName:"@ag-grid-community/csrm-ssrm-shared-api",apiFunctions:{expandAll:function NI(e){e.expansionService.expandAll(!0)},collapseAll:function GI(e){e.expansionService.expandAll(!1)},onRowHeightChanged:function HI(e){const t=e.rowModelHelperService?.getClientSideRowModel(),r=e.rowModelHelperService?.getServerSideRowModel();t?t.onRowHeightChanged():r&&r.onRowHeightChanged()}}},jI={version:xe,moduleName:"@ag-grid-community/ssrm-infinite-shared-api",apiFunctions:{setRowCount:function zI(e,t,r){const i=e.rowModelHelperService?.getServerSideRowModel();if(i)return e.funcColsService.isRowGroupEmpty()?void i.setRowCount(t,r):void Me("setRowCount cannot be used while using row grouping.");const s=e.rowModelHelperService?.getInfiniteRowModel();s&&s.setRowCount(t,r)},getCacheBlockState:function VI(e){return e.rowNodeBlockLoader?.getBlockState()??{}},isLastRowIndexKnown:function WI(e){return e.rowModel.isLastRowIndexKnown()}}},$I=class{wrap(e,t,r=[],i){const s=this.createWrapper(e,i);return t.forEach(n=>{this.createMethod(s,n,!0)}),r.forEach(n=>{this.createMethod(s,n,!1)}),s}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&q("Framework component is missing the method "+t+"()"),null)}}},Ed=class{};Ed.CHART_TYPE_TO_SERIES_TYPE={column:"bar",groupedColumn:"bar",stackedColumn:"bar",normalizedColumn:"bar",bar:"bar",groupedBar:"bar",stackedBar:"bar",normalizedBar:"bar",line:"line",scatter:"scatter",bubble:"bubble",pie:"pie",donut:"donut",doughnut:"donut",area:"area",stackedArea:"area",normalizedArea:"area",histogram:"histogram",radarLine:"radar-line",radarArea:"radar-area",nightingale:"nightingale",radialColumn:"radial-column",radialBar:"radial-bar",sunburst:"sunburst",rangeBar:"range-bar",rangeArea:"range-area",boxPlot:"box-plot",treemap:"treemap",heatmap:"heatmap",waterfall:"waterfall"},Ed.COMBO_CHART_TYPES=["columnLineCombo","areaColumnCombo","customCombo"],Ed.SERIES_GROUP_TYPES=["grouped","stacked","normalized"];var dn=typeof global>"u"?{}:global;dn.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement,dn.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement,dn.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement,dn.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement,dn.Node=typeof Node>"u"?{}:Node,dn.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var Rd="32.2.1",k0={version:Rd,moduleName:"@ag-grid-community/client-side-row-model-core",rowModel:"clientSide",beans:[class extends U{constructor(){super(...arguments),this.beanName="rowModel",this.onRowHeightChanged_debounced=Yt(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.selectionService=e.selectionService,this.valueCache=e.valueCache,this.environment=e.environment,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggregationStage=e.aggregationStage,this.pivotStage=e.pivotStage,this.filterAggregatesStage=e.filterAggregatesStage}postConstruct(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),r=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedEventListeners({newColumnsLoaded:r,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Si(this.beans),this.nodeManager=new class{constructor(e,t,r,i,s,n){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=t,this.eventService=r,this.funcColsService=i,this.beans=n,this.selectionService=s,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id="ROOT_NODE_ID",this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return Tf(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"==typeof e)return void q("rowData must be an array.");this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,r=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map((i,s)=>this.createNode(i,this.rootNode,0,s)):(t.allLeafChildren=[],t.childrenAfterGroup=[]),r&&(r.childrenAfterFilter=t.childrenAfterFilter,r.childrenAfterGroup=t.childrenAfterGroup,r.childrenAfterAggFilter=t.childrenAfterAggFilter,r.childrenAfterSort=t.childrenAfterSort,r.childrenMapped=t.childrenMapped,r.allLeafChildren=t.allLeafChildren)}updateRowData(e){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const t={rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},r=[];return this.executeRemove(e,t,r),this.executeUpdate(e,t,r),this.executeAdd(e,t),this.updateSelection(r,"rowDataChanged"),t}updateRowOrderFromRowData(e){const t=this.rootNode.allLeafChildren,r=t?.length??0,i=new Map;let s=-1,n=-1;for(let o=0;o<r;++o){const a=t[o],l=a.data;l!==e[o]&&(n<0&&(s=o),n=o,i.set(l,a))}if(s<0)return!1;for(let o=s;o<=n;++o){const a=i.get(e[o]);void 0!==a&&(t[o]=a,a.sourceRowIndex=o)}return!0}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){this.eventService.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}updateSelection(e,t){const r=e.length>0;r&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),r&&this.eventService.dispatchEvent({type:"selectionChanged",source:t})}executeAdd(e,t){const r=e.add;if(rr(r))return;const i=this.rootNode.allLeafChildren;let s=i.length;if("number"==typeof e.addIndex&&(s=this.sanitizeAddIndex(e.addIndex),s>0&&this.gos.get("treeData")))for(let l=0;l<i.length;l++)if(i[l]?.rowIndex==s-1){s=l+1;break}const n=r.map((a,l)=>this.createNode(a,this.rootNode,0,s+l));if(s<i.length){const a=i.slice(0,s),l=i.slice(s,i.length),c=a.length+n.length;for(let d=0,u=l.length;d<u;++d)l[d].sourceRowIndex=c+d;this.rootNode.allLeafChildren=[...a,...n,...l],t.rowsInserted=!0}else this.rootNode.allLeafChildren=i.concat(n);const o=this.rootNode.sibling;o&&(o.allLeafChildren=i),t.rowNodeTransaction.add=n}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}executeRemove(e,{rowNodeTransaction:t},r){const{remove:i}=e;if(rr(i))return;const s={};i.forEach(o=>{const a=this.lookupRowNode(o);a&&(a.isSelected()&&r.push(a),a.clearRowTopAndRowIndex(),s[a.id]=!0,delete this.allNodesMap[a.id],t.remove.push(a))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren?.filter(o=>!s[o.id])??null,this.rootNode.allLeafChildren?.forEach((o,a)=>{o.sourceRowIndex=a});const n=this.rootNode.sibling;n&&(n.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,{rowNodeTransaction:t},r){const{update:i}=e;rr(i)||i.forEach(s=>{const n=this.lookupRowNode(s);n&&(n.updateData(s),!n.selectable&&n.isSelected()&&r.push(n),this.setMasterForRow(n,s,0,!1),t.update.push(n))})}lookupRowNode(e){const t=Xs(this.gos);let r;if(t){const i=t({data:e,level:0});if(r=this.allNodesMap[i],!r)return Me(`could not find row id=${i}, data item was not found for this id`),null}else if(r=this.rootNode.allLeafChildren?.find(i=>i.data===e),!r)return Me("could not find data item as object was not found",e),Me("Consider using getRowId to help the Grid find matching row data"),null;return r||null}createNode(e,t,r,i){const s=new Si(this.beans);return s.sourceRowIndex=i,s.group=!1,this.setMasterForRow(s,e,r,!0),t&&(s.parent=t),s.level=r,s.setDataAndId(e,this.nextId.toString()),this.allNodesMap[s.id]&&q(`duplicate node id '${s.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[s.id]=s,this.nextId++,s}setMasterForRow(e,t,r,i){if(this.gos.get("treeData"))e.setMaster(!1),i&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const o=this.gos.get("isRowMaster");e.setMaster(!o||o(t))}else e.setMaster(!1);if(i){const o=this.funcColsService.getRowGroupColumns();e.expanded=!!e.master&&this.isExpanded(r+(o?o.length:0))}}}isExpanded(e){const t=this.gos.get("groupDefaultExpanded");return-1===t||e<t}}(this.rootNode,this.gos,this.eventService,this.funcColsService,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),r=new Set(["excludeChildrenWhenTreeDataFiltering"]),i=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),s=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),n=new Set(["postSortRows","groupDisplayType","accentedSort"]),o=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...r,...i,...i,...s,...n,...o,...a];this.addManagedPropertyListeners(l,c=>{const d=c.changeSet?.properties;if(!d)return;const u=h=>d.some(g=>h.has(g));u(e)?this.setRowData(this.rootNode.allLeafChildren.map(h=>h.data)):u(t)?this.refreshModel({step:"group"}):u(r)?this.refreshModel({step:"filter"}):u(i)?this.refreshModel({step:"pivot"}):u(s)?this.refreshModel({step:"aggregate"}):u(n)?this.refreshModel({step:"sort"}):u(o)?this.refreshModel({step:"filter_aggregates"}):u(a)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,r,i){let s,n=!1;do{s=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,r),c=Math.min(a,i);for(let d=l;d<=c;d++){const u=this.getRow(d);if(u.rowHeightEstimated){const h=Ni(this.gos,u);u.setRowHeight(h.height),s=!0,n=!0}}s&&this.setRowTopAndRowIndex()}while(s);return n}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const r=new Set,i=Pt(this.gos,"normal");for(let s=0;s<this.rowsToDisplay.length;s++){const n=this.rowsToDisplay[s];if(null!=n.id&&r.add(n.id),null==n.rowHeight){const o=Ni(this.gos,n,i,e);n.setRowHeight(o.height,o.estimated)}n.setRowTop(t),n.setRowIndex(s),t+=n.rowHeight}return r}clearRowTopAndRowIndex(e,t){const r=e.isActive(),i=n=>{n&&null!=n.id&&!t.has(n.id)&&n.clearRowTopAndRowIndex()},s=n=>{i(n),i(n.detailNode),i(n.sibling),n.hasChildren()&&n.childrenAfterGroup&&(r&&-1!=n.level&&!n.expanded||n.childrenAfterGroup.forEach(s))};s(this.rootNode)}ensureRowsAtPixel(e,t,r=0){const i=this.getRowIndexAtPixel(t),s=this.getRow(i),n=!this.gos.get("suppressAnimationFrame");if(s===e[0])return!1;const o=this.rootNode.allLeafChildren;return e.forEach(a=>{qt(o,a)}),e.forEach((a,l)=>{Xn(o,a,Math.max(i+r,0)+l)}),e.forEach((a,l)=>{a.sourceRowIndex=l}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:n,rowNodesOrderChanged:!0}),!0}highlightRowAtPixel(e,t){const r=null!=t?this.getRowIndexAtPixel(t):null,i=null!=r?this.getRow(r):null;if(!i||!e||i===e||null==t)return void(this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null));const s=this.getHighlightPosition(t,i);this.lastHighlightedRow&&this.lastHighlightedRow!==i&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),i.setHighlighted(s),this.lastHighlightedRow=i}getHighlightPosition(e,t){if(!t){const s=this.getRowIndexAtPixel(e);if(!(t=this.getRow(s||0)))return 1}const{rowTop:r,rowHeight:i}=t;return e-r<i/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(0===this.rowsToDisplay.length)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const t=this.rootNode.childrenAfterAggFilter;return(t?t.length:0)+(this.rootNode.sibling?1:0)}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let r=e;if(this.rowsToDisplay[0].footer){if(0===e)return 0;r-=1}const i=this.rowsToDisplay[this.rowsToDisplay.length-1];if(i.footer&&r>=this.rootNode.childrenAfterSort.length)return i.rowIndex;let n=this.rootNode.childrenAfterSort[r];if(this.gos.get("groupHideOpenParents"))for(;n.expanded&&n.childrenAfterSort&&n.childrenAfterSort.length>0;)n=n.childrenAfterSort[0];return n.rowIndex}getRowBounds(e){if(Ie(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=qs(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=qs(this.gos),i=0===e.columns.length||e.columns.some(s=>s.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=qs(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=rr(e),r=new Ba(!1,this.rootNode);return t&&r.setInactive(),r}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction")||null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter(i=>null!=i.add&&i.add.length>0||null!=i.remove&&i.remove.length>0);return null==t||0==t.length}buildRefreshModelParams(e){let t="group";const r={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(te(e)&&(t=r[e]),!Ie(t))return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gos.get("suppressAnimationFrame")};Me(`invalid step ${e}, available steps are ${Object.keys(r).join(", ")}`)}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.isChangeEventsDispatching())return;const t="object"==typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t||this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const r=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,r,!!t.rowNodesOrderChanged,!!t.afterColumnsChanged);case"filter":this.doFilter(r);case"pivot":this.doPivot(r);case"aggregate":this.doAggregate(r);case"filter_aggregates":this.doFilterAggregates(r);case"sort":this.doSort(t.rowNodeTransactions,r);case"map":this.doRowsToDisplay()}const i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(r,i),this.isRefreshingModel=!1,this.eventService.dispatchEvent({type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack})}isEmpty(){const e=Ie(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return Ie(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return te(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let r=!1,i=!1;const s=[],n=ms(this.gos);return this.forEachNodeAfterFilterAndSort(o=>{if(!i)if(r&&(o===t||o===e)&&(i=!0,o.group&&n))s.push(...o.allLeafChildren);else{if(!r){if(o!==t&&o!==e)return;r=!0}o.group&&n||s.push(o)}}),s}setDatasource(e){Me("should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let t=0,r=this.rowsToDisplay.length-1;if(e<=0)return 0;if(Le(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let s=-1,n=-1;for(;;){const o=Math.floor((t+r)/2),a=this.rowsToDisplay[o];if(this.isRowInPixel(a,e)||(a.rowTop<e?t=o+1:a.rowTop>e&&(r=o-1),s===t&&n===r))return o;s=t,n=r}}isRowInPixel(e,t){return e.rowTop<=t&&e.rowTop+e.rowHeight>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((t,r)=>e(t,r))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:r,recursionType:i,includeFooterNodes:s}=e;let{index:n}=e;const o=a=>{const l=t[0]?.parent;if(!l)return;const c=s&&vf(this.gos),d=Cf(this.gos),u=s&&d({node:l});l!==this.rootNode?u===a&&(l.createFooter(),r(l.sibling,n++)):c===a&&(l.createFooter(),r(l.sibling,n++))};o("top");for(let a=0;a<t.length;a++){const l=t[a];if(r(l,n++),l.hasChildren()&&!l.footer){let c=null;switch(i){case 0:c=l.childrenAfterGroup;break;case 1:c=l.childrenAfterAggFilter;break;case 2:c=l.childrenAfterSort;break;case 3:c=l.leafGroup?null:l.childrenAfterSort}c&&(n=this.recursivelyWalkNodesAndCallback({nodes:[...c],callback:r,recursionType:i,index:n,includeFooterNodes:s}))}}return o("bottom"),n}doAggregate(e){this.aggregationStage?.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),r=this.columnModel.isPivotActive(),i=s=>{s&&s.forEach(n=>{const o=()=>{n.expanded=e,i(n.childrenAfterGroup)};t?te(n.childrenAfterGroup)&&o():r?!n.leafGroup&&o():n.group&&o()})};this.rootNode&&i(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"}),this.eventService.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,r,i){if(this.groupStage)this.groupStage.execute(e?{rowNode:this.rootNode,rowNodeTransactions:e,rowNodesOrderChanged:r,changedPath:t}:{rowNode:this.rootNode,changedPath:t,afterColumnsChanged:i}),ms(this.gos)&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",t)&&this.eventService.dispatchEvent({type:"selectionChanged",source:"rowGroupChanged"});else{const s=this.rootNode,n=s.sibling;s.childrenAfterGroup=s.allLeafChildren,n&&(n.childrenAfterGroup=s.childrenAfterGroup),this.rootNode.updateHasChildren()}this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getNodeManager(){return this.nodeManager}getRowNode(e){if("string"==typeof e&&0==e.indexOf(Si.ID_PREFIX_ROW_GROUP)){let r;return this.forEachNode(i=>{i.id===e&&(r=i)}),r}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const r=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.isAlive()&&this.executeBatchUpdateRowData()},r)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let r=!1;this.rowDataTransactionBatch?.forEach(i=>{const{rowNodeTransaction:s,rowsInserted:n}=this.nodeManager.updateRowData(i.rowDataTransaction);n&&(r=!0),t.push(s),i.callback&&e.push(i.callback.bind(null,s))}),this.commonUpdateRowData(t,r),e.length>0&&window.setTimeout(()=>{e.forEach(i=>i())},0),t.length>0&&this.eventService.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache.onDataChanged();const{rowNodeTransaction:t,rowsInserted:r}=this.nodeManager.updateRowData(e);return this.commonUpdateRowData([t],r),t}afterImmutableDataChange(e,t){this.commonUpdateRowData([e],t)}commonUpdateRowData(e,t){if(!this.hasStarted)return;const r=!this.gos.get("suppressAnimationFrame");this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodesOrderChanged:t,keepRenderedRows:!0,keepEditingRows:!0,animate:r})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const r=t.detailNode;r&&r.setRowHeight(r.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.columnModel.isAutoRowHeightActive())return;this.resetRowHeights()}}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}},class extends U{constructor(){super(...arguments),this.beanName="filterStage"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const r=(i,s)=>{i.childrenAfterFilter=i.hasChildren()&&e&&!s?i.childrenAfterGroup.filter(n=>{const o=n.childrenAfterFilter&&n.childrenAfterFilter.length>0,a=n.data&&this.filterManager.doesRowPassFilter({rowNode:n});return o||a}):i.childrenAfterGroup,i.sibling&&(i.sibling.childrenAfterFilter=i.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const i=(n,o)=>{if(n.childrenAfterGroup)for(let a=0;a<n.childrenAfterGroup.length;a++){const l=n.childrenAfterGroup[a],c=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?i(n.childrenAfterGroup[a],c):r(l,c)}r(n,o)};t.executeFromRootNode(n=>i(n,!1))}else t.forEachChangedNodeDepthFirst(s=>r(s,!1),!0)}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},class extends U{constructor(){super(...arguments),this.beanName="sortStage"}wireBeans(e){this.sortService=e.sortService,this.sortController=e.sortController}execute(e){const t=this.sortController.getSortOptions(),r=te(t)&&t.length>0,i=r&&te(e.rowNodeTransactions)&&this.gos.get("deltaSort"),s=t.some(n=>Jr(this.gos)?n.column.isPrimary()&&n.column.isRowGroupActive():!!n.column.getColDef().showRowGroup);this.sortService.sort(t,r,i,e.rowNodeTransactions,e.changedPath,s)}},class extends U{constructor(){super(...arguments),this.beanName="flattenStage"}wireBeans(e){this.beans=e,this.columnModel=e.columnModel}execute(e){const t=e.rowNode,r=[],i=this.columnModel.isPivotMode(),s=i&&t.leafGroup,n=s?[t]:t.childrenAfterSort,o=this.getFlattenDetails();return this.recursivelyAddToRowsToDisplay(o,n,r,i,0),!s&&r.length>0&&o.grandTotalRow&&(t.createFooter(),this.addRowNodeToRowsToDisplay(o,t.sibling,r,0,"top"===o.grandTotalRow)),r}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:wf(this.gos),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:vf(this.gos),groupTotalRow:Cf(this.gos)}}recursivelyAddToRowsToDisplay(e,t,r,i,s){if(!rr(t))for(let n=0;n<t.length;n++){const o=t[n],a=o.hasChildren(),c=e.groupRemoveSingleChildren&&a&&1===o.childrenAfterGroup.length,d=e.groupRemoveLowestSingleChildren&&a&&o.leafGroup&&1===o.childrenAfterGroup.length;if(!(i&&!a)&&!(e.hideOpenParents&&o.expanded&&!o.master&&(!i||!o.leafGroup))&&!c&&!d&&this.addRowNodeToRowsToDisplay(e,o,r,s),!i||!o.leafGroup)if(a){const p=c||d;if(o.expanded||p){const f=e.groupTotalRow({node:o});f||o.destroyFooter();const m=p?s:s+1;"top"===f&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,r,m)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,r,i,m),"bottom"===f&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,r,m))}}else if(o.master&&o.expanded){const p=this.createDetailNode(o);this.addRowNodeToRowsToDisplay(e,p,r,s)}}}addRowNodeToRowsToDisplay(e,t,r,i,s){s?r.unshift(t):r.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:i)}createDetailNode(e){if(te(e.detailNode))return e.detailNode;const t=new Si(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,te(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}},class extends U{constructor(){super(...arguments),this.beanName="sortService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.rowNodeSorter=e.rowNodeSorter,this.showRowGroupColsService=e.showRowGroupColsService}sort(e,t,r,i,s,n){const o=this.gos.get("groupMaintainOrder"),a=this.columnModel.getCols().some(h=>h.isRowGroupActive());let l={};r&&i&&(l=this.calculateDirtyNodes(i));const c=this.columnModel.isPivotMode(),d=this.gos.getCallback("postSortRows");s&&s.forEachChangedNodeDepthFirst(h=>{this.pullDownGroupDataForHideOpenParents(h.childrenAfterAggFilter,!0);const g=c&&h.leafGroup;if(o&&a&&!h.leafGroup&&!n){const m=null===this.funcColsService.getRowGroupColumns()?.[h.level+1]?.getSort(),w=h.childrenAfterAggFilter.slice(0);if(h.childrenAfterSort&&!m){const C={};h.childrenAfterSort.forEach((v,k)=>{C[v.id]=k}),w.sort((v,k)=>(C[v.id]??0)-(C[k.id]??0))}h.childrenAfterSort=w}else h.childrenAfterSort=!t||g?h.childrenAfterAggFilter.slice(0):r?this.doDeltaSort(h,l,s,e):this.rowNodeSorter.doFullSort(h.childrenAfterAggFilter,e);h.sibling&&(h.sibling.childrenAfterSort=h.childrenAfterSort),this.updateChildIndexes(h),d&&d({nodes:h.childrenAfterSort})}),this.updateGroupDataForHideOpenParents(s)}calculateDirtyNodes(e){const t={},r=i=>{i&&i.forEach(s=>t[s.id]=!0)};return e&&e.forEach(i=>{r(i.add),r(i.update),r(i.remove)}),t}doDeltaSort(e,t,r,i){const s=e.childrenAfterAggFilter,n=e.childrenAfterSort;if(!n)return this.rowNodeSorter.doFullSort(s,i);const o={},a=[];s.forEach(u=>{t[u.id]||!r.canSkip(u)?a.push(u):o[u.id]=!0});const l=n.filter(u=>o[u.id]),c=(u,h)=>({currentPos:h,rowNode:u}),d=a.map(c).sort((u,h)=>this.rowNodeSorter.compareRowNodes(i,u,h));return this.mergeSortedArrays(i,d,l.map(c)).map(({rowNode:u})=>u)}mergeSortedArrays(e,t,r){const i=[];let s=0,n=0;for(;s<t.length&&n<r.length;)this.rowNodeSorter.compareRowNodes(e,t[s],r[n])<0?i.push(t[s++]):i.push(r[n++]);for(;s<t.length;)i.push(t[s++]);for(;n<r.length;)i.push(r[n++]);return i}updateChildIndexes(e){if(Ie(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let r=0;r<t.length;r++){const i=t[r],n=r===e.childrenAfterSort.length-1;i.setFirstChild(0===r),i.setLastChild(n),i.setChildIndex(r)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return q("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=r=>{this.pullDownGroupDataForHideOpenParents(r.childrenAfterSort,!1),r.childrenAfterSort.forEach(i=>{i.hasChildren()&&t(i)})};e&&e.executeFromRootNode(r=>t(r))}pullDownGroupDataForHideOpenParents(e,t){!this.gos.get("groupHideOpenParents")||Ie(e)||e.forEach(r=>{(this.showRowGroupColsService?.getShowRowGroupCols()??[]).forEach(s=>{const n=s.getColDef().showRowGroup;if("string"!=typeof n)return void Me("groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const a=this.columnModel.getColDefCol(n);if(a!==r.rowGroupColumn)if(t)r.setGroupValue(s.getId(),void 0);else{const c=this.getFirstChildOfFirstChild(r,a);c&&r.setGroupValue(s.getId(),c.key)}})})}getFirstChildOfFirstChild(e,t){let r=e;for(;r;){const i=r.parent;if(!i||!r.firstChild)return null;if(i.rowGroupColumn===t)return i;r=i}return null}},class extends U{constructor(){super(...arguments),this.beanName="immutableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){it(this.gos)&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const e=this.gos.exists("getRowId");return!this.gos.get("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const r=this.clientSideRowModel.getNodeManager(),{rowNodeTransaction:i,rowsInserted:s}=r.updateRowData(t);let n=!1;this.gos.get("suppressMaintainUnsortedOrder")||(n=r.updateRowOrderFromRowData(e)),this.clientSideRowModel.afterImmutableDataChange(i,n||s)}createTransactionForRowData(e){if(!it(this.gos))return Me("ImmutableService only works with ClientSideRowModel"),null;const t=Xs(this.gos);if(null==t)return Me("ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!"),null;const r=this.clientSideRowModel.getNodeManager().getCopyOfNodesMap(),i=[],s=[],n=[];return te(e)&&e.forEach(o=>{const a=t({data:o,level:0}),l=r[a];l?(l.data!==o&&s.push(o),r[a]=void 0):n.push(o)}),kr(r,(o,a)=>{a&&i.push(a.data)}),{remove:i,update:s,add:n}}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}}]},f8={version:Rd,moduleName:"@ag-grid-community/client-side-row-model",dependantModules:[k0,{version:Rd,moduleName:"@ag-grid-community/client-side-row-model-api",beans:[R0],apiFunctions:{onGroupExpandedOrCollapsed:function QI(e){e.expansionService.onGroupExpandedOrCollapsed()},refreshClientSideRowModel:function ZI(e,t){e.rowModelHelperService?.getClientSideRowModel()?.refreshModel(t)},isRowDataEmpty:function JI(e){return e.rowModelHelperService?.getClientSideRowModel()?.isEmpty()??!0},forEachLeafNode:function e8(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachLeafNode(t)},forEachNodeAfterFilter:function t8(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilter(t)},forEachNodeAfterFilterAndSort:function r8(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilterAndSort(t)},resetRowHeights:function i8(e){e.columnModel.isAutoRowHeightActive()?q("calling gridApi.resetRowHeights() makes no sense when using Auto Row Height."):e.rowModelHelperService?.getClientSideRowModel()?.resetRowHeights()},applyTransaction:function s8(e,t){return e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.updateRowData(t))},applyTransactionAsync:function n8(e,t,r){e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.batchUpdateRowData(t,r))},flushAsyncTransactions:function o8(e){e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.flushAsyncTransactions())},getBestCostNodeSelection:function a8(e){return e.selectionService.getBestCostNodeSelection()}},dependantModules:[k0,UI]}]},p8=class extends U{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return(null==e||!e.length)&&(e=this.getDefaultFileName()),-1===e.indexOf(".")?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},m8=class{constructor(e){this.groupColumns=[];const{columnModel:t,funcColsService:r,columnNameService:i,valueService:s,gos:n,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.funcColsService=r,this.columnNameService=i,this.valueService=s,this.gos=n,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,r,i,s){const o=this.gos.get("groupHideOpenParents")&&!s.footer||!this.shouldRenderGroupSummaryCell(s,e,t)?this.valueService.getValue(e,s):this.createValueForGroupNode(e,s);return this.processCell({accumulatedRowIndex:r,rowNode:s,column:e,value:o,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,r){if(!e||!e.group)return!1;if(-1!==this.groupColumns.indexOf(t)){if(null!=e.groupData?.[t.getId()]||pi(this.gos)&&e.group)return!0;if(e.footer&&-1===e.level){const o=t.getColDef();return null==o||!0===o.showRowGroup||o.showRowGroup===this.funcColsService.getRowGroupColumns()[0].getId()}}const n=aa(this.gos,this.columnModel.isPivotMode());return 0===r&&n}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnNameService.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const r=this.gos.get("treeData"),i=this.gos.get("suppressGroupMaintainValueType"),s=l=>{if(r||i)return l.key;const c=l.groupData?.[e.getId()];return c&&l.rowGroupColumn&&!1!==l.rowGroupColumn.getColDef().useValueFormatterForExport?this.valueService.formatValue(l.rowGroupColumn,l,c)??c:c},n=t.footer,o=[s(t)];if(!wf(this.gos))for(;t.parent;)o.push(s(t=t.parent));const a=o.reverse().join(" -> ");return n?`Total ${a}`:a}processCell(e){const{accumulatedRowIndex:t,rowNode:r,column:i,value:s,processCellCallback:n,type:o}=e;return n?{value:n(this.gos.addGridCommonParams({accumulatedRowIndex:t,column:i,node:r,value:s,type:o,parseValue:a=>this.valueService.parseValue(i,r,a,this.valueService.getValue(i,r)),formatValue:a=>this.valueService.formatValue(i,r,a)??a}))??""}:!1!==i.getColDef().useValueFormatterForExport?{value:s??"",valueFormatted:this.valueService.formatValue(i,r,s)}:{value:s??""}}},v8=class{static download(e,t){const r=document.defaultView||window;if(!r)return void q("There is no `window` associated with the current `document`");const i=document.createElement("a"),s=r.URL.createObjectURL(t);i.setAttribute("href",s),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:r})),document.body.removeChild(i),r.setTimeout(()=>{r.URL.revokeObjectURL(s)},0)}},C8=class extends m8{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:r}=e;this.suppressQuotes=t,this.columnSeparator=r}addCustomContent(e){e&&("string"==typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((r,i)=>{0!==i&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(r.data.value||""),r.mergeAcross&&this.appendEmptyCells(r.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,r,i){0!=r&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,r){0!=t&&(this.result+=this.columnSeparator);const i=this.extractRowCellValue(e,t,t,"csv",r);this.result+=this.putInQuotes(i.valueFormatted??i.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null==e)return'""';let t;return"string"==typeof e?t=e:"function"==typeof e.toString?t=e.toString():(q("unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}},kd="32.2.1",D0={version:kd,moduleName:"@ag-grid-community/csv-export-core",beans:[class extends p8{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.gridSerializer=e.gridSerializer}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void q("Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),r=this.getData(t),i=new Blob(["\ufeff",r],{type:"text/plain"}),s="function"==typeof t.fileName?t.fileName(this.gos.getGridCommonParams()):t.fileName;v8.download(this.getFileName(s),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const r=t?Object.assign({},e):this.getMergedParams(e);return this.getData(r)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,columnNameService:r,funcColsService:i,valueService:s,gos:n}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:d,columnSeparator:u}=e;return new C8({columnModel:t,columnNameService:r,funcColsService:i,valueService:s,gos:n,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:d||!1,columnSeparator:u||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}},class extends U{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.selectionService=e.selectionService,this.rowNodeSorter=e.rowNodeSorter,this.sortController=e.sortController}serialize(e,t={}){const{allColumns:r,columnKeys:i,skipRowGroups:s}=t,n=this.getColumnsToExport(r,s,i);return function CF(...e){return t=>e.reduce((r,i)=>i(r),t)}(this.prepareSession(n),this.prependContent(t),this.exportColumnGroups(t,n),this.exportHeaders(t,n),this.processPinnedTopRows(t,n),this.processRows(t,n),this.processPinnedBottomRows(t,n),this.appendContent(t))(e).parse()}processRow(e,t,r,i){const s=t.shouldRowBeSkipped||(()=>!1),n=this.gos.get("groupRemoveSingleChildren"),o=this.gos.get("groupRemoveLowestSingleChildren"),l=null!=t.rowPositions||!!t.onlySelected,c=this.gos.get("groupHideOpenParents")&&!l,d=this.columnModel.isPivotMode()?i.leafGroup:!i.group,u=!!i.footer,h=o&&i.leafGroup;if(!d&&!u&&(t.skipRowGroups||1===i.allChildrenCount&&1===i.childrenAfterGroup?.length&&(n||h)||c)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&"top"===i.rowPinned||t.skipPinnedBottom&&"bottom"===i.rowPinned||-1===i.level&&!d&&!u||s(this.gos.addGridCommonParams({node:i})))return;const m=e.onNewBodyRow(i);if(r.forEach((w,C)=>{m.onColumn(w,C,i)}),t.getCustomContentBelowRow){const w=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:i}));w&&e.addCustomContent(w)}}appendContent(e){return t=>{const r=e.appendContent;return r&&t.addCustomContent(r),t}}prependContent(e){return t=>{const r=e.prependContent;return r&&t.addCustomContent(r),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return r=>{if(!e.skipColumnGroupHeaders){const i=new _f,s=this.visibleColsService.createGroups({columns:t,idCreator:i,pinned:null,isStandaloneStructure:!0});this.recursivelyAddHeaderGroups(s,r,e.processGroupHeaderCallback)}return r}}exportHeaders(e,t){return r=>{if(!e.skipColumnHeaders){const i=r.onNewHeaderRow();t.forEach((s,n)=>{i.onColumn(s,n,void 0)})}return r}}processPinnedTopRows(e,t){return r=>{const i=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(s=>"top"===s.rowPinned).sort((s,n)=>s.rowIndex-n.rowIndex).map(s=>this.pinnedRowModel.getPinnedTopRow(s.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedRow("top",i),r}}processRows(e,t){return r=>{const i=this.rowModel,s=it(this.gos),n=pi(this.gos),o=!s&&e.onlySelected,a=this.processRow.bind(this,r,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(c=>null==c.rowPinned).sort((c,d)=>c.rowIndex-d.rowIndex).map(c=>i.getRow(c.rowIndex)).forEach(a);else if(this.columnModel.isPivotMode())s?i.forEachPivotNode(a,!0):n?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);else if(e.onlySelectedAllPages||o){const c=this.selectionService.getSelectedNodes();this.replicateSortedOrder(c),c.forEach(a)}else"all"===l?i.forEachNode(a):s||n?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);return r}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),r=(i,s)=>null!=i.rowIndex&&null!=s.rowIndex?i.rowIndex-s.rowIndex:i.level===s.level?i.parent?.id===s.parent?.id?this.rowNodeSorter.compareRowNodes(t,{rowNode:i,currentPos:i.rowIndex??-1},{rowNode:s,currentPos:s.rowIndex??-1}):r(i.parent,s.parent):i.level>s.level?r(i.parent,s):r(i,s.parent);e.sort(r)}processPinnedBottomRows(e,t){return r=>{const i=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(s=>"bottom"===s.rowPinned).sort((s,n)=>s.rowIndex-n.rowIndex).map(s=>this.pinnedRowModel.getPinnedBottomRow(s.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedRow("bottom",i),r}}getColumnsToExport(e=!1,t=!1,r){const i=this.columnModel.isPivotMode();if(r&&r.length)return this.columnModel.getColsForKeys(r);const s=this.gos.get("treeData");let n=[];return n=e&&!i?this.columnModel.getCols():this.visibleColsService.getAllCols(),t&&!s&&(n=n.filter(o=>Ec(o)||Js(o))),n}recursivelyAddHeaderGroups(e,t,r){const i=[];e.forEach(s=>{s.getChildren&&s.getChildren().forEach(o=>i.push(o))}),e.length>0&&ft(e[0])&&this.doAddHeaderHeader(t,e,r),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,r)}doAddHeaderHeader(e,t,r){const i=e.onNewHeaderGroupingRow();let s=0;t.forEach(n=>{const o=n;let a;a=r?r(this.gos.addGridCommonParams({columnGroup:o})):this.columnNameService.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((c,d,u,h)=>{let g=Le(c);return"open"===d.getColumnGroupShow()?(!g||null!=g[1])&&(g=[u],c.push(g)):g&&null==g[1]&&(g[1]=u-1),u===h.length-1&&g&&null==g[1]&&(g[1]=u),c},[]);i.onColumn(o,a||"",s++,o.getLeafColumns().length-1,l)})}}]},F8={version:kd,moduleName:"@ag-grid-community/csv-export",dependantModules:[D0,{version:kd,moduleName:"@ag-grid-community/csv-export-api",apiFunctions:{getDataAsCsv:function x8(e,t){return e.csvCreator?.getDataAsCsv(t)},exportDataAsCsv:function S8(e,t){e.csvCreator?.exportDataAsCsv(t)}},dependantModules:[D0]}]},R8=function(){var e=(0,oi.A)(function*(t){let r=0;const i=[],s=new WritableStream({write:a=>{i.push(a),r+=a.length}}),n=new ReadableStream({start:a=>{const l=new FileReader;l.onload=c=>{c.target?.result&&a.enqueue(c.target.result),a.close()},l.readAsArrayBuffer(t)}}),o=new window.CompressionStream("deflate-raw");return yield n.pipeThrough(o).pipeTo(s),{size:r,content:new Blob(i)}});return function(r){return e.apply(this,arguments)}}(),k8=function(){var e=(0,oi.A)(function*(t){const r=new Blob([t]),{size:i,content:s}=yield R8(r);return{size:i,content:new Uint8Array(yield s.arrayBuffer())}});return function(r){return e.apply(this,arguments)}}();function Wt(e,t){let r="";for(let i=0;i<t;i++)r+=String.fromCharCode(255&e),e>>>=8;return r}var M0=e=>e.length?(e=>{if(!e.length)return 0;let t=-1,r=0,i=0,s=0;for(let n=0;n<e.length;n++)r=e[n],i=255&(t^r),s=A8[i],t=t>>>8^s;return-1^t})("string"==typeof e?(new TextEncoder).encode(e):e):0,A8=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),I0=(e,t,r,i,s,n)=>{const{content:o,path:a,created:l}=e,c=(e=>{let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t})(l),d=(e=>{let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t})(l),u=M0(s),h=void 0!==n?n:i,g=function ZF(e){const t=String.fromCharCode;function s(u,h){return t(u>>h&63|128)}function n(u){if(!(4294967168&u))return t(u);let h="";return 4294965248&u?4294901760&u?4292870144&u||(h=t(u>>18&7|240),h+=s(u,12),h+=s(u,6)):(function i(u){if(u>=55296&&u<=57343)throw Error("Lone surrogate U+"+u.toString(16).toUpperCase()+" is not a scalar value")}(u),h=t(u>>12&15|224),h+=s(u,6)):h=t(u>>6&31|192),h+=t(63&u|128),h}const o=function r(u){const h=[];if(!u)return[];const g=u.length;let f,m,p=0;for(;p<g;)f=u.charCodeAt(p++),f>=55296&&f<=56319&&p<g?(m=u.charCodeAt(p++),56320==(64512&m)?h.push(((1023&f)<<10)+(1023&m)+65536):(h.push(f),p--)):h.push(f);return h}(e),a=o.length;let c,l=-1,d="";for(;++l<a;)c=o[l],d+=n(c);return d}(a),p=g!==a;let f="";if(p){const v=Wt(1,1)+Wt(M0(g),4)+g;f="up"+Wt(v.length,2)+v}const m="\x14\0"+(p?"\0\b":"\0\0")+Wt(t?8:0,2)+Wt(c,2)+Wt(d,2)+Wt(h?u:0,4)+Wt(n??i,4)+Wt(i,4)+Wt(g.length,2)+Wt(f.length,2),w="PK\x03\x04"+m+g+f,C="PK\x01\x02\x14\0"+m+"\0\0\0\0\0\0"+(o?"\0\0\0\0":"\x10\0\0\0")+Wt(r,4)+g+f;return{localFileHeader:Uint8Array.from(w,v=>v.charCodeAt(0)),centralDirectoryHeader:Uint8Array.from(C,v=>v.charCodeAt(0))}},L0=e=>{let t;if("string"==typeof e){const r=atob(e.split(";base64,")[1]);t=Uint8Array.from(r,i=>i.charCodeAt(0))}else t=e;return{size:t.length,content:t}},P8=function(){var e=(0,oi.A)(function*(t,r){const{content:i}=t,{size:s,content:n}=i?L0(i):{size:0,content:Uint8Array.from([])};let o,a,l=!1;if("file"===t.type&&n&&s>0){const u=yield k8(n);o=u.content,a=u.size,l=!0}return{...I0(t,l,r,s,n,a),content:o||n,isCompressed:l}});return function(r,i){return e.apply(this,arguments)}}(),M8=(e,t)=>{const{content:r}=e,{content:i}=r?L0(r):{content:Uint8Array.from([])};return{...I0(e,!1,t,i.length,i,void 0),content:i,isCompressed:!1}},_0=class{static addFolders(e){e.forEach(this.addFolder.bind(this))}static addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1,type:"folder"})}static addFile(e,t,r=!1){this.files.push({path:e,created:new Date,content:r?t:(new TextEncoder).encode(t),isBase64:r,type:"file"})}static getZipFile(e="application/zip"){var t=this;return(0,oi.A)(function*(){const r=yield t.buildCompressedFileStream();return t.clearStream(),new Blob([r],{type:e})})()}static getUncompressedZipFile(e="application/zip"){const t=this.buildFileStream();return this.clearStream(),new Blob([t],{type:e})}static clearStream(){this.folders=[],this.files=[]}static packageFiles(e){let t=0,r=0;for(const c of e){const{localFileHeader:d,centralDirectoryHeader:u,content:h}=c;t+=d.length+h.length,r+=u.length}const i=new Uint8Array(t),s=new Uint8Array(r);let n=0,o=0;for(const c of e){const{localFileHeader:d,centralDirectoryHeader:u,content:h}=c;i.set(d,n),n+=d.length,i.set(h,n),n+=h.length,s.set(u,o),o+=u.length}const a=((e,t,r)=>{const i="PK\x05\x06\0\0\0\0"+Wt(e,2)+Wt(e,2)+Wt(t,4)+Wt(r,4)+"\0\0";return Uint8Array.from(i,s=>s.charCodeAt(0))})(e.length,r,t),l=new Uint8Array(i.length+s.length+a.length);return l.set(i),l.set(s,i.length),l.set(a,i.length+s.length),l}static buildCompressedFileStream(){var e=this;return(0,oi.A)(function*(){const t=[...e.folders,...e.files],r=[];let i=0;for(const s of t){const n=yield P8(s,i),{localFileHeader:o,content:a}=n;r.push(n),i+=o.length+a.length}return e.packageFiles(r)})()}static buildFileStream(){const e=[...this.folders,...this.files],t=[];let r=0;for(const i of e){const s=M8(i,r),{localFileHeader:n,content:o}=s;t.push(s),r+=n.length+o.length}return this.packageFiles(t)}};_0.folders=[],_0.files=[];var L8=class extends k4{wireBeans(e){this.beans=e}constructor(e,t,r){super(e),this.parentCache=t,this.params=r,this.startRow=e*r.blockSize,this.endRow=this.startRow+r.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,r){te(t)?e.setDataAndId(t,r.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();Ie(this.params.datasource.getRows)?q("datasource is missing getRows method"):window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,r){this.rowNodes.forEach((i,s)=>{this.startRow+s<r&&e(i,t.next())})}getLastAccessed(){return this.lastAccessed}getRow(e,t=!1){return t||(this.lastAccessed=this.params.lastAccessedSequence.next()),this.rowNodes[e-this.startRow]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,r=new Si(this.beans);r.setRowHeight(this.params.rowHeight),r.uiLevel=0,r.setRowIndex(t),r.setRowTop(this.params.rowHeight*t),this.rowNodes.push(r)}}processServerResult(e){this.rowNodes.forEach((r,i)=>{const s=e.rowData?e.rowData[i]:void 0;!r.id&&r.alreadyRendered&&s&&(this.rowNodes[i]=new Si(this.beans),this.rowNodes[i].setRowIndex(r.rowIndex),this.rowNodes[i].setRowTop(r.rowTop),this.rowNodes[i].setRowHeight(r.rowHeight),r.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[i],s,this.startRow+i)}),this.parentCache.pageLoaded(this,null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0)}destroy(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()}),super.destroy()}},O8=class extends U{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}wireBeans(e){this.rowRenderer=e.rowRenderer,this.focusService=e.focusService}getRow(e,t=!1){const r=Math.floor(e/this.params.blockSize);let i=this.blocks[r];if(!i){if(t)return;i=this.createBlock(r)}return i.getRow(e)}createBlock(e){const t=this.createBean(new L8(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){0!=this.blockCount?(this.getBlocksInOrder().forEach(t=>t.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()):this.purgeCache()}destroy(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e)),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.gos.get("debug")&&Rr(`InfiniteCache - onPageLoaded: page = ${e.getId()}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e);t.sort((o,a)=>a.getLastAccessed()-o.getLastAccessed());const i=this.params.maxBlocksInCache>0,s=i?this.params.maxBlocksInCache-1:null;t.forEach((o,a)=>{if("needsLoading"===o.getState()&&a>=1||i&&a>=s){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t||null!=t.rowPinned)return!1;const r=e.getStartRow(),i=e.getEndRow();return t.rowIndex>=r&&t.rowIndex<i}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),r=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,r)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if("number"==typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const i=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<i&&(this.rowCount=i)}}setRowCount(e,t){this.rowCount=e,te(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize==0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t=new rn;this.getBlocksInOrder().forEach(r=>r.forEachNode(e,t,this.rowCount))}getBlocksInOrder(){return Hi(this.blocks).sort((r,i)=>r.getId()-i.getId())}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventService.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach(t=>{t.getId()*this.params.blockSize>=this.rowCount&&e.push(t)}),e.length>0&&e.forEach(t=>this.destroyBlock(t))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const r=[];let i=-1,s=!1;const n=new rn;let o=!1;return this.getBlocksInOrder().forEach(l=>{if(!o){if(s&&i+1!==l.getId())return void(o=!0);i=l.getId(),l.forEachNode(c=>{const d=c===e||c===t;(s||d)&&r.push(c),d&&(s=!s)},n,this.rowCount)}}),o||s?[]:r}},Td="32.2.1",O0={version:Td,moduleName:"@ag-grid-community/infinite-row-model-core",rowModel:"infinite",beans:[class extends U{constructor(){super(...arguments),this.beanName="rowModel"}wireBeans(e){this.filterManager=e.filterManager,this.sortController=e.sortController,this.selectionService=e.selectionService,this.rowRenderer=e.rowRenderer,this.rowNodeBlockLoader=e.rowNodeBlockLoader}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){"infinite"===this.gos.get("rowModelType")&&(this.rowHeight=fs(this.gos),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&q("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.onCacheUpdated.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=fs(this.gos),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;e=!this.cacheParams||this.isSortModelDifferent(),e&&this.reset()}isSortModelDifferent(){return!Kn(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){this.datasource&&(null!=Xs(this.gos)||this.selectionService.reset("rowDataChanged"),this.resetCache())}dispatchModelUpdatedEvent(){this.eventService.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager?.getFilterModel()??{},sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:fs(this.gos),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new rn},this.infiniteCache=this.createBean(new O8(this.cacheParams)),this.eventService.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){this.dispatchModelUpdatedEvent()}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode(r=>{r.id===e&&(t=r)}),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(0!==this.rowHeight){const t=Math.floor(e/this.rowHeight),r=this.getRowCount()-1;return t>r?r:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}}],dependantModules:[D4]};"object"!=typeof window||!window||"object"!=typeof document||(window,document),xi.__registerModules([x0,f8,{version:Td,moduleName:"@ag-grid-community/infinite-row-model",dependantModules:[O0,{version:Td,moduleName:"@ag-grid-community/infinite-row-model-api",beans:[R0],apiFunctions:{refreshInfiniteCache:function N8(e){e.rowModelHelperService?.getInfiniteRowModel()?.refreshCache()},purgeInfiniteCache:function G8(e){e.rowModelHelperService?.getInfiniteRowModel()?.purgeCache()},getInfiniteRowCount:function H8(e){return e.rowModelHelperService?.getInfiniteRowModel()?.getRowCount()}},dependantModules:[O0,jI]}]},F8],!1,void 0);let Q0=(()=>{class e extends $I{setViewContainerRef(r,i){this.viewContainerRef=r,this.angularFrameworkOverrides=i}createWrapper(r){const i=this.angularFrameworkOverrides,s=this,o=new class n extends kL{init(l){i.runInsideAngular(()=>{super.init(l),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return i.runInsideAngular(()=>s.createComponent(r))}hasMethod(l){return null!=o.getFrameworkComponentInstance()[l]}callMethod(l,c){const d=this.getFrameworkComponentInstance();return i.runInsideAngular(()=>o.getFrameworkComponentInstance()[l].apply(d,c))}addMethod(l,c){o[l]=c}};return o}createComponent(r){return this.viewContainerRef.createComponent(r)}static#e=this.\u0275fac=function(){let r;return function(s){return(r||(r=D.xGo(e)))(s||e)}}();static#t=this.\u0275prov=D.jDH({token:e,factory:e.\u0275fac})}return e})();class kL{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,Hr(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&"function"==typeof this._frameworkComponentInstance.destroy&&this._frameworkComponentInstance.destroy(),this._componentRef&&this._componentRef.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}}let Z0=(()=>{class e extends n0{constructor(r){super("angular"),this._ngZone=r,this.isRunningWithinTestZone=!1,this.wrapIncoming=(i,s)=>this.runOutside(i,s),this.wrapOutgoing=i=>this.runInsideAngular(i),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this.runOutside=this._ngZone?this.isRunningWithinTestZone?(i,s)=>"resize-observer"===s||"popupPositioning"===s?this._ngZone.runOutsideAngular(i):i():i=>this._ngZone.runOutsideAngular(i):i=>i()}get shouldWrapOutgoing(){return this._ngZone&&D.SKi.isInAngularZone()}isFrameworkComponent(r){if(!r)return!1;const i=r.prototype;return i&&"agInit"in i}runInsideAngular(r){return this._ngZone?this._ngZone.run(r):r()}runOutsideAngular(r,i){return this.runOutside(r,i)}static#e=this.\u0275fac=function(i){return new(i||e)(D.KVO(D.SKi))};static#t=this.\u0275prov=D.jDH({token:e,factory:e.\u0275fac})}return e})(),J0=(()=>{class e{constructor(r,i,s,n){this.viewContainerRef=i,this.angularFrameworkOverrides=s,this.frameworkComponentWrapper=n,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(o=>{this._resolveFullyReady=o}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.components=void 0,this.editType=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.advancedFilterModel=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressAsyncEvents=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.enableCellChangeFlash=void 0,this.cellFlashDuration=void 0,this.cellFlashDelay=void 0,this.cellFadeDuration=void 0,this.cellFadeDelay=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.suppressGroupMaintainValueType=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupIncludeFooter=void 0,this.groupIncludeTotalFooter=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.treeData=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideInfiniteScroll=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSideSortOnServer=void 0,this.serverSideFilterOnServer=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.toolPanelVisibleChanged=new D.bkB,this.toolPanelSizeChanged=new D.bkB,this.columnMenuVisibleChanged=new D.bkB,this.contextMenuVisibleChanged=new D.bkB,this.cutStart=new D.bkB,this.cutEnd=new D.bkB,this.pasteStart=new D.bkB,this.pasteEnd=new D.bkB,this.columnVisible=new D.bkB,this.columnPinned=new D.bkB,this.columnResized=new D.bkB,this.columnMoved=new D.bkB,this.columnValueChanged=new D.bkB,this.columnPivotModeChanged=new D.bkB,this.columnPivotChanged=new D.bkB,this.columnGroupOpened=new D.bkB,this.newColumnsLoaded=new D.bkB,this.gridColumnsChanged=new D.bkB,this.displayedColumnsChanged=new D.bkB,this.virtualColumnsChanged=new D.bkB,this.columnEverythingChanged=new D.bkB,this.columnHeaderMouseOver=new D.bkB,this.columnHeaderMouseLeave=new D.bkB,this.columnHeaderClicked=new D.bkB,this.columnHeaderContextMenu=new D.bkB,this.componentStateChanged=new D.bkB,this.cellValueChanged=new D.bkB,this.cellEditRequest=new D.bkB,this.rowValueChanged=new D.bkB,this.cellEditingStarted=new D.bkB,this.cellEditingStopped=new D.bkB,this.rowEditingStarted=new D.bkB,this.rowEditingStopped=new D.bkB,this.undoStarted=new D.bkB,this.undoEnded=new D.bkB,this.redoStarted=new D.bkB,this.redoEnded=new D.bkB,this.cellSelectionDeleteStart=new D.bkB,this.cellSelectionDeleteEnd=new D.bkB,this.rangeDeleteStart=new D.bkB,this.rangeDeleteEnd=new D.bkB,this.fillStart=new D.bkB,this.fillEnd=new D.bkB,this.filterOpened=new D.bkB,this.filterChanged=new D.bkB,this.filterModified=new D.bkB,this.advancedFilterBuilderVisibleChanged=new D.bkB,this.chartCreated=new D.bkB,this.chartRangeSelectionChanged=new D.bkB,this.chartOptionsChanged=new D.bkB,this.chartDestroyed=new D.bkB,this.cellKeyDown=new D.bkB,this.gridReady=new D.bkB,this.firstDataRendered=new D.bkB,this.gridSizeChanged=new D.bkB,this.modelUpdated=new D.bkB,this.virtualRowRemoved=new D.bkB,this.viewportChanged=new D.bkB,this.bodyScroll=new D.bkB,this.bodyScrollEnd=new D.bkB,this.dragStarted=new D.bkB,this.dragStopped=new D.bkB,this.dragCancelled=new D.bkB,this.stateUpdated=new D.bkB,this.paginationChanged=new D.bkB,this.rowDragEnter=new D.bkB,this.rowDragMove=new D.bkB,this.rowDragLeave=new D.bkB,this.rowDragEnd=new D.bkB,this.rowDragCancel=new D.bkB,this.columnRowGroupChanged=new D.bkB,this.rowGroupOpened=new D.bkB,this.expandOrCollapseAll=new D.bkB,this.pivotMaxColumnsExceeded=new D.bkB,this.pinnedRowDataChanged=new D.bkB,this.rowDataUpdated=new D.bkB,this.asyncTransactionsFlushed=new D.bkB,this.storeRefreshed=new D.bkB,this.headerFocused=new D.bkB,this.cellClicked=new D.bkB,this.cellDoubleClicked=new D.bkB,this.cellFocused=new D.bkB,this.cellMouseOver=new D.bkB,this.cellMouseOut=new D.bkB,this.cellMouseDown=new D.bkB,this.rowClicked=new D.bkB,this.rowDoubleClicked=new D.bkB,this.rowSelected=new D.bkB,this.selectionChanged=new D.bkB,this.cellContextMenu=new D.bkB,this.rangeSelectionChanged=new D.bkB,this.cellSelectionChanged=new D.bkB,this.tooltipShow=new D.bkB,this.tooltipHide=new D.bkB,this.sortChanged=new D.bkB,this._nativeElement=r.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this.angularFrameworkOverrides.runOutsideAngular(()=>{this.frameworkComponentWrapper.setViewContainerRef(this.viewContainerRef,this.angularFrameworkOverrides);const r=function lR(e,t){"object"!=typeof e&&(e={});const r={...e};return Jn.ALL_PROPERTIES_AND_CALLBACKS.forEach(s=>{const n=t[s];typeof n<"u"&&n!==Jn.VUE_OMITTED_PROPERTY&&(r[s]=n)}),r}(this.gridOptions,this);this.gridParams={globalEventListener:this.globalEventListener.bind(this),frameworkOverrides:this.angularFrameworkOverrides,providedBeanInstances:{frameworkComponentWrapper:this.frameworkComponentWrapper},modules:this.modules||[]};const i=function OI(e,t,r){if(!t)return Me("No gridOptions provided to createGrid"),{};const i=(new class{create(e,t,r,i,s){const o=function fI(e){const t={};return Object.entries(e).forEach(([r,i])=>{const s=S0(r,i);t[r]=s}),t}(Na.applyGlobalGridOptions(t)),a=o.gridId??String(BI++),l=this.getRegisteredModules(s,a),c=this.createBeansList(o.rowModelType,l,a),d=this.createProvidedBeans(e,o,s);if(!c)return void Me("Failed to create grid.");const h=new Rk({providedBeanInstances:d,beanClasses:c,gridId:a,beanInitComparator:Z4,beanDestroyComparator:J4,derivedBeans:[W4]});return this.registerModuleUserComponents(h,l),this.registerControllers(h,l),this.registerModuleApiFunctions(h,l),r(h),h.getBean("syncService").start(),i&&i(h),h.getBean("gridApi")}registerControllers(e,t){const r=e.getBean("ctrlsFactory");t.forEach(i=>{i.controllers&&i.controllers.forEach(s=>r.register(s))})}getRegisteredModules(e,t){const r=e?e.modules:null,i=xi.__getRegisteredModules(t),s=[],n={},o=(a,l,c)=>{var u;n[(u=l).moduleName]||(n[u.moduleName]=!0,s.push(u),xi.__register(u,a,c)),l.dependantModules&&l.dependantModules.forEach(u=>o(a,u,c))};return o(!!r?.length||!xi.__isPackageBased(),x0,void 0),r&&r.forEach(a=>o(!0,a,t)),i&&i.forEach(a=>o(!xi.__isPackageBased(),a,void 0)),s}registerModuleUserComponents(e,t){const r=this.extractModuleEntity(t,s=>s.userComponents?s.userComponents:[]),i=e.getBean("userComponentRegistry");r.forEach(({name:s,classImp:n,params:o})=>{i.registerDefaultComponent(s,n,o)})}registerModuleApiFunctions(e,t){const r=e.getBean("apiFunctionService");t.forEach(i=>{const s=i.apiFunctions;s&&Object.keys(s).forEach(o=>{r?.addFunction(o,s[o])})})}createProvidedBeans(e,t,r){let i=r?r.frameworkOverrides:null;Ie(i)&&(i=new n0);const s={gridOptions:t,eGridDiv:e,globalEventListener:r?r.globalEventListener:null,globalSyncEventListener:r?r.globalSyncEventListener:null,frameworkOverrides:i};return r&&r.providedBeanInstances&&Object.assign(s,r.providedBeanInstances),s}createBeansList(e="clientSide",t,r){const i=t.filter(l=>!l.rowModel||l.rowModel===e),s={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!s[e])return void Me("Could not find row model for rowModelType = ",e);if(!xi.__assertRegistered(s[e],`rowModelType = '${e}'`,r))return;const n=[sA,rA,mI,uI,V4,ok,q4,X4,ID,lp,RI,PD,vI,F4,Lk,sR,aA,pI,N4,b0,UF,qT,xI,wI,b4,II,WF,AD,LI,_I,S4,MD,Ak,lA,DD,nA,H4,P4,TD,DI,bI,yI,TI,MI,LD,U4,FI,kI,tA,cA,iA,eA,AI,EI,OD,CI,SI,BD,YF,j4,qF,$F,$4,K4,iR,KF,tR,Y4,rR,NF],o=this.extractModuleEntity(i,l=>l.beans?l.beans:[]);n.push(...o);const a=[];return n.forEach(l=>{a.indexOf(l)<0&&a.push(l)}),a}extractModuleEntity(e,t){return[].concat(...e.map(t))}}).create(e,t,s=>{const n=new g0(e);s.createBean(n)},void 0,r);if(!Object.isFrozen(t)&&!r?.frameworkOverrides){const s="https://ag-grid.com/javascript-data-grid/grid-interface/#grid-api";Object.defineProperty(t,"api",{get:()=>{Me(`gridOptions.api is no longer supported. See ${s}.`)},configurable:!0})}return i}(this._nativeElement,r,this.gridParams);i&&(this.api=i),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(r){this._initialised&&this.angularFrameworkOverrides.runOutsideAngular(()=>{const i={};Object.entries(r).forEach(([s,n])=>{i[s]=n.currentValue}),function cR(e,t){if(!e)return;const r={};let i=!1;if(Object.keys(e).filter(o=>Jn.ALL_PROPERTIES_AND_CALLBACKS_SET.has(o)).forEach(o=>{r[o]=e[o],i=!0}),!i)return;t.dispatchEvent({type:"gridOptionsChanged",options:r});const n={type:"componentStateChanged"};kr(r,(o,a)=>{n[o]=a}),t.dispatchEvent(n)}(i,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(r){const s=this[r],n=s?.observed??s?.observers?.length>0,o=`on${r.charAt(0).toUpperCase()}${r.substring(1)}`;return n||!!this.gridOptions&&!!this.gridOptions[o]}globalEventListener(r,i){if(this._destroyed)return;const s=this[r];if(s&&this.isEmitterUsed(r)){const n=()=>this.angularFrameworkOverrides.runInsideAngular(()=>s.emit(i));this._holdEvents?this._fullyReady.then(()=>n()):n()}}static#e=this.\u0275fac=function(i){return new(i||e)(D.rXU(D.aKT),D.rXU(D.c1b),D.rXU(Z0),D.rXU(Q0))};static#t=this.\u0275cmp=D.VBU({type:e,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:"suppressContextMenu",preventDefaultOnContextMenu:"preventDefaultOnContextMenu",allowContextMenuWithControlKey:"allowContextMenuWithControlKey",columnMenu:"columnMenu",suppressMenuHide:"suppressMenuHide",enableBrowserTooltips:"enableBrowserTooltips",tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:"tooltipMouseTrack",tooltipShowMode:"tooltipShowMode",tooltipInteraction:"tooltipInteraction",popupParent:"popupParent",copyHeadersToClipboard:"copyHeadersToClipboard",copyGroupHeadersToClipboard:"copyGroupHeadersToClipboard",clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:"suppressCopyRowsToClipboard",suppressCopySingleCellRanges:"suppressCopySingleCellRanges",suppressLastEmptyLineOnPaste:"suppressLastEmptyLineOnPaste",suppressClipboardPaste:"suppressClipboardPaste",suppressClipboardApi:"suppressClipboardApi",suppressCutToClipboard:"suppressCutToClipboard",columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:"maintainColumnOrder",enableStrictPivotColumnOrder:"enableStrictPivotColumnOrder",suppressFieldDotNotation:"suppressFieldDotNotation",headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",allowDragFromColumnsToolPanel:"allowDragFromColumnsToolPanel",suppressMovableColumns:"suppressMovableColumns",suppressColumnMoveAnimation:"suppressColumnMoveAnimation",suppressMoveWhenColumnDragging:"suppressMoveWhenColumnDragging",suppressDragLeaveHidesColumns:"suppressDragLeaveHidesColumns",suppressRowGroupHidesColumns:"suppressRowGroupHidesColumns",colResizeDefault:"colResizeDefault",suppressAutoSize:"suppressAutoSize",autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:"skipHeaderOnAutoSize",autoSizeStrategy:"autoSizeStrategy",components:"components",editType:"editType",singleClickEdit:"singleClickEdit",suppressClickEdit:"suppressClickEdit",readOnlyEdit:"readOnlyEdit",stopEditingWhenCellsLoseFocus:"stopEditingWhenCellsLoseFocus",enterNavigatesVertically:"enterNavigatesVertically",enterNavigatesVerticallyAfterEdit:"enterNavigatesVerticallyAfterEdit",enableCellEditingOnBackspace:"enableCellEditingOnBackspace",undoRedoCellEditing:"undoRedoCellEditing",undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:"suppressCsvExport",defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:"suppressExcelExport",excelStyles:"excelStyles",quickFilterText:"quickFilterText",cacheQuickFilter:"cacheQuickFilter",includeHiddenColumnsInQuickFilter:"includeHiddenColumnsInQuickFilter",quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:"applyQuickFilterBeforePivotOrAgg",excludeChildrenWhenTreeDataFiltering:"excludeChildrenWhenTreeDataFiltering",enableAdvancedFilter:"enableAdvancedFilter",advancedFilterModel:"advancedFilterModel",includeHiddenColumnsInAdvancedFilter:"includeHiddenColumnsInAdvancedFilter",advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",suppressAdvancedFilterEval:"suppressAdvancedFilterEval",suppressSetFilterByDefault:"suppressSetFilterByDefault",enableCharts:"enableCharts",chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:"masterDetail",keepDetailRows:"keepDetailRows",keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:"detailRowAutoHeight",context:"context",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:"valueCache",valueCacheNeverExpires:"valueCacheNeverExpires",enableCellExpressions:"enableCellExpressions",suppressTouch:"suppressTouch",suppressFocusAfterRefresh:"suppressFocusAfterRefresh",suppressAsyncEvents:"suppressAsyncEvents",suppressBrowserResizeObserver:"suppressBrowserResizeObserver",suppressPropertyNamesCheck:"suppressPropertyNamesCheck",suppressChangeDetection:"suppressChangeDetection",debug:"debug",loading:"loading",overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:"suppressLoadingOverlay",overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:"suppressNoRowsOverlay",pagination:"pagination",paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:"paginationAutoPageSize",paginateChildRows:"paginateChildRows",suppressPaginationPanel:"suppressPaginationPanel",pivotMode:"pivotMode",pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:"pivotSuppressAutoColumn",suppressExpandablePivotGroups:"suppressExpandablePivotGroups",functionsReadOnly:"functionsReadOnly",aggFuncs:"aggFuncs",suppressAggFuncInHeader:"suppressAggFuncInHeader",alwaysAggregateAtRootLevel:"alwaysAggregateAtRootLevel",aggregateOnlyChangedColumns:"aggregateOnlyChangedColumns",suppressAggFilteredOnly:"suppressAggFilteredOnly",removePivotHeaderRowWhenSingleValueColumn:"removePivotHeaderRowWhenSingleValueColumn",animateRows:"animateRows",enableCellChangeFlash:"enableCellChangeFlash",cellFlashDuration:"cellFlashDuration",cellFlashDelay:"cellFlashDelay",cellFadeDuration:"cellFadeDuration",cellFadeDelay:"cellFadeDelay",allowShowChangeAfterFilter:"allowShowChangeAfterFilter",domLayout:"domLayout",ensureDomOrder:"ensureDomOrder",enableRtl:"enableRtl",suppressColumnVirtualisation:"suppressColumnVirtualisation",suppressMaxRenderedRowRestriction:"suppressMaxRenderedRowRestriction",suppressRowVirtualisation:"suppressRowVirtualisation",rowDragManaged:"rowDragManaged",suppressRowDrag:"suppressRowDrag",suppressMoveWhenRowDragging:"suppressMoveWhenRowDragging",rowDragEntireRow:"rowDragEntireRow",rowDragMultiRow:"rowDragMultiRow",rowDragText:"rowDragText",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:"embedFullWidthRows",suppressGroupMaintainValueType:"suppressGroupMaintainValueType",groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:"groupMaintainOrder",groupSelectsChildren:"groupSelectsChildren",groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupIncludeFooter:"groupIncludeFooter",groupIncludeTotalFooter:"groupIncludeTotalFooter",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:"groupSuppressBlankHeader",groupSelectsFiltered:"groupSelectsFiltered",showOpenedGroup:"showOpenedGroup",groupRemoveSingleChildren:"groupRemoveSingleChildren",groupRemoveLowestSingleChildren:"groupRemoveLowestSingleChildren",groupHideOpenParents:"groupHideOpenParents",groupAllowUnbalanced:"groupAllowUnbalanced",rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",suppressMakeColumnVisibleAfterUnGroup:"suppressMakeColumnVisibleAfterUnGroup",treeData:"treeData",rowGroupPanelSuppressSort:"rowGroupPanelSuppressSort",suppressGroupRowsSticky:"suppressGroupRowsSticky",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:"suppressModelUpdateAfterUpdateTransaction",datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideInfiniteScroll:"suppressServerSideInfiniteScroll",suppressServerSideFullWidthLoadingRow:"suppressServerSideFullWidthLoadingRow",cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:"purgeClosedRowNodes",serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:"serverSideSortAllLevels",serverSideEnableClientSideSort:"serverSideEnableClientSideSort",serverSideOnlyRefreshFilteredGroups:"serverSideOnlyRefreshFilteredGroups",serverSideSortOnServer:"serverSideSortOnServer",serverSideFilterOnServer:"serverSideFilterOnServer",serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:"alwaysShowHorizontalScroll",alwaysShowVerticalScroll:"alwaysShowVerticalScroll",debounceVerticalScrollbar:"debounceVerticalScrollbar",suppressHorizontalScroll:"suppressHorizontalScroll",suppressScrollOnNewData:"suppressScrollOnNewData",suppressScrollWhenPopupsAreOpen:"suppressScrollWhenPopupsAreOpen",suppressAnimationFrame:"suppressAnimationFrame",suppressMiddleClickScrolls:"suppressMiddleClickScrolls",suppressPreventDefaultOnMouseWheel:"suppressPreventDefaultOnMouseWheel",scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:"rowMultiSelectWithClick",suppressRowDeselection:"suppressRowDeselection",suppressRowClickSelection:"suppressRowClickSelection",suppressCellFocus:"suppressCellFocus",suppressHeaderFocus:"suppressHeaderFocus",selectionColumnDef:"selectionColumnDef",suppressMultiRangeSelection:"suppressMultiRangeSelection",enableCellTextSelection:"enableCellTextSelection",enableRangeSelection:"enableRangeSelection",enableRangeHandle:"enableRangeHandle",enableFillHandle:"enableFillHandle",fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:"suppressClearOnFillReduction",sortingOrder:"sortingOrder",accentedSort:"accentedSort",unSortIcon:"unSortIcon",suppressMultiSort:"suppressMultiSort",alwaysMultiSort:"alwaysMultiSort",multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:"suppressMaintainUnsortedOrder",icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:"suppressRowHoverHighlight",suppressRowTransform:"suppressRowTransform",columnHoverHighlight:"columnHoverHighlight",gridId:"gridId",deltaSort:"deltaSort",treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:"enableGroupEdit",initialState:"initialState",theme:"theme",loadThemeGoogleFonts:"loadThemeGoogleFonts",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:"resetRowDataOnUpdate",processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},standalone:!0,features:[D.Jv_([Z0,Q0]),D.OA$,D.aNF],decls:0,vars:0,template:function(i,s){},encapsulation:2})}return e})(),TL=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=D.$C({type:e});static#r=this.\u0275inj=D.G2t({})}return e})(),DL=(()=>{class e{constructor(r){this.spinner=r,this.dataarrayobj=[],this.rowData=[],this.columnDefs=[],this.usergroup=[],this.mailmsg="",this.admin="",this.isadmin=!1,this.xlsxdataarrayobj=[],this.gridOptions={},this.gridOptions.rowClass="custom-row-class"}ngOnChanges(){this.rowData=this.spendlist,console.log(this.rowData)}ngOnInit(){this.columnDefs=[{headerName:"Id",field:"id",filter:!0,initialWidth:100,maxWidth:300},{headerName:"Id",field:"id",filter:!0,initialWidth:100,minWidth:160,maxWidth:300},{headerName:"Material",cellStyle:r=>"Credit"==r.value?{color:"white",backgroundColor:"green",fontWeight:"bold"}:null,field:"matname",filter:!0,initialWidth:100,minWidth:200,maxWidth:300},{headerName:"Materialgroup",field:"matgroup",cellStyle:r=>"Liability"===r.value?{color:"white",backgroundColor:"red",fontWeight:"bold"}:"Investment"===r.value?{color:"white",backgroundColor:"green",fontWeight:"bold"}:"Liability Give"==r.value?{color:"white",backgroundColor:"lightgreen",fontWeight:"bold"}:"Liability Get"==r.value?{color:"white",backgroundColor:"orange",fontWeight:"bold"}:null,filter:!0,initialWidth:100,minWidth:150,maxWidth:300},{headerName:"Price",field:"matprice",cellStyle:r=>r.value>999?{color:"white",backgroundColor:"red",fontWeight:"bold"}:null,filter:!0,initialWidth:150,minWidth:50,maxWidth:300},{headerName:"Balance",field:"matbalance",cellStyle:r=>r.value<2499?{color:"white",backgroundColor:"orange",fontWeight:"bold"}:null,filter:!0,initialWidth:150,minWidth:100,maxWidth:300},{headerName:"Date",field:"date",filter:!0,initialWidth:200,minWidth:30,maxWidth:300},{headerName:"Comment",field:"comments",filter:!0}],this.startdate=new Date,this.startdate=new Date(this.startdate.getTime()-864e5),this.enddate=new Date}xlsxwriter(){this.xlsxdataarrayobj=[];let r=0,i=0;const s=new Date;let u=`${String(s.getDate()).padStart(2,"0")}|${String(s.getMonth()+1).padStart(2,"0")}|${s.getFullYear()} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}:${String(s.getSeconds()).padStart(2,"0")}`;if(u=u.toString(),""!=this.mailmsg&&null!=this.mailmsg){console.log(this.mailmsg),this.dataarrayobj.filter(p=>{p.Name==this.mailmsg.Name&&new Date(p.Date)>=this.startdate&&new Date(p.Date)<=this.enddate&&(r=p.AccountBalance,i=p.InhandBalance,"Give"==p.Liabilitystatus?p.Materialgroup="Liability Give":"Get"==p.Liabilitystatus&&(p.Materialgroup="Liability Get"),this.xlsxdataarrayobj.push(p))}),console.log(this.xlsxdataarrayobj);const h=oc.json_to_sheet(this.xlsxdataarrayobj),g=oc.book_new();oc.book_append_sheet(g,h,"Sheet1"),function tF(e,t,r){var i=r||{};i.type="file",i.file=t,function rc(e){if(!e.bookType){var r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(i),tc(e,i)}(g,"data"+u+".xlsx")}}static#e=this.\u0275fac=function(i){return new(i||e)(D.rXU(fF.ex))};static#t=this.\u0275cmp=D.VBU({type:e,selectors:[["app-grid"]],inputs:{spendlist:["Spendlist","spendlist"]},features:[D.OA$],decls:1,vars:4,consts:[[1,"ag-theme-alpine","m-2",2,"width","99%","height","80vh",3,"rowData","columnDefs","pagination","gridOptions"]],template:function(i,s){1&i&&D.nrm(0,"ag-grid-angular",0),2&i&&D.Y8G("rowData",s.rowData)("columnDefs",s.columnDefs)("pagination",!0)("gridOptions",s.gridOptions)},dependencies:[J0]})}return e})();function AL(e,t){if(1&e&&(D.j41(0,"div"),D.nrm(1,"app-summarycard",7),D.k0s()),2&e){const r=t.$implicit;D.R7$(1),D.Y8G("carddetails",r)}}function PL(e,t){if(1&e&&(D.j41(0,"div"),D.nrm(1,"app-summarycard",7),D.k0s()),2&e){const r=t.$implicit;D.R7$(1),D.Y8G("carddetails",r)}}function ML(e,t){if(1&e&&(D.j41(0,"div"),D.nrm(1,"app-summarycard",7),D.k0s()),2&e){const r=t.$implicit;D.R7$(1),D.Y8G("carddetails",r)}}function IL(e,t){if(1&e&&(D.j41(0,"div")(1,"h1",4),D.EFF(2,"Spend Margin"),D.k0s(),D.j41(3,"div",5),D.DNE(4,AL,2,1,"div",6),D.k0s(),D.j41(5,"h1",4),D.EFF(6,"Invest Margin"),D.k0s(),D.j41(7,"div",5),D.DNE(8,PL,2,1,"div",6),D.k0s(),D.j41(9,"h1",4),D.EFF(10,"Total Margin"),D.k0s(),D.j41(11,"div",5),D.DNE(12,ML,2,1,"div",6),D.k0s()()),2&e){const r=D.XpG();D.R7$(4),D.Y8G("ngForOf",r.Spendreport),D.R7$(4),D.Y8G("ngForOf",r.Investreport),D.R7$(4),D.Y8G("ngForOf",r.totalreport)}}function LL(e,t){if(1&e&&D.nrm(0,"app-grid",8),2&e){const r=D.XpG();D.Y8G("Spendlist",r.griddata)}}const _L=[{path:"main",component:(()=>{class e{constructor(r){this.fb=r,this.iscard="MARGIN",this.cardsdata=[],this.ischart=!1,this.last1DaysDatainv=[],this.last7DaysDatainv=[],this.last30DaysDatainv=[],this.Spendreport=[],this.Investreport=[],this.totalinvest=0,this.totalspend=0,this.totalreport=[]}ngOnInit(){this.fb.getAllspendItems().subscribe(r=>{this.data=r,this.summarizespend(this.data)}),this.fb.getAllinvestItems().subscribe(r=>{this.investdata=r,this.summarizeinvest(this.investdata)}),this.fb.getAllspendItemsgrid().subscribe(r=>{this.griddata=r})}summarizespend(r){let i=[],s=[],n=[];this.filterDataByDate(r,1,i),0==i.length&&(i=[{matprice:"Nil"}]),this.Spendreport.push({...Ur.maxBy(i,"matprice"),heading:"MaxofToday"}),this.filterDataByDate(r,7,s),0==s.length&&(s=[{matprice:"Nil"}]),this.Spendreport.push({...Ur.maxBy(s,"matprice"),heading:"Maxof7days"}),this.filterDataByDate(r,30,n),0==n.length&&(n=[{matprice:"Nil"}]),this.Spendreport.push({...Ur.maxBy(n,"matprice"),heading:"Maxof30days"}),0==this.Spendreport.length&&(this.Spendreport=[{matprice:0}]),this.Spendreport.push({...Ur.maxBy(r,"matprice"),heading:"MaxofAlltime"}),this.totalreport.push({matprice:Ur.sumBy(r,"matprice"),heading:"Total Spend"}),console.log(this.Spendreport)}summarizeinvest(r){let i=[],s=[],n=[];this.filterDataByDate(r,1,i),0==i.length&&(i=[{matprice:"Nil"}]),this.Investreport.push({...Ur.maxBy(i,"matprice"),heading:"MaxofToday"}),this.filterDataByDate(r,7,s),0==s.length&&(s=[{matprice:"Nil"}]),this.Investreport.push({...Ur.maxBy(s,"matprice"),heading:"Maxof7days"}),this.filterDataByDate(r,30,n),0==n.length&&(n=[{matprice:"Nil"}]),this.Investreport.push({...Ur.maxBy(n,"matprice"),heading:"Maxof30days"}),0==this.Investreport.length&&(this.Investreport=[{matprice:0}]),this.Investreport.push({...Ur.maxBy(r,"matprice"),heading:"MaxofAlltime"}),this.totalreport.push({matprice:Ur.sumBy(r,"matprice"),heading:"Total Invest"}),console.log(this.Investreport)}filterDataByDate(r,i,s){return(0,oi.A)(function*(){const n=new Date,o=new Date;o.setDate(n.getDate()-i),console.log(o),r.forEach(a=>{const l=new Date(a.date);l>=o&&l<=n&&s.push(a)})})()}static#e=this.\u0275fac=function(i){return new(i||e)(D.rXU(dm.f))};static#t=this.\u0275cmp=D.VBU({type:e,selectors:[["app-summary"]],decls:7,vars:2,consts:[[1,"d-flex","justify-content-center","my-2"],[1,"btn","btn-sm","btn-info","mx-1","text-white",3,"click"],[4,"ngIf"],[3,"Spendlist",4,"ngIf"],[1,"text-center"],[1,"d-flex","flex-wrap","justify-content-center","card-container"],[4,"ngFor","ngForOf"],[3,"carddetails"],[3,"Spendlist"]],template:function(i,s){1&i&&(D.j41(0,"div",0)(1,"button",1),D.bIt("click",function(){return s.iscard="MARGIN"}),D.EFF(2,"OVERVIEW"),D.k0s(),D.j41(3,"button",1),D.bIt("click",function(){return s.iscard="GRID"}),D.EFF(4,"GRID LIST"),D.k0s()(),D.DNE(5,IL,13,3,"div",2),D.DNE(6,LL,1,1,"app-grid",3)),2&i&&(D.R7$(5),D.Y8G("ngIf","MARGIN"==s.iscard),D.R7$(1),D.Y8G("ngIf","GRID"==s.iscard))},dependencies:[hn.Sq,hn.bT,Cm,DL],styles:[".card-conatiner[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:0px;justify-content:center;width:100%}"]})}return e})()},{path:"**",redirectTo:"main"}];let OL=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=D.$C({type:e});static#r=this.\u0275inj=D.G2t({imports:[Hd.iI.forChild(_L),Hd.iI]})}return e})();var BL=ar(205),NL=ar(7644),GL=ar(5351);let HL=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=D.$C({type:e});static#r=this.\u0275inj=D.G2t({providers:[BL.i],imports:[hn.MD,OL,J0,vm,TL,NL.EntryModule,GL.hM]})}return e})()}}]);